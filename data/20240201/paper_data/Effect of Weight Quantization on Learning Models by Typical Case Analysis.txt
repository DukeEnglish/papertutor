EFFECT OF WEIGHT QUANTIZATION ON LEARNING MODELS
BY TYPICAL CASE ANALYSIS
SHUHEIKASHIWAMURA1,AYAKASAKATA2,MASAAKIIMAIZUMI1,3
1 2 3
TheUniversityofTokyo ,TheInstituteofStatisticalMathematics ,RIKENAIP
Abstract. Thispaperexaminesthequantizationmethodsusedinlarge-scaledataanalysismodels
andtheirhyperparameterchoices. Therecentsurgeindataanalysisscalehassignificantlyincreased
computational resource requirements. To address this, quantizing model weights has become a
prevalent practice in data analysis applications such as deep learning. Quantization is particularly
vital for deploying large models on devices with limited computational resources. However, the
selectionofquantizationhyperparameters,likethenumberofbitsandvaluerangeforweightquan-
tization, remains an underexplored area. In this study, we employ the typical case analysis from
statisticalphysics,specificallythereplicamethod,toexploretheimpactofhyperparametersonthe
quantization of simple learning models. Our analysis yields three key findings: (i) an unstable
hyperparameterphase,knownasreplicasymmetrybreaking,occurswithasmallnumberofbitsand
alargequantizationwidth;(ii)thereisanoptimalquantizationwidththatminimizeserror;and(iii)
quantizationdelaystheonsetofoverparameterization,helpingtomitigateoverfittingasindicatedby
thedoubledescentphenomenon. Wealsodiscoverthatnon-uniformquantizationcanenhancestabil-
ity. Additionally,wedevelopanapproximatemessage-passingalgorithmtovalidateourtheoretical
results.
1. Introduction
Thedevelopmentofdata-drivenscience,whichinvolvesanalyzinglarge-scaleobservationaldata
using models with a vast number of parameters, has led to a significant increase in computational
costs. Aprimeexampleisthelarge-scaleneuralnetworksusedinartificialintelligencetechnologies.
Forinstance,GPT(GenerativePre-trainedTransformer)-3[BMR+20]possessestensofbillionsof
parameters, requiring substantial computational resources for storage and updates in computer
memory. Moreover, with the growing need to implement these models in small-edge devices,
itâ€™s crucial to minimize their computational resource requirements. Practical applications, such as
implementing neural networks in smartphones and in-vehicle sensors, are examples of this trend
[LGW+21]. Reducingcomputationalcostsisessentialtoachieveaccurateandsustainableinference
onthesedevices.
Quantizationisoneofthemostcommontechniquesforcompressinglargemodels(forasurvey,
see [GKD+22]). Quantization involves rounding the parameters or activation values of a model to
discretevalueswithlowerbitprecision. Specifically,itconvertsoriginalvaluesstoredwithhigher
bits, e.g., 32 bits, to lower bits, such as 4 or 8 bits. This operation not only reduces the amount
ofmemoryrequiredtostoreparametersbutalsodecreasesthecomputationalresourcesneededfor
operations like matrix products. In practice, it is empirically known that quantization minimally
impactsthepredictionaccuracyofneuralnetworks,therebyenhancingtheutilityofthistechnology
Date:January31,2024.
1
4202
naJ
03
]LM.tats[
1v96271.1042:viXra(see [BHHS18] for an example). Additionally, quantization can be integrated with other model
compressiontechniques,suchasdistillationandpruning[LGW+21]. Itssignificanceisanticipated
togrowasmodels,includingnewversionsofGPT,continuetoincreaseinsize.
Anongoingchallengeinquantizationistheselectionofhyperparameters,includingthenumber
ofbitsandthequantizationrange. Whileneuralnetworksexhibitsomerobustnesstoquantization,
a significant reduction in the number of bits can make them susceptible to outliers and data
shifts. Consequently, it is crucial to choose appropriate hyperparameters that balance accuracy
with computational load. Nevertheless, the comprehension of quantization remains an evolving
issue. The characteristics of optimal hyperparameters and their very existence are still not fully
understood.
In this study, we investigate the effects of hyperparameters on quantization, namely the number
of bits and the quantization range, and their impact on its generalization performance. To achieve
this, we employ typical case analysis from statistical physics, the replica method, to analyze
the characteristics of a simple learning model. Specifically, we focus on the learning model in
the proportionally high-dimensional regime, where the number of parameters infinitely increases
whilemaintainingaconstantratiotothesamplesize. Throughthismethod,wederivethestability
condition for the replica symmetric ansatz, which can be a stability measure for algorithms under
quantization,detectingexponentialnumberoflocalminima[RTWZ01],andsubsequentlyascertain
the precise value of the generalization error in the high-dimensional regime. Additionally, we
exploretwoquantizationpatterns,uniformandnon-uniformquantization.
Asforthetheoreticalcontributions,thisstudyelucidatedthefollowingpoints:
â€¢ When the number of bits is small and the quantization range is broad, unstable phases
intermittently appear, leading to algorithmic instability. Moreover, these unstable phases
canbemitigatedthroughnon-uniformquantization.
â€¢ Regarding the selection of hyperparameters, greater bit numbers result in higher accuracy.
Conversely, there exists an optimal quantization range that is neither excessively large nor
toosmall.
â€¢ Quantization alters the peak of the double descent in the generalization error. In simpler
terms, quantization slightly hinders reaching a phase where the learning model mitigates
overfitting.
Additionally, we applied Approximate Message Passing (AMP) algorithm to the quantization
that corresponds to the replica analysis. The simulation results from this algorithm validate our
theoreticalfindings.
1.1. Related Studies. Papers on quantization, especially for neural networks, are numerous and
have a long history. Only a few are mentioned here; the techniques of quantization prior to
the 2000s are summarized in the paper [GN98]. A seminal study [BHHS18] demonstrated the
utility of quantization in more modern deep learning and discussed the effectiveness of 8-bit
quantization. Thispolicyandtheimportantroleofbitsindeeplearningwereactivelydiscussedin
[WCB+18,WJZ+20,CBD14,BLS+21]. Morepracticaluseofthequantizationisalsoinvestigated:
a study [CBUS+20] demonstrated the effectiveness of 6-bit quantization techniques in improving
performancewithnaturalgradientmethods. Theseresearchstreamsofquantizationareexhaustively
summarizedin[GKD+22].
Thetheoreticalstudyofquantizationisstilladevelopingfield. Thisstudy[DLXS19]investigated
the universal approximability of neural network models with the quantization, i.e., any continuous
function can be approximated under any accuracy, as well as the magnitude of overfitting when
2(cid:2)(cid:3) (cid:2)(cid:3)
(a) (b)
(cid:4) (cid:4)
(cid:3) (cid:3)
(cid:1)(cid:4) (cid:1)(cid:4)
(cid:1)(cid:2)(cid:3) (cid:1)(cid:2)(cid:3)
(cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3) (cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3)
(cid:6)(cid:3) (c) (cid:6)(cid:3) (d)
(cid:5)(cid:3) (cid:5)(cid:3)
(cid:2)(cid:3) (cid:2)(cid:3)
(cid:3) (cid:3)
(cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3) (cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3)
ğ‘¤ ğ‘¤
Figure 1. (a) and (b): Quanzied values ğ‘¤ = ğœ‘(ğ‘¤) as a function of continuous
(cid:98)
parameter ğ‘¤ at ğœ” = 8 and ğ‘› ğ‘ = 6 for (a) uniform and (b) non-uniform cases. The
diagonal lines represent the identity map. (c) and (d): Loss function at ğ‘ = ğ‘€ = 1
for ğ‘¦ = 0 and ğ‘¥ = 1 with ğœ† = 0 for (c) uniform and (d) non-uniform quantization
correspondingto(a)and(b),respectively.
making predictions with the quantized neural network. Another paper [HTL+23] discussed theo-
retically the impact of the training process with the quantization on this prediction performance.
Thispaper[GBGR23]quantifiedtheimpactofquantizationontheapproximationabilityofneural
networks. This study [LDX+17] analyzed theoretically the difficulty of learning by the quanti-
zation, and another study [CEKL16] proposed a new loss function and methodology to prevent
performancedegradationduetothequantization.
Quantization has been a subject of investigation in statistical physics, particularly in classical
spin models like the Ising model with binary variables and the Potts model with ğ¾-state values.
The variations in phase transition phenomena arising from distinct values of variables have been
discussed[MPV87]. Statisticalphysicsmodelsandmethodshavebeenincorporatedintostatistical
learning, and have successfully revealed conditions for both the failure and success of inference,
as well as the development of the efficient algorithms [KWT09, KMS+12a, KMS+12b, ZK16]. In
line with recent trends, quantization settings are incorporated in statistical physics-based machine
learning studies, such as Hopfield model with discrete coupling [SA21], restricted Boltzmann
machine with binary synapses [Hua17], and single layer neural network with multiple states
[BGL+16]. However, there is still a lack of discussion on proper quantization, especially in
termsofgeneralization,whichisfocusofourstudy.
2. ProblemSetup
2.1. Quantization. Quantization is a procedure that converts real values ğ‘¤ âˆˆ R into their closest
discretecounterpartsğ‘¤withinapredefinedsetofcandidatevaluesÎ©. Werepresentthequantization
(cid:98)
asğ‘¤ = ğœ‘(ğ‘¤),usingaquantizationfunctionğœ‘ : R â†’ Î©thatoutputsthevalueinÎ©closesttoğ‘¤. This
(cid:98)
3
ğ‘¤
ğœ‘
=
ğ‘¤#
ğ‘¤
ğ¸quantizationprocessisdeterminedbyclippingandpartitioning[WJZ+20]. Intheclippingprocess,
continuous values whose absolute magnitude exceeds ğœ” are capped at Â±ğœ”, while their respective
signs are preserved. Further, the range [âˆ’ğœ”,ğœ”] is divided into ğ‘› subintervals following the
ğ‘
partitioning procedure, and possible discrete values are located at the edges of these subintervals,
hence |Î©| = ğ‘› ğ‘+1. Here,wedefinethenumberofbits,ğ‘ := log 2(ğ‘› ğ‘+2),capableofassumingreal
values. We investigate two types of quantization: uniform and non-uniform quantizations, which
areillustratedinFig.1(a)and(b).
2.1.1. UniformQuantization[WJZ+20]. Inuniformquantization,thesubintervalshaveequalwidth
2ğœ”/ğ‘› .
ğ‘
2.1.2. Non-Uniform Quantization. Non-uniform quantization is introduced to finely partition the
significant value regions [HMD15, ZHMD16]. We consider a non-uniform quantization based on
a uniform partition in the log-domain, which is a slightly updated version of [MLM16, ZYG+16].
Here,thesubintervalwidthclosesttozeroissettoÎ”0 givenby,
ğœ”
Î”0 = (1)
2(ğ‘› ğ‘+ğ‘˜)/2 âˆ’ ğ‘˜
where ğ‘˜ = 2 for an even ğ‘› ğ‘ and ğ‘˜ = 3 for an odd ğ‘› ğ‘. The widths of other subintervals are larger
thanÎ”0 andaretwiceaswideastheirnearestneighborsubintervalwidthtowardzero1.
2.2. Learning Problem with Linear Model. We formulate the problem setting. Let ğ‘€ be a
sample size and ğ‘ be a dimension. Suppose that we have ğ‘€ pairs of an predictor and output
D := {(xğœ‡,ğ‘¦ ğœ‡)} ğœ‡ğ‘€ =1 âŠ‚ Rğ‘ Ã— R, which is independently generated from the linear model ğ‘¦ ğœ‡ =
xâŠ¤w0 + ğœ€0 with the true parameter w0 âˆˆ Rğ‘ and the independent noise ğœ€0 âˆ¼ N(0,ğœ2). The
ğœ‡ ğœ‡ ğœ‡
components of the true parameter and predictors are independently drawn from N(0,ğœŒ) with
ğœŒ > 0 and N(0,1/ğ‘), respectively 2. We also introduce a notation y = (ğ‘¦ 1,...,ğ‘¦ ğ‘€)âŠ¤ âˆˆ Rğ‘€ and
X = (x1,...,xğ‘€)âŠ¤ âˆˆ Rğ‘€Ã—ğ‘.
We formulate the estimation procedure for parameters with quantization. We define a quanti-
zation map Ï† : Rğ‘ â†’ Î©ğ‘ for a vector w = (ğ‘¤ 1,...,ğ‘¤ ğ‘) âˆˆ Rğ‘ as Ï†(w) = (ğœ‘(ğ‘¤ 1),...,ğœ‘(ğ‘¤ ğ‘))âŠ¤.
Then,weconsidertheempiricalriskofw âˆˆ Rğ‘ withtheâ„“
2
regularizationwithacoefficientğœ† > 0:
1 ğœ†
ğ¸(w;D) := âˆ¥y âˆ’XÏ†(w)âˆ¥2 + âˆ¥Ï†(w)âˆ¥2. (2)
2 2 2 2
Thelossfunctionisnonconvexduetothequantization,asshowninFig.1. Thetrainedcontinuous
parameter
wâˆ—(D) := argminğ¸(w;D), (3)
wâˆˆRğ‘
constitutecontinuoussetsthatcoversubintervalatthebottomofloss(Fig.1(c)and(d)). Here,we
denotequantizedvaluesof (3)aswâˆ—(D) := Ï†(wâˆ—(D)).
(cid:98)
1We define this partition width using ğ‘› and ğœ” to compare it with uniform quantization. For various designs of
ğ‘
non-uniformquantization,seethecomprehensivereviewby[BLS+21].
2Thesesettingsarenotrestrictiveasitseems. IthasbeenshownthatasymptoticbehaviorsofGaussianuniversality
regression problems with a large class of features can be computed to leading order under a simpler model with
Gaussianfeatures[LGC+21,GLR+22,MS22,GKL+23].
4Our interest is a generalization error, which measures a prediction performance of the trained
parameter wâˆ—(D). With a newly generated pair (ğ‘¦ new,xnew) from the identical distribution of the
observations D,wedefineanexpectationofthegeneralizationerroras
1
ğ¸ ğ‘” := 2E D[E (ğ‘¦ new,xnew)[(ğ‘¦ new âˆ’xâŠ¤ neww (cid:98)âˆ—(D))2 ]]. (4)
Simplecalculationsyieldtheexpression
1 (cid:16) (cid:17)
ğ¸ ğ‘” = ğ‘„ ğœ‘ âˆ’2ğ‘š ğœ‘ + ğœŒ +ğœ2 (5)
2
withğ‘„ ğœ‘ := ğ‘1E D[âˆ¥w (cid:98)âˆ—(D)âˆ¥2 2] and ğ‘š ğœ‘ := ğ‘1E D[w0âŠ¤ w (cid:98)âˆ—(D)].
3. ReplicaAnalysis
We employ replica method [MPV87, CMP+23] to compute the terms ğ‘„ ğœ‘ and ğ‘š ğœ‘ in (5). In
preparation,weintroducetheposteriordistributionwithaparameter ğ›½ > 0as
ğ‘ ğ›½(w|D) = exp(âˆ’ğ›½ğ¸(w;D))/ğ‘ ğ›½(D), (6)
âˆ«
where ğ‘ ğ›½(D) = ğ‘‘wexp(âˆ’ğ›½ğ¸(w)) is the normalization constant. At ğ›½ â†’ âˆ, the posterior
distributionconvergestotheuniformdistributionoverthesolution(3). Denotingtheposteriormean
atğ›½ â†’ âˆasâŸ¨wâŸ© ,itsquantizedvalueÏ†(âŸ¨wâŸ© )isequivalenttowâˆ—(D),whenthequantizedvalue
D D (cid:98)
of (3)isunique. Further, âŸ¨ğœ‘(w)âŸ© D = ğœ‘(âŸ¨wâŸ© D) holds,henceweobtainğ‘„ ğœ‘ = ğ‘1E D (cid:2) âŸ¨âˆ¥ğœ‘(w)âˆ¥2 2âŸ© D(cid:3)
and ğ‘š ğœ‘ = ğ‘1E D[w0âŠ¤ âŸ¨Ï†(w)âŸ© D]. Since the posterior mean has ğ‘ ğ›½(D) in its denominator, which
requires summations over exponential number of terms, we need the following procedure. As we
set
1
(cid:34) âˆ« ğ‘‘wâˆ¥ğœ‘(w)âˆ¥2exp(âˆ’ğ›½ğ¸(w))(cid:35)
ğ‘„ ğœ‘(ğ‘›) = ğ›½l â†’im âˆğ‘E
D
ğ‘ ğ›½ğ‘› (D)
ğ‘
ğ›½2
(D)
, (7)
it is obvious that ğ‘„ ğœ‘ = lim ğ‘›â†’0ğ‘„ ğœ‘(ğ‘›) holds. Assuming that ğ‘› is an integer larger than 1, the
denominatoriscanceled,andtheterm ğ‘ğ‘›âˆ’1(D)exp(âˆ’ğ›½ğ¸(w)) canbeexpressedwithğ‘›-replicated
ğ›½
systems with w1,Â·Â·Â· ,wğ‘›. At ğ‘€ â†’ âˆ and ğ‘ â†’ âˆ with keeping ğ›¼ = ğ‘€/ğ‘ âˆ¼ ğ‘‚(1), the
expectation E [Â·] is implemented by the saddle point evaluation. The resulting expression for the
D
integer ğ‘› is analytically continued to ğ‘› âˆˆ R to take the limit ğ‘› â†’ 0 under the replica symmetric
(RS)ansatz,whereweassumethatthedominantsaddlepointisinvariantunderanypermutationof
replica indices ğ‘ = 1,2,Â·Â·Â· ,ğ‘›. Finally, ğ‘„ ğœ‘ and ğ‘š ğœ‘ are given by ğ‘„ and ğ‘š that satisfy saddle point
equations
âˆ« âˆ«
ğ‘„ = ğ·ğ‘§(ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)))2, ğ‘š = ğ‘š (cid:98)ğœŒ ğ·ğ‘§ğœ•ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)), (8)
where ğ·ğ‘§ = âˆšğ‘‘ 2ğ‘§ ğœ‹ğ‘’âˆ’1 2ğ‘§2, â„ = âˆšï¸ ğ‘š (cid:98)2ğœŒ + (cid:98)ğœ’ andÎ˜(cid:98) = ğ‘„ (cid:98)+ğœ† satisfy
ğ›¼ 2ğ›¼E âˆ«
ğ‘”
ğ‘„ (cid:98)= ğ‘š
(cid:98)
=
1+
ğœ’, (cid:98)ğœ’ =
(1+
ğœ’)2, ğœ’ = ğ·ğ‘§ğœ•ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)). (9)
530 30
(a) (b)
20 20
10 10
2 3 4 5 2 3 4 5
30 30
(c) (d)
20 20
10 10
2 3 4 5 2 3 4 5
b b
Figure 2. Phase diagrams on ğ‘ âˆ’ ğœ” plane for quantized regression at (ğœ,ğ›¼) =
(0.01,1.5). Shaded and blighted regions are RS and RSB phase, respectively. (a)
and(b)areunderuniformquantizationatğœ† = 0.0andğœ† = 1.0,respectively. (c)and
(d)areundernon-uniformquantizationatğœ† = 0.0andğœ† = 1.0,respectively.
Here, E ğ‘” = 21 (ğ‘„ âˆ’2ğ‘š + ğœŒ +ğœ2) coincides with ğ¸ ğ‘” at the saddle point. The function ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)) is
thesolutionoftheproblem
(cid:26)1 (cid:27)
ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)) = argmin Î˜(cid:98)ğ‘‘2 âˆ’ â„ğ‘§ğ‘‘ , (10)
2
ğ‘‘âˆˆÎ©
whichcorresponds ğœ‘(â„ğ‘§/Î˜(cid:98)),namelythethesolutionofthequantization-restrictedridgeoptimiza-
tion problem under RS assumption3[KWT09], and ğœ•ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)) = ğœ•(ğœ• â„ğ‘§)ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)). The random
variable ğ‘§ effectively represents the randomness induced by data D, and the solution of (10) is
statisticallyequivalenttothesolutionoftheoriginalproblem(3)[BM11].
4. Result
4.1. Phase Diagram. We study the RS ansatz for replica analysis. The RS solution loses local
stability against symmetry breaking perturbations when the following condition is not satisfied
[DAT78]:
ğ›¼ âˆ« (cid:16) (cid:17)2
ğ·ğ‘§ ğœ•ğœ‘âˆ—(â„ğ‘§,Î˜(cid:98)) < 1. (11)
(1+ ğœ’)2
Thephasessatisfying(11)andthatnotsatisfyingitaretermedasRSandreplicasymmetrybreaking
(RSB) phases, respectively. In the RSB phase, algorithmic instabilities arise due to exponential
number of local minima [AHW95, MPV87], necessitating quantization hyperparameter setting to
avoidtheRSBphase.
3This correspondence does not mean that the obtained quantized posterior mean is equivalent to the quantized
solutionforridgeregression. Thesaddlepointsdependonthequantizationfunction,hencethevaluesof â„andÎ˜(cid:98)for
quantizedregressiondifferfromthoseinusualridgeregression.
6
Ï‰
Ï‰
Ï‰
Ï‰(cid:3)(cid:5)(cid:8) (cid:3)(cid:5)(cid:8)
(a) (b)
(cid:3)(cid:5)(cid:7) (cid:3)(cid:5)(cid:7)
(cid:3)(cid:5)(cid:6) (cid:3)(cid:5)(cid:6)
(cid:3)(cid:5)(cid:2) (cid:3)(cid:5)(cid:2)
âˆ’ğœ” ğ‘¤$ ğœ” âˆ’ğœ” ğ‘¤$ ğ‘¤$ ğœ”
! ! "
(cid:3) (cid:3)
(cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3) (cid:1)(cid:2)(cid:3) (cid:1)(cid:4) (cid:3) (cid:4) (cid:2)(cid:3)
Figure 3. Comparison between the distribution of continuous value â„ğ‘§/Î˜(cid:98) (solid
line)andquantizedvaluesinÎ©withğœ” = 10(dots)for(a)ğ‘› ğ‘ = 2and(b)ğ‘› ğ‘ = 3under
uniformquantization. Here,weset â„/Î˜(cid:98) = 1forsimplicity,andareascorresponding
tothediscretevaluesareshadedseparately.
Figure 2 shows the phase diagrams for uniform quantization ((a), (b)) and non-uniform quanti-
zation((c),(d)). Weobtainseveralimplicationsasfollows.
(I): Irrespective of the quantization method, large bits ğ‘ and small ğœ” result in RS phase. This
alignswiththefactthatalargeğ‘ makesquantizedvaluesclosertocontinuousvalues. Additionally,
a small ğœ” induces shrinkage in estimates, which tends to be the RS phase as the effective model
complexityisreduced[ZHT07,Sak23].
(II): The stronger regularization with largeğœ† makes the RS phase larger. This is consistent with
the general trend that regularization improves the stability of the model by reducing the variance
of weights. (III): In regions with small bits ğ‘ and large range ğœ”, the RS and RSB phases alternate
periodically along the ğ‘ direction, resulting in a striped phase diagram. The striped pattern is
caused by the dependence of Î© on ğ‘› ğ‘ (or ğ‘), leading to RS for even ğ‘› ğ‘ and RSB for odd ğ‘› ğ‘. As
illustrated in Fig. 3, for even ğ‘› ğ‘, Î© includes zero (ğ‘¤ (cid:98)1 of (a)), while for odd ğ‘› ğ‘, it does not. For
largeğœ” withsmallğ‘› ğ‘,theintervalsbetweenquantizedvaluescanbesubstantialcomparedto â„/Î˜(cid:98),
which represents the variance of the continuous value to be quantized in (10). Hence, for even
ğ‘› , continuous values are highly likely to be quantized to zero, while for odd ğ‘› , they tend to be
ğ‘ ğ‘
quantized to the non-zero value closest to zero (ğ‘¤ (cid:98)1 or ğ‘¤ (cid:98)2 in Fig.3 (b) where |ğ‘¤ (cid:98)1| = |ğ‘¤ (cid:98)2|). The
closest values can be substantial relative to â„/Î˜(cid:98) at large ğœ” and small ğ‘› ğ‘, causing the quantization
at odd ğ‘› to extend the continuous value. This parameter extension increases effective degrees of
ğ‘
freedom[ZHT07],resultingintheinstabilityoftheRSsolution.
(IV): The non-uniform quantization exhibits a larger RS phase compared to uniform one, in-
dicating a broader range for quantization settings. In non-uniform quantization, the subintervals
near the origin are small, effectively suppressing the extension caused by quantization for odd ğ‘› ,
ğ‘
leadingtoawiderRSphase.
4.2. Optimal Parameters in RS Phase. We now investigate the generalization error ğ¸ ğ‘” in RS
phase to consider optimal quantization hyperparameters. Figure 4 shows the generalization errors
underRSansatzwithdifferentvaluesofğ‘andğœ”for(a)lowand(b)highnoisecases. Insightsderived
from the behavior of generalization errors are as follows. First, in most cases, the generalization
error is a convex function of ğœ” and has a unique minimum. This characteristics implies that there
existstheoptimalchoicefortherangeğœ”,whichshouldbeappropriatelyselected. Especiallywhen
7(a) (b)
Ïƒ = 0.01,Î» = 0.01,Î± = 1.4 Ïƒ = 1.0,Î» = 0.01,Î± = 1.4
0.6
b=1 b=1
1.4
b=2 b=2
RSB
b=3 b=3
0.4
b=4 1.2 b=4
b=5 b=5
0.2
1.0
0.0 0.8
1 2 3 4 0.5 1.0 1.5
Ï‰ Ï‰
Figure 4. Expected generalization error under RS assumption as a function of ğœ”
for (a) (ğœ,ğœ†,ğ›¼) = (0.01,0.01,1.4) and (b) (ğœ,ğœ†,ğ›¼) = (1.0,0.01,1.4). Solid lines
and dashesd lines represent the result of uniform and non-uniform quantization,
respectively. RSBphaseisindicatedbyblackarrows.
(a) (b)
b = 9.0,Ïƒ = 1.0,Î» = 0.01 b = 9.0,Ïƒ = 1.0,Î» = 0.01
Ï‰=1 Ï‰=1
2.5 Ï‰=2 2.5 Ï‰=2
Ï‰=3 Ï‰=3
Ï‰=4 Ï‰=4
2.0 2.0
Ï‰=5 Ï‰=5
Ï‰=6 Ï‰=6
1.5 Ï‰=7 1.5 Ï‰=7
1.0 1.0
0.5 1.0 1.5 2.0 0.5 1.0 1.5 2.0
Î± = M/N Î± = M/N
Figure 5. Expected generalization error under RS assumption as a function of
ğ›¼ = ğ‘/ğ‘€ for (a) uniform quantization and (b) non-uniform quantization. The
dashedlinesrepresenttheresultofridgeregression.
the number of bits is small, ğ¸ exhibits a stronger dependence on ğœ” compared to cases with a
ğ‘”
larger number of bits, resulting in a sharper minimum value of ğ¸ . Consequently, the appropriate
ğ‘”
selectionofğœ”becomesmorecrucialforscenarioswithasmallnumberofbits. Second,asthenoise
ğœ increases with the large bit ğ‘ increases, the generalization error of non-uniform and uniform
quantizationdisappears.
8
E
E
g
g
E
g
E
g(a) (b)
Ïƒ = 0.01,Î» = 0.01,Î± = 1.4 Ïƒ = 0.01,Î» = 0.01,Î± = 1.4
0.5
Ï‰=1 b=1
0.4 Ï‰=2 b=2
0.6 b=3
Ï‰=3
b=4
RSB Ï‰=4
0.3 b=5
RSB
Ï‰=5
0.4
0.2
0.2
0.1
0.0 0.0
3.0 3.5 4.0 4.5 5.0 1 2 3
b Ï‰
Figure 6. Comparison of results by replica analysis (solid line) and AMP (â—¦) in
terms of generalization error dependence on (a) ğ‘ and (b) ğœ”. The error bars denote
standarderrorsassessedby100independentrunsofAMP,wheretheeachcomponent
of initial conditions m0 is generated by N(0,1). RSB phase is indicated by black
arrows.
4.3. Effect on Double Descent. We investigate the effect of quantization on the double-descent
phenomenon of the generalization error ğ¸ . The double-descent refers to the phenomenon in
ğ‘”
whichthegeneralizationerrorincreasesonceandthendecreaseswhenthenumberofparametersis
extremely large[BHMM19, LVM+20]. This is an important notion in modern data analysis, since
it suggests that an excess number of parameters enters a regime where the low performance from
overfitting can be avoided [BHMM19, HMRT22]. Ridge regression with continuous parameter
exhibits the double descent phenomena, where generalization error has a peak at ğ›¼ = ğ‘€/ğ‘ = 1
undersufficientlysmallğœ† andsufficientlylarge ğœ [HMRT22,KH92].
Fig.5 shows the generalization errors under quantization as a function of ğ›¼ for (a) uniform and
(b) non-uniform cases. The quantization shifts the peak toward smaller ğ›¼ compared with the
usual ridge regression, which is indicated by dashed line. This means that more parameters are
needed to reach the regime of overparameterization under the quantization. This implies that it
is slightly difficult to benefit from the overparameterization, since the quantization reducing an
effective number of parameters. This tendency is marginally more pronounced for non-uniform
quantization. However,thisdiscrepancydisappearswiththelargerğœ”.
5. AMPAlgorithmandExperiments
As a numerical method that can potentially achieve the theoretical results under the replica
symmetry (RS) ansatz, we employ the approximate message passing (AMP) algorithm [DMM09,
Ran11]. AMP for quantized regression includes the procedures outlined in Algorithm 1, which
utilizeaquantizationfunction(10)anditsderivative. Asinreplicaanalysis,thequantizedestimate
byAMPinstepğ‘¡,mÂ¯ ğ‘¡,correspondstothequantizedsolutionoftheridgeregression[SO21]. Inthe
quantized regression, the following relationship between AMP and replica analysis holds, as with
continuous regression [ZK16, KMS+12a]. First, the typical trajectory of AMP can be described
bythestateevolutionequation,whichcorrespondstothesaddlepointequationsderivedbyreplica
9
E
g
E
ganalysisundertheRSansatz. Second,themicroscopicconvergenceconditionofAMPcorresponds
tothestabilityconditionoftheRSsolution(11). Thispropertyindicatesthatthetheoreticalresult
forquantizedregressioncanbeachievedbyAMP,inprinciple.
Fig. 6shows ğ‘ andğœ”-dependenceof ğ¸ ğ‘” at ğ‘ = 2500,computedwiththeform(4)usingAMPâ€™s
estimatemÂ¯ ğ‘¡ atsufficientlylargeğ‘¡ aswâˆ—(D). Theobservednumericalresultsareingoodagreement
(cid:98)
with the theory in the RS phase, and indicate the validity of the AMP for the quantized regression
problems.
Algorithm1AMPforquantizedregression
mÂ¯ ğ‘¡ = {ğ‘šÂ¯ ğ‘–ğ‘¡} ğ‘–ğ‘ =1,vğ‘¡ = {ğ‘£ ğ‘–ğ‘¡} ğ‘–ğ‘ =1,xğœ‡ = {ğ‘‹ ğœ‡ğ‘–} ğ‘–ğ‘ =1.
Initialize {(ğ‘‰0,ğœƒ0)}ğ‘€ , {(Î£0,ğ‘…0)}ğ‘ ,mÂ¯ 0,v0.
ğœ‡ ğœ‡ ğœ‡=1 ğ‘– ğ‘– ğ‘–=1
forğ‘¡ = 1,...,ğ‘‡ do
ğ‘‰ ğœ‡ğ‘¡ â† (vğ‘¡âˆ’1)âŠ¤xğœ‡
(Î£ğ‘¡)âˆ’1 â† (cid:205)ğ‘€ ğ‘‹2 /(ğ‘‰ğ‘¡ +1)
ğ‘– ğœ‡=1 ğœ‡ğ‘– ğœ‡
ğœƒğ‘¡
ğœ‡
â† (mÂ¯ ğ‘¡âˆ’1)âŠ¤xğœ‡ âˆ’ğ‘‰ ğœ‡ğ‘¡(ğ‘¦
ğœ‡
âˆ’ğœƒğ‘¡ ğœ‡âˆ’1)/(ğ‘‰ ğœ‡ğ‘¡âˆ’1 +1),
ğ‘… ğ‘–ğ‘¡ â† ğ‘šÂ¯ ğ‘–ğ‘¡âˆ’1 +Î£ ğ‘–ğ‘¡(cid:205) ğœ‡ğ‘€
=1
ğ‘‹ ğœ‡ğ‘–(ğ‘¦
ğœ‡
âˆ’ğœƒğ‘¡ ğœ‡)/(ğ‘‰ ğœ‡ğ‘¡âˆ’1 +1)
ğ‘šÂ¯ğ‘¡ â† ğœ‘âˆ—(ğ‘…ğ‘¡/Î£ğ‘¡,ğœ†+1/Î£ğ‘¡)
ğ‘– ğ‘– ğ‘– ğ‘–
ğ‘£ğ‘¡ â† ğœ•ğœ‘âˆ—(ğ‘…ğ‘¡/Î£ğ‘¡,ğœ†+1/Î£ğ‘¡)
ğ‘– ğ‘– ğ‘– ğ‘–
endfor
6. DiscussionandConclusion
Inthisstudy,weprovidedthetheoreticalresultsoftheeffectofhyperparametersofquantization.
Weinvestigatedtwotypesofquantization: uniformandnon-uniform. First,wederivedtheRS-RSB
phase diagram that describes the validity of our theoretical results. We showed that non-uniform
quantizationandregularizationcanreducetheextentoftheRSBphase. Second,wedemonstrated
thatanoptimalquantizationrangeexists,whichminimizesthegeneralizationerror. Lastly,wefound
that more parameters are required to diminish the generalization error in the overparametrization
regime when applying quantization. Our numerical experiments by AMP are in good agreement
withtheoreticalresults.
It is reported that AMP fail to achieve the theoretical limit for nonconvex problems [SO21].
Investigating the existence of this divergence in quantized regression is future work. Additionally,
extendingourresultstodevelopapracticalmethodforselectinghyperparametersisalsothesubject
offuturework.
Acknowledgment
SK is supported by JSPS KAKENHI (23KJ0723) and JST CREST (JPMJCR21D2). AS is
supportedbyJSPSKAKENHI(22H05117)andJSTPRESTO(JPMJPR23J4). MIissupportedby
JSPSKAKENHI(21K11780),JSTCREST(JPMJCR21D2),andJSTFOREST(JPMJFR216I).
References
[AHW95] Peter Auer, Mark Herbster, and Manfred KK Warmuth. Exponentially many local minima for single
neurons.Advancesinneuralinformationprocessingsystems,8,1995.
10[BGL+16] CarloBaldassi,FedericaGerace,CarloLucibello,LucaSaglietti,andRiccardoZecchina.Learningmay
needonlyafewbitsofsynapticprecision.PhysicalReviewE,93:052313,2016.
[BHHS18] RonBanner,ItayHubara,EladHoffer,andDanielSoudry.Scalablemethodsfor8-bittrainingofneural
networks.Advancesinneuralinformationprocessingsystems,31,2018.
[BHMM19] Mikhail Belkin, Daniel Hsu, Siyuan Ma, and Soumik Mandal. Reconciling modern machine-learning
practice and the classical biasâ€“variance trade-off. Proceedings of the National Academy of Sciences,
116(32):15849â€“15854,2019.
[BLS+21] Chaim Baskin, Natan Liss, Eli Schwartz, Evgenii Zheltonozhskii, Raja Giryes, Alex M Bronstein, and
Avi Mendelson. Uniq: Uniform noise injection for non-uniform quantization of neural networks. ACM
TransactionsonComputerSystems(TOCS),37(1-4):1â€“15,2021.
[BM11] MohsenBayatiandAndreaMontanari.Thedynamicsofmessagepassingondensegraphs,withapplica-
tionstocompressedsensing.IEEETransactiononinformationtheory,57(2):764â€“785,2011.
[BMR+20] TomBrown,BenjaminMann,NickRyder,MelanieSubbiah,JaredDKaplan,PrafullaDhariwal,Arvind
Neelakantan,PranavShyam,GirishSastry,AmandaAskell,etal.Languagemodelsarefew-shotlearners.
Advancesinneuralinformationprocessingsystems,33:1877â€“1901,2020.
[CBD14] MatthieuCourbariaux,YoshuaBengio,andJean-PierreDavid.Trainingdeepneuralnetworkswithlow
precisionmultiplications.arXivpreprintarXiv:1412.7024,2014.
[CBUS+20] Brian Chmiel, Liad Ben-Uri, Moran Shkolnik, Elad Hoffer, Ron Banner, and Daniel Soudry. Neural
gradients are near-lognormal: improved quantized and sparse training. In International Conference on
LearningRepresentations,2020.
[CEKL16] Yoojin Choi, Mostafa El-Khamy, and Jungwon Lee. Towards the limit of network quantization. In
InternationalConferenceonLearningRepresentations,2016.
[CMP+23] Patrick Charbonneau, Enzo Marinari, Giorgio Parisi, Federico Ricci-tersenghi, Gabriele Sicuro,
FrancescoZamponi,andMarcMezard.SpinGlassTheoryandFarBeyond: ReplicaSymmetryBreaking
after40Years.WorldScientific,2023.
[DAT78] JRLDeAlmeidaandDavidJThouless.Stabilityofthesherrington-kirkpatricksolutionofaspinglass
model.JournalofPhysicsA:MathematicalandGeneral,11(5):983,1978.
[DLXS19] YukunDing,JinglanLiu,JinjunXiong,andYiyuShi.Ontheuniversalapproximabilityandcomplexity
bounds of quantized relu neural networks. In International Conference on Learning Representations.
InternationalConferenceonLearningRepresentations,ICLR,2019.
[DMM09] David L Donoho, Arian Maleki, and Andrea Montanari. Message-passing algorithms for compressed
sensing.ProceedingsoftheNationalAcademyofSciences,106(45):18914â€“18919,2009.
[GBGR23] AntoineGonon,NicolasBrisebarre,ReÂ´miGribonval,andElisaRiccietti.Approximationspeedofquan-
tizedvs.unquantizedreluneuralnetworksandbeyond.IEEETransactionsonInformationTheory,2023.
[GKD+22] AmirGholami,SehoonKim,ZhenDong,ZheweiYao,MichaelWMahoney,andKurtKeutzer.Asurvey
of quantization methods for efficient neural network inference. In Low-Power Computer Vision, pages
291â€“326.ChapmanandHall/CRC,2022.
[GKL+23] FedericaGerace,FlorentKrzakala,BrunoLoureiro,LudovicStephan,andLenkaZdeborovaÂ´.Gaussian
universalityofperceptronswithrandomlabels.2023.hal-04019749.
[GLR+22] SebastianGoldt,BrunoLoureiro,GalenReeves,FlorentKrzakala,MarcMeÂ´zard,andLenkaZdeborovaÂ´.
Thegaussianequivalenceofgenerativemodelsforlearningwithshallowneuralnetworks.InMathematical
andScientificMachineLearning,pages426â€“471.PMLR,2022.
[GN98] Robert M. Gray and David L. Neuhoff. Quantization. IEEE transactions on information theory,
44(6):2325â€“2383,1998.
[HMD15] SongHan,HuiziMao,andWilliamJDally.Deepcompression: Compressingdeepneuralnetworkswith
pruning,trainedquantizationandhuffmancoding.arXivpreprintarXiv:1510.00149,2015.
[HMRT22] TrevorHastie,AndreaMontanari,SaharonRosset,andRyanJTibshirani.Surprisesinhigh-dimensional
ridgelessleastsquaresinterpolation.Annalsofstatistics,50(2):949,2022.
[HTL+23] Charles Hernandez, Bijan Taslimi, Hung Yi Lee, Hongcheng Liu, and Panos M Pardalos. Training
generalizablequantizeddeepneuralnets.ExpertSystemswithApplications,213:118736,2023.
[Hua17] HaipingHuang.Statisticalmechanicsofunsupervisedfeaturelearninginarestrictedboltzmannmachine
withbinarysynapses.JournalofStatisticalMechanics: TheoryandExperiment,2017(5):053302,2017.
11[KH92] AndersKroghandJohnAHertz.Generalizationinalinearperceptroninthepresenceofnoise.Journal
ofPhysicsA:MathematicalandGeneral,25(5):1135,1992.
[KMS+12a] FKrzakala, MMeÂ´zard, FSausset, YF.Sun, andLZdeborovaÂ´.Statistical-physics-basedreconstruction
incompressedsensing.PhysicalReviewX,2:021005,2012.
[KMS+12b] FlorentKrzakala,MarcMeÂ´zard,FrancoisSausset,YifanSun,andLenkaZdeborovaÂ´.Probabilisticrecon-
structionincompressedsensing: algorithms,phasediagrams,andthresholdachievingmatrices.Journal
ofStatisticalMechanics: TheoryandExperiment,2012(08):P08009,2012.
[KWT09] Yoshiyuki Kabashima, Tadashi Wadayama, and Toshiyuki Tanaka. A typical reconstruction limit for
compressed sensing based on lp-norm minimization. Journal of Statistical Mechanics: Theory and
Experiment,2009(09):L09003,2009.
[LDX+17] HaoLi,SohamDe,ZhengXu,ChristophStuder,HananSamet,andTomGoldstein.Trainingquantized
nets: Adeeperunderstanding.AdvancesinNeuralInformationProcessingSystems,30,2017.
[LGC+21] BrunoLoureiro,CedricGerbelot,HugoCui,SebastianGoldt,FlorentKrzakala,MarcMezard,andLenka
ZdeborovaÂ´.Learningcurvesofgenericfeaturesmapsforrealisticdatasetswithateacher-studentmodel.
AdvancesinNeuralInformationProcessingSystems,34:18137â€“18151,2021.
[LGW+21] TailinLiang,JohnGlossner,LeiWang,ShaoboShi,andXiaotongZhang.Pruningandquantizationfor
deepneuralnetworkacceleration: Asurvey.Neurocomputing,461:370â€“403,2021.
[LVM+20] Marco Loog, Tom Viering, Alexander Mey, Jesse H Krijthe, and David MJ Tax. A brief prehistory of
doubledescent.ProceedingsoftheNationalAcademyofSciences,117(20):10625â€“10626,2020.
[MLM16] DaisukeMiyashita,EdwardHLee,andBorisMurmann.Convolutionalneuralnetworksusinglogarithmic
datarepresentation.arXivpreprintarXiv:1603.01025,2016.
[MPV87] MarcMeÂ´zard,GiorgioParisi,andMiguelVirasoro.Spinglasstheoryandbeyond: AnIntroductiontothe
ReplicaMethodandItsApplications,volume9.WorldScientificPublishingCoInc,1987.
[MS22] Andrea Montanari and Basil N Saeed. Universality of empirical risk minimization. In Conference on
LearningTheory,pages4310â€“4312.PMLR,2022.
[Ran11] Sundeep Rangan. Generalized approximate message passing for estimation with random linear mixing.
In Information Theory Proceedings (ISIT), 2011 IEEE International Symposium on, pages 2168â€“2172.
IEEE,2011.
[RTWZ01] FedericoRicci-Tersenghi,MartinWeigt,andRiccardoZecchina.Simplestrandomk-satisfiabilityproblem.
PhysicalReviewE,63(2):026702,2001.
[SA21] Ryuta Sasaki and Toru Aonishi. Analysis of the hopfield model with discrete coupling. Journal of the
PhysicalSocietyofJapan,90(9):094602,2021.
[Sak23] Ayaka Sakata. Prediction errors for penalized regressions based on generalized approximate message
passing.JournalofPhysicsA:MathematicalandTheoretical,56(4):043001,2023.
[SO21] AyakaSakataandTomoyukiObuchi.Perfectreconstructionofsparsesignalswithpiecewisecontinuous
nonconvexpenaltiesandnonconvexitycontrol.JournalofStatisticalMechanics: TheoryandExperiment,
2021(9):093401,2021.
[WCB+18] NaigangWang,JungwookChoi,DanielBrand,Chia-YuChen,andKailashGopalakrishnan.Trainingdeep
neural networks with 8-bit floating point numbers. Advances in neural information processing systems,
31,2018.
[WJZ+20] HaoWu,PatrickJudd,XiaojieZhang,MikhailIsaev,andPauliusMicikevicius.Integerquantizationfor
deeplearninginference: Principlesandempiricalevaluation.arXivpreprintarXiv:2004.09602,2020.
[ZHMD16] ChenzhuoZhu,SongHan,HuiziMao,andWilliamJDally.Trainedternaryquantization.InInternational
ConferenceonLearningRepresentations,2016.
[ZHT07] H.Zou,T.Hastie,andR.Tibshirani.Onthedegreesoffreedomofthelasso.Annal.Stat.,35(5):2173â€“
2192,2007.
[ZK16] Lenka ZdeborovaÂ´ and Florent Krzakala. Statistical physics of inference: Thresholds and algorithms.
AdvancesinPhysics,65(5):453â€“552,2016.
[ZYG+16] AojunZhou,AnbangYao,YiwenGuo,LinXu,andYurongChen.Incrementalnetworkquantization: To-
wardslosslesscnnswithlow-precisionweights.InInternationalConferenceonLearningRepresentations,
2016.
12AppendixA. AdditionalResult
(a) (b)
Ïƒ = 0.01,Î» = 0.01,Î± = 0.7 Ïƒ = 1.0,Î» = 0.01,Î± = 0.7
0.6
b=1 b=1
1.4
0.5 b=2 b=2
RSB
b=3 b=3
0.4 b=4 1.2 b=4
b=5 b=5
0.3
1.0
0.2
0.8
0.1
1 2 3 4 0.5 1.0 1.5
Ï‰ Ï‰
Figure7. ExpectedgeneralizationerrorunderRSassumptionasafunctionofğœ”for
(a)(ğœ,ğœ†,ğ›¼) = (0.01,0.01,0.7)and(b)(ğœ,ğœ†,ğ›¼) = (1.0,0.01,0.7). Theoutcomeof
uniform quantization is represented by solid lines, while non-uniform quantization
isrepresentedbydashedlines. TheblackarrowsindicatetheRSBphase.
We present an additional finding regarding the analysis of the expected generalization error.
Figure7showsthegeneralizationerrorsforboththelownoisecase(a)andthehighnoisecase(b)
whenğœ† = 0.01andğ›¼ = 0.7. Itisevidentthatthegeneralizationperformanceissignificantlyworse
due to the impact of overparameterization, where ğ›¼ < 1, compared to the performance shown in
Figure4ofthemaintext.
Figure 8 shows the generalization errors with (a) low and (b) high noise cases at ğœ† = 1.0 and
ğ›¼ = 0.7. We observe that regularization can mitigate the sharpness of the optimality condition for
ğœ”.
Figure 9 shows the generalization errors under quantization as a function of ğ›¼ for (a) uniform
and(b)non-uniformcases. Thedoubledecentpeakisdiminishedinthelow-noisecase.
Figure 10 illustrates the generalization errors associated with quantization as a function of the
numberofbitsğ‘for(a)uniformand(b)non-uniformcases. Inthecaseofuniformquantization,the
generalization performance asymptotically approaches that of the ridge regression as the number
of bits increases. This is not the case, however, for non-uniform quantization. In non-uniform
quantization, since the partition width increases exponentially, the approximation accuracy is
inferiorcomparedtothatofuniformquantization.
AppendixB. StateEvolutionandLocalStability
The typical performance of AMP can be analyzed by state evolution (SE). SE describes the
statistical properties of the trajectory of AMP, which depend on the randomness of the data. The
typical trajectory of AMP is tracked by two variables: ğ‘‰ğ‘¡ := 1 (cid:205)ğ‘ ğ‘£ğ‘¡ and ğ¸ğ‘¡ := 1 (cid:205)ğ‘ (ğ‘¤0 âˆ’ğ‘šÂ¯ğ‘¡).
ğ‘ ğ‘– ğ‘– ğ‘ ğ‘– ğ‘– ğ‘–
13
E
g
E
g(a) (b)
Ïƒ = 0.01,Î» = 1.0,Î± = 0.7 Ïƒ = 1.0,Î» = 1.0,Î± = 0.7
0.7
b=1 b=1
1.4
b=2 b=2
0.6
b=3 b=3
b=4 1.2 b=4
0.5
b=5 b=5
0.4
1.0
0.3
0.8
1 2 3 4 0.5 1.0 1.5
Ï‰ Ï‰
Figure 8. Expected generalization error under RS assumption as a function of ğœ”
for (a) (ğœ,ğœ†,ğ›¼) = (0.01,1.0,0.7) and (b) (ğœ,ğœ†,ğ›¼) = (1.0,1.0,0.7). Solid lines
and dashed lines represent the result of uniform and non-uniform quantization,
respectively. RSBphaseisindicatedbyblackarrows.
(a) (b)
b = 9.0,Ïƒ = 0.01,Î» = 0.01 b = 9.0,Ïƒ = 0.01,Î» = 0.01
0.4 0.4
Ï‰=1 Ï‰=1
Ï‰=2 Ï‰=2
0.3 Ï‰=3 0.3 Ï‰=3
Ï‰=4 Ï‰=4
Ï‰=5 Ï‰=5
0.2 0.2
Ï‰=6 Ï‰=6
Ï‰=7 Ï‰=7
0.1 0.1
0.0 0.0
0.5 1.0 1.5 2.0 0.5 1.0 1.5 2.0
Î± = M/N Î± = M/N
Figure 9. Expected generalization error under RS assumption as a function of
ğ›¼ = ğ‘/ğ‘€ for (a) uniform quantization and (b) non-uniform quantization. The
dashedlinesrepresenttheresultofridgeregression.
Assumingthesamesettingsasthereplicaanalysisinthemaintext,theSEequationsaregivenas
âˆ« ğœ•ğœ‘âˆ— (cid:0)ğœ‰ğ‘¡ğ‘§,Î›ğ‘¡(cid:1)
ğ‘‰ğ‘¡+1 = ğ·ğ‘§ , (12)
ğœ•(ğœ‰ğ‘¡ğ‘§)
ğœŒğ›¼ âˆ« ğœ•ğœ‘âˆ—(ğœ‰ğ‘¡ğ‘§,Î›ğ‘¡) âˆ«
ğ¸ğ‘¡+1 = ğœŒ âˆ’2 ğ·ğ‘§ + ğ·ğ‘§ğœ‘âˆ—(ğœ‰ğ‘¡ğ‘§,Î›ğ‘¡ )2, (13)
ğœ‰ğ‘¡(1+ğ‘‰ğ‘¡) ğœ•ğ‘§
14
E
E
g
g
E
g
E gÏƒ = 0.01,Î» = 0.01,Î± = 1.4 Ïƒ = 0.01,Î» = 0.01,Î± = 1.4
0.5
Ï‰=1 Ï‰=1
0.15
0.4 Ï‰=2 Ï‰=2
Ï‰=3 Ï‰=3
RSB
0.3 Ï‰=4 Ï‰=4
0.10
Ï‰=5 Ï‰=5
0.2 ridge ridge
0.05
0.1
0.0
0.00
3.0 3.5 4.0 4.5 5.0 3.0 3.5 4.0 4.5 5.0
b b
Figure10. TheexpectedgeneralizationerrorundertheRSassumptionispresented
as a function of ğ‘ for (a) uniform quantization and (b) non-uniform quantization.
Theyellowlinesrepresenttheresultsoftheridgeregression.
with ğœ‰ğ‘¡ := âˆšï¸ ğ›¼2ğœŒ/(1+ğ‘‰ğ‘¡)2 +ğ›¼(ğœ2 +ğ¸ğ‘¡)/(1+ğ‘‰ğ‘¡)2 and Î›ğ‘¡ := ğœ† + ğ›¼/(1+ğ‘‰ğ‘¡). The SE equations
and the saddle point equations of the replica analysis in the main text are equivalent based on the
correspondences
ğ‘‰ğ‘¡ â†” ğœ’, (14)
ğ¸ğ‘¡ â†” ğ‘„ âˆ’2ğ‘š + ğœŒ. (15)
Therefore,thefixedpointofSEandtheRSsolutionofthereplicaanalysisareequivalent. Further-
more,thelinearstabilityconditionofthefixedpointofAMPisderivedas
ğ›¼ âˆ«
ğ·ğ‘§(ğœ•ğœ‘âˆ—(ğœ‰ğ‘§,Î›))2 < 1. (16)
(1+ğ‘‰)2
SincethisconditionisequivalenttothestabilityconditionoftheRSsolutioninreplicaanalysis,it
isexpectedthattheoreticalresultsobtainedbythereplicamethodintheRSphasecanbevalidated
throughnumericalexperimentsemployingAMP.
15
E
g
E
g