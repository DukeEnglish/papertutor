CityFlowER: An Efficient and Realistic Traffic Simulator with
Embedded Machine Learning Models
LongchaoDa1,ChenChu1,WeinanZhang2,HuaWei1
1ArizonaStateUniversity,2ShanghaiJiaoTongUniversity
1{longchao,cchu37,hua.wei}@asu.edu,2wnzhang@sjtu.edu.cn
Tempe,AZ,USA
ABSTRACT intransportationsystems.Inessence,theinsightscomingfrom
Trafficsimulationisanessentialtoolfortransportationinfrastruc- simulatorshaveaprerequisite:thesimulatorisrealisticenoughto
tureplanning,intelligenttrafficcontrolpolicylearning,andtraffic replicatereal-worldtrafficproblems.Withsimulatorsbeingunreal-
flowanalysis.Itseffectivenessreliesheavilyontherealismofthe istic,theanalysisandsolutionscomingfromthesimulatorswillbe
simulatorsused.Traditionaltrafficsimulators,suchasSUMOand unreliable.
CityFlow,areoftenlimitedbytheirrelianceonrule-basedmodels In order to make the simulators realistic, existing work usu-
withhyperparametersthatoversimplifydrivingbehaviors,result- ally calibrates the hyperparameters on the given physical/rule-
inginunrealisticsimulations.Toenhancerealism,somesimulators basedmodelswithinthesimulator[9,10,13,16].Trafficsimulators,
haveprovidedApplicationProgrammingInterfaces(APIs)tointer- especiallymicroscopicsimulatorslikeVISSIM[4],SUMO[2]or
actwithMachineLearning(ML)models,whichlearnfromobserved CityFlow[17],havedifferentrule-basedmodelswithin,asshown
dataandoffermoresophisticateddrivingbehaviormodels.How- in Figure 1 (a), given the current stateğ‘  ğ‘¡, the actionğ‘ ğ‘¡ will be
ever,thisapproachfaceschallengesinscalabilityandtimeefficiency outputfromrule-basedmodels.Representativemodelsincludecar-
asvehiclenumbersincrease.Addressingtheselimitations,wein- followingmodels,lane-changingmodels,orroutingmodels,each
troduceCityFlowER,anadvancementovertheexistingCityFlow ofwhichconsistsofmultiplehyperparametersandassumesthat
simulator,designedforefficientandrealisticcity-widetrafficsim- thebehaviorofthevehicleisonlyinfluencedbyasmallnumberof
ulation.CityFlowERinnovativelypre-embedsMLmodelswithin factorswithpredefinedrule-basedrelations,suchasWiedemann
thesimulator,eliminatingtheneedforexternalAPIinteractions andKrauss,etc.Calibratingthehyperparametersforthesemodels
andenablingfasterdatacomputation.Thisapproachallowsfor willneedtofindtheparametersthatbestfittheobserveddata[11].
ablendofrule-basedandMLbehaviormodelsforindividualve- Theproblemwithsuchmethodsisthattheirassumptionsover-
hicles,offeringunparalleledflexibilityandefficiency,particularly simplifythedrivingbehavior,resultinginthesimulateddriving
inlarge-scalesimulations.Weprovidedetailedcomparisonswith behaviorfarfromtherealworld.
existingsimulators,implementationinsights,andcomprehensive Tomakethebehaviormodelmorerealistic,somesimulators
experimentstodemonstrateCityFlowERâ€™ssuperiorityintermsof provideApplicationProgrammingInterfaces(APIs)tocontrolthe
realism,efficiency,andadaptability. vehiclebehaviors[6,15].TheseAPIsextractvehiclestatesfrom
thesimulators,uponwhichtheMLmodelsoutsideofthesimula-
KEYWORDS torstakeasinputandoutputthepredictionsbackintosimulators
throughtheAPIs,asillustratedinFigure1(b).TheseMLmodels
ReinforcementLearningPlatform;MicroscopicTrafficSimulation;
donotassumetheunderlyingformofthebehaviormodelsand
Mobility
directlylearnfromtheobserveddata[3,5,12,14].WithMLmodels,
ACMReferenceFormat: amoresophisticateddrivingbehaviormodelcanberepresentedby
LongchaoDa1,ChenChu1,WeinanZhang2,HuaWei1.2018.CityFlowER:
aparameterizedmodellikeneuralnetsandprovidesapromising
AnEfficientandRealisticTrafficSimulatorwithEmbeddedMachineLearn-
waytolearnthemodelsthatbehavesimilarlytoobserveddata.
ingModels.InProceedingsofMakesuretoenterthecorrectconferencetitle
ThisformofbehaviorAPIprovidesflexibilityinvehiclebehavior
fromyourrightsconfirmationemai(Conferenceacronymâ€™XX).ACM,New
sincedifferentMLmodelscanbeutilizedtointeractwiththesimu-
York,NY,USA,4pages.https://doi.org/XXXXXXX.XXXXXXX
lator.However,asthenumberofvehiclesscalesup,theinteraction
betweentheAPIandMLmodelsoutsidethesimulatorsrequires
1 INTRODUCTION
additionaltimeconsumptionbyextracomputationanddatatransi-
Trafficsimulationplaysacrucialroleinanalyzingpotentialprob-
tion,whereasimulatormustbefastenoughfordecision-making.
lems[1],andprovidesquantitativeresultsfordecision-making[17]
ToenableEfficientandRealisticsimulationforintelligenttrans-
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor
portation,wepresentCityFlowERbasedonawell-acceptedtraffic
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed simulatorCityFlow[17]tosupporttherealisticcity-widetraffic
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation simulation.Specifically,thisworkpre-embedsMLmodelsintothe
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or simulatorandcontrolsvehiclebehaviorsdirectlywithinthesimula-
republish,topostonserversortoredistributetolists,requirespriorspecificpermission tor.InsteadofrelyingoninteractionsbetweenAPIsandMLmodels
and/orafee.Requestpermissionsfrompermissions@acm.org.
outsideofthesimulator,CityFlowERdirectlyconductsdatacom-
Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
putationinthesimulatorwiththeembeddedMLmodelstoenable
Â©2018Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM.
ACMISBN978-1-4503-XXXX-X/18/06 efficientsimulation.Additionally,inCityFlowER,anyindividual
https://doi.org/XXXXXXX.XXXXXXX
4202
beF
9
]AM.sc[
1v72160.2042:viXraConferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
t t t
Simulator Simulator Simulator
(C++) (C++) MLs (C++)
Rules MLs
t+1 a t =Rule(s t) t+1 a t= C++[API(ML(s t))] t+1 a t = Embedded_ML(s t)
Simulator Simulator Simulator
(C++) (C++) (C++)
Python Interface
Rules Behavior Module MLs
(a) Rule-based Simulation (b) ML-based Simulation with API (c) ML-embedded Simulation (Ours)
Figure1:ComparisononCityFlowERofembeddingMLmodelsvsrule-basedmethodandinteraction-basedmethodinoriginal
CityFlowforrealisticsimulations.TheoriginalsimulatorisimplementedinC++forefficiency.NotethattheMLscanbeany
vehiclebehaviormodels,e.g.,Car Following Model,Lane Changing Model,etc.
vehiclecanbespecifiedwitheitherrule-basedbehaviormodels weleveragetheLibTorch[8],aC++supportivereleaseofPytorchto
orMLmodels,whereasoriginalCityFloworSUMOonlysupports realizethemodelloading,anexampleofVehicle::getCarFollowSpeed
rule-basedmodels.ThisML-embeddedmechanismprovidesdiverse is shown below. In this implementation, the MLğ‘ ğ‘ğ‘’ğ‘’ğ‘‘ğ‘€ğ‘œğ‘‘ğ‘’ğ‘™ is
andflexiblesimulationswhilemaintaininghighefficiencyforlarge- loadedwiththespecifiedPATHatthestartofthesimulation.At
scaletrafficsimulation.Wehaveelaboratedtheproposedmethod eachtimestepğ‘¡,theinput_featureistheobservablestateinforma-
incomparisontotheexistingsimulatorsforrealisticsimulation, tionğ‘  ,fedintotheloadedğ‘ ğ‘ğ‘’ğ‘’ğ‘‘ğ‘€ğ‘œğ‘‘ğ‘’ğ‘™,anoutputfromğ‘ ğ‘ğ‘’ğ‘’ğ‘‘ğ‘€ğ‘œğ‘‘ğ‘’ğ‘™
ğ‘¡
andwealsoprovideimplementationdetailsandconductsufficient istheğ‘ğ‘ğ‘Ÿğ¹ğ‘œğ‘™ğ‘™ğ‘œğ‘¤ğ‘†ğ‘ğ‘’ğ‘’ğ‘‘expectedtotakeinthenextstep.
experimentstoshowthecorrectness,efficiency,andflexibilityin
CityFlowERâ€™ssimulation. 1 // vehicleInfo is updated out of the function
2 // "PATH" is the preâˆ’trained model path
3 double Vehicle::getCarFollowSpeed(double interval) {
2 DESCRIPTION 4
5 Vehicle âˆ—leader = getLeader();
Inthissection,wefirstproposeasimulator-levelbehaviormodel 6 std::vector<torch:: jit ::IValue> input_feature;
pre-embeddingmechanism,andthenprovideanimplementation 7 auto input = torch::tensor ({leaderâˆ’>getSpeed() ,
vehicleInfo.speed ...}) ;
inarenownedsimulatorCityFlow[17]toverifythefeasibilityand
8
efficiency. 9 input_feature.push_back(input);
10 static torch:: jit ::script::Module speedModel = torch
:: jit ::load("PATH");
2.1 BehaviorModelPre-embeddingMechanism 11
Weproposeawaytoembedthepre-trainedmodeldirectlyintothe 12 at::Tensor output_speed = speedModel.forward(
input_feature).toTensor();
simulatoritselfandavoidextrasimulator-modelcommunication. 13 return output_speed.item<double>();
AsshowninFigure1(c),MLmodelsarepre-loadedinsideofthe 14 }
simulatorincorrespondencetotheactingfunctions,andcompiled
Similarly,thelane-changingmodelisanMLmodelimplemented
readilyforuse,giventhecurrentenvironmentstateğ‘  ,theappro-
ğ‘¡ togeneratethelanechoice:{0:"changetotheleft(Innerlane)",1:
priateactionğ‘ canbedecidedbasedonthemodelâ€™slogicswhile
ğ‘¡ "keepcurrentlane",2:"changetotheright(Outerlane)"}.TheML
keepingthesimulationefficiency,whereğ‘
ğ‘¡
:=(ğ‘£ ğ‘¡,ğ‘™ ğ‘¡),ğ‘£
ğ‘¡
represents
modelisalsoloadedatthebeginningofthesimulation.
thespeedadjustmentthatğ‘£
ğ‘¡
âˆˆRandğ‘™
ğ‘¡
representslanechanging
options:ğ‘™ ğ‘¡ âˆˆ{left,stay,right}.Bypre-embeddingthemodels,the 1 void SimpleLaneChange::makeSignal(double interval) {
interactionbetweenthesimulatorandMLmodelsisavoided,thus 2
dataflowtimeoverheadisgreatlyreduced. 3 std::vector<torch:: jit ::IValue> input_feature;
4 auto input = torch::tensor ({vehicleâˆ’>engineâˆ’>
getCurrentTime() ,...}) ;
2.2 SystemImplementationinCityFlowER 5 input_feature.push_back(input);
6
Inordertoimplementanextensible,realistic,andhighlyefficient 7 static torch:: jit ::script::Module laneModel = torch::
jit ::load("PATH");
simulator,thisworkbuildsupontheexistingsimulatorCityFlow[17],
8 at::Tensor lane_choice = laneModel.forward(
aimingatimprovingtherealisticbehaviormodelingwhilekeep- input_feature).toTensor();
ingsimulatingefficiency.WefollowthesamebasicRoad Network 9 signalSendâˆ’>target = lane_choice;
10 }
structurelikeSegmentsasdefinedinCityFlowforitscomputation
efficiency.ForCar Following ModelandLane Changing Model, InCityFlowER,therealisticsimulationreliesonrealisticbehav-
weimplementedtheembeddedarchitectureasshowninFigure1(c), iormodels, whicharetrained bybehaviordatausing ImitationCityFlowER:AnEfficientandRealisticTrafficSimulatorwithEmbeddedMachineLearningModels Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
Learning(IL)orBehaviorCloning(BC)methods.Thebehaviordata Table 1: The Ability to recover different behavior models
couldeitherbecollectedfromamorerealisticsimulatorâ€™srollout fromothersimulators(SUMO).Thebehaviormodelsarea
processorfromreal-worlddemonstrations. combinationoftrainedmodelsforcar-followingandlane-
Itisworthnotingthat,toguaranteetheuniversalityacrossdif- changingbehaviorusingdatacollectedfromSUMO.
ferentsimulators,definingaunifiedinputfeaturespaceandoutput
actionspaceisinevitable.CityFlowisrichinsystemstateinforma- BehaviorModels FinalDisplacementError TravelTimeError
tionAPIsandprovidesafulldescriptionofmicrocosmicvehicle
properties,sobasedonCityFlowperceptiblefeatures,wedefine Krauss+SL2015 1.24 Â±0.71 0.44 Â±0.26
asupersetğ¹ ğœ™ = {ğ‘“1,ğ‘“2,ğ‘“3,...ğ‘“ ğ‘›},ğœ™ = {followSpeed,laneChange},
Krauss+LC2013 0.64 Â±0.52 0.30 Â±0.09
andthefeaturesetğº frombehaviordatasetcanberepresented IDM+SL2015 1.82 Â±1.64 0.56 Â±0.91
asğº âŠ† ğ¹.Ifforthetrainedmodelthatadoptsfeatureğº,exists IDM+LC2013 0.79 Â±0.29 0.50 Â±0.37
ğº âŠ‚ğ¹,thenwhenapplyingCityFlowobservedfeatures,theğ‘˜extra BKerner+SL2015 1.26 Â±0.35 0.75 Â±0.16
features:{ğ‘“ ğ‘’1,ğ‘“ ğ‘’2,...,ğ‘“ ğ‘’ğ‘˜}willbemaskedtoalignthefeaturespace. BKerner+LC2013 0.29 Â±1.13 0.08 Â±0.21
Foroutputspace,theoutputoffollowSpeedistherealspeedvalue,
andtheoutputoflaneChangeisthelane-changingchoice.
onlysupportasingularbehaviormodel,whileCityFlowERisde-
Oncethesystemhasaccesstobehaviormodels,thesimulator
signedinabroaderway,sowedesignedanexperimenttocompare
willberebuiltbasedonthenewstructurewithembeddedmodels.
theCityFlowERwithlearnedbehaviormodels(usingdatalogged
Inexecution,thesemodelswillcontrolcorrespondingbehaviors.
fromSUMO)tooriginalSUMO,themodelsarecommonlytrained
3 PERFORMANCE withsimpleMLPlayersfor300EpochsasinSection3.1,wehave
testifiedthetotal6combinationsofsettings1(3car-followingmod-
In this section, we conduct experiments to verify the accuracy,
els:Krauss,IDM,andBKerner,and2lane-changingmodels:LC2013,
efficiency,andflexibilityoftheproposedmethod.
andSL2015)asshowninTable1,weconductsimulationsinboth
SUMOandCityFlowERusingtheapproximatelyidenticalmapand
3.1 Accuracy
withsame122vehicleconfigs2 asreleasedinLibSigsnal[7].We
CityFlowERtorecovertheCityFlowdrivingbehaviors. Inthisex- calculatethemeanofvehiclesâ€™finaldisplacementerrorandtravel
periment,weinvestigateifCityFlowERcouldrecovertheoriginal
timeconsumptionerror.AsshowninTable1.Justbysimpletrain-
CityFlow driving behaviors, i.e., car-following speeds and lane-
ing,itcanachievelowerrors,indicatingthepotentialtoreplicate
changingbehaviors.WetrainedtwobehaviormodelsbyBCusing
realisticbehaviorsusingmodelslearnedfromreal-worlddata.
dataloggedfromCityFlowinnetworkhz1x1.Intesting,wevisual-
izespeedchangeinFigure2(a).Inthissub-figure,wecouldobserve
3.2 Efficiency
thesamespeedchangesfordifferentvehiclesinCityFlowERand
CityFlow,whichindicatesanaccurateimitationofcar-following
behavior.InFigure2(b),wevisualizethevehicletrajectoriesrelated
tothelane-changingbehaviors,andfoundoutthatthetrajecto-
ries of the same vehicle are almost identical between CityFlow
andCityFlowER,indicatingtheMLmodelsinCityFlowERcould
recovertherule-basedvehiclebehaviormodelsinoriginalCityFlow.
Vehicle Speed Change Vehicle Lane Change Behavior
e f a b
c
d
Figure3:SpeedupofSUMO,CityFlowandCityFlowER
(a) (b)
Inthissection,weinvestigatetheefficiencyoftheCityFlowER
Figure2:ThevehiclesbehaviorcomparisonofCityFlowER- comparedtobaselinesimulations:SUMO,Cityflow-API(integrate
pinkandCityflow-greyonexamplevehicles(aâˆ¼f).Left:the the behavior models by commonly adopted API controls), and
speedchangesovertime.Right:Thelanechangesovertime. SUMO-API.WecouldobservethattheAPI-basedrealisticsimula-
tionsuffersfromhightimeconsumptionduetotheexpensivebe-
haviormoduletosimulatorcommunications,whiletheCityFlowER
CityFlowERtorecovertheSUMOdrivingbehaviors. InSection3.1,
wehaveshownthatCityFlowERisabletorecovertheCityFlowâ€™s
1https://sumo.dlr.de/docs/Definition_of_Vehicles,_Vehicle_Types,_and_Routes.html
behaviormodelsaccurately,however,theoriginalCityFlowcan 2https://github.com/DaRL-LibSignal/LibSignal/tree/master/data/raw_data
)s/m(egnahC
deepS
)m( ecnatsiD
levarTConferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
couldprovideminimalefficiencyimpairmentcomparedtoCityFlow. andlaneChange)intothesimulator,andshowcasehowsimilarly
Thecomparisonmetricisthetimeconsumptioninseconds.As thevehiclesinthenewsimulatorcanperformasexpected.The
showninFigure3,CityFlowERachievessimilarefficiencytorule- codewillbereleasedandactivelymaintainedinpublicrepository4.
basedsimulatorsandismuchfasterthantheAPI-basedsimulations.
ACKNOWLEDGMENTS
3.3 DiversityandFlexibility WeappreciatethesupportfromCityFlowteam,includingHuichu
CityFlowER can support specifying individual driving behavior Zhang and Zhenhui (Jessie) Li for their suggestions during the
modelsforindividualvehicles,whichprovidesthesimulatingof developmentofthispaper.Thefeaturesenabledinthispaperwill
diversebehaviorsfromdifferentMLmodelsandflexibilityofspeci- befurtherintegratedintoCityFlowcodebaseasnewversions.
fyingdifferentbehaviorsfordifferentvehicles.AsshowninFigure4.
Applyingdifferentcontrolpoliciescouldhelpthesimulatortocus- REFERENCES
tomizethedrivingmodelsonindividualvehiclesandachievea [1] MostafaAmeli,Jean-PatrickLebacque,andLudovicLeclercq.2020.Simulation-
realisticsimulationwiththeideathateachdrivermighthavetheir baseddynamictrafficassignment:Meta-heuristicsolutionmethodswithparallel
computing.Computer-AidedCivilandInfrastructureEngineering35,10(2020),
owndrivingbehaviorintherealworld.Thiswouldprovidemore 1047â€“1062.
insightfulresearchresultsandreliabletrafficplanningstrategies. [2] MichaelBehrisch,LauraBieker,JakobErdmann,andDanielKrajzewicz.2011.
SUMOâ€“simulationofurbanmobility:anoverview.InProceedingsofSIMUL2011,
TheThirdInternationalConferenceonAdvancesinSystemSimulation.ThinkMind.
[3] EstebanEgea-Lopez,FernandoLosilla,JuanPascual-Garcia,andJoseMaria
Future trajectories for V andV Molina-Garcia-Pardo.2019.Vehicularnetworkssimulationwithrealisticphysics.
1 2
IEEEAccess7(2019),44021â€“44036.
â€¦ [4] MartinFellendorf.1994. VISSIM:Amicroscopicsimulationtooltoevaluate
actuatedsignalcontrolincludingbuspriority.In64thInstituteoftransportation
engineersannualmeeting,Vol.32.Springer,1â€“9.
[5] LanFeng,QuanyiLi,ZhenghaoPeng,ShuhanTan,andBoleiZhou.2023.Traf-
V 1 d V 2 d fi Inc tg ee rnn a: tL ioe na arn li Cn og nt fo erg enen ceer oa nte Rod biv oe tir cs se aa nn dd Ar uea toli mst aic tiotr naffi (ICc Rs Ace ).n Ia Er Eio Es ,. 3In 562 70 â€“2 33 5I 7E 5E .E
[6] MansourehJeihani,ShivaNarooieNezhad,andKavehBakhshKelarestaghi.2017.
V 1andV 2are controlled by Integrationofadrivingsimulatorandatrafficsimulatorcasestudy:Exploring
different behavior models driversâ€™behaviorinresponsetovariablemessagesigns. IATSSresearch41,4
(2017),164â€“171.
[7] HaoMei,XiaoliangLei,LongchaoDa,BinShi,andHuaWei.2023.Libsignal:An
openlibraryfortrafficsignalcontrol.MachineLearning(2023),1â€“37.
Figure 4: The diverse behaviors of vehicles controlled by [8] AdamPaszke,SamGross,FranciscoMassa,AdamLerer,JamesBradbury,Gregory
differentmodelsinCityFlowER.Thefigureshowsasnapshot Chanan,TrevorKilleen,ZemingLin,NataliaGimelshein,LucaAntiga,etal.2019.
oftrafficflowattimeğ‘¡.Sinceğ‘‰1andğ‘‰2arespecifiedwithtwo
P inyt no er uc rh a: lA inn foim rmp ae tr ia ot niv pe rost cy el se s, inh gig sh y- sp tee mrfo sr 3m 2a (n 20c 1e 9d )e .eplearninglibrary.Advances
differentbehaviorpolicies,theybehavedifferentlyinthe [9] KotagiriRamamohanarao,HairuoXie,LarsKulik,ShanikaKarunasekera,Egemen
Tanin,RuiZhang,andEmanBinKhunayn.2016.Smarts:Scalablemicroscopic
followingtimestepseventhoughunderasimilardriving
adaptiveroadtrafficsimulator. ACMTransactionsonIntelligentSystemsand
situation(distancewithleadvehicle,movingvelocity,and Technology(TIST)8,2(2016),1â€“22.
lanecapacity). [10] MicheleRondinone,JulenManeros,DanielKrajzewicz,RamonBauza,Pasquale
Cataldi,FatmaHrizi,JavierGozalvez,VineetKumar,MatthiasRÃ¶ckl,LanLin,
OscarLazaro,JÃ©rÃ©mieLeguay,JÃ©rÃ´meHÃ¤rri,SendoaVaz,YoannLopez,Miguel
Sepulcre,MichelleWetterwald,RobbinBlokpoel,andFabioCartolano.2013.
4 DEMODETAILS iTETRIS:Amodularsimulationplatformforthelargescaleevaluationofco-
operativeITSapplications.SimulationModellingPracticeandTheory34(2013),
Weprovideavideo3demonstrationofCityFlowERforfollowing 99â€“125. https://doi.org/10.1016/j.simpat.2013.01.007
scenariostoshowitscapabilityforrealisticandefficientsimulation. [11] SiroosShahriari,MiladGhasri,SASisson,andTahaRashidi.2020. Ensemble
ofARIMA:combiningparametricandbootstrappingtechniquefortrafficflow
â€¢ UseCityFlowERtorecovertheoriginalCityFlow. prediction.TransportmetricaA:TransportScience16,3(2020),1552â€“1573.
â€¢ UseCityFlowERtorecovertheoriginalSUMObehavior. [12] XiaomengShi,ShuaiYang,andZhiruiYe.2023.DevelopmentofaUnityâ€“VISSIM
Co-SimulationPlatformtoStudyInteractiveDrivingBehavior. Systems11,6
â€¢ EnableDiversebehaviorsforindividualvehicles. (2023),269.
â€¢ Conductlarge-scale(30x30intersections)efficientsimulation [13] ChristophSommer,DavidEckhoff,AlexanderBrummer,DominikSBuse,Florian
Hagenauer,StefanJoerer,andMicheleSegata.2019. Veins:Theopensource
withdiversebehaviors.
vehicularnetworksimulationframework.RecentAdvancesinNetworkSimulation:
TheOMNeT++EnvironmentanditsEcosystem(2019),215â€“252.
5 SUMMARY [14] SimonSuo,SebastianRegalado,SergioCasas,andRaquelUrtasun.2021.Traffic-
sim:Learningtosimulaterealisticmulti-agentbehaviors.InProceedingsofthe
Thisworkpresentsanovelwaytoextendandenhancetheexisting IEEE/CVFConferenceonComputerVisionandPatternRecognition.10400â€“10409.
simulatorforrealisticsimulationandhighefficiencybyembedding [15] ThomasNguenThatandJordiCasas.2011.Anintegratedframeworkcombining
atrafficsimulatorandadrivingsimulator.Procedia-SocialandBehavioralSciences
thebehaviormodelsintotheactingfunctionswithinthesource
20(2011),648â€“655.
architectureofthesimulator.Itprovidesflexiblebehaviormodel [16] Chun-WeiTsai,Chien-HuiHsia,Shuang-JieYang,Shih-JuiLiu,andZhi-YanFang.
supportandavoidsunnecessarydatatransmissionbetweenthesim- 2020.Optimizinghyperparametersofdeeplearninginpredictingbuspassengers
basedonsimulatedannealing.Appliedsoftcomputing88(2020),106068.
ulatorandthePythoninterface.ByconstructingCityFlowER,we [17] HuichuZhang,SiyuanFeng,ChangLiu,YaoyaoDing,YichenZhu,ZihanZhou,
verifiedthefeasibilityoftheproposedmethodonarenownedbase WeinanZhang,YongYu,HaimingJin,andZhenhuiLi.2019.Cityflow:Amulti-
agentreinforcementlearningenvironmentforlargescalecitytrafficscenario.In
simulatorCityFlow.Wetransplanttwolearnedmodels(followSpeed
Theworldwidewebconference.3620â€“3624.
3https://drive.google.com/drive/folders/1O6-HR8HgNoMEBzqAJWpRz5p6-
3l7VtPy?usp=sharing 4https://github.com/cityflow-project/CityFlowER.git