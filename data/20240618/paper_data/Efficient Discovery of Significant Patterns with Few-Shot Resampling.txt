Efficient Discovery of Significant Patterns
with Few-Shot Resampling
LeonardoPellegrina FabioVandin
Dept.ofInformationEngineering,UniversityofPadova Dept.ofInformationEngineering,UniversityofPadova
Padova,Italy Padova,Italy
leonardo.pellegrina@unipd.it fabio.vandin@unipd.it
ABSTRACT 1 INTRODUCTION
Significantpatternminingisafundamentaltaskinminingtransac- Patternminingisafundamentaltaskindataminingthat,initsmost
tionaldata,requiringtoidentifypatternssignificantlyassociated commondefinition[17],requirestofindpatternsthatoccurmore
withthevalueofagivenfeature,thetarget.Inseveralapplications, oftenthanagivenfrequencythresholdinadatabaseoftransactions.
suchasbiomedicine,basketmarketanalysis,andsocialnetworks, Patternminingfindsapplicationsinseveralareassuchasmarket
thegoalistodiscoverpatternswhoseassociationwiththetarget basketanalysis[2],graphdatabases[1,3,11],andtheanalysisof
isdefinedwithrespecttoanunderlyingpopulation,orprocess, spatialandtemporaldata[9,10,18].
ofwhichthedatasetrepresentsonlyacollectionofobservations, Significant pattern mining [16, 31] is an extension of pattern
orsamples.Anaturalwaytocapturetheassociationofapattern miningthat,initsmostgeneralformulation,requirestodiscover
withthetargetistoconsideritsstatisticalsignificance,assessing patternswithasignificantassociationwithabinarylabelfroma
itsdeviationfromthe(null)hypothesisofindependencebetween datasetconsistingofacollectionofelements,whereeachelement
thepattern andthetarget. While severalalgorithms havebeen comprisesthevaluesoffeatures,whichmaybecategorical,binary,
proposedtofindstatisticallysignificantpatterns,itremainsacom- orcontinuous,andthevalueofthebinarylabelofinterests,also
putationally demanding task, and for complex patterns such as calledthetarget.Suchformulationcapturesvarioustypesofpat-
subgroups,noefficientsolutionexists. terns,suchasitemsets,whenallfeaturesarebinary,orsubgroups[4],
WepresentFSR,anefficientalgorithmtoidentifystatistically withmoregeneralfeatures.Thistaskfindsapplicationsinawide
significantpatternswithrigorousguaranteesontheprobability rangeofdomains,suchasmarketbasketanalysis,medicine,and
offalsediscoveries.FSRbuildsonanovelgeneralframeworkfor molecularbiology,wherefindingreliableassociationsisparamount.
miningsignificantpatternsthatcapturessomeofthemostcom- Significanceisusuallyassessedusingthestatisticalhypothesis
monlyconsideredpatterns,includingitemsets,sequentialpatterns, testingframework.Insuchframeworkonedefinesameasureof
andsubgroups.FSRusesasmallnumberofresampleddatasets, qualityforpatterns,andassumesthenullhypothesisofnoassocia-
obtainedbyassigningi.i.d.labelstoeachtransaction,torigorously tionbetweenapatternandthetargetlabel.Thesignificantpatterns
boundthesupremumdeviationofaqualitystatisticmeasuringthe arethentheoneswithqualitythatsignificantlydeviatefromthe
significanceofpatterns.FSRbuildsonnoveltightboundsonthe nulldistribution,thatis,thedistributionofthequalityunderthe
supremumdeviationthatrequiretomineasmallnumberofresam- nullhypothesis.Thedeviationfromthenulldistributionisusually
pleddatasets,whileprovidingahigheffectivenessindiscovering measuredbyağ‘-value,thatistheprobability,underthenulldistri-
significantpatterns.Asatestcase,weconsidersignificantsubgroup bution,thatthepatternhasqualityaslargeastheoneobservedin
mining,andourevaluationonseveralrealdatasetsshowsthatFSR thedataset.
iseffectiveindiscoveringsignificantsubgroups,whilerequiringa Amajorcomplicationintheuseofthestatisticalhypothesis
smallnumberofresampleddatasets. testingframeworkindataminingisgivenbythehugenumber
ofcandidatepatternsthatareconsidered,resultinginamultiple
hypothesistestingproblem.Withahugenumberofcandidatepat-
PVLDBReferenceFormat:
terns,somenon-significantpatternsdisplayasubstantialdeviation
LeonardoPellegrinaandFabioVandin.EfficientDiscoveryofSignificant
fromthenulldistributionjustbychance.Therefore,itiscriticalto
PatternswithFew-ShotResampling.PVLDB,17(10):XXX-XXX,2024.
accountfortestingmultiplehypotheseswhenminingsignificant
doi:XX.XX/XXX.XX
patterns,inordertoavoidreportingalargenumberofspuriousdis-
PVLDBArtifactAvailability: coveries.Severalmethodshavebeenproposedtodealwithmultiple
hypothesistesting[6,7,46].Whilethesemethodsprovidevarious
Thesourcecode,data,and/orotherartifactshavebeenmadeavailableat
guarantees,theonemostcommonlyconsideredistheFamily-Wise
https://github.com/VandinLab/FSR
ErrorRate(FWER),whichistheprobabilityofreportinginoutput
oneormorefalsediscoveries.
Currentapproachesforsignificantpatternminingwithguar-
ThisworkislicensedundertheCreativeCommonsBY-NC-ND4.0International
License.Visithttps://creativecommons.org/licenses/by-nc-nd/4.0/toviewacopyof anteesontheFWERbelongtooneoftwoclasses.Thefirstclass
thislicense.Foranyusebeyondthosecoveredbythislicense,obtainpermissionby isgivenbyapproachesthatassessthesignificanceofeachsingle
emailinginfo@vldb.org.Copyrightisheldbytheowner/author(s).Publicationrights
licensedtotheVLDBEndowment. pattern (e.g., through ağ‘-value or related quantities), and then
ProceedingsoftheVLDBEndowment,Vol.17,No.10ISSN2150-8097. performananalyticalcorrectiontoaccountformultiplehypothe-
doi:XX.XX/XXX.XX
sistesting[43â€“45].Awidelyusedprocedureinthisclassisgiven
4202
nuJ
71
]GL.sc[
1v30811.6042:viXrabyBonferronicorrection[6],whichcomputesacorrectedğ‘-value ofthepatterninanelementofthedatasetiswelldefined.Such
bymultiplyingtheğ‘-valueğ‘ P ofapatternPbythenumberâ„of patternsincludewidelyusedpatternssuchasitemsets,subgroups,
candidatehypotheses.Ifpatternswithcorrectedğ‘-valueâ„Ã—ğ‘ P sequentialpatterns,andsubgraphs.Second,weproposeFSR,an
belowathresholdğ›¼ areflaggedassignificant,theFWERofthe algorithmfortheefficientdiscoveryofarigorousapproximation
outputisguaranteedtobeâ‰¤ğ›¼.Whiletheseapproachesandtheir ofsignificantpatternswhilecontrollingtheFamily-WiseErrorRate,
improvedversions[29,40]arefairlyefficient,thankstotheuse whichistheprobabilityofreportingevenasinglefalsediscovery.
ofanalyticalderivations,theysufferfromalowstatisticalpower, FSRusesafew-shotresamplingapproach,thatis,itminesasmall
thatistheyoftenfailinidentifyingsignificantpatterns,duetothe numberofresampled datasets,obtainedbykeepingthefeatures
multiplehypothesiscorrectionsthatmustprovideguaranteesfor ofeachelementofthedatasetfixedandassigningi.i.d.valuesto
everysituation,independentlyoftheobserveddata. thetarget.Moreover,FSRcanleverageanyexistingalgorithmfor
Thesecondclassisgivenbyapproachesthatusethedatasetto miningthepatternsofinterest.Third,weprovidenoveltighttheo-
estimatetheoveralldistributionofthepatternsâ€™statistics(orcorre- reticalresultsrelatingthedistributionofpatternsâ€™qualitiesunder
spondingmeasures,suchastheğ‘-values)underthenullhypothe- theconditionalandtheunconditionaldistributions,andrelatingthe
sis[25,33,39].Thedistributionisestimatedusingpermutedver- estimatedmaximumdeviationofpatternsâ€™qualitiesinresampled
sionsofthedata,obtainedbykeepingthefeaturesineachelement datasetswiththeir(unknown)truequalityinthecorresponding
ofthedatasetfixedandrandomlypermutingthetargetlabelsamong distribution.Theseresultsarecrucialinmakingourapproachprac-
elements.Forexample,theWestfall-Young(WY)method[46]uses tical,sincetheyimplythatminingasmallnumberofresampled
permuteddatasetstoestimatethequantilesofthesmallestğ‘-value datasetsisenoughtoidentifysignificantpatterns.Fourth,wecon-
underthenullhypotheses(or,equivalently,largestqualitiesortest sidersignificantsubgroupsminingasatestcaseinourextensive
statistics),andusessuchestimatetoderiveacorrectedthreshold empiricalevaluation.WeuseouralgorithmFSRtoderivethefirst
toflagpatternsassignificant.Theseapproachesusuallyimprove approachforminingsignificantsubgroupswithunconditionaltest-
thestatisticalpowerfordetectingsignificantpatternscomparedto ing,andanapproachfortheconditionaltestingscenariowhichis
approachesinthefirstclass,butareoftencomputationallydemand- muchmoreefficientthanpermutationtestingwhilemaintaining
ing,sincetheyneedtominealargenumberofpermuteddatasets anextremelyhighpower.Forthemostchallengingdatasets,FSRis
toobtaingoodestimatesoftheoveralldistributionofthepatternsâ€™ theonlyapproachthatallowstominesignificantsubgroupswithin
statistics.Whilethiscanbeachievedfairlyefficientlyforsimple reasonabletime.Moreimportantly,weremarkthattheconsidered
patternssuchasitemsets[25,33],theoverallapproachisimpracti- testcaseofsubgroupsiswellrepresentativeofothersettings.Infact,
calformorecomplexpatternssuchassubgroups,forwhichmining weexpectthesensibleimprovementsobtainedbyFSRtotransfer
evenasingledatasetisextremelytime-consuming. toothercases(i.e.,otherpatterntypes),giventhegeneralityofour
An additional limitation of permutational approaches is that frameworkandthecharacteristicsofourpermutationalapproaches,
theyfocusonconditionaltesting[15].Inconditionaltestingone whicharesharedbyallsignificantpatterntasks.
assumesthatthevariablesofinterest,inourcasethefrequency Duetospaceconstraints,wedefersomeoftheproofsandaddi-
ofpatternsandthefractionofelementswithtargetlabel1,are tionalresultstotheAppendix.
thesameineverydatasetfromthenulldistribution.Incontrast,in
unconditionaltesting[5]oneassumesthatthevariablesofinterest
2 RELATEDWORKS
aretherealizationofcorrespondingrandomvariables.Conditional
testingandunconditionaltestingcapturedifferentassumptions Ourworkfocusesonefficientlyminingsignificantpatterns.Wenow
regardinghowdataisgeneratedandcollected,thatis,whetherthe discussthepreviousworksmostrelatedtoourcontributions.We
variablesofinterestwouldbethesameindifferentrepetitionsofthe referthereadertorecentcomprehensivereviewsandtutorialsfor
experiment.Thechoicebetweenthetwotypesoftestingdepends anoverviewofcommonlyusedtechniquesforminingsignificant
onthespecificscenarios.However,inpracticeconditionaltestsare patterns[16,31].
oftenusedforcomputationalreasons,sinceunconditionaltestsare Severalapproaches[43â€“45]haveusedgeneralmethodsformul-
muchmoredemandingfromthecomputationalstandpointdueto tiplehypothesestesting,suchasBonferroni[7]andHolmmeth-
theneedtoaccountforuncertaintiesintheobservedquantities. ods[19],withinsignificantpatternmining.Suchmethodsresult
Infact,whileforsimplepatternssuchasitemsets[32]significant inlowstatisticalpower,sincetheycorrecttheğ‘-value,oramea-
patternminingprocedureswith(partial)unconditionaltestinghave sureofthesignificanceofapattern,bythenumberofcandidate
beendesigned,formorecomplexpatternssuchassubgroupsno hypotheses(i.e.,thenumberofpatterns),whichisextremelylarge
unconditionaltestingprocedureisavailable. indataminingapplications.LAMP[29,40]isarecentlyintroduced
methodthatpartiallyaddressessuchissuebyselectingasubsetof
patternsfortesting,whilediscardingthepatternswithnochanceof
1.1 Contributions
beingsignificant.Suchapproachleadstoidentifyinganimproved
Thisworkfocusesontheefficientdiscoveryofsignificantpatterns. (i.e.,smaller)correctionfactor,resultinginhigherstatisticalpower
Ourcontributionsarefour-fold.Firstly,weproposethefirstgeneral whilecontrollingtheFWER.However,sinceeachselectedpattern
frameworktodiscoversignificantpatternsthatcanbeusedforboth isstilltestedasadistincthypothesis,LAMPstillleadstoreduced
conditionalandunconditionaltesting.Ourframeworkisbasedon statisticalpower[25,39].OuralgorithmFSRinsteadusesresam-
anaturaldefinitionofapatternâ€™squalitythatcapturesitssignifi- pleddatasets,takingintoaccountdependenciesamongpatterns,to
cance,andappliestoanytypeofpatternforwhichtheappearance achievehighstatisticalpower.
2Severalpermutation-basedmethodshavebeenproposedtoiden- thesetğ‘ ,whileforsubgroupminingitmeansthattheconditions
tify patterns significantly associated with a binary target label. definedbyPareallsatisfiedbythefeaturesofğ‘ .Wedefinetheset
[25,33,39]usetheWestfall-Young(WY)permutationtest[46].The CP(D)oftransactionsinthedatasetDthatsupportapatternPas
WYpermutationprocedurerequirestoestimatetheğ›¿-quantileof CP(D)={(ğ‘ ,â„“) âˆˆD :P âˆˆğ‘ }.ThefrequencyfP(D)ofapattern
thedistributionoftheminimum(overallallpatterns)ğ‘-value(or, PinthedatasetDisthefractionoftransactionsofDthatsupport
equivalently,ofthedistributionofthemaximumdeviation,overall P:fP(D)= ğ‘š1 (cid:205)ğ‘š ğ‘–=11[P âˆˆğ‘  ğ‘–] = |CP ğ‘š(D)| .
patterns,ofthemeasureofsignificance).Theuseofsuchquantiles Finally,let ğœ‡(D) denotetheaveragevalueofthetargetâ„“ for
makesWYpermutationtestingmorepowerfulthanLAMP,but transactionsinthedatasetD:ğœ‡(D)= |D1
|
(cid:205) (ğ‘ ,â„“)âˆˆDâ„“.
alsomorecomputationallyexpensive,sincetheestimationofsuch
quantilesrequirestominealargenumberofpermuteddatasets. 3.1 SignificantPatterns
Forthesereasons,allsuchmethodsmayneedimpracticalresources.
Ourgoalistofindsignificantpatterns,whereapatternPissignif-
Our algorithm FSR instead requires to mine a small number of
icant ifthepresenceofP inatransactionisassociatedwiththe
resampleddatasets,leadingtoanefficientapproachevenforcom-
targetvariableofthetransactionbeing1.Inparticular,wecon-
plexpatternssuchassubgroups.Inaddition,permutation-based
siderthesignificanceofapatternintheframeworkofstatistical
methodsonlyconsidertheconditionaldistribution,wherepatternsâ€™
frequenciesandthefractionofelementswithtargetlabelequalto
significance,assumingthatthetransactions{(ğ‘  1,â„“ 1),...,(ğ‘  ğ‘š,â„“ ğ‘š)}
constitutingthedatasetD aresamplesfromanunknowndistri-
1areassumedfixedinallpermuteddatasets.Ourapproachinstead
butionğ›¾.ApatternPisassociatedwiththetargetvariableifthe
worksforboththeconditionalandtheunconditionaldistribution.
probability of the event â€œP âˆˆ ğ‘  and â„“ = 1â€ is higher than the
Theidentificationofsignificantpatternswithunconditionaltest-
correspondingprobabilitywhentheeventâ€œP âˆˆğ‘ â€andtheevent
inghasreceivedscantattention.Thisisdue,inpart,tothehigher
â€œâ„“ =1â€areindependent.Formally,thiscorrespondstoconsiderthe
computationalcostrequiredforassessingthesignificanceofeven
followingnullhypothesisforapatternP:
asinglehypothesisintheunconditionalsetting,forexampleus-
ingBarnardâ€™stest[5].Asfarasweknow,theonlyapproachfor Pr (P âˆˆğ‘ âˆ§â„“ =1)= Pr (P âˆˆğ‘ ) Pr (â„“ =1).
miningsignificantpatternsinapartiallyunconditionalsettingis
(ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾
SPuManTE[32].Inthepartiallyunconditionalsettingconsideredby Sinceweareinterestedinpatternswithasignificantassociation
SPuManTEonlythefrequenciesofthepatternsarenotfixed,while withthetargetvariablebeing1,weareinterestedinfindingpatterns
thetargetisfixedbydesign.IncontrastouralgorithmFSRconsid-
forwhichthefollowingalternativehypothesisholds:
ersafullyunconditionalsetting,wherethefractionofelements
Pr (P âˆˆğ‘ âˆ§â„“ =1) > Pr (P âˆˆğ‘ ) Pr (â„“ =1).
withtargetlabelequalto1isnotfixedeither.Moreover,SPuManTE (ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾
leveragesspecializedtechniquesforminingsignificantitemsets Tothisend,wedefinethequality1ofapatternPas
thatcannotbeeasilygeneralizedtootherpatterntypes,whileour
approachappliesdirectlytoseveralpatternlanguages,including qP = Pr (P âˆˆğ‘ âˆ§â„“ =1)âˆ’ Pr (P âˆˆğ‘ ) Pr (â„“ =1).
(ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾
itemsets,sequentialpatterns,andsubgroups.
Otherworks,orthogonaltoours,considerimprovingthediver- NotethatthealternativehypothesisisequivalenttoqP >0,and
sityorlimitingredundancyoftheoutput[12,21,41]. thenullhypothesisisequivalenttoqP = 0.Therefore,finding
significantpatternsisequivalenttofindingpatternswithquality
qP >0.
3 PRELIMINARIES
Forexample,considerthestudyoftheassociationbetweenthe
Weconsideradataset D asacollectionofğ‘š transactions D = characteristicsoftheusersofanonlinesocialnetworkandusersâ€™
{(ğ‘  1,â„“ 1),...,(ğ‘  ğ‘š,â„“ ğ‘š)},whereeachtransaction(ğ‘ ,â„“) âˆˆ D iscom- interestsinagiventopic.Inthiscase,eachuserisatransaction,
posedbyasetğ‘ ofğ‘‘features,eitherbinary,categorical,orcontin- usersâ€™characteristicsarethefeatures,andbeinginterestedornot
uous,andabinarytargetvariableâ„“ âˆˆ {0,1}.Moregenerally,we inthetopicdefinesthetargetvariable.Significantpatternsinthis
assumethatğ‘  belongstoadomainX.Bydefiningthemultisets exampleareassociationsbetweenusersâ€™characteristicsandusersâ€™
A = {ğ‘  1,...,ğ‘  ğ‘š}andT = {â„“ 1,...,â„“ ğ‘š},adatasetD isalsorepre- intereststhataresignificantlystrongerthanexpectedunderthenull
sentedbythepairD =(A,T).WeassumetohavealanguageL hypothesisofindependencebetweencharacteristicsandinterests.
containingthepatternsofpotentialinterest.Thisscenariocaptures Forexample,iftheprobabilitythatauserhasagivenbinaryfeature
widelyusedpatternminingtasks,suchas:itemsetmining,where
ğ‘“ is0.3,andtheprobabilitythatauserisinterestedinthetopicis
allfeaturescorrespondto(binary)itemsandthelanguageLcorre- 0.5,thenunderthenullhypothesisofindependencewehavethat
spondstothesetofallitemsets,i.e.,(non-empty)subsetsofitems; theprobabilitythatauserhasfeature ğ‘“ and isinterestedinthe
subgroupmining,wherethelanguageLcontainsallsubgroups,i.e., topicis0.15.Therefore,thefeatureğ‘“ issignificantlyassociatedwith
thesetsofconjunctionswithatmostğ‘§ conditionsoverfeatures thetopicofinterestiftheactualprobabilitythatauserhasfeature
fromA,whereeachconditioniseitheranequality,onacategorical ğ‘“ andisinterestedinthetopicis>0.15.
feature,oraninterval,onacontinuousfeature.
TaskDefinition.GivenadatasetDandthecorrespondingpat-
Given a transaction (ğ‘ ,â„“), we use the notation P âˆˆ ğ‘  to say ternlanguageL,ourgoalistoidentifysignificantpatterns,that
thatthesetğ‘  offeaturessupportspatternP,wherethemeaning
ofP âˆˆ ğ‘  dependsonthespecificdataminingtask.Forexample, 1 qT uh ae litq yua gl ii vty enqP itsis reo lf ate tin onca tl oled thl eev 1e -r qag ue alf io tyrg ce on mer mal op na lytte er mns pl[ o1 y6 e], db tu ot fiw ne dus ine tt eh re est te ir nm
g
foritemsetmining,P âˆˆğ‘ meansthatthepatternPiscontainedin subgroups.
3is,patternsP âˆˆ LwithqualityqP > 0.Sincethedistributionğ›¾ testassumesthatthedata-generatingprocessrepresentedbythe
isunknownandwehaveaccessonlytothedatasetDcomprising unknowndistributionğ›¾onlyproducesdatasetswithğ‘štransactions
transactionssampledfromğ›¾,wecannothopetodiscoverallsignif- inwhichboththefrequencyfP(D)ofpatternPandthefraction
icantpatternswithouterrors.Asaconsequence,wemustresortto ğœ‡(D) oftransactionswithtargetvalue1arethesameasinthe
approximations.Inparticular,definethesubsetLâ˜… ofthelanguage observeddataset;thatis,itconditionsontheobservedvariables
Lofpatternsforwhichthenullhypothesisholds: ofinterest.Incontrast,unconditionaltestsassumethatfP(D)and
Lâ˜… ={P âˆˆL:qP =0}. ğœ‡(D)aretherealizationofcorrespondingrandomvariables.Un-
conditionalteststhereforeassesstheassociationbetweenapattern
Ourtaskisthentoproduceasubsetğ‘‚ âŠ† Lofallpatternsinthe andclasslabelsconsideringalsoscenarios(i.e.,datasets)whereall
languagewithFamily-WiseErrorRate(FWER)belowauser-defined
frequenciesofthepatternsand/ortheaveragetargetvaluemay
thresholdğ›¿,suchthattheprobabilitythatğ‘‚containsatleastone differfromwhatisobservedinthedata.Equivalently,conditional
elementfromLâ˜… isatmostğ›¿: testsandunconditionaltestsarebasedondifferentassumptions
Pr(cid:0)ğ‘‚âˆ©Lâ˜… â‰ âˆ…(cid:1) â‰¤ğ›¿. (1) regardinghowdataisgeneratedandcollected,namely,whether
D thevariablesofinterestwouldbethesameinadifferentrepetition
Notethat(1)impliesthatğ‘‚ isfalsediscoveryfreeapproximation, oftheexperiment(conditionaltests)ornot(unconditionaltests).
whichhavepreviouslybeenconsideredforotherpatternmining Consider for example the scenario of online social networks
tasks[36,37]. described in Section 3.1, and assume for simplicity that we are
SinceqP dependsontheunknowndistributionğ›¾,wedefinea interestedinassociationsbetweenthesinglefeaturesandthetarget.
statisticqÂ¯P(D)thatcorrespondstoanestimateofqP fromdata Ifthedataiscollectedsothatthetotalnumberoftransactionsfor
andthatwewilluseinouralgorithmFSRtoidentifysignificant eachvalueofthetargetisfixedandthefractionoftransactions
patterns.ForeachpatternP,wedefinethefunctionsğ‘“
P
andğ‘”
P
withgivenvaluesofthefeaturesisfixedaswell,thenconditional
asfollows:eachğ‘“
P
:X â†’ {0,1}isdefinedasğ‘“ P(ğ‘ ) =1[P âˆˆğ‘ ], testingismoreappropriate.Ifinsteadonecollectsthedatawithout
such that ğ‘“ P(ğ‘ ) = 1 if P âˆˆ ğ‘ , and ğ‘“ P(ğ‘ ) = 0 otherwise; each constraintsonthefeatures/targetvalues(e.g.,simplycollectingas
ğ‘” P : X Ã—{0,1} â†’ [âˆ’ğœ‡(D),1âˆ’ğœ‡(D)] isdefinedasğ‘” P(ğ‘ ,â„“) = manytransactionsaspossible),thenunconditionaltestingismore
ğ‘“ P(ğ‘ )(â„“âˆ’ğœ‡(D)).Then,theestimateqÂ¯P(D)ofqP forpatternP appropriate.
fromthedatasetDis Conditionaltestsandunconditionaltestsarethereforebothvalid
ğ‘š andofinterestfordataminingapplications,andthechoicebetween
1 âˆ‘ï¸
qÂ¯P(D)=
ğ‘š
ğ‘” P(ğ‘  ğ‘–,â„“ ğ‘–). thetwoclassesdependsonthespecificscenario,evenifinpractice
ğ‘–=1 conditionaltestsareusuallypreferredforcomputationalreasons,
Interestingly,qÂ¯P(D)correspondstothe1-qualitycommonlyused sinceunconditionaltestsneedtotakeintoaccountmoreuncer-
taintiesintheobservedquantities.Inwhatfollows,weintroducea
insubgroupmining[4](seeAppendixA.1),evenifthewayitis
generalalgorithmtoidentifysignificantpatternsforbothcondi-
usedinouralgorithmFSR(seeSection4)isdifferentfromitsusual
tionaltestingandunconditionaltesting.Ouralgorithmisextremely
application,duetoourfocusonstatisticallysignificantpatterns.
efficientinbothcasesduetotheuseoffew-shotresampling.
Intuitively,weexpectsignificantpatternstohaveasufficiently
high empirical quality qÂ¯P(D) measured on the data D, since
4 FSRALGORITHM
qÂ¯P(D)estimatesthe(true)qualityqP ofP.Totakeintoaccount
themultiplehypothesistestingissuedescribedabove,weneedto WenowdescribeouralgorithmFSR(Algorithm1)tofindsignificant
identifyathresholdğœ€suchthatreportinginoutputallpatternswith patternsforbothconditionaltestingandunconditionaltesting.We
qualityâ‰¥ğœ€hasboundedFWER.Notethatğœ€shouldbeassmallas firstpresentthegeneralapproach,thatiscommontobothtesting
possibleinordertohavehighstatisticalpower(i.e.,toreportthe scenarios,andthenpresentthedetailsforconditionaltestingin
largestsetofresultswithguaranteesonfalsediscoveries).Acritical Section4.1,andthedetailsforunconditionaltestinginSection4.2.
quantitywestudytoaddressthisissueisthesupremumdeviation Inanutshell,FSRidentifiessignificantpatternsfromadataset
oftheempiricalqualitiesofnon-significantpatterns,definedas D ={(ğ‘  1,â„“ 1),...,(ğ‘  ğ‘š,â„“ ğ‘š)}usingafew-shotresamplingapproach
tocomputerigorousprobabilisticboundstothedeviationofthees-
Ps âˆˆu Lp â˜…{qÂ¯P(D)}. (2)
timatedqualitiesqÂ¯P(D)ofthepatterns,underthenullhypothesis
ofnoassociationbetweenthepatternsandthetargetlabel.Itthen
WeaddressthischallengewithFSR:wederivenovelanalytical
reportsinoutputallpatternswithestimatedqualityqÂ¯P(D)above
boundsontheconcentrationofthesupremumdeviation(2),and
suchdeviation.
b toui sl hd ao rpn lyth ee ss te imto ao tels ita .n FSe Rffi ac cie hn iet vf ee sw h-s igh hot str ae ts ia sm ticp al lin pg owal eg ror wit hh im
le
resaF mSR plc eo dn ds ai td ae sr es tsa ,ec ao cl hle oc bti to an ineR dâ˜… by= re{ sD am1â˜…, p. li. n. g,D thğ‘â˜… e} tao rf gğ‘ etâ‰¥ lab1 eli s.i. od f.
scaling to large datasets and complex languages. Our approach
DwhilemaintainingthesamefeaturesofthetransactionsofD.
appliestobothconditionalandunconditionaltesting,bothofgreat EachresampleddatasetisDâ˜… ğ‘— =(cid:8) (ğ‘  1,ğœ‰ 1,ğ‘—),...,(ğ‘  ğ‘š,ğœ‰ ğ‘š,ğ‘—)(cid:9) ,where
interestindatamining.
ğœ‰ ğ‘–,ğ‘— arei.i.d.randomvariableswith
3.2 ConditionalandUnconditionalTesting ğœ‰ ğ‘–,ğ‘— âˆ¼ğµğ‘’ğ‘Ÿğ‘›(ğ‘),âˆ€ğ‘– âˆˆ [1,ğ‘š],âˆ€ğ‘— âˆˆ [1,ğ‘],
WhenassessingthestatisticalsignificanceofapatternP,onehasto andğµğ‘’ğ‘Ÿğ‘›(ğ‘)istheBernoullirandomvariablewithparameterğ‘(i.e.,
choosebetweenconditionalandunconditionaltests.Aconditional itis1withprobabilityğ‘,and0otherwise).
4We now describe the general approach followed by FSR (Al- Algorithm1:FSR
gorithm 1). FSR starts by computing an upper boundğœ€ ğ‘‡ to the Input:PatternlanguageL;datasetDofğ‘štransactions;
deviationbetweentheaveragetargetvalueğœ‡(D)observedinD
ğ‘ â‰¥1;ğ›¿ âˆˆ (0,1).
and its expected value ğœ‡ = E D[ğœ‡(D)] under the null hypoth- Output:Setğ‘‚ âŠ†LofsignificantpatternswithFWERâ‰¤ğ›¿.
esis (line 1). Note that ğœ‡ is the probability that a sample from 1 ğœ€ ğ‘‡ â†boundTarget(ğœ‡(D),ğ‘š,ğ›¿);
theunknowndistributionğ›¾ hastargetlabelâ„“ equalto1,thatis 2 ğœ‡Ë†â†ğœ‡(D)+ğœ€ ğ‘‡;
ğœ‡ = Pr(ğ‘ ,â„“) (â„“ =1). The computation ofğœ€ ğ‘‡ is performed by the 3 ğœ‡Ë‡â†ğœ‡(D)âˆ’ğœ€ ğ‘‡;
procedureboundTargetanditdependsonwhetheroneisinter-
4
Râ˜…â†resampleTarget(D,ğ‘,ğœ‡Ë†);
estedinconditionaltestingorinunconditionaltesting.Thede-
tails of boundTarget for the two settings are described in Sec- 5 forallğ‘— âˆˆ [1,ğ‘]doğ‘‘ ğ‘— â†sup PâˆˆL(cid:8) qÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)(cid:9) ;
tion4.1andinSection4.2,respectively.ThenFSRusesğœ€ ğ‘‡ toob- 6 ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)â† ğ‘1(cid:205)ğ‘ ğ‘—=1ğ‘‘ ğ‘—;
taintheupperbound ğœ‡Ë† (line2)andlowerbound ğœ‡Ë‡ (line3)to ğœ‡ 7 ğœ€ â†boundStatistic(D,L,ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡),ğ›¿);
(
r
sw
ie
gse
na
it
m
nri
p
gv li tea ol Tl eay ara
cg
hs es tu trm
t ao
ne sg0
ae
cnâ‰¤
te
iorğœ‡
a
nË‡ teâ‰¤ inğ‘ğœ‡ tË†
r
heâ‰¤
esa
d1
m
a) t.
p
aI
l
st
e
edt th sde oan ftau Rss
e
â˜…e ts
s
tht Rh eâ˜…e tap
(
rlr
i
gno eec te
4
ld a)u bar ese
l-
98 ğ‘‚ retâ† urn{P ğ‘‚âˆˆ
;
L:qÂ¯P(D) â‰¥ğœ€+ğœ€ ğ‘‡fP(D)};
1withprobabilityğ‘ =ğœ‡Ë†(i.e,theupperboundtoğœ‡).Notethatthe
resampleTargetprocedureisthesameforbothconditionalandun-
ğ‘co rn ed sait mio pn la el dt des at ti an sg e. tsT oh fe Ral â˜…g ,o ari nth em stit mhe an tec oo fm thp eut mes a, xf ir mom umea dc eh vio af tit oh ne qÂ¯P(D)fromthe(unknown)valueqP underthenullhypothesis.
Moreover,theexactsameprocedureisusedtogeneratetheresam-
oftheempiricalqualityqÂ¯P(D)fornon-significantpatterns.Thisis
pleddatasets.Notethatourapproachissimilartopermutation
achievedbycomputing,foreveryresampleddatasetDâ˜…
ğ‘— ,thequan- approachesforsignificantpatternmining,whichusepermuted
titysup PâˆˆLqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡),whereqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)= ğ‘š1 (cid:205)ğ‘š ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(ğœ‰ ğ‘–,ğ‘—âˆ’ datasetstoestimatethesignificanceofpatterns,butwithtwocru-
ğœ‡Ë‡).Thevaluesup PâˆˆLqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)canbeinterpretedasanempiri- cialdifferences.First,ourdatasetsareobtainedbyresamplingthe
calestimateofthemaximumqualityofnon-significantpatterns, targetvalues,andnotbypermutingthem,whichallowsustoobtain
measuredfromdatasetssampledfromthenulldistribution.Note rigorousboundsforbothconditionalandunconditionaltesting,
thatweuseqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)asğœ‡Ë‡isalowerboundtoğœ‡;consequently, while permutation approaches can be used for conditional test-
qÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)providesaproperupperboundtosuchmaximumdevia- ingonly.Second,sinceouranalysisdependsontheexpectation
ofthemaximumdeviation,wecanemployadvancedboundson
tion.Then,notethatitisnecessarytoconsiderthesupremumover
thelanguageL,sincethesetoftruenullhypothesisLâ˜…
isunknown.
theconcentrationoftheexpectedvalueoffunctionsofindepen-
Weremarkthatthecomputationofsup PâˆˆLqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)canbeper- d ree sn at mra pn led dom datv aa sr ei ta sb ,l ae ss; st hh ois wa nllo bw ys ouu rst ao nau ls ye sia ss am na dll en xpu em rib mer enğ‘ to af
l
formedwithfastpatternenumerationstrategies,similartotheones
evaluation.Thisisincontrastwithpermutationapproaches(e.g.,
leveragedbypreviousmethodsforfrequentandsignificantpattern
theonesbasedonWYpermutationtesting[25,33,39])thatinstead
mining;infact,FSRcanbecombinedwithanyefficientexploration
estimatethequantilesofthedistributionofthemaximumdevia-
procedure,suchastheonesthatexplorethesearchspaceofthe
tionusingalargenumberofpermutations(seealsoSectionA.2in
patternlanguageofinterestusingpruningbounds,forinstance
Appendixforamoredetailedcomparison).
depth-first[25,29,39]orbest-firstsearches[30,33,34].Thealgo-
rithmthenstorestheempiricaldeviationssup PâˆˆLqÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)in 4.1 FSRforConditionalTesting
thevariablesğ‘‘ ğ‘—.Then,theaveragemaximumdeviationğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)
overtheğ‘resampleddatasetsiscomputed(line6)asthemeanof We now describe the details of procedures boundTarget and
thevalues{ğ‘‘ ğ‘—,ğ‘— âˆˆ [1,ğ‘]},anditisthenusedtocomputearigor- boundStatisticfortheversionof FSRthatusesconditionaltest-
ousupperboundğœ€tothesupremumdeviationsup PâˆˆLâ˜…{qÂ¯P(D)} i on ug r, pw rh oi bc lh emwe ar se sf ue mrt eo sa ths aF tSR th- eC. aA ves ra agre em tain rgd ee tr, va ac luo end ğœ‡it aio nn da pl ate tts et rf no sr
(Eq.(2))underthenullhypothesis(line7)throughtheprocedure
boundStatistic.Theimplementationofthisprocedure,i.e.,the
frequenciesfP(D)arefixed,forallP âˆˆL,tothevaluesobserved
returnedvalueofğœ€,dependsonwhetherconditionaltestingorun-
inthedatasetD.
ForboundTarget,sincetheaveragetargetvalueğœ‡ isfixedto
conditionaltestingisconsidered,anditisdescribedinSection4.1
thevalue ğœ‡(D) observedinthedataset D,theboundğœ€ ğ‘‡ onits
andSection4.2,respectively.Inbothcases,weuseadvancedcon-
deviationfromtheexpectationis0,thatis,boundTargetsimply
centrationbounds[8,27]thatallowustoobtainsmallvaluesof
ğœ€withasmallnumberğ‘ofresampleddatasets.Finally,thesetof returns0.Notethatthisimpliesthattheoutputof FSR-Cconsists
patternswithestimatedqualityqÂ¯P(D)greaterthanğœ€+ğœ€ ğ‘‡fP(D)
ofallpatternsinLwithqÂ¯P(D) â‰¥ğœ€(line8).
For boundStatistic, we now show how to compute a
isreportedinoutput(lines8-9).
Notethatwhilethecomputationofğœ€
ğ‘‡
andğœ€dependsonwhether rigorous probabilistic bound ğœ€ to the supremum deviation
conditionaltestingorunconditionaltestingisconsidered,theover-
sup PâˆˆLâ˜…{qÂ¯P(D)}(Eq.(2))underthenullhypothesis.Thebound
isobtainedbycomputingtheaveragemaximumdeviationğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)
allapproachfollowedbyFSRisthesameinbothcases.Inparticular,
forbothcasesFSRreliesontheresampleddatasetsRâ˜…
toestimate
overğ‘ resampleddatasets,andthenapplyingadvancedconcen-
themaximumdeviation,overallpatternsP âˆˆL,oftheestimate trationresults[8].Notethatsinceğœ€ ğ‘‡ =0,inthiscaseğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡) =
ğ‘‘Ëœ(Râ˜…,ğœ‡(D)).
5Since FSR-C is based on resampled datasets, where each tar- Therefore,wehave
getlabelissampledindependently,ourestimateğ‘‘Ëœ(Râ˜…,ğœ‡(D))of
theexpectedmaximumdeviationisnotbasedontheconditional
E [ğ‘“(v)]
vâˆ¼ğ¼(ğ‘˜/ğ‘š)
distributionassumedbyconditionaltests,wherethefractionof
ğ‘š (cid:34) ğ‘š (cid:35) (cid:32)ğ‘š (cid:33)
targetlabelsequalto1isexactlyğœ‡(D)ineverydataset(whilein âˆ‘ï¸ âˆ‘ï¸ âˆ‘ï¸
= E ğ‘“(v) | vğ‘– = ğ‘— Pr vğ‘– = ğ‘—
ourresampleddatasetssuchfractionmayvary,anditisequalto ğ‘—=0vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
ğœ‡(D)onlyinexpectation).Wethereforeneedtorelatethesupre-
ğ‘š (cid:34) ğ‘š (cid:35) (cid:32)ğ‘š (cid:33)
mumdeviationoftheobservedqualityofpatternsonresampled â‰¥âˆ‘ï¸ E ğ‘“(v) |âˆ‘ï¸ vğ‘– = ğ‘— Pr âˆ‘ï¸ vğ‘– = ğ‘—
datasetswiththeoneobservedindatasetssampledfromthecondi- ğ‘—=ğ‘˜vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
tionaldistribution.Interestingly,weshowthattheresamplingand
(cid:34) ğ‘š (cid:35) ğ‘š (cid:32)ğ‘š (cid:33)
conditionaldistributionsarecloselyrelated,inthesensethathigh
â‰¥ E ğ‘“(v)
|âˆ‘ï¸
vğ‘– =ğ‘˜
âˆ‘ï¸
Pr
âˆ‘ï¸
vğ‘– = ğ‘—
probabilityboundsfortheformeralsoapplytothelatter. vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
ğ‘—=ğ‘˜vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
Wefirstproveageneralresult(Lemma1)relatingtheexpec-
(cid:32)ğ‘š (cid:33)
tationofmonotonefunctionsofpermutationsofbinaryvectors, = E [ğ‘“(v)] Pr âˆ‘ï¸ vğ‘– â‰¥ğ‘˜
correspondingtotheconditionaldistribution,withtheexpectation vâˆ¼ğ‘ˆ(ğµ(ğ‘˜)) vâˆ¼ğ¼(ğ‘˜/ğ‘š)
ğ‘–=1
takenw.r.t.toindependentresamples,correspondingtoresampled
1
datasets.Foranintegerğ‘˜ with0 â‰¤ğ‘˜ â‰¤ğ‘š,definethesetğµ(ğ‘˜)of â‰¥ E [ğ‘“(v)] ,
binaryvectorswithğ‘˜entriesequaltooneas
vâˆ¼ğ‘ˆ(ğµ(ğ‘˜)) 2
wherethelastinequalityfollowsfromLemma2. â–¡
ğ‘š
ğµ(ğ‘˜)=(cid:110) vâˆˆ{0,1}ğ‘š,âˆ‘ï¸
vğ‘–
=ğ‘˜(cid:111)
,
ğ‘–=1 WemakeuseofLemma1toprovethefollowingresult.
Theorem3. Definetheconstantğœ‡Â¯= ğœ‡(D)andletğ‘˜ = ğœ‡Â¯ğ‘š.For
and letğ‘ˆ(ğµ(ğ‘˜)) be the uniform distribution over the set ğµ(ğ‘˜). anyğ‘§ â‰¥0,itholds
Equivalently,ğ‘ˆ(ğµ(ğ‘˜)) correspondstothesetofuniformpermu-
tations of a binary vector with ğ‘˜ ones. Then, define ğ¼(ğ‘) as a (cid:32) ğ‘š (cid:33)
p ar ro ab na db oil mity ved cis totr rib vu tt aio kn enov fre or m{0 ğ¼, (1 ğ‘} )ğ‘š is,s au nch i.i.t dh .a Bt ee ra nc oh ue lln it rr .vy .v wğ‘– ito hf vâˆ¼ğ‘ˆP (ğµr
(ğ‘˜))
Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¥ğ‘§
Pr(vğ‘– =1)=ğ‘ =1âˆ’Pr(vğ‘– =0),forsomeğ‘ âˆˆ [0,1]. (cid:32)
1
âˆ‘ï¸ğ‘š (cid:33)
Lemma1. Letğ‘“ : {0,1}ğ‘š â†’ Rbeanonnegativefunctionsuch
â‰¤2 vâˆ¼P ğ¼r
(ğœ‡Â¯)
Ps âˆˆu Lp
â˜…ğ‘š
ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¥ğ‘§ .
tt oh na it cE alv lâˆ¼ yğ‘ˆ d( eğµ cr(ğ‘˜ ea)) si[ nğ‘“ g( iv n)] ğ‘˜.is Ite hit oh le dr smonotonicallyincreasingormono- ProofofTheorem3. Definethefunctionğ‘”:{0,1}ğ‘š â†’{0,1}
(cid:34) ğ‘š (cid:35)
vâˆ¼ğ‘ˆ(E ğµ(ğ‘˜))[ğ‘“(v)] â‰¤2 vâˆ¼ğ¼(E ğ‘˜/ğ‘š)[ğ‘“(v)]. ğ‘”(v)=1 Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¥ğ‘§ .
ToproveLemma1,weneedthefollowingtechnicalresult,pro- In order to apply Lemma 1, we prove that E vâˆ¼ğ‘ˆ(ğµ(ğ‘˜)) [ğ‘”(v)] is
vidingboundstotheprobabilitythataBinomialrandomvariable nondecreasingwithğ‘˜.Thisisequivalenttoshowthat
exceedsitsexpectation[20].
E [ğ‘”(v)] â‰¤ E [ğ‘”(v)],
Lemma2. Letğœ‡ğ‘šbeaninteger.Thenitholds vâˆ¼ğ‘ˆ(ğµ(ğ‘˜)) vâˆ¼ğ‘ˆ(ğµ(ğ‘˜â€²))
whereğ‘˜â€² = ğ‘˜ + ğ‘—, for any pair of integersğ‘˜ âˆˆ [0,ğ‘š] and ğ‘— âˆˆ
(cid:32) âˆ‘ï¸ğ‘š (cid:33)
1
(cid:32) âˆ‘ï¸ğ‘š (cid:33) [0,ğ‘šâˆ’ğ‘˜].Todoso,webuildacouplingğœ‹(ğ‘˜,ğ‘˜â€²)betweenthetwo
vâˆ¼P ğ¼r (ğœ‡) ğ‘–=1vğ‘– >ğœ‡ğ‘š < 2 < vâˆ¼P ğ¼r (ğœ‡) ğ‘–=1vğ‘– â‰¥ğœ‡ğ‘š . d fri os mtri ğ‘ˆbu (t ğµio (n ğ‘˜s ))ğ‘ˆ ,d( eğµ fi( nğ‘˜ e)) va â€²n ad sağ‘ˆ c( oğµ p( yğ‘˜â€² o) f) vas (i.f eo .l ,l so uw cs h. tF ho ar ta vn ğ‘–y =v vğ‘–â€²t ,a âˆ€k ğ‘–e âˆˆn
[1,ğ‘š]),thatismodifiedaccordingtothefollowingprocedure:for
WenowproveLemma1.
ğ‘— times,selectuniformlyatrandomanindexğ‘– suchthatvğ‘–â€² = 0,
andsetvğ‘–â€²to1.Denotethepairv,vâ€²sampledaccordingtoğœ‹(ğ‘˜,ğ‘˜â€²)
astheoutputofthisprocedure.Itisimmediatetoobservethat
ProofofLemma1. We prove the result assuming that
E cav sâˆ¼ eğ‘ˆ is(ğµ a( nğ‘˜ a)) lo[ gğ‘“ o( uv s) .] Fi is rsm t,o wn eot no on teic ta hll ay tincreasinginğ‘˜,astheother v anâ€² dâˆ¼ tğ‘ˆ ha(ğµ t( vğ‘˜ ğ‘–â€²) â‰¤)( vi. ğ‘–e â€²,., âˆ€t ğ‘–ha âˆˆtt [h 1e ,ğ‘šm ]a .rg Ti hn ia sl id mis ptr li ib eu st ti hon ato ,f fov râ€²i as nğ‘ˆ y( pğµ a( iğ‘˜ râ€² o)) f,
vectorsv,vâ€² âˆ¼ğœ‹(ğ‘˜,ğ‘˜â€²),itholds
(cid:34) ğ‘š (cid:35) ğ‘š ğ‘š
vâˆ¼ğ‘ˆ(E ğµ(ğ‘˜))[ğ‘“(v)] = vâˆ¼ğ¼(E
ğ‘˜/ğ‘š)
ğ‘“(v) |âˆ‘ï¸ ğ‘–=1vğ‘– =ğ‘˜ . Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¤ Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘–â€²âˆ’ğœ‡Â¯).
6Aconsequenceofthisfactis ProofofTheorem4. Definethefunctionğ‘”:{0,1}ğ‘š â†’Ras
E (cid:2)ğ‘”(vâ€²)(cid:3) ğ‘š
1 âˆ‘ï¸
vâ€²âˆ¼ğ‘ˆ(ğµ(ğ‘˜+ğ‘—)) ğ‘”(v)= sup
ğ‘š
ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯).
= vâ€²âˆ¼ğ‘ˆ(P ğµr (ğ‘˜+ğ‘—))(cid:32) Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–ğ‘š =1ğ‘“ P(ğ‘  ğ‘–)(vğ‘–â€²âˆ’ğœ‡Â¯) â‰¥ğ‘§(cid:33)
W she owfir ts ht an to ,cte hoth oa st in,f gro
thmP etâˆˆ
ch
oL
e
nâ˜…
sre tas
nuğ‘– tl= st1
o ğ‘¡f aT ndhe ğ‘§o ar sem3,itissufficientto
(cid:32) ğ‘š (cid:33)
= v,vâ€²âˆ¼P ğœ‹r
(ğ‘˜,ğ‘˜â€²)
Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘–â€²âˆ’ğœ‡Â¯) â‰¥ğ‘§
ğ‘¡
=âˆšï¸„
2ğœ”log( ğ›¿2)
, ğ‘§= E [ğ‘”(v)]+ğ‘¡, (3)
(cid:32)
1
âˆ‘ï¸ğ‘š (cid:33) ğ‘š vâˆ¼ğ¼(ğœ‡Â¯)
â‰¥ v,vâ€²âˆ¼P ğœ‹r
(ğ‘˜,ğ‘˜â€²)
Ps âˆˆu Lp
â˜…ğ‘š
ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¥ğ‘§
itholds
(cid:32) 1 âˆ‘ï¸ğ‘š (cid:33) Pr (ğ‘”(v) â‰¥ğ‘§) â‰¤ğ›¿/2.
= vâˆ¼ğ‘ˆP (ğµr
(ğ‘˜))
Ps âˆˆu Lp
â˜…ğ‘š
ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) â‰¥ğ‘§ vâˆ¼ğ¼(ğœ‡Â¯)
ğ‘—
= E [ğ‘”(v)].
Todoso,wemakeuseofTheorem5.DefinevÂ¯ acopyofv,where
vâˆ¼ğ‘ˆ(ğµ(ğ‘˜)) itsğ‘—-thelementvğ‘— isreplacedbyanindependentcopyvâ€² ğ‘—.Wewant
Therefore,ğ‘”isnonnegativeandE
vâˆ¼ğ‘ˆ(ğµ(ğ‘˜))
[ğ‘”(v)]isnondecreas- toupperbound
i mn eg ni tn .ğ‘˜.WeapplyLemma1tothefunctionğ‘”,obtainingthestat â–¡e- âˆ‘ï¸ğ‘š E(cid:20)(cid:16) ğ‘”(v)âˆ’ğ‘”(vÂ¯ğ‘— )(cid:17)2 |v(cid:21)
+
ğ‘—=1
WenotethatTheorem3ispreciselywhatweseek:itimpliesthat
largesupremumdeviationsthatareunlikelyintheindependent belowsomeconstantğ‘ â‰¥0.DefinePâ˜… asoneoftheelementsof
resamplesdistributionvâˆ¼ğ¼(ğœ‡Â¯)arealsounlikelyintheconditional Lâ˜… thatachievethesupremuminğ‘”(v).Weobservethat
distributionvâˆ¼ğ‘ˆ(ğµ(ğ‘˜)).ByusingTheorem3,weprovethefol- (cid:16) ğ‘”(v)âˆ’ğ‘”(vÂ¯ğ‘— )(cid:17)
lowingresult,thatimpliesstrongconcentrationofthesupremum +
deviationofpatternqualitiesw.r.t.theirexpectations,takenw.r.t. (cid:18) ğ‘š ğ‘š (cid:19)
independentresamplesofthetargetlabelsratherthanpermuta- â‰¤ ğ‘š1 âˆ‘ï¸ ğ‘“ Pâ˜…(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯)âˆ’ ğ‘š1 âˆ‘ï¸ ğ‘“ Pâ˜…(ğ‘  ğ‘–)(vÂ¯ ğ‘–ğ‘— âˆ’ğœ‡Â¯)
tions. ğ‘–=1 ğ‘–=1 +
(cid:18) (cid:19)
1 1
Theorem4. Defineğœ‡Â¯=ğœ‡(D),and = ğ‘šğ‘“ Pâ˜…(ğ‘  ğ‘—)(vğ‘— âˆ’ğœ‡Â¯)âˆ’ ğ‘šğ‘“ Pâ˜…(ğ‘  ğ‘—)(vâ€² ğ‘— âˆ’ğœ‡Â¯)
ğ‘š +
ğœ” =(1âˆ’ğœ‡Â¯)min(cid:110) ğœ‡Â¯, Psu âˆˆp Lğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(cid:111) . = (cid:18) ğ‘š1 ğ‘“ Pâ˜…(ğ‘  ğ‘—)(vğ‘— âˆ’vâ€² ğ‘—)(cid:19) +. (4)
Withprobabilityatleast1âˆ’ğ›¿overvâˆ¼ğ‘ˆ(ğµ(ğ‘˜)),itholds Wenowobservethatvâ€² ğ‘— =0istheonlypossiblevalueofvâ€² ğ‘— that
1
âˆ‘ï¸ğ‘š makes(4)be>0.Therefore,wehave
Ps âˆˆu Lp
â˜…ğ‘š
ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯)
âˆ‘ï¸ğ‘š E(cid:20)(cid:16) ğ‘”(v)âˆ’ğ‘”(vÂ¯ğ‘— )(cid:17)2 |v(cid:21)
(cid:34) ğ‘š (cid:35) (cid:118)(cid:116) 2ğœ”log(cid:16) 2(cid:17) ğ‘—=1 +
1 âˆ‘ï¸ ğ›¿
â‰¤ vâˆ¼ğ¼E (ğœ‡Â¯) Ps âˆˆu Lp â˜…ğ‘š ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) + ğ‘š . â‰¤âˆ‘ï¸ğ‘š E(cid:34)(cid:18) ğ‘š1 ğ‘“ Pâ˜…(ğ‘  ğ‘—)(vğ‘— âˆ’vâ€² ğ‘—)(cid:19)2 |v(cid:35)
To prove Theorem 4, we need the following technical result
ğ‘—=1 +
regardingtheconcentrationoffunctionsofindependentrandom âˆ‘ï¸ğ‘š (cid:18) 1 (cid:19)2
variables.
=(1âˆ’ğœ‡Â¯) ğ‘šğ‘“ Pâ˜…(ğ‘  ğ‘—)vğ‘—
ğ‘—=1
a ran
ndT dh olee mto ğ‘‹r ve am
r=
ia5 b(( lğ‘‹T esh
1
.,e
.
Do
.
er
.
fi,e
ğ‘‹
nm
ğ‘š
e6 ğ‘‹). Â¯7 ğ‘—âˆˆo =f Y[ (8 ğ‘‹ğ‘š]) 1.
,a
.L .e
c
.t
o
,lğ‘”
ğ‘‹le
ğ‘—:
c
âˆ’Y
ti 1o
,ğ‘š
n
ğ‘‹â†’
ğ‘—â€²o ,f
ğ‘‹ğ‘šR ğ‘—+b
1i
,e
n
.da
.e
.f
p
,u ğ‘‹en
n
ğ‘šc dti )eo nn âˆˆt,
=
(1 ğ‘šâˆ’ğœ‡Â¯) âˆ‘ï¸ ğ‘—ğ‘š =1(cid:18) ğ‘š1
ğ‘“ Pâ˜…(ğ‘ 
ğ‘—)vğ‘—(cid:19)
Yğ‘š as a copy ofğ‘‹, where its ğ‘—-th elementğ‘‹ ğ‘— is replaced by an (1âˆ’ğœ‡Â¯) âˆ‘ï¸ğ‘š (cid:18) 1 (cid:19) ğœ”
independentcopyğ‘‹ ğ‘—â€².Assumethat,forsomeconstantğ‘ â‰¥0, â‰¤
ğ‘š
sup ğ‘šğ‘“ P(ğ‘  ğ‘—)vğ‘— â‰¤ ğ‘š.
PâˆˆLâ˜…ğ‘—=1
âˆ‘ï¸ğ‘š E(cid:20)(cid:16) ğ‘”(ğ‘‹)âˆ’ğ‘”(ğ‘‹Â¯ğ‘— )(cid:17)2 |ğ‘‹(cid:21) â‰¤ğ‘ WeapplyTheorem5tothefunctionğ‘”withğ‘ = ğœ”/ğ‘š,obtaining
+
ğ‘—=1 that
holdsalmostsurely.Then,itholds,forallğ‘¡ â‰¥0,
Pr
(cid:16)
ğ‘”(v) â‰¥ E
[ğ‘”(v)]+ğ‘¡(cid:17)
â‰¤exp(âˆ’ğ‘šğ‘¡2/(2ğœ”)).
Pr(cid:16)
ğ‘”(ğ‘‹)
â‰¥E[ğ‘”(ğ‘‹)]+ğ‘¡(cid:17)
â‰¤exp(âˆ’ğ‘¡2/(2ğ‘)).
vâˆ¼ğ¼(ğœ‡Â¯) vâˆ¼ğ¼(ğœ‡Â¯)
ğ‘‹ Settingğ‘¡ asin(3),itisimmediatetoobservethattheprobability
WeusetheseresultstoproveTheorem4. aboveisâ‰¤ğ›¿/2,obtainingthestatement. â–¡
7NotethatTheorem4providesaprobabilisticupperbound,hold- Theorem8. Fixğ›¿ âˆˆ (0,1)andğ‘,ğ‘§ â‰¥1.Letğ‘‚betheoutputofFSR
ingwithprobabilityatleast1âˆ’ğ›¿,tothemaximumobservedvalue withinputparametersL,D,ğ‘,andğ›¿,whereListhelanguageof
ofthepatternqualitysup PâˆˆLâ˜… ğ‘š1 (cid:205)ğ‘š ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) whenthe subgroupscomposedbyconjunctionswithatmostğ‘§conditionsoverğ‘‘
conditionaldistributionvâˆ¼ğ‘ˆ(ğµ(ğ‘˜))isconsidered,intermsofthe continuousfeatures.Then,withprobabilityatleast1âˆ’ğ›¿,ğ‘‚contains
expectationofthemaximumobservedvalueofthepatternquality allpatternswithqualityqP satisfying
accordingtotheresampleddistributionv âˆ¼ ğ¼(ğœ‡Â¯).Then,thefol- âˆšï¸„ âˆšï¸„
l do ew vii an tg ior nes iu nlt thp ero uv pe ps et rh ba ot ut nh dee as bt oim vea it sio vn erğ‘‘Ëœ y(R acâ˜… c, uğœ‡Ë‡ r) ato ef .theexpected
qP â‰¥
2ğœ”Ë†ğ‘§ln ğ‘š(ğ‘’3 4ğ‘‘ ğ‘§ğ‘š 32)
+
ln 2ğ‘(cid:0) ğ‘šğ›¿2(cid:1) +ğ‘§ln(cid:0) 3ğ‘’ ğ‘š3 4ğ‘‘ ğ‘§ğ‘š 32(cid:1)
Theorem6. Withprobabilityatleast1âˆ’ğ›¿/4overRâ˜…,itholds âˆšï¸„ 2ğœ”log(cid:0)4(cid:1) âˆšï¸„ log(cid:0)4(cid:1) âˆšï¸„ 2fË†(D)ğ‘§ln(ğ‘’3ğ‘‘ğ‘š2)
+ ğ›¿ + ğ›¿ + 2ğ‘§3ğ›¿ ,
vâˆ¼ğ¼E
(ğœ‡Â¯)(cid:34)
Ps âˆˆu Lp
â˜…ğ‘š1 âˆ‘ï¸
ğ‘–ğ‘š
=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘–
âˆ’ğœ‡Â¯)(cid:35) â‰¤ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)+âˆšï¸„
lo 2g
ğ‘(cid:0) ğ‘šğ›¿4(cid:1)
. wherefË†(D)=sup
Pğ‘š âˆˆLfP(D)a2 nğ‘ dğ‘š
ğœ”Ë†
=ğœ‡Ë†(1âˆ’ğœ‡Ë‡)fË†(Dğ‘š
).
4.2 FSRforUnconditionalTesting
Bycombiningtheresultsabove,weprovetheguaranteespro-
videdbyFSRforthetaskoffindingsignificantpatternswhencondi- We now describe the details of procedures boundTarget and
tionaltestingisused.Inparticular,thefollowingCorollaryproves boundStatisticfortheversionof FSRthatusesunconditional
that,whenboundStatisticreturnsthevalueğœ€definedbelow,then
testing,whichwerefertoasFSR-U.Asareminder,inourscenario
theoutputsetğ‘‚ofsignificantpatternsreturnedbyFSRhasFWER
anunconditionaltestassumesthattheaveragetargetvalueand
boundedbytheuser-definedparameterğ›¿.
patternsfrequenciesfP(D)areobservationsofrandomvariables,
Corollary7. Fixğ›¿ âˆˆ (0,1)andğ‘ â‰¥1.Letğ‘‚betheoutputofFSR whoseexpectedvaluesareunknown.Inparticular,hereweconsider
withinputparametersL,D,ğ‘,ğ›¿,andlet thetransactions{(ğ‘  1,â„“ 1),...,(ğ‘  ğ‘š,â„“ ğ‘š)}constitutingthedatasetD
asi.i.d.samplesfromanunknowndistributionğ›¾.Thisscenariois
âˆšï¸„ âˆšï¸„
2ğœ”log(cid:0)4(cid:1) log(cid:0)4(cid:1) morecomplexthantheconditionaltestingone,sinceweneedto
ğœ€ =ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)+
ğ‘š
ğ›¿ + 2ğ‘ğ‘šğ›¿
accountfortheunknowndeviationofallobservedvalueswhen
computingaboundtothemaximumpatternqualityunderthenull
bethevaluereturnedbyboundStatisticinline7.Then,thesetğ‘‚
hypothesis.However,weshowthattheuseofresampleddatasets
hasFWERâ‰¤ğ›¿undertheconditionalnulldistribution.
allowustoefficientlytakeintoaccountsuchdeviations.
Notethatthevalueofğœ€returnedbyboundStatisticrequires ForboundTarget,recallthatğœ‡isthetheprobabilitythatasample
tocomputesup
PâˆˆL(cid:8) qÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)(cid:9)
,whichiscostly,butonlyneeds
fromtheunknowndistributionğ›¾ hastargetlabelâ„“equalto1,such
tobeperformedonğ‘resampleddatasets.Aswewillshowinour thatğœ‡=E D[ğœ‡(D)] =Pr(ğ‘ ,â„“)âˆ¼ğ›¾ (â„“ =1).Moreimportantly,inthis
experimentalevaluation(seeSection5),smallvaluesofğ‘ suffice. settingğœ‡isunknown(asğ›¾ is).However,giventhatthesamplesin
Moreover,themaximumfrequencyofapatterninthelanguage
Darei.i.d.,thefollowingresultprovidesaprobabilisticboundğœ€
ğ‘‡
Lisrequiredinordertocomputeğœ” (seeTheorem4).Suchmax- tothedeviationoftheobservedvalueğœ‡(D)fromitsexpectationğœ‡.
imumfrequencycanbecomputedveryefficientlyinmostdata Lemma9. LetDbeacollectionofğ‘šsamplestakeni.i.d.fromğ›¾.
miningtasks.Forexample:initemsetminingitcorrespondstothe Forğ›¿ âˆˆ (0,1),itholdswithprobabilityâ‰¥1âˆ’ğ›¿/4
frequencyofthemostfrequentitem;insubgroupmining,itisequal
to1wheneveracontinuousfeatureispresentandtheconditions (cid:118)(cid:116) 2min(cid:8)ğœ‡(D),1(cid:9) ln(cid:16) 8(cid:17) 2ln(cid:16) 8(cid:17)
defi Pn owin eg rt ah ne ap lya st it se .r Tn hl ean reg su ua lg tse aL boi vn ecl su hd oe win theq atua Fl Si Rtie rs i.
gorouslycon-
|ğœ‡(D)âˆ’ğœ‡| â‰¤ğœ€ ğ‘‡ (cid:17) ğ‘š 4 ğ›¿ + ğ‘šğ›¿ .
trolstheprobabilityoffalsepositives(i.e.,patternsforwhichthe boundTargetreturnsthevalueğœ€ ğ‘‡ asdefinedinLemma9,which
nullhypothesisholdbutarewronglyreportedinoutputassig- requiresthevaluesğœ‡(D),ğ›¿,andğ‘š.
nificant).However,theydonotprovideguaranteesonthepower ForboundStatistic,thecomputationoftheupperboundğœ€to
of FSR, that is, its ability to report patterns P with sufficiently themaximumdeviationbetweentheobservedpatternqualitiesand
highqualityqP.Thefollowingresultprovidesguaranteesonthe theirexpectationsismoreinvolvedthanintheconditionalcase.We
powerofFSR-C,theversionofFSRthatusesconditionaltesting, showthatthequalityqP ofapatternP,whichdependsonseveral
forthepatternlanguageofsubgroups.Ouranalysisisbasedona unknownquantities(seeSection3.1),canbesharplyestimatedfrom
probabilisticupperboundtoğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡),obtainedfromboundstothe adatasetDprovidedthatğœ‡isknown,whichisnotthecaseforthe
pseudodimension[24,35,38]ofsubgroups,andanadvancedcon- unconditionaldistribution.Wethenshowthatusingğœ‡(D)inplace
centrationboundforsumsofdependentrandomvariables[13],that ofğœ‡providesagoodestimateofqP,andproveaprobabilisticupper
holdundermild(butnecessary)assumptionsonthedistribution boundonthedifferencebetweenthetwoestimates.
ofalternativehypotheses(thesetofpatternswithqP >0).More First,weintroducethefunctionfamilythatweusetoanalyze
precisely,weassumethatthetargetlabelsofthetransactionsthat thesupremumdeviationoftheempiricalqualityofpatternsfrom
supportapatternP withqP > 0aredistributedaccordingtoa thedatasetD.Wedefinethefamilyoffunctionsğ‘”âˆ—
P
:XÃ—{0,1}â†’
noncentralhypergeometricdistribution[42],i.e.,abiasedversionof [âˆ’ğœ‡,1âˆ’ğœ‡],whereğ‘”âˆ—
P
isdefinedasğ‘”âˆ— P(ğ‘ ,â„“) = ğ‘“ P(ğ‘ )(â„“âˆ’ğœ‡).Note
thestandardhypergeometricdistribution.Weprovidetheproofs thatğ‘”âˆ— P(ğ‘ ,â„“) = ğ‘“ P(ğ‘ )(â„“âˆ’ğœ‡)correspondstothefunctionğ‘” P(ğ‘ ,â„“)
andadditionaldetailsinAppendixA.5. usedbytheFSRstatisticwheretheunknownvalueğœ‡ isusedin
8placeofitsestimate ğœ‡(D) obtainedfromdataset D.Definethe Withprobabilityatleast1âˆ’ğ›¿overthechoiceofDandRâ˜…itholds
estimatorqP(D)ofthequalityqP ofPfromDastheaverageof sup PâˆˆLâ˜…{qP(D)}â‰¤ğœ€.
ğ‘”âˆ— overD,thatis
P Weusethefollowingsimpleupperboundforbothğœˆ ğ‘‡ andğœˆ:ğœˆ ğ‘‡ =
qP(D)= ğ‘š1 âˆ‘ï¸ğ‘š ğ‘”âˆ— P(ğ‘  ğ‘–,â„“ ğ‘–). ğœˆ refi= ns eu dp b|ğ‘¥ oâˆ’ uğœ‡ n( dD s) a| râ‰¤ eğœ€ğ‘‡ poğ‘¥ s( s1 ibâˆ’ le,ğ‘¥ w), ea on md in to thte emtha tot iw mh pi rle ovs elig reh at dly abm ilo itr ye
.
ğ‘–=1
NotethatTheorem11doesnotrequiretheknowledgeofthe
NotethatE D[qP(D)] = qP,asqP(D) isanunbiasedestima- unknown parameter ğœ‡, but only of an upper bound ğœ‡Ë† and of a
torofqP.However,qP(D) dependsontheunknownquantity lowerboundğœ‡Ë‡.Theorem11allowstoimplementtheprocedure
ğœ‡. Even if qP(D) â‰  qÂ¯P(D) (since ğœ‡(D) may be â‰  ğœ‡), FSR-U boundStatisticfortheunconditionalsetting:boundStatistic
exploitsthefactthatğœ‡(D) issharplyconcentratedaroundğœ‡,as computesğœ€asinEq.(5).Analogouslytotheconditionalcase,evalu-
proved in Lemma 9. This implies that the maximum deviation atingğœ€requirestocomputesup PâˆˆL(cid:8) qÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)(cid:9) ,whichiscostly,
sup PâˆˆL|qP(D)âˆ’qÂ¯P(D)|forallpatternsP âˆˆLcanbesharply butonlyneedstobeperformedonğ‘resampleddatasets,andğ‘isin
estimatedfromD.Tothisaim,weprovethefollowingresult. practicesmall(asweshowinSection5).
Theorem10. LetDbeacollectionofğ‘šsamplestakeni.i.d.from Bycombiningtheresultsinthissection,weprovetheguarantees
ğ›¾.Forğ›¿ âˆˆ (0,1),withprobabilityâ‰¥1âˆ’ğ›¿/4itholds providedbyFSRforthetaskoffindingsignificantpatternswhen
unconditionaltestingisused.Inparticular,thefollowingCorollary
|qP(D)âˆ’qÂ¯P(D)| â‰¤ğœ€ ğ‘‡fP(D),âˆ€P âˆˆL. provesthat,whenboundStatisticreturnsthevalueğœ€definedin
Eq. 5, then the output setğ‘‚ of significant patterns returned by
Proof. UsingLemma9,âˆ€P âˆˆLitholdswithprob.â‰¥1âˆ’ğ›¿/4 FSR-UhasFWERboundedbytheuser-definedparameterğ›¿.
(cid:12) ğ‘š ğ‘š (cid:12)
|qP(D)âˆ’qÂ¯P(D)|=(cid:12) (cid:12)
(cid:12)
(cid:12)ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘”âˆ— P(ğ‘  ğ‘–,â„“ ğ‘–)âˆ’ ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘” P(ğ‘  ğ‘–,â„“ ğ‘–)(cid:12) (cid:12)
(cid:12)
(cid:12)
FSRC wor ito hl il na pr uy t1 p2 a. raF mix eğ›¿ terâˆˆ sL(0 ,,1 D) ,a ğ‘n ,d ğ›¿ğ‘ ,aâ‰¥ nd1. leL te ğœ€t ağ‘‚ sb ine Eth qe .o (5u )t .p Tu ht eo nf
,
(cid:12) ğ‘š (cid:12) thesetğ‘‚hasFWERâ‰¤ğ›¿undertheunconditionalnulldistribution.
(cid:12)1 âˆ‘ï¸ (cid:12)
=(cid:12)
(cid:12)ğ‘š
ğ‘“ P(ğ‘  ğ‘–)(ğœ‡(D)âˆ’ğœ‡)(cid:12) (cid:12)â‰¤ğœ€ ğ‘‡fP(D). â–¡
Poweranalysis.Thefollowingresultprovidesguaranteesonthe
(cid:12) ğ‘–=1 (cid:12) powerofFSR-U,theversionofFSRthatusesunconditionaltesting,
WeremarkthatthedefinitionofqP(D)iscrucialtotheanalysis
buildingontheprobabilisticupperboundtoğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)
provedin
ofouralgorithmFSR-U,asqP(D)isanaverageofğ‘šindependent AppendixA.5,andonconcentrationboundsbasedonthepseudodi-
randomvariables,whileqÂ¯P(D)isnot(sinceitdependsonğœ‡(D), mensionofthelanguageofsubgroups.
thatisestimatedfromtheobservationsinthewholedataset).
RecallthedefinitionofthesetLâ˜…
ofnon-significantpatterns:
Theorem13. Fixğ›¿ âˆˆ (0,1)andğ‘,ğ‘§ â‰¥ 1.Letğ‘‚ betheoutputof
Lâ˜… ={P âˆˆL:qP =0}.Tooutputsignificantpatternswhilecon- F ofSR suw bgit rh ouin pspu cot mpa pr oa sem de bte yrs coL nj, uD nc, tğ‘ io, na sn wd iğ›¿ th,w ath mer oe sL tğ‘§i cs ot nh de itl ia on ng su oa vg ee
r
trollingtheFWERbelowğ›¿,ourgoalistoboundthesupremumdevi-
ationsup PâˆˆLâ˜…{qÂ¯P(D)}(Eq.(2))belowsomevalueğœ‚withproba-
ğ‘‘ ğœ€bc eon dt ei finu no edus af se ia ntu Tr he es. orD ee mfin 1e 1,ğœ”Ë† w= heğœ‡ rË† e(1 ğ‘ŸË†âˆ’ isğœ‡Ë‡ re) ps lu ap
ceP dâˆˆ bL
yfP(D),andlet
bilityatleast1âˆ’ğ›¿,forsomeğ›¿ âˆˆ (0,1),andprovideinoutputallpat-
ternswithqÂ¯P(D) â‰¥ğœ‚.Tobound(2),westudythesurrogatequan- âˆšï¸„ 2ğœ”Ë†ğ‘§ln(ğ‘’3ğ‘š2ğ‘‘ ) âˆšï¸„ ln(3) ğ‘§ln(ğ‘’3ğ‘š2ğ‘‘ ) âˆšï¸„ ln(cid:0)4(cid:1)
t o oi n fty ğ‘|qs â‰¥u Pp 1(P D i.iâˆˆ .) dL âˆ’ .â˜… rqÂ¯ e{ P sq a( mP D( p)D l| e. d) C} do, ana tss ai sT d eeh tr se to ch or ee mm c po ul1 l te0 ec dg tiu boa ynr Fa R Sn â˜… Rte = (e ls in(cid:8)a eDs 41â˜…m ).,a W.l .l e.b , po D ru oğ‘â˜…n vd (cid:9)
e
Theğ‘Ÿ nË† ,=
definefP
ğ‘š
=
E4ğ‘§ D3 [fP+ (D)]2 .ğ‘ Wğ‘šğ›¿ ith+ proba3 bğ‘š4 ilğ‘§ i3 tyat+ least2ğ‘ 1ğ‘šğ›¿ âˆ’ğ›¿.
,ğ‘‚
thefollowingresult.
containsallpatternsPwithqualityqP satisfying
âˆšï¸„ âˆšï¸„
a
dT ish tre io br ue tim on11 ğ›¾.
,
aL net dD Râ˜…be aa cd oa llt ea cs te iot nof oğ‘š fğ‘sa â‰¥mp 1le is .it .da .ke ren sai. mi.d p. lf er som
of qP â‰¥ğœ€+2ğœ€
ğ‘‡(cid:32)
fP+
ğ‘§ln(cid:0)2ğ‘’ ğ‘§ğ‘‘ 2ğ‘š(cid:1)+ln(cid:0) ğ›¿3(cid:1)(cid:33)
+
ğ‘§ln(cid:0)2ğ‘’ ğ‘§ğ‘‘ 2ğ‘š(cid:1)+ln(cid:0) ğ›¿3(cid:1)
.
thetargetlabelsof D.Foranyğ›¿ âˆˆ (0,1),defineğœˆ ğ‘‡ â‰¥ ğœ‡(1âˆ’ğœ‡),
ğœˆ â‰¥ğœˆ ğ‘‡ sup PâˆˆLâ˜…{E D[fP(D)]},andğœ€as 5 EXPERIMENTS
ğ‘
ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)= ğ‘1âˆ‘ï¸ sup(cid:8) qÂ¯P(Dâ˜… ğ‘—,ğœ‡Ë‡)(cid:9) T ouh ris es xe pc et rio imn ep nr te as le en vts alt uh ae tir oe nsu islts too af so su er sse Fx Sp Rer â€™sim cae pn ats b. iT lith iee sg oo fa dl io sf
-
ğ‘—=1PâˆˆL
coveringsignificantpatternswithhighstatisticalpower,analyzing
âˆšï¸„
ln(cid:0)4(cid:1) efficientlylargereal-worlddatasetswithfew-shotresampling,in
ğ‘ŸË†=ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)+ ğ›¿
bothconditional(FSR-C)andunconditional(FSR-U)settings.
2ğ‘ğ‘š
PatternLanguage.Inourexperimentalevaluationwefocusonthe
ğ‘‘Ë†=ğ‘ŸË†+(cid:118)(cid:117)(cid:116)(cid:32)
2ğœˆ
ğ‘‡
ln(cid:0) ğ›¿4(cid:1)(cid:33)2
+
2ğ‘ŸË†ln(cid:0) ğ›¿4(cid:1)
+
2ğœˆ
ğ‘‡
ln(cid:0) ğ›¿4(cid:1) p daro tab sl ee tm swof itd his mco ixv ee dri fn eg ats ui rg en ti yfi pc ea snt (bs ou tb hg cro au tep gs of rr io cm alala nr dge cor nea til n-w uoo url sd
).
ğ‘š ğ‘š ğ‘š
ThelanguageLiscomposedofconjunctionsofuptoğ‘§conditions
ğœ€
(cid:17)ğ‘‘Ë†+(cid:118)(cid:116) 2ln(cid:0) ğ›¿4(cid:1)(cid:16) ğœˆ+2ğ‘‘Ë†(cid:17)
+
ln(cid:0) ğ›¿4(cid:1)
. (5)
o lon wt )h .e Thfe ea st eu cr oes ndo if tit oh ne sd aa rt ea e[ i4 th], ew reh qe ure alğ‘§ itii es sa (ffi ox re cd atp ea gr oa rm ice at le fr e( as te ue reb se )-
,
ğ‘š 3ğ‘š inequalities,orintervals(oncontinuousfeatures).
9Datasets.WetestedFSRon12standardbenchmarksandreal- Table1:Statisticsofthedatasetsconsideredinourexper-
iments.ğ‘š is the number of transactions,ğ‘‘ is the number
worlddatasetstoevaluatesubgroupdiscoveryalgorithmsfrom
UCI2.ThestatisticsofthedatasetsaredescribedinTable1.These offeatures(categorical/continuous),ğœ‡(D)isthefractionof
datasetscoverawiderangeofsizes,dimensionalities,andappli-
transactionswithtargetequalto1,ğ‘§isthemaximumnumber
cationdomains.Thecolumnğ‘§ ofTable1reportsthemaximum ofconjunctiontermsinthelanguageL.
numberofconjunctiontermsforthesubgroupsinthelanguageL
foreachdataset. D ğ‘š ğ‘‘ ğœ‡(D) ğ‘§
ImplementationofFSR.WeimplementedFSRinPython.Thecode
andthescriptstoreproduceallexperimentsareavailableonline3. abalone 4177 1/7 0.663 5
Tominesubgroups,wemakeuseofafastdepth-firstenumeration adult 32561 8/6 0.241 5
algorithmincludedinthelibrarypysubgroup4[23]. bank 41188 10/10 0.113 3
Baselines.SinceouralgorithmFSRisthefirstalgorithmthatcan brain-cancer 862 22/1 0.421 5
beusedforminingsignificantpatternswithbothconditionaland cancer-rna-seq 801 0/20531 0.375 2
unconditionaltesting,weconsiderdifferentbaselinesforcondi- covtype 581012 0/54 0.365 3
tionaltestingandforunconditionaltesting. gisette 7000 0/5000 0.500 2
Forconditionaltesting,wecompareFSR-Cwithavariantof HIGGS 11000000 0/28 0.529 3
TopKWY[33],thestate-of-the-artmethodforsignificantpattern kdd-cup 95370 73/405 0.050 2
miningwithconditionaltesting,basedontheWYpermutation mushroom 8124 22/0 0.482 5
testingprocedure[46].TheoriginalimplementationofTopKWY SUSY 5000000 0/18 0.457 3
isonlytailoredtoidentifysignificantitemsetsandsubgraphs,and theorem-prover 3059 0/51 0.420 3
doesnotsupportsubgroupsfromcategoricalandcontinuousfea-
tures;however,wenotethatitisfairlysimpletoadaptitsstrategy
tosuchcase.Inparticular,weextendedTopKWYtoidentifysig- upperboundthesupremumdeviationintermsofitsexpectation
nificantsubgroupsbyestimatingthedistributionofthesupremum (takenw.r.t.theresamplesbutconditionallyonthetransactions,
deviationusingpermuteddatasets(insteadoftheğ‘-valuesasdone seeTheorem11andAppendixA.6),butinsteadofestimatingthe
intheoriginalTopKWYimplementation[33]).Thatis,ourvariant expectedsupremumdeviationwithğ‘resamples(asdonebyFSR-U),
ofTopKWYconsidersthesamestatisticof FSR-C(i.e.,thesupre- wecomputeanupperboundtoitviaanunionboundoverthe
mumdeviation),butinsteadofgeneratingresamplesandtaking (finite)numberofdistinctsubgroupsthatareobservedinthedatain
theaverageofsupremumdeviationsasdonebyFSR-C,itefficiently atleastonetransaction,i.e.,weconsiderthefiniteprojectionofLon
computesitsğ›¿-quantilesconsideringpermutationsofthelabels.In D,insteadofall |L|possiblesubgroups.Notethatsuchapproach
addition,inourvariantofTopKWYweusepysubgrouptomine boundstheFWERwhilebeingmuchlessconservativethanBonfer-
subgroups.NotethatsinceourvariantofTopKWYandFSR-Cshare roni,sinceitcorrectsforthesizeoftheprojectioninsteadofthe
thesame,equallyoptimized,proceduretoexplorethesearchspace sizeofL.BycomparingFSR-UtoFSR-U-UBwedirectlyevaluate
ofthelanguageL,allcomparisonsintermsofrunningtimesare theadvantageofcomputingboundsfromresampleddatasetsthat
fair.ForTopKWYweuse103 permutations,agoodtrade-offin considerdependenciesamongpatterns,asdonebyFSR-U.
termsofrunningtimeandaccuracyforestimatingtheğ›¿-quantile Experimentalsetup.Alltheexperimentswererunonamachine
fortypicalvaluesofğ›¿(e.g.,0.05)[25]. with2.30GHzIntelXeonCPU,512GBofRAM,onUbuntu20.04.
Regardingunconditionaltesting,wenotethatFSR-Uisthefirst Inallexperimentsweuseğ›¿ =0.05(i.e.,wecontroltheFWERbelow
methodtodiscoversignificantpatternsina(fully)unconditional 0.05).Werepeatedallexperiments10times,andreportaveragesÂ±
setting.Therefore,abaselinethatmayseemreasonabletocontrol stdsoverthe10repetitions.
theFWERisthestandardBonferronicorrection:eachpatternPis ImpactofparametersonFSR.Inthefirstsetofexperimentswe
flaggedassignificantiftheprobability(underthenullhypothesis) evaluatetheeffectofthenumberofresamplesğ‘onthedeviation
ofobservingaqualitygreaterorequalthantheonemeasuredin boundğœ€computedbyFSRanditsrunningtime.Weconsiderboth
thedataisatmostğ›¿/|L|,where |L| isthesizeofthelanguage FSR-CandFSR-U,respectivelydesignedtocomputesignificant
L(seealsoSection1).Note,however,thatthissimplemethodis patternswithconditionalandunconditionaltesting.Toeasethe
notusefulforsubgroupsas|L|isinfinite(e.g.,asthenumberof presentation,forthisfirstexperimentwefocuson3ofthedatasets
inequalitiesoveracontinuousfeatureisunbounded)5.Therefore, weconsidered;theresultsfortheotherdatasetsareverysimilar.
wecompareFSR-Uwithanovelnon-trivialbaseline,thatwecall InFigure1-(a)weshowthedeviationboundscomputedbyFSR-C
FSR-U-UB,thatresolvesthisissue.WedescribeFSR-U-UBathigh fordifferentvaluesofğ‘,whileFigure1-(b)isanalogousforFSR-U.
levelanddeferadditionaldetailstoAppendixA.6.ForFSR-U-UB, Fromtheseplotsweclearlyconcludethatusingğ‘ =10resamples
weusepartoftheconcentrationboundsdevelopedforFSR-Uto issufficienttoobtainasmalldeviationbound,andthatusingmore
than 10 resamples is marginally beneficial as all curves flatten.
2https://archive.ics.uci.edu/ Remarkably,foralldatasets(andinparticularforthelargerdataset
3https://github.com/VandinLab/FSR adult),andforbothmethods,evenusingoneresampleisenoughto
4https://github.com/flemmerich/pysubgroup computeameaningfuldeviationbound.Thisisinstrikingcontrast
5Weremarkthat,whilethereexistothercorrectionproceduresmorepowerfulthan
withstate-of-the-artmethodsbasedonpermutationtesting,that
Bonferroni(e.g.,theHolmprocedure),theyallrequiretofixafinitesetofhypothesis,
thereforedonotapplytooursetting. insteadrequireanumberof103-104 permutationsofthetarget
10Deviation bounds for FSR-C Deviation bounds for FSR-U Running times for FSR-C Running times for FSR-U
0.10 m adu us lh troom 0.10 m adu us lh troom
104
m adu us lh troom
104
m adu us lh troom
abalone abalone abalone abalone
0.08 0.08 103 103
0.06 0.06 102 102
0.04 0.04 101 101
0.02 0.02 100 100
101 101
100 101 102 100 101 102 100 101 102 100 101 102
Number c of resamples Number c of resamples Number c of resamples Number c of resamples
(a) (b) (c) (d)
Figure1:Effectofthenumberofresamplesğ‘onthedeviationbounds(a)-(b)andrunningtimes(c)-(d)forFSRalgorithms.
1.0
FSR-C TopKWY
101
Deviation bounds 106 0.8 Running times 500N 0umber of top-k patterns in output (k=5000) 10N 00u 0mber of top-k patterns in output (k=10000)
105 4000 8000
104 0.6 3000 6000
102 103 2000 4000
102 0.4 1000 2000
103
101 0 0
0.2
0.0
0.0 0.2 0.4 0.6 0.8 1.0
(a) (b) (c) (d)
Figure2:ComparisonofFSR-CwithTopKWYintermsofdeviationbounds(a),runningtimes(b),andnumberofresults(c)-(d).
1.0
FSR-U FSR-U-UB
Deviation bounds 106 0.8 Running times 500N 0umber of top-k patterns in output (k=5000) 10N 00u 0mber of top-k patterns in output (k=10000)
101 104 4000 8000
0.6
3000 6000
102 102 2000 4000
100 0.4 1000 2000
103 102 0 0
0.2
0.0
0.0 0.2 0.4 0.6 0.8 1.0
(a) (b) (c) (d)
Figure3:ComparisonofFSR-UwiththebaselineFSR-U-UB(AppendixA.6)intermsofdeviationbounds(a),runningtimes(b),
andnumberofresults(c)-(d).
labelstoproperlyestimatetheğ›¿-quantile.Furthermore,weobserve intermsofrunningtime.WealsoobservethatFSR-Uisfasterthan
thatthedeviationboundscomputedbyFSR-C,intheconditional FSR-Cforallvaluesofğ‘.ThisisduetothefactthatFSR-C,by
setting,aresmallerthantheboundscomputedbyFSR-U,forthe computingasmallerdeviationbound,exploresawiderportionof
unconditionalscenario;thisconfirmsthefactthattheassumptions thepatternlanguageL.Inanycase,usingatmost10resamplesis
made on the process generating the data have a sensible effect alwaysfeasible(sincebothalgorithmsterminateafteratmost17
onthisaspect,aconsequenceofproperlytakingintoaccountthe minutesforthesedatasets).Fromtheseobservation,wefixğ‘to10
uncertaintyofthecollecteddata. forFSR-CandFSR-Uinallourexperiments.
Figures 1-(c)-(d) show the running time of the two methods EvaluationofFSR-C.Inthisexperimentwereporttheperfor-
FSR-CandFSR-Uasfunctionsofğ‘.Notsurprisingly,weclearly manceof FSR-Ctoidentifysignificantpatternswithconditional
observethattherunningtimeincreaseslinearlywiththenumberof testing,comparingitwithavariantofTopKWY,thestate-of-the-art
resamplesğ‘forbothmethods.Therefore,weexpectthatprocessing methodtoidentifysignificantpatternswithpermutationtesting.
asmallnumberofresampleddatasetsisextremelyadvantageous InFigure2weshowthedeviationbounds(a),therunningtimes
11
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
)s(
emit
gninnuR
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
tuptuo
ni
snrettap
k-pot
fo
rebmuN
tuptuo
ni
snrettap
k-pot
fo
rebmuN
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht
)s(
emit
gninnuR
tuptuo
ni
snrettap
k-pot
fo
rebmuN
tuptuo
ni
snrettap
k-pot
fo
rebmuN
enolaba
enolaba
tluda
tluda
knab
knab
recnac-niarb
recnac-niarb
qes-anr-recnac
qes-anr-recnac
epytvoc
epytvoc
ettesig
ettesig
SGGIH
SGGIH
puc-ddk
puc-ddk
moorhsum
moorhsum
YSUS
YSUS
revorp-meroeht
revorp-meroeht(b),andthenumberofreportedresults(c)-(d)forbothalgorithms. time(b),andnumberofresults(c)-(d).FromFigure3-(a)weclearly
FromFigure2-(a),weobservethatthedeviationboundscomputed observethatFSR-Ucomputesdeviationboundsthatarealways
byFSR-CarelargerthantheonescomputedbyTopKWY.Thisis smallerthanFSR-U-UB.Weconcludethatprocessingtheresamples
notsurprising,asthedeviationboundreturnedbyTopKWY,that ofthetargetlabelprovidesmuchmoreaccuratedeviationbounds
isbasedontheWYprocedure,isaveryaccurateestimateofthe w.r.t.morestandardtechniques(i.e.,aBonferronicorrection).This
optimal correctedthreshold to boundthe FWER (since the WY isaconsequenceoftakingintoaccountthedependenciesamong
estimatorconvergesasymptoticallytoit[28]);ontheotherhand, patternswhenupperboundingtheexpectedsupremumdeviation.
FSR-Ccomputesanupperbound tosuchquantitywithstronger Intermsofrunningtime,FSR-Ualwaysconcludeinreasonable
probabilisticguarantees(i.e.,thebounddoesnotonlyconverge time(similarlytoFSR-C),whileFSR-U-UBisfaster(sinceitdoes
asymptoticallyandinexpectation,butratherholdsinfinitesamples notconsideranyresamples).Ontheotherhand,inmanycases
withhighprobability).Whilethedeviationboundscomputedby thebaselineFSR-U-UBterminatesquicklybutwithoutreporting
TopKWYaresmallerthanFSR-C,fromFigure2-(b)weobservea anythingin output:Figures 3-(c)-(d) showthat for 5 datasetsit
significantgapintermsofrunningtimebetweenthetwomethods. doesnotreportsignificantpatterns,whilefortheotherdatasetsit
Infact,TopKWYrequirestwoordersofmagnitudemoretimethan outputsasignificantlysmalleramount(e.g.,foradult,FSR-Ufinds
FSR-Ctocomputeitsdeviationbound;thisismainlyduetothe almostanorderofmagnitudemoreresultsthanFSR-U-UB).This
factthatTopKWYhastoprocesstwoordersofmagnitudemore experimentshowsthatFSR-Uisapracticalandpowerfulmethod
permutationsofthetargetlabelthanFSR-C.Notethatusing104 todiscoversignificantpatternswithunconditionaltesting,andthat
permutations(insteadof103,tohaveamoreaccurateestimationof itsignificantlyimprovesovermorestandardtechniquessuchas
theğ›¿-quantile,asoftendoneinpractice)inTopKWYwouldresult Bonferronicorrection.
inanevenmoresubstantialgap. ApplicationtoNeuralNetworkinterpretation.Inthisfinalexper-
Wenowcomparethetwomethodsintermsofnumberofre- iment we evaluate a practical application of FSR to the task of
portedsignificantpatterns.Todoso,wefollowatypicalsubgroup NeuralNetworkinterpretation[14].Moreprecisely,weconsider
discoveryanalysis,basedonthetaskofidentifyingtheğ‘˜mostâ€œin- theMNISTdataset[22]andtrainaConvolutionalNeuralNetwork
terestingâ€subgroupsintermsofquality:first,weminethesetof (CNN),withthegoalofidentifyingcorrelationsbetweentheacti-
top-ğ‘˜subgroupswithhighestquality;then,wecountthenumber vationvaluesofneuronswiththepredictedtarget.Todoso,we
ofthemthatareflaggedassignificantbythetwomethods.Weuse evaluatetheassociationoftheactivationvaluesofneuronsina
ğ‘˜ âˆˆ {5Â·103,104}.Figures2-(c)-(d)showthenumberofpatterns convolutionalfilterwithabinarytarget,composedbydrawingsof
thatarereportedinoutputbybothmethods.Weobservethat,for digitscomposedbystraightlinesonly(1and7),versustheotherdig-
ğ‘˜ =5Â·103,for6ofthe12datasetsweconsidered,bothalgorithms its.WhilewedefermostdetailsofthisexperimenttoAppendixA.7,
outputallthetop-ğ‘˜ patterns,i.e.,theyhavethesameoutput;for weobservedthatFSRsuccessfullyidentifiesinterpretableactivation
suchdatasetsTopKWYreportsalltop-ğ‘˜patternsalsoforğ‘˜ =104, patternsofseveralneurons,whilerequiringordersofmagnitude
whileFSR-Coutputsthesamesetofresultsforallbuttwodatasets, lesstimethanpreviousmethods(asdiscussedpreviously).
forwhichitreportsmorethan70%ofthem.Fortheremaining6
6 CONCLUSIONS
datasets,whichconsistofthe4largestdatasets(intermsofthe
numberğ‘šoftransactions)andthe2datasetswithhighestnumber
WepresentedFSR,anovelalgorithmtoidentifystatisticallysig-
offeatures,TopKWYcouldnotcompleteinreasonabletime(i.e.,we nificant patterns with rigorous bounds on the FWER. FSR uses
stoppeditafter10days),whileFSR-Cfinishedtheanalysiswhilere- a few-shot resampling strategy, which leads to an efficient and
turningalargenumberofsignificantresults(i.e.,eitherallthetop-ğ‘˜
practicalapproachthatcanbeusedforbothconditionalandun-
patternsormorethan600ofthemforthekdd-cupdataset).Forthe conditionaltesting.OurexperimentalevaluationshowsthatFSRis
mostchallengingdatasets(HIGGS,with11millionstransactions, aneffectiveandaccuratemethodforsignificantpatternsdiscovery,
andcancer-rna-seq,with>104continuousfeatures),FSR-Ccon-
whilesignificantlyreducingthecomputationalcostofstate-of-the-
cludesafter5days,whileTopKWYwouldrequire(approximately) artmultiplecomparisonsprocedures,suchaspermutationtesting,
1.5yearsofcomputation.Therefore,insuchcasesFSR-Cenables
thathardlyscaletheanalysistocomplexlanguages,suchassub-
theanalysisofthesechallenginginstanceswhileidentifyingmany groups,andlargedatasets.Whiletheexperimentspresentedinthis
significantpatterns.TheseresultsconfirmthatFSR-C,whilepro- workarefocusedonsubgroups,weexpecttherelativeimprove-
vidingaslightlymoreconservativeupperboundtothesupremum mentsobtainedbyFSRtodirectlytransfertootherpatterntypes,
deviation,isstillcapableofdiscoveringthesame(oralmostthe giventhegeneralityofourframeworkandofthedesignofour
same)mostsignificantpatterns,whilebeingmorethantwoorders resamplingprocedures,whicharesharedbyalltypesofpatterns.
ofmagnitudefaster,andreportingmanypatternsassignificant
forchallenginginstancesoutofreachforthestate-of-the-art.We ACKNOWLEDGMENTS
concludethatFSR-Cprovidesanexcellenttrade-offbetweenthe
Thisworkwassupportedbytheâ€œNationalCenterforHPC,Big
numberofpatternsidentifiedassignificantandthecomputational
Data,andQuantumComputingâ€,projectCN00000013,andbythe
requirementoftheanalysis.
PRINProjectn.2022TS4Y3N-EXPAND:scalablealgorithmsfor
EvaluationofFSR-U.WenowevaluatetheperformanceofFSR-U
EXPloratoryAnalysesofheterogeneousanddynamicNetworked
todiscoversignificantpatternswithunconditionaltesting.Weshow
Data,fundedbytheItalianMinistryofUniversityandResearch
theresultsinFigure3.WecompareFSR-UwiththebaselineFSR-
(MUR).
U-UB(describedabove)intermsofdeviationbounds(a),running
12REFERENCES
[25] FelipeLlinares-LÃ³pez,MahitoSugiyama,LaetitiaPapaxanthos,andKarsten
[1] CharuCAggarwal,YaoLi,PhilipSYu,andRuomingJin.2010.Ondensepattern Borgwardt.2015.Fastandmemory-efficientsignificantpatternminingviaper-
miningingraphstreams. ProceedingsoftheVLDBEndowment3,1-2(2010), mutationtesting.InProceedingsofthe21thACMSIGKDDinternationalconference
975â€“984.
onknowledgediscoveryanddatamining.725â€“734.
[2] RakeshAgrawal,TomaszImieliÅ„ski,andArunSwami.1993.Miningassociation [26] MaartenLÃ¶fflerandJeffMPhillips.2009.Shapefittingonpointsetswithproba-
rulesbetweensetsofitemsinlargedatabases.InProceedingsofthe1993ACM bilitydistributions.InAlgorithms-ESA2009:17thAnnualEuropeanSymposium,
SIGMODinternationalconferenceonManagementofdata.207â€“216. Copenhagen,Denmark,September7-9,2009.Proceedings17.Springer,313â€“324.
[3] MohammadAlHasanandMohammedJZaki.2009.Outputspacesamplingfor [27] ColinMcDiarmid.1989. Onthemethodofboundeddifferences. Surveysin
graphpatterns.ProceedingsoftheVLDBEndowment2,1(2009),730â€“741. combinatorics141,1(1989),148â€“188.
[4] MartinAtzmueller.2015.Subgroupdiscovery.WileyInterdisciplinaryReviews: [28] NicolaiMeinshausen,MarloesHMaathuis,andPeterBÃ¼hlmann.2011.Asymp-
DataMiningandKnowledgeDiscovery5,1(2015),35â€“49. toticoptimalityoftheWestfall-Youngpermutationprocedureformultipletesting
[5] GABarnard.1945.Anewtestfor2Ã—2tables.Nature156,3954(1945). underdependence.TheAnnalsofStatistics(2011),3369â€“3391.
[6] YoavBenjaminiandYosefHochberg.1995.Controllingthefalsediscoveryrate: [29] Shin-ichiMinato,TakeakiUno,KojiTsuda,AikaTerada,andJunSese.2014.A
a stap tr ia stc it ci ac la sl oa cn ied typ :o sew rie er sfu Bl (Map ep thro oa dc oh logto icam l)u 5lt 7i ,p 1le (1t 9e 9st 5i )n ,g 2. 89J â€“o 3u 0r 0n .aloftheRoyal f fra es qt um enet th io ted mo sf etst ea nt uis mtic ea ral ta ioss ne .s Is nm Ee Cn Mt Lfo Pr Kc Dom Db 2i 0n 1a 4t .o Sr pia rl inh gy ep r.othesesbasedon
[30] LeonardoPellegrina,CyrusCousins,FabioVandin,andMatteoRiondato.2022.
[7] CarloBonferroni.1936.Teoriastatisticadelleclassiecalcolodelleprobabilita.
PubblicazionidelRIstitutoSuperiorediScienzeEconomicheeCommericialidi MCRapper:Monte-CarloRademacheraveragesforposetfamiliesandapprox-
[8]
F Si tr Ã©e pn hz ae n8 e( B19 o3 u6 c) h, e3 râ€“ o6 n2 ,.
GÃ¡borLugosi,andPascalMassart.2013. Concentration
(i Tm Ka Dte Dp )a 1t 6t ,er 6n (2m 02in 2)in ,1g â€“. 2A 9.CMTransactionsonKnowledgeDiscoveryfromData
inequalities:Anonasymptotictheoryofindependence.Oxforduniversitypress. [31] TL ee so tn ina grd ao ndPe Sl tl ae tg ir si tn ica a, llM y-a st ote uo ndR Pio an ttd ea rt no, Ma in nd inF ga .b Inio PV roa cn ed edin in. g2 s01 of9. thH e2y 5p to hth Ae Cs Mis
[9] LeiCao,YizhouYan,SamuelMadden,ElkeARundensteiner,andMathanGopal- SIGKDDInternationalConferenceonKnowledgeDiscovery&DataMining(KDD
s Va Lm Dy B.2 E0 n1 d9 o. wE mffi ec ni te 1n 2t ,d 8is (c 2o 0v 1e 9r ),y 9o 2f 0s â€“e 9q 3u 2e .nceoutlierpatterns.Proceedingsofthe â€™19).ACM,NewYork,NY,USA,3215â€“3216.
[32] LeonardoPellegrina,MatteoRiondato,andFabioVandin.2019. SPuManTE:
[10] M Sea rit ete so MC oe tc ifc sa wre il tl ho Pa rn od bJ ao bh ila isn tn icG Ga um arp ae nr t. e2 e0 s2 .2 P. rF oa ces et da in nd gsS oc fa tla hb el Ve LM Di Bni En ng do of wT mim ene t S Ai Cgn Mifi Sc Ia Gn Kt DP Datt Ie nr tn erM nain tii on ng aw lCit oh nU fen rc eo nn cedi ot nio Kna nl oT we ls et din geg. DIn iscP or vo ec re yed &ing Ds ao tf at Mhe in2 i5 nth
g
15,13(2022),3841â€“3853. (KDDâ€™19).ACM,NewYork,NY,USA,1528â€“1538.
[11] ChenChen,CindyXLin,MattFredrikson,MihaiChristodorescu,XifengYan,and
[33] LeonardoPellegrinaandFabioVandin.2020.Efficientminingofthemostsignif-
J Pi ra ow cee ei dH ina gn s. o2 f00 th9 e. VM Lin Di Bng Eng dra op wh mp ea nt tte 2r ,n 1s (e 2ffi 00c 9i )e ,n 7t 4ly 2â€“v 7ia 53r .andomizedsummaries. icantpatternswithpermutationtesting.DataMiningandKnowledgeDiscovery
34(2020),1201â€“1234.
[12] SebastianDalleigerandJillesVreeken.2022.Discoveringsignificantpatterns
u Cn od ne fer rs ee nq cu ee on nti Kal nf oa wls le edd gi esc Dov ise cr oy vec ro yn atr no dl. DIn atP aro Mce ie nd inin gg .softhe28thACMSIGKDD [34] A ton pd -Kre fa reP qie ut er na tca cp lor sin eda ia tn emdF sea tb si .o InVa Inn td erin n. a2 ti0 o0 n7 a. lE Cffi onc fi ee rn et ncin ec or nem De isn ct oa vl em ryin Scin ieg nco ef
.
[13] D foe rv td ha et at nP aD lyu sib sh oa fs rh ai na dn od mA izle edss aa ln gd or ro ithP man sc .o Cn ae msi b. r2 i0 d0 g9 e. UC non ivc ee rn st ir ta yti Po rn eso sf .measure [35] S Dp ar vin idge Pr o, l2 l7 a5 rdâ€“ .2 28 00 1. 2. Convergenceofstochasticprocesses. SpringerScience&
BusinessMedia.
[14] JonasFischer,AnnaOlah,andJillesVreeken.2021.Whatâ€™sintheBox?Exploring
t Inh te erIn nan te ir onL aif le Co of nN fee ru enra cl eN onet Mw ao cr hk is nw ei Lt eh aR rno ib nu gst (PR ru ocle es e. dI in ngP sro ofce Med ai cn hg is neof Lt eh ae rn3 i8 nth
g
[36] M gra ot ut peo swRi io thnd saa mto pa lin nd gF aa nb dio psV ea un dd oi dn i. m20 en20 si. oM n.iS Ao CS Mou TP r: aM nsi an ci tn iog ni sn ote nre Ks nti on wg les du gb e-
Research),Vol.139.PMLR,3352â€“3362.
DiscoveryfromData(TKDD)14,5(2020),1â€“31.
[15] R tho en ca ald lcA ulaF tis ioh ner o. f19 P2 .2 J. oO urn nt ah le oi fn tt he erp rr oe yt aa lti so tan to isf tiğœ’ ca2 lsfr oo cm ietc yo 8n 5t ,in 1g (e 1n 9c 2y 2)t .ables,and [37] D Paie ttg eo rnS sa wnt io thro V, CA -n Dd ir mea enT so ion non a, na dn Rd aF da eb mio acV ha en rd Cin o. m2 p0 l2 e0 x. ityM
.
i An li gn og riS the mqu se 1n 3ti ,a 5l
(2020),123.
[16] W souil nh del pm ai ti tn ea rnH dÃ¤ im scÃ¤ ol vÃ¤i en re yn .Dan atd aG Me io nff inre gy aI nW dKeb nb o. w2 l0 e1 d9 g. eA Dit su coto vr ei ra ylo 33n (s 2t 0a 1ti 9s )t ,ic 3a 2l 5ly
â€“
[38] S Frh oa miS Th ha ele ov r- yS th ow Aa lr gt oz ra in thd mS sh .a CiB amen b- rD ida gv eid U.2 n0 iv14 e. rsU itn yde Pr rs et sa sn .dingMachineLearning:
377.
[39] AikaTerada,HanyoungKim,andJunSese.2015.High-speedWestfall-Young
[17] J mia inw ie ni gH :ca un rr, eH no tn stg atC ush ae nn dg, fuD to un reg dX iri en c, tia on nd s.X Di afe tang miY na in ng.2 a0 n0 d7 k. nF or we lq eu dgen et dip sca ott ve er rn y p the erm 6tu hta At Cio Mnp Cr oo nc fe ed ru enre cefo or ng Be in oo inm foe r- mw aid tie csa ,s Cso oc mia pt uio tan tis otu nd alie Bs i. oI ln ogP yro ac nee dd Hin eg as lto hf
15,1(2007),55â€“86. Informatics.17â€“26.
[18] NguyenThiThaoHo,TorbenBachPedersen,etal.2022. Efficienttemporal
[19]
p
V
Sta
L
ut Dt re eBr Hn
E
onm
ld
mi on
w
.i 1n
m
9g 7eni 9n
.t
Ab 1i 5g
s,
i3t mim
( p2
le
0
e2s s2e e)r
,
qi 6e u7s
e3
nu
â€“
ts i6i an
8
llg
5
y.m reu jetu cta il vi en mfo urm ltia pt li eo tn e. stP pro rc oe ce ed di un rg es .o Sf ct ah ne
-
[40] A
t Ais
cik
t
aia
dc
eaT mle
s
yr ia
g
od
n
fa
i
S,
fi
cM
c
ieaa nnr cci ek
e
so
o
1O
f
10ck ,oa 3md 2a
b
(-
i
2H
n
0aa 1tt 3oa )rk ,ie 1ay 2la 9rm
9e
6ga â€“u, 1lK
a
3to
0i
0j oi 1nT .ss .u Pd ra o, ca en ed diJ nu gn sS oe fs te h. e2 N01 a3 t. ioS nt aa l-
dinavianjournalofstatistics(1979),65â€“70. [41] M Daa tt ath Mijs inV ina gn aL ne deu Kw ne on wla en dd geA Drn iso coK vn eo rybb 2e 5. (2 20 01 12 2. )D ,2i 0v 8e â€“rs 2e 4s 2u .bgroupsetdiscovery.
[20] K
p
Mru aom
tb
haa er
b
miJ lo aitg
ti
id
e
ce aso
la
Sa
n
tn add tiaS stt ige cp
e
snh 3e
e
9n
r ,a
4M
liz
(1S
a
9a
ti
6m
o
8nu ),e 1ols 1f. 91
R
19
a
â€“6
m
18 1.
a
9M
n
5uo .jn ao nt â€™o sn ee qc uo an tv ioe nrg .en Tc he eof Ab ni nn ao lm si oa fl [ [4 42 3]
]
K
p
Gre eon obn ffae
b
ret ilh yityT Ie Wdd
is
etW
bri
bba .ul 2l te 0in
o
0ni 6u
.
.s
T
D. e1
ic
s9
h
c6
n
o3 vi.
c
eaB
rl
ii
R
nas gee
p
sd
o
igrs ta n.m ifihp
t
ctl api nn
s
tg :/:
r/p
uth
u
lee
r
sln
.
.so
It
nn anc Pe
f
ron ort cdr ea
.
eel ddh
iu
ny
/
gp
w
se hr og
0
f5e to
6
hm
v
ej9e 1t
3
2r
4
ti h7c
[21] J ca an lli ys eK xa cl eo pfo til oia ns a, lM yea tri go loB bo al le lyy, ra en pd reJ si ell ne ts aV tir ve ee sk ue bn g. r2 o0 u1 p7 s. .E Inffi 2c 0i 1e 7nt IEly Ed Ei Is nc to ev re nr ai tn iog nl ao l- ACMSIGKDDinternationalconferenceonKnowledgediscoveryanddatamining.
ConferenceonDataMining(ICDM).IEEE.
[44]
4 G3 e4 oâ€“ ff4 r4 e3 y.
IWebb.2007.Discoveringsignificantpatterns.Machinelearning68
[22] YannLeCunandCorinnaCortes.2010. MNISThandwrittendigitdatabase.
(2007),1â€“33.
http://yann.lecun.com/exdb/mnist/
[45] GeoffreyIWebb.2008. Layeredcriticalvalues:apowerfuldirect-adjustment
[23] F dl io scr oia vn erL yem inm pe yr ti hch ona .n Id nM ECar Mti Ln PB Ke Dck Der 2. 02 10 81 .9 S. pp ry insu gb eg r,r 6o 5u 8p â€“: 6E 6a 2s .y-to-usesubgroup approachtodiscoveringsignificantpatterns.MachineLearning71(2008),307â€“
323.
[24] Y sai mL pi, lePh coil mip pM lexL ito yn og f,a len ad rnA inra gv .i Jn .d CS omrin pi uv ta .s Sa yn st. e2 m00 S1 c. i.I 6m 2p ,r 3o (v 2e 0d 01b )o ,5u 1n 6d â€“s 5o 2n 7.the [46] P Exet ae mr pH leW sae ns dtfa mll eta hn od dS sfS ot ra pn -l vey aluYo eu an dg ju. s1 t9 m9 e3 n. tR .e Js oa hm np Wlin ilg e- yba &se Sd om nsu .ltipletesting:
13A APPENDIX distribution of the maximum deviation, that is, the valueğ‘ for
A.1 RelationtoQualityMeasures whichthemaximumdeviationisbelowğ‘withprobabilityğ›¿,fora
(relatively)smallvalueofğ›¿.Accuratelyestimatingsuchquantile
Interestingsubgroupsareoftenidentifiedusingaqualitymeasure,
requiresmanymorepermutationsthanestimatingtheexpectation
definedbycombiningthegeneralityandtheunusualnessofapat-
(asdonebyourapproach).Forexample,ifonly10permutations
tern.ThegeneralityfP(D)ofapatternPinthedatasetDisthe (e.g.,correspondingtothevalueğ‘usedinourexperiments)areused
fractionofsamplesofDthatsupportP toestimatetheğ›¿-quantile,withğ›¿ =0.05,theWYprocedurereturns
fP(D)=
ğ‘š1 âˆ‘ï¸ğ‘š
1[P âˆˆğ‘  ğ‘–] =
|CP ğ‘š(D)|
.
t inhe pm osa itx ii om nu âŒˆm ğ›¿Â·d 1e 0v âŒ‰ia =ti 1on ino tv he er lt ih ste o1 f0 dp ee vr im atu iot nat si ,o sn os rt( ei. de. i, nth de ece rl ee am sie nn gt
ğ‘–=1 order).Thisimpliesthat,withprobability> 1,theFWERwillnotbe
2
Foranybagofsamplesğµ âŠ†D,definetheaveragetargetvalue controlledatlevelğ›¿(sincetheprobabilitythatthedeviationofone
ğœ‡(ğµ)ofsamplesğ‘¡ âˆˆğµas permutationwillbeabovetheğ›¿-quantileis0.95,andtheprobability
1 âˆ‘ï¸ thatalldeviationsareabovetheğ›¿-quantileis0.9510â‰ˆ0.599> 1).
ğœ‡(ğµ)= â„“. 2
|ğµ| Moreover,withprobability> 1,theFWERwillnotbecontrolled
(ğ‘ ,â„“)âˆˆğµ 3
even at level 2ğ›¿ = 0.1 (since 0.910 â‰ˆ 0.3487 > 1). For such a
TheunusualnessuP(D)ofthepatternPonthedatasetDisdefined reason,previousworkssuggesttouseatleast103pe3
rmutationsfor
asthedifferenceofthetargetvariableofthesamplesâˆˆ CP(D)
permutationapproaches(aswedoinourexperiments),while104
andtheaveragetargetintheentiredataD
isthesuggestednumberofpermutationstohaveastableFWER
uP(D)=ğœ‡(CP(D))âˆ’ğœ‡(D). estimation([25,33,39]alluse104).
Theğ›¼-qualityqÂ¯âˆ— (D)ofapatternPonadatasetDisdefined
P,ğ›¼ A.3 ProofsofSection4.1
as
qÂ¯âˆ— P,ğ›¼(D)=fP(D)ğ›¼ uP(D). Thi Fs irs se tc ,t wio en np er ee dse tn ht es fa od ld loit wio in na gl tp er co ho nfs icf ao lr rt eh se ulr te .sultsofSection4.1.
Commonlyusedqualitymeasuresarethe1-quality,the1-quality,
2 Theorem14(McDiarmidâ€™sineqality[27]). LetYbeadomain,
andthe2-quality. andletğ‘”:Yğ‘š â†’Rbeafunctionsuchthat,foreachğ‘–,1â‰¤ğ‘– â‰¤ğ‘š,
GivenasubgroupP,itsqualityqP canbewrittenas
thereisanonnegativeconstantğ‘ suchthat:
ğ‘–
qP = (ğ‘ ,P â„“)r âˆ¼ğ›¾(P âˆˆğ‘ âˆ§â„“ =1)âˆ’ (ğ‘ ,P â„“)r âˆ¼ğ›¾(P âˆˆğ‘ ) (ğ‘ ,P â„“)r âˆ¼ğ›¾(â„“ =1) sup |ğ‘”(ğ‘¥ 1,...,ğ‘¥ ğ‘š)âˆ’ğ‘”(ğ‘¥ 1,...,ğ‘¥ ğ‘–âˆ’1,ğ‘¥ ğ‘–â€²,ğ‘¥ ğ‘–+1,...,ğ‘¥ ğ‘š)| â‰¤ğ‘ ğ‘–.
(cid:18) (cid:19)
âŸ¨ğ‘¥ 1,...,ğ‘¥ğ‘šâŸ©âˆˆYğ‘š
= Pr (P âˆˆğ‘ ) Pr (â„“ =1|P âˆˆğ‘ )âˆ’ Pr (â„“ =1) . ğ‘¥ ğ‘–â€²âˆˆY
(ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾ (ğ‘ ,â„“)âˆ¼ğ›¾ Let ğ‘¥ 1,...,ğ‘¥ ğ‘š be ğ‘š independent random variables such that
NotethatthegeneralityfP(D)istheestimate(ondatasetD) âŸ¨ğ‘¥ 1,...,ğ‘¥ ğ‘šâŸ© âˆˆYğ‘š.Then,forğ¶ =(cid:205)ğ‘š ğ‘–=1ğ‘ ğ‘–2,itholds
o mf aP ter( (ğ‘  o,â„“ n)âˆ¼ dğ›¾ a( tP aseâˆˆ tğ‘  D), )a on fd Pt rh (ğ‘ a ,t â„“)t âˆ¼h ğ›¾e (u â„“n =us 1u |Paln âˆˆes ğ‘ s )u âˆ’P P( rD (ğ‘ ,) â„“)i âˆ¼s ğ›¾th (â„“e =es 1t )i-
,
Pr(cid:16) E[ğ‘”] >ğ‘”(ğ‘¥ 1,...,ğ‘¥ ğ‘š)+ğ‘¡(cid:17) â‰¤ğ‘’âˆ’2ğ‘¡2/ğ¶.
where Pr(ğ‘ ,â„“)âˆ¼ğ›¾ (â„“ =1|P âˆˆğ‘ ) is estimated by ğœ‡(CP(D)) and
ProofofTheorem6. First,wenotethatintheconditionalset-
Pr(ğ‘ ,â„“)âˆ¼ğ›¾ (â„“ =1)isestimatedbyğœ‡(D).Thisshowsthatthe1-quality tingitholdsğœ‡Ë†=ğœ‡Ë‡=ğœ‡Â¯.Then,fromthefactLâ˜…âŠ†L,wehave
qÂ¯âˆ— P,1(D) = fP(D)uP(D) correspondstoanestimate,obtained
(cid:34) ğ‘š (cid:35)
wfro em caD nc, oo nft sh ide eq ru mal ii nty inq gP suo bf gs ru ob ug pr sou wp itP h. hW igi hth 1t -h qi us ar le itl yat qi Â¯o
âˆ—
Pn ,1in (Dm )in ad s, vâˆ¼ğ¼E
(ğœ‡Â¯)
Ps âˆˆu Lp â˜…ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯)
anheuristicforfindingsignificantsubgroups,whichignoresthe (cid:34) ğ‘š (cid:35)
randomfluctuationsoftheestimatesfP(D)anduP(D). â‰¤ vâˆ¼ğ¼E
(ğœ‡Â¯)
Psu âˆˆp Lğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Â¯) = RE â˜…(cid:2)ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)(cid:3),
A.2 ComparisonwithPermutationApproaches
therefore we focus on the concentration
ofğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)
around its
Inthissectionweprovideamoredetailedcomparisonbetweenour expectationtakenw.r.t.Râ˜…
.OurproofisbasedonMcDiarmidâ€™s
few-shotapproachandcommonlyusedpermutationapproaches. inequality(Theorem14).Definethefunctionğ‘”(Râ˜…)
=
ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡),
Our few-shot approach leverages our analytical results (e.g., andnotethatmodifyinganyğœ‰ ğ‘–,ğ‘—,foranypairğ‘–,ğ‘—,changesğ‘”(Râ˜…)by
T deh ve io ar tie om no6 f) pto ato teb rt na sin â€™qh ui ag lh itypr bo yb ea sb ti il mit ay tib no gu on nd ls yo thn eth exe pm eca tax ti im onum
of
atmost1/(ğ‘ğ‘š).Therefore,definingğ¶ =(cid:205) ğ‘–(cid:205) ğ‘—(1/(ğ‘ğ‘š))2=1/(ğ‘ğ‘š),
fromTheorem14itholds
maximumdeviationofpatternsâ€™quality.Estimatingsuchexpecta- âˆšï¸„
tionrequiresasmallnumberğ‘ofresampleddatasets,suchasğ‘ =10 Pr(cid:32)
E (cid:2)ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)(cid:3)>ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)+
log(cid:0) ğ›¿4(cid:1)(cid:33)
â‰¤ğ›¿/4.
thatweusedinourexperimentalevaluation. Râ˜… 2ğ‘ğ‘š
Thesameapproachcannotbeusedbypermutationapproaches
â–¡
(e.g.,[25,33,39]),sincetheyareestimatingtheğ›¿-quantileofthe
14A.4 ProofsofSection4.2 isaself-boundingfunction[8].Definetherandomvariableğ‘ ğ‘—,for
ThisSectionpresentstheproofsfortheresultsofSection4.2.
ğ‘— âˆˆ [1,ğ‘š],as
(cid:20) (cid:26) ğ‘š (cid:27)(cid:21)
denP tr ao no df bo of uL ne dm edma ra9 n. doS minc ve arğœ‡ i( aD ble) si ,s Ht oh ee ffa dv iner ga â€™g se ano dfğ‘š Berin nd ste ep inen â€™s- ğ‘ ğ‘— = TE
â˜…
Psu âˆˆp
L
ğ‘š1 ğ‘–=âˆ‘ï¸ 1,ğ‘–â‰ ğ‘—ğ‘“ P(ğ‘  ğ‘–)(ğœ‰ ğ‘– âˆ’ğœ‡)
inequalities[8]yield,respectively,that First,notethatğ‘ â‰¥0:
|ğœ‡âˆ’ğœ‡(D)|
â‰¤(cid:118)(cid:116) ln(cid:16) ğ›¿8(cid:17)
,
ğ‘ = TE â˜…(cid:2) Psu âˆˆp L{qP(Dâ˜… )}(cid:3) â‰¥ Psu âˆˆp L(cid:8) TE â˜…(cid:2) qP(Dâ˜… )(cid:3)(cid:9) â‰¥0.
2ğ‘š
(cid:118)(cid:116) (cid:16) (cid:17) (cid:16) (cid:17)
Then,weprovethatğ‘ âˆ’ğ‘
ğ‘—
â‰¥0.Defineğ‘“Ë†asoneofthefunctions
2ğœ‡(D)ln ğ›¿8 2ln ğ›¿8 thatattainthesupremumforğ‘ ğ‘—,foranychoiceofTâ˜… .Wehave
|ğœ‡âˆ’ğœ‡(D)| â‰¤ ğ‘š + ğ‘š , (cid:20) 1 âˆ‘ï¸ğ‘š (cid:21)
h foo ll ld owsi sm fru ol mtan theo eu os bly serw vi at th iop nro thb aa tb til hit ey irâ‰¥ mi1 niâˆ’ mğ›¿ u/ m4. isT â‰¤he
ğœ€
ğ‘‡st .atemen â–¡t ğ‘ ğ‘— âˆ’ğ‘ â‰¤ğ‘ ğ‘— (cid:20)âˆ’ TE â˜… ğ‘š ğ‘–=1ğ‘“Ë†(ğ‘  ğ‘–) (cid:21)(ğœ‰ ğ‘– âˆ’ğœ‡)
1
ProofofTheorem11. Recall that Râ˜… = (cid:8) D 1â˜…,...,Dğ‘â˜…(cid:9) is = ğœ‰E
ğ‘—
âˆ’ ğ‘šğ‘“Ë†(ğ‘  ğ‘—)(ğœ‰ ğ‘— âˆ’ğœ‡) =0.
a collection of ğ‘ â‰¥ 1 i.i.d. resampled datasets, each obtained
by resampling the target labels of D while maintaining the
Wenowshowthatğ‘ âˆ’ğ‘
ğ‘—
â‰¤ğœ‡(1âˆ’ğœ‡)/ğ‘š.Wehave
s (cid:8)a (m
ğ‘ 
1e
,ğœ‰
1fe ,ğ‘—a )t ,u .r .e .s
(ğ‘ 
ğ‘šof ,ğœ‰D ğ‘š. ,ğ‘—T )(cid:9)h ,a wt his e, reeach resampled dataset is Dâ˜… ğ‘— = ğ‘ â‰¤ TE â˜…(cid:20) Psu âˆˆp L(cid:26) ğ‘š1 ğ‘–=âˆ‘ï¸ 1,ğ‘–â‰ ğ‘—ğ‘“ P(ğ‘  ğ‘–)(ğœ‰ ğ‘– âˆ’ğœ‡)(cid:27)
ğœ‰ ğ‘–,ğ‘— âˆ¼ğµğ‘’ğ‘Ÿğ‘›(ğ‘),âˆ€ğ‘– âˆˆ [1,ğ‘š],âˆ€ğ‘— âˆˆ [1,ğ‘], (cid:26) 1 (cid:27)(cid:21)
andğµğ‘’ğ‘Ÿğ‘›(ğ‘)istheBernoullidistributionwithparameterğ‘.Inthe
+ Psu âˆˆp
L
ğ‘šğ‘“ P(ğ‘  ğ‘—)(ğœ‰ ğ‘— âˆ’ğœ‡)
p ofro reo sf aw me pls ee dtğ‘ da= tasğœ‡ et= sRE Ë†â˜…D =[ğœ‡ {( DD Ë† 1â˜…)] ,. .T ..h ,e Dn Ë† ğ‘â˜…,w }e simde ifi lan re lyt th oe Rco â˜…l ,le wc hti eo rn e â‰¤ğ‘ ğ‘— + ğœ‡(1 ğ‘šâˆ’ğœ‡) .
t rh ole espa or fa Rm â˜…et ae nr dğœ‡ RË†is â˜…r ae rp ela swce ad ppb ey dit is nu thp epe str ab teo mun end tğœ‡Ë† an(n do it ne Ath lga .t 1t )h .e Wenowprovethat(cid:205)ğ‘š ğ‘—=1ğ‘ âˆ’ğ‘
ğ‘—
â‰¤ğ‘.Itholds
supL Pet âˆˆLğ‘Œ â˜…= ğ‘‰ğ‘E
ğ‘Ÿ
DD ((cid:2) qsu Pp (P Dâˆˆ )L )â˜… â‰¤{qP ğœˆ.(D W) e} a(cid:3) , ppan lyd Bo ob us se qrv ue ett â€™sha it neit quh ao ll id tys âˆ‘ï¸ ğ‘—ğ‘š =1ğ‘ ğ‘— â‰¥ TE â˜…(cid:20) Psu âˆˆp L(cid:26) ğ‘š1 âˆ‘ï¸ ğ‘—ğ‘š =1ğ‘–=âˆ‘ï¸ 1ğ‘š ,ğ‘–â‰ ğ‘—ğ‘“ P(ğ‘  ğ‘–)(ğœ‰ ğ‘– âˆ’ğœ‡)(cid:27)(cid:21)
(Theorem12.5of[8])toprovethat (cid:20) (cid:26)ğ‘šâˆ’1âˆ‘ï¸ğ‘š (cid:27)(cid:21)
Ps âˆˆu Lp â˜…{qP(D)}â‰¤ğ‘Œ +âˆšï¸„ 2ln(cid:0) ğ›¿4(cid:1) ğ‘š(ğœˆ+2ğ‘Œ) + ln 3(cid:0) ğ‘šğ›¿4(cid:1) , = =(TE ğ‘šâ˜… âˆ’Psu 1âˆˆ )p L
ğ‘.
ğ‘š ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(ğœ‰ ğ‘– âˆ’ğœ‡)
withprobabilityâ‰¥1âˆ’ğ›¿/4.Wenowshowhowtoupperboundğ‘Œ. Asğ‘ isaself-boundingfunction,wehavethat
First,notethat
(cid:18) âˆ’ğ‘šğ‘2 (cid:19)
DE(cid:2) Ps âˆˆu Lp â˜…{qP(D)}(cid:3) = DE
â˜…
ğ‘—
(cid:2) Ps âˆˆu Lp â˜…{qP(Dâ˜… ğ‘— )}(cid:3) Pr(E[ğ‘]âˆ’ğ‘ â‰¥ğ‘) â‰¤exp 2ğœ‡(1âˆ’ğœ‡)E[ğ‘] .
(cid:20) ğ‘ (cid:21) Imposing the r.h.s. â‰¤ ğ›¿/4, solving for ğ‘, and finding the fixed
= RE
â˜…
ğ‘1âˆ‘ï¸ ğ‘—=1Ps âˆˆu Lp â˜…{qP(Dâ˜… ğ‘— )} Wpo ein at po pf lythe Mi cn De iq au ra mli it dy iw ne eqo ub at la itin yğ‘‘ (Ë† T. hLe et orğ‘‘ eËœ( mRâ˜… 1) 4)= toğ‘‘Ëœ( sR hâ˜… o, wğœ‡(D th) a) t.
bydefinitionofLâ˜… andRâ˜…
.Then,itfollowsthat
E Râ˜…[ğ‘‘Ëœ(Râ˜…) | A] â‰¤ ğ‘ŸË† with probability â‰¥ 1 âˆ’ğ›¿/4. In fact, de-
finethefunctionğ‘”(Râ˜…)
=
ğ‘‘Ëœ(Râ˜…),andnotethatmodifyingany
RE â˜…(cid:20) ğ‘1âˆ‘ï¸ ğ‘—=ğ‘ 1Ps âˆˆu Lp â˜…{qP(Dâ˜… ğ‘— )}(cid:21) â‰¤ RE â˜…(cid:20) ğ‘1âˆ‘ï¸ ğ‘—=ğ‘ 1Psu âˆˆp L{qP(Dâ˜… ğ‘— )}(cid:21) , ğœ‰ dğ‘– e,ğ‘— fi, nfo inr gan ğ¶y =pai (cid:205)r ğ‘–ğ‘–, (cid:205)ğ‘—, ğ‘—c (h 1a /n (ğ‘g ğ‘šes ))ğ‘” 2(R =â˜…) 1/b (y ğ‘ğ‘šat )m
,
to hs et1 u/ p( pğ‘ğ‘š er) b.T ouh ner def ğ‘ŸË†or te o,
since Lâ˜… âŠ† L. We now prove bounds to the concentration of E Râ˜…[ğ‘‘Ëœ(Râ˜…)|A]holdsbyTheorem14.Wenowneedtoprovethat
E DR â˜…â˜…(cid:2) =ğ‘1 ((cid:205) Ağ‘ ğ‘— ,= T1s â˜…u )p bP eâˆˆ aL g{q enP e( rD icâ˜… ğ‘— D)} â˜…(cid:3) w âˆˆ.r R.t â˜…. ,th we its het To â˜…ffe =at {u ğœ‰r 1e ,s ..A .,.
ğœ‰
ğ‘šLe }t
.
t
s
ah
m
lle
a
ğ‘¥lu ,lep rp te hr ab no uu sn ind gğ‘‘Ë† Rc â˜…o .m Tp hu iste id seu qs uin ivg alR eË† nâ˜… ti ts o( sp hr oo wba tb hi ali ts it tic ha oll ly d) s,n foo rt
Definetherandomvariableğ‘ as
ğ‘ = TE â˜…(cid:2) Psu âˆˆp L{qP(Dâ˜… )}(cid:3), RP Ë†â˜…r (cid:16) ğ‘‘Ëœ(RË†â˜… ) >ğ‘¥(cid:17) â‰¥ RP â˜…r (cid:16) ğ‘‘Ëœ(Râ˜… ) >ğ‘¥(cid:17) .
wheretheexpectationisw.r.t.Tâ˜… ,conditioningonA.Toshowthe Equivalently,theprobabilityofunderestimatingE Râ˜…[ğ‘‘Ëœ(Râ˜…)]using
concentrationofğ‘ w.r.t.itsexpectationE A[ğ‘],weprovethatğ‘
ğ‘‘Ëœ(Râ˜…)doesnotincreasewhenusingğ‘‘Ëœ(RË†â˜…).Sincethetwoprobabil-
itiesaretakenw.r.t.totwodifferentsamplespaces,itisnotpossible
tocomparethemdirectly.Therefore,webuildanappropriatecou-
plingbetweenthetwodistributions.Defineanğ‘šÃ—ğ‘matrixğ‘£ofğ‘šğ‘
i.i.d.Bernoullirandomvariables,suchthatPr(ğ‘£
ğ‘–,ğ‘—
=1)=ğœ€ ğ‘‡/(1âˆ’ğœ‡)
15forallğ‘–,ğ‘—.(Notethatweassume0<ğœ‡ <1and0â‰¤ğœ‡Ë‡â‰¤ğœ‡ â‰¤ğœ‡Ë†â‰¤1, andthenconcludewithaconcentrationboundforğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)w.r.t.
otherwisethestatementholdstrivially.)Weobservethat toitsexpectationE vâˆ¼ğ¼(ğœ‡Ë†)[ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)],usinganalogousderivations
ğ‘ (cid:40) ğ‘š (cid:41) of the proof of Theorem 6. For any P âˆˆ L, define ğ‘‹ P =
Pr (cid:16) ğ‘‘Ëœ(RË†â˜… ) >ğ‘¥(cid:17) = Pr(cid:169) (cid:173)ğ‘1âˆ‘ï¸ sup ğ‘š1 âˆ‘ï¸ ğ‘“ P(ğ‘  ğ‘–)(cid:16) ğœ‰Ë† ğ‘–,ğ‘— âˆ’ğœ‡(cid:17) >ğ‘¥(cid:170) (cid:174), ğ‘š1 (cid:205)ğ‘š ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(vğ‘– âˆ’ğœ‡Ë‡).LettwopatternsP 1,P 2suchthatthepro-
RË†â˜… RË†â˜… ğ‘—=1PâˆˆL ğ‘–=1 jection of P 1 on D is equal to the projection of P 2 on D, i.e.,
w b Ru â˜…h ie l ,d ure st ihğœ‰ nË† eğ‘– g,ğ‘— f to ha lr eloe fw ai. ci i t. nd tg. hB ac toe ğœ‰ur Ë†(cid:171) ğ‘–n p ,ğ‘—o liu âˆ¼nl gl mi bw ae xtit w {h ğœ‰e ğ‘–P ,e ğ‘—nr ,( ğ‘£tğœ‰ ğ‘–Ë† h ,ğ‘– ğ‘—, eğ‘— }.d= Tis h1 t i) r sib= au llğœ‡ t oË† i wofo n sr s ua o sl f tl oRğ‘– Ë†, oâ˜…ğ‘— b. taW an inde(cid:172) wi st u ip th hğ‘–o âˆˆ inl {d 1 Es ,2 v}{ âˆ¼ğ‘– ğ‘‹ ğ¼(P ğœ‡: Ë†ğ‘– )[P = ğ‘‘Ëœ1 (ğ‘‹ Râˆˆ P â˜…1 ,. ğœ‡ğ‘  Ë‡ğ‘– T )} ]h oe= vre ef ro{ tğ‘– r he e,: sw eP e t2 oc faâˆˆ pn ar tğ‘  teğ‘– ew} r. nri sT te whi t is th heim ds iup stpl ii nre es cm tt puh rma ot
-
jections,recallingthatthenumberofsuchdistinctprojectionsis
thelowerboundstatedabove: ğ‘ L(D).Now,foranyP âˆˆL,Bernsteinâ€™sinequality(Theorem2.10
RP Ë†â˜…r(cid:169) (cid:173) (cid:171)ğ‘1âˆ‘ï¸ ğ‘—=ğ‘ 1Psu âˆˆp L(cid:40) ğ‘š1 âˆ‘ï¸ ğ‘–ğ‘š =1ğ‘“ P(ğ‘  ğ‘–)(cid:16) ğœ‰Ë† ğ‘–,ğ‘— âˆ’ğœ‡(cid:17)(cid:41) >ğ‘¥(cid:170) (cid:174)
(cid:172)
i [ in t8] i[ s)8 ,] as) nui cm ah vp etl hi re aas gtt eğ‘‹ha oPt fğ‘‹ âˆˆ i.P iÎ“ .d+i .s ( rğ‘¢a a, ns ğ‘u d)b ow- mg ia thm vağ‘¢m ri=a abr ğœ”a Ë† len / sğ‘šdo
ğ‘“
Pam n (ğ‘ v d ğ‘–a )ğ‘r (i v=ab ğ‘–1l âˆ’e /(( ğœ‡Ë‡S 3 )e ğ‘šc t) hti , ao s tn in a2 c r. ee4
ğ‘ (cid:40) ğ‘š (cid:41) boundedintheinterval[âˆ’ğœ‡Ë‡,1âˆ’ğœ‡Ë‡]andhavevarianceâ‰¤ğœ”Ë†.Conse-
= RP â˜…r ,ğ‘£(cid:169) (cid:173)ğ‘1âˆ‘ï¸ ğ‘—=1Psu âˆˆp
L
ğ‘š1 âˆ‘ï¸ ğ‘–=1ğ‘“ P(ğ‘  ğ‘–)(cid:0) max{ğœ‰ ğ‘–,ğ‘—,ğ‘£ ğ‘–,ğ‘—}âˆ’ğœ‡(cid:1) >ğ‘¥(cid:170) (cid:174) q pu eren bt ol uy, nw de tha ep ep xly pea cm tea dx mim aa xl imin ue mqu oa fli st uy b( -C go ar mol mla ary ra2 n.6 doin m[ v8 a]) rit ao bu lep s-
,
(cid:171) (cid:172)
â‰¥ RP â˜…r ,ğ‘£(cid:169) (cid:173)ğ‘1âˆ‘ï¸ ğ‘—=ğ‘ 1Psu âˆˆp L(cid:40) ğ‘š1 âˆ‘ï¸ ğ‘–ğ‘š =1ğ‘“ P(ğ‘  ğ‘–)(cid:0)ğœ‰ ğ‘–,ğ‘— âˆ’ğœ‡(cid:1)(cid:41) >ğ‘¥(cid:170) (cid:174) o N stb o at tta eei mn thi en a ntg tth ft oh e la lu ot p wE p se[ rm frb oa ox muP n tdğ‘‹ hetP o a] t ph pâ‰¤ e lie câˆšï¸ x ap t2 ieğ‘¢ oc nl tn a ot( i fğ‘ o TnL hg( eiD v oe r) en) ma+ b 1oğ‘ 4vl e tn oh( ğ‘‘ğ‘ o Ëœl (L d Rs( â˜….D T ,ğœ‡h Ë‡) )) e ,.
(cid:171) (cid:172)
= Pr (cid:16) ğ‘‘Ëœ(Râ˜… ) >ğ‘¥(cid:17) . followingthesamestepsoftheproofofTheorem6. â–¡
Râ˜…
Toupperboundğ‘ L(D)forthelanguageofsubgroups,weprove
Then,itisimmediatetoobservethat
thefollowing.Notethatwefocusonthecaseofsubgroupswith
Pr (cid:16) ğ‘‘Ëœ(RË†â˜…,ğœ‡Ë‡) >ğ‘¥(cid:17) â‰¥ Pr (cid:16) ğ‘‘Ëœ(RË†â˜… ) >ğ‘¥(cid:17) , continuousfeatures,sinceeverycategoricalfeatureğ‘“ ğ‘ canbecon-
RË†â˜… RË†â˜… vertedtoadiscreteoneğ‘“ ğ‘‘ (assigningarandomordertothedistinct
sinceğœ‡isreplacedbyitslowerboundğœ‡Ë‡inthedefinitionofğ‘‘Ëœ(RË†â˜…),as elements),andobservingthateachequalityconditionâ€œğ‘“ ğ‘ =ğ‘â€is
ğ‘‘Ëœ(RË†â˜…,ğœ‡Ë‡) â‰¥ğ‘‘Ëœ(RË†â˜…)forallRË†â˜… .Thestatementfollowsobservingthat equivalenttotheintervalâ€œğ‘“ ğ‘‘ âˆˆ [ğ‘âˆ’ğ‘¥,ğ‘+ğ‘¥]â€forsomeğ‘¥ >0.There-
allotherquantitiesinthedefinitionofğœ€areconstantsindependent fore,thelanguageofsubgroupsovercontinuousfeaturescontains
ofğœ‡,andfromanunionboundoverthe3concentrationbounds thelanguageoverdatasetswithbothcontinuousandcategorical
consideredintheproof,andtheeventâ€œ|ğœ‡âˆ’ğœ‡(D)| â‰¤ğœ€ ğ‘‡â€,eachof features,thusallresultsfortheformerapplytothelatter.Notethe
themtruewithprobabilityâ‰¥1âˆ’ğ›¿/4. â–¡ reversedirectionisnottrueingeneral.
Lemma16. LetLbethelanguageofsubgroupscomposedbycon-
A.5 PowerAnalysis
junctionswithatmostğ‘§conditionsoverğ‘‘continuousfeatures.Then,
Inthissectionweprovetheresultsonthepowerof FSRstatedin itholdsğ‘ (D) â‰¤
(cid:16)ğ‘’3ğ‘‘ğ‘š2(cid:17)ğ‘§
.
Sections4.1and4.2.
L 4ğ‘§3
Wefirstprovideaprobabilisticupperboundtoğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡),the Proof. ConsideradatasetDwithğ‘‘continuousfeatures,andlet
estimateofthesupremumdeviationoffalsediscoveriescomputed [1,ğ‘‘]betheindicesofthesefeatures.Letanyğ´âŠ† [1,ğ‘‘]with|ğ´|=
byAlgorithm1(inline6).Thisresultcanbeappliedtogeneral ğ‘£ â‰¤ ğ‘§,anddefinethelanguageLğ´ âŠ† L asallsubgroupswithğ‘£
languages;wethenshowhowtoapplyittothelanguageofsub- conjunctiontermsinvolvingconditionsonthefeaturesofğ´,suchas
groups.Wedefineğ‘ L(D)asthenumberofdistinctprojectionsof
inequalitiesorintervals.Equivalently,wecanseetheprojectionof
thelanguageLonthedatasetD: Lğ´overthetransactionsofDastheclassofaxis-alignedrectangles
ğ‘ L(D)=|{{ğ‘– :P âˆˆğ‘  ğ‘–},P âˆˆL}|. inRğ‘£ .ItisknownthattheVC-dimensionofthisclassis2ğ‘£(Problem
6.5in[38]).Therefore,fromSauer-Shelah-Perlesâ€™Lemma(Lemma
N t Tr hio v eTt ie vhal at eh lu o ua p r et p, e oed m fri ğ‘‘ff b 1 Ëœ(e 5o Rr .ue â˜…nn L ,dt e ğœ‡l Ë‡ty i )s ğœ†f cğ‘r oâˆˆo mLm ( p( 0D u| ,L t1 e) ) d| ,, â‰¤ ağ‘ bn y2L dğ‘š F( Sğœ”)D Ë†. R=) ini ğœ‡s Ë† l( ia n1l ew âˆ’ 6a ğœ‡y Ë‡ o)s fs Aa u lfi p gn
P
ori âˆˆt ie
tL
hv mfa Pl 1u (e D is( )a . 6 D.1 ğ‘0 isin ğ‘ ([ L D3 ğ´8 )(]) â‰¤D,t ) âˆ‘ï¸he â‰¤n ğ‘(cid:205)um ğ‘–2 =ğ‘£b 1 (e (cid:0) Dr ğ‘š ğ‘–ğ‘ )(cid:1)L â‰¤â‰¤ğ´ âˆ‘ï¸(cid:0)( ğ‘§ğ‘’D 2ğ‘š ğ‘£) (cid:18)(cid:1) ğ‘‘2o (cid:19)ğ‘£f . (cid:16)d F ğ‘’i rs ğ‘šoti mn (cid:17)c 2a ğ‘£t np â‰¤r uo n (cid:16)je ğ‘’ioc ğ‘št ni (cid:17)o b 2n o ğ‘§s u (cid:18)o n ğ‘’f d ğ‘‘L , (cid:19)ğ´
ğ‘§
,on
L Lğ´ ğ‘£ 2ğ‘£ 2ğ‘§ ğ‘§
ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡) â‰¤âˆšï¸‚ 2ğœ”Ë†ln(ğ‘ L(D))
+âˆšï¸„
ln( ğœ†1) + ln(ğ‘ L(D))
obtainingthesğ´
tatement.
ğ‘£=1
â–¡
ğ‘š 2ğ‘ğ‘š 3ğ‘š
withprobabilityatleast1âˆ’ğœ†. CombiningLemma16andTheorem15,weobtainthefollowing
Corollary.
Proof. Toobtainthestatement,wefirstproveanupperbound
totheexpectationE vâˆ¼ğ¼(ğœ‡Ë†)[ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)],thatis
E [ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)]
â‰¤âˆšï¸‚ 2ğœ”Ë†ln(ğ‘ L(D))
+
ln(ğ‘ L(D))
,
vâˆ¼ğ¼(ğœ‡Ë†) ğ‘š 3ğ‘š
16Corollary17. LetLbethelanguageofsubgroupscomposedby Thefollowingresultestablishesconcentrationboundsforfunc-
conjunctionswithatmostğ‘§ conditionsoverğ‘‘ continuousfeatures. tionsthatsatisfytheALC.
Thenthevalueğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)computedbyFSRinline6ofAlgorithm1is
Theorem19(Corollary5.1[13]). Letğ‘“ satisfytheALCwithpa-
ğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡) â‰¤âˆšï¸„ 2ğœ”Ë†ğ‘§ln ğ‘š(ğ‘’3 4ğ‘‘ ğ‘§ğ‘š 32) +âˆšï¸„ ln 2ğ‘( ğ‘šğœ†1) +ğ‘§ln( 3ğ‘’ ğ‘š3 4ğ‘‘ ğ‘§ğ‘š 32) r aa nm de lt ee tr ğ¶sğ‘ =ğ‘–,ğ‘– (cid:205)âˆˆ ğ‘› ğ‘–=[ 1ğ‘› ğ‘] ğ‘–2, .w Ti hth enre itsp he oc lt dt sotherandomvariablesğ‘‹ 1,...,ğ‘‹ ğ‘›,
Pr(ğ‘“ >E[ğ‘“]+ğ‘¡),Pr(ğ‘“ <E[ğ‘“]âˆ’ğ‘¡) â‰¤exp(âˆ’2ğ‘¡2/ğ¶).
withprobabilityatleast1âˆ’ğœ†.
A.5.1 PoweranalysisofFSR-C. ToproveTheorem8,regarding Wenowprovethatthesum(cid:205)ğ‘› ğ‘–=1â„“ ğ‘– isafunctionthatsatisfythe
ALC,thusissharplyconcentratedtowarditsexpectation.
thepowerof FSR-C,wefirstdescribethemodelweassumeforthe
distributionofthealternativehypotheses,i.e.,thesetofpatterns Theorem20. Let{â„“ ğ‘–,ğ‘– âˆˆ [1,ğ‘›]}beasetofrandomvariablesdis-
withqP >0.Weassumethatthequalityofpatternscorrelatedwith tributedaccordingtoğ‘Š ğ‘›({ğ‘š ğ‘–,ğ‘¤ ğ‘–}).Denoteğ‘‹ ğ‘– =â„“ ğ‘– andthefunction
thetargetfollowstheWalleniusâ€™noncentralhypergeometricdis- ğ‘“ =(cid:205)ğ‘› ğ‘–=1ğ‘‹ ğ‘–.Then,itholds
tribution[42],ageneralizationofthehypergeometricdistribution
Pr(ğ‘“ >E[ğ‘“]+ğ‘¡),Pr(ğ‘“ <E[ğ‘“]âˆ’ğ‘¡) â‰¤exp(âˆ’2ğ‘¡2/ğ‘›).
thatallowstomodelabiasedrandomsamplingofacontingency
tablewithfixedmarginals.Wedefinethemodelğ‘Š ğ‘›({ğ‘š ğ‘–,ğ‘¤ ğ‘–})that Proof. Weprovethatğ‘“ satisfytheALC.Foranyğ‘– âˆˆ [1,ğ‘›],
describesthedistributionofasequenceofbinaryrandomvariables ğ‘› ğ‘›
â„“ 1,...,â„“ ğ‘›fortheweightedsamplingofğ‘›elementsfromasetofğ‘š
1
E(cid:104)âˆ‘ï¸
ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=1(cid:105) âˆ’E(cid:104)âˆ‘ï¸
ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=0(cid:105)
itemswithlabel1andğ‘š 0itemswithlabel0;theparametersğ‘¤ 0and ğ‘—=1 ğ‘—=1
ğ‘¤ 1,with1â‰¤ğ‘¤ 0 <ğ‘¤ 1,arerespectivelytheweightsofitemswith (cid:104) âˆ‘ï¸ğ‘› (cid:105) (cid:104) âˆ‘ï¸ğ‘› (cid:105)
label0and1.Thefactğ‘¤ 1 >ğ‘¤ 0expressesthebiastowardsampling =1+E ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =1 âˆ’E ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =0
itemswithlabel1.Thefirstelementâ„“ 1issampledaccordingtothe ğ‘—=ğ‘–+1 ğ‘—=ğ‘–+1
weightedproportionoftheitems,suchthat (cid:104) âˆ‘ï¸ğ‘› (cid:105) (cid:104) âˆ‘ï¸ğ‘› (cid:105)
Pr(â„“ 1=1)=
ğ‘š
ğ‘¤ğ‘š
1
+ğ‘¤
ğ‘š1
ğ‘¤
.
â‰¤1+E ğ‘—=ğ‘–+1ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =0 âˆ’E ğ‘—=ğ‘–+1ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =0 =1.
1 1 0 0
The second element â„“ 2 is taken according to the weighted pro- Wethenprovetheotherdirection:
portion of the remaining items, therefore dependending on the (cid:104)âˆ‘ï¸ğ‘› (cid:105) (cid:104)âˆ‘ï¸ğ‘› (cid:105)
outcomeofthefirstchoice.Ingeneral,weobtainthat E ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =0 âˆ’E ğ‘‹ ğ‘— |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =1
ğ‘šğ‘–ğ‘¤
ğ‘—=1 ğ‘—=1
Pr(â„“ ğ‘– =1)= ğ‘šğ‘– 1ğ‘¤ 11 +ğ‘š1 ğ‘– 0ğ‘¤ 0, =E(cid:104) âˆ‘ï¸ğ‘› ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=0(cid:105) âˆ’1âˆ’E(cid:104) âˆ‘ï¸ğ‘› ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=1(cid:105)
whereğ‘šğ‘– 1=ğ‘š 1âˆ’(cid:205)ğ‘– ğ‘—âˆ’ =1 1â„“ ğ‘— andğ‘šğ‘– 0=ğ‘š 0âˆ’(cid:205)ğ‘– ğ‘—âˆ’ =1 1(1âˆ’â„“ ğ‘—)are,respec- ğ‘—=ğ‘–+1
ğ‘›
ğ‘—=ğ‘–+1
ğ‘›
tively,thenumberofremainingitemswithlabel1andlabel0,i.e., â‰¤1+E(cid:104) âˆ‘ï¸ ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=1(cid:105) âˆ’1âˆ’E(cid:104) âˆ‘ï¸ ğ‘‹
ğ‘—
|Xğ‘–âˆ’1,ğ‘‹
ğ‘–
=1(cid:105)
theonesthatarenotsampledinprevioussteps.Wemayobserve
ğ‘—=ğ‘–+1 ğ‘—=ğ‘–+1
that,asthebiasgoesto0(i.e.,ğ‘¤ 1 â†’ ğ‘¤ 0),thisdistributioncon- =0.
vergestothe(standard)hypergeometricdistribution.Weremark
thatadirectcalculationofmeanandtheprobabilitymassfunction
Weconcludethatğ‘“ satisfytheALCwithğ‘
ğ‘–
=1,forall1â‰¤ğ‘– â‰¤ğ‘›,
ofthenoncentralhypergeometricdistributionabove,thereforethe andtheconcentrationboundsfollowfromTheorem19. â–¡
computationofexacttailbounds,isextremelyunwieldy.Moreover,
Using the result above, we prove a probabilitic lower bound
therandomvariables{â„“ ğ‘–,ğ‘– âˆˆ [1,ğ‘›]}areclearlynotindependent,
totheobservedqualityqÂ¯P(D) ofapattern P.Forany P âˆˆ L,
thereforestandardconcentrationresults(e.g.,Chernoff-Hoeffding letğ‘› =ğ‘šfP(D)bethenumberoftransactionsofD whereP is
bounds)donotapplydirectly. supported,andassumew.l.o.g.that{ğ‘– :P âˆˆğ‘  ğ‘–,ğ‘– âˆˆ [1,ğ‘š]}= [1,ğ‘›].
Toovercometheseissues,weleverageanadvancedconcentra- Wedefineğ‘‹ ğ‘– = â„“ ğ‘– forallğ‘– âˆˆ [1,ğ‘›],whereâ„“ ğ‘– followsthebiased
tionboundformartingales,whichalsoappliestorandomvariables
samplingdistributiondescribedabove.
thatarenotnecessarelyindependent[13].Weusethefollowing
version of the method of bounded differences [27]. For a given Proposition21. Itholds
s {e ğ‘‹t ğ‘—,o ğ‘—f âˆˆran [1d ,o ğ‘–]m }.variablesğ‘‹ 1,...,ğ‘‹ ğ‘›,weuseXğ‘– todenotetheset
Pr(qÂ¯P(D) â‰¤qPâˆ’ğ‘¡)
â‰¤exp(cid:18) fâˆ’ P2 (ğ‘š Dğ‘¡2 )(cid:19)
.
ditiD onefi (n Ai Lti Con )w18 it. hA paf ru an mct ei to en rsğ‘“ ğ‘ ğ‘–s ,a ğ‘–t âˆˆisfi [e ğ‘›s ],t whe itA hv re er sa pg ee cd ttL oip ts hc eh rit az nC doo mn- theP fr uo no cf t. ioD ne ğ‘“fin inet th he ef su tn ac teti mon enğ‘” t= ofğ‘š1 T(cid:205) heğ‘› ğ‘–= o1 re(â„“ mğ‘–âˆ’ 2ğœ‡ 0( ,D w) e). oC bo sn ers vid ee tr hin ag
t
variablesğ‘‹ 1,...,ğ‘‹ ğ‘›ifforanyğ‘ ğ‘–,ğ‘ ğ‘–â€², it holdsğ‘” = ğ‘“/ğ‘š âˆ’ ğœ‡(D), and that ğ‘› = ğ‘šfP(D). From these
|E[ğ‘“ |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =ğ‘ ğ‘–]âˆ’E(cid:2)ğ‘“ |Xğ‘–âˆ’1,ğ‘‹ ğ‘– =ğ‘ ğ‘–â€²(cid:3) | â‰¤ğ‘ ğ‘–, observations,weapplyTheorem20tothefunctionğ‘“ =ğ‘š(ğ‘”+ğœ‡(D)),
obtainingthestatementaftersimplemanipulationsofther.h.s.. â–¡
for1â‰¤ğ‘– â‰¤ğ‘›.
WenowextendProposition21toobtainaboundvalidsimoulta-
neouslyforallpatternsofthelanguageL.
17Proposition22. DefinefË†(D)=sup PfP(D).Withprobability Proposition24. LetLbethelanguageofsubgroupscomposed
â‰¥1âˆ’ğ›¿,itholds byconjunctionswithatmostğ‘§conditionsoverğ‘‘continuousfeatures,
âˆšï¸„ anddefinefP =E D[fP(D)].Withprobabilityâ‰¥ 1âˆ’ğ›¿ w.r.t.Dit
qÂ¯P(D) â‰¥qPâˆ’
2fË†(D)ln( ğ‘šğ‘ L(D)/ğ›¿)
,âˆ€P âˆˆL.
holds,forallP âˆˆL,
âˆšï¸„
Proof. Definetheevent
âˆšï¸„
fP(D) â‰¤fP+
2ğ‘§+ln(cid:0)(cid:205) ğ‘–ğ‘§
= 21
ğ‘š(cid:0)ğ‘‘ ğ‘–(cid:1)(cid:1)+ln(cid:0) ğ›¿2(cid:1)
,
Thestateğ¸ mP en= tâ€œ hqÂ¯ oP ld( sD if) Pâ‰¤ r(q âˆªP Pâˆ’
ğ¸
P)2 â‰¤fË†( ğ›¿D .N)l on w( ğ‘šğ‘ ,dL en(D ot) e/ tğ›¿ w) oâ€.
patterns
qP(D)
â‰¥qPâˆ’âˆšï¸„ 2ğ‘§+ln(cid:0)(cid:205) ğ‘–ğ‘§
= 21
ğ‘š(cid:0)ğ‘‘ ğ‘–(cid:1)(cid:1)+ln(cid:0) ğ›¿2(cid:1)
.
P 1,P 2,suchthattheyaresupportedbythesamesetoftransactions: Proof. ConsideradatasetDwithğ‘‘continuousfeatures,and
{ğ‘– :P
1
âˆˆğ‘  ğ‘–}={ğ‘– :P
2
âˆˆğ‘  ğ‘–}.ThisimpliesthatqÂ¯P 1(D) =qÂ¯P 2(D) let[1,ğ‘‘]betheindicesofthesefeatures.Letanyğ´ âŠ† [1,ğ‘‘]with
forallpossiblelabels,butalsothatqP =qP ,sincethetwoquali- |ğ´|=ğ‘£ â‰¤ğ‘§,anddefinethelanguageLğ´ âŠ†Lasallsubgroupswith
1 2
tiesarefunctionsofthesamesetoflabels.Fromtheseobservations, ğ‘£conjunctiontermsinvolvingconditionsonthefeaturesofğ´,such
itholdsğ¸ P âˆªğ¸ P =ğ¸ P .Therefore,theunionoverallpatternscan asinequalitiesorintervals.
1 2 1
bereplacedbytheunionovertheoneswithdistinctprojections, WefirstprovetheboundforfP(D).ForanyP âˆˆLğ´,recallthe
whosenumberisatmostğ‘ L(D).Fromanunionboundoverthese functionsğ‘“ P(ğ‘ ) =1[P âˆˆğ‘ ],andletFğ´ ={ğ‘“ P : P âˆˆ Lğ´}bethe
events,andusingthetailboundofProposition21withthefact familyofsuchfunctions.Itisimmediatetoobservethattheaverage
fP(D) â‰¤fË†(D),wehave valueofğ‘“ P overDisequaltofP(D).Asdiscussedpreviously,Fğ´
Pr(âˆª Pğ¸ P) â‰¤ğ‘ L(D)exp(cid:0)âˆ’2ğ‘šğ‘¡2/fË†(D)(cid:1). Vis Ce -q du imiv ea nle sn iot nto 2ğ‘£th (Pe rc ol ba ls es mof 6.a 5x ii ns- [a 3li 8g ]n ).e Wd ere ac pta pn lygl Tes hein orR emğ‘£ , 2w 3it th
o
Imposingther.h.s.oftheinequalitytobeâ‰¤ğ›¿,andsolvingforğ‘¡,we
theparticularcaseofthebinaryfunctionfamilyFğ´,obtainingthat
obtainthestatement. â–¡ (cid:16) (cid:17)
Pr sup |fPâˆ’fP(D)| >ğ‘¡ â‰¤exp(2ğ‘£âˆ’2ğ‘¡2ğ‘š).
Finally,weprovethepowerguaranteesforFSR-C. ğ‘“ PâˆˆFğ´
Fromanunionboundoverallsubsetsğ´âŠ† [1,ğ‘‘]withcardinality
ProofofTheorem8. Toobtainthestatement,weshowthat
theconditionqP â‰¥ ğœ‰,forsomeğœ‰ > 0sufficientlylarge,implies
â‰¤ğ‘§,wehave
thatPisreportedinoutputwithprobabilityâ‰¥ 1âˆ’ğ›¿.Infact,we Pr(cid:16) sup sup |fPâˆ’fP(D)| >ğ‘¡(cid:17)
havethattheimplicationqP â‰¥ğœ‰ =â‡’ qÂ¯P(D) â‰¥ğœ‰âˆ’ğœ€ 1holdswith ğ´ ğ‘“ PâˆˆFğ´
âˆšï¸‚ 2fË†(D)ğ‘§ln(ğ‘’3ğ‘š2ğ‘‘) âˆ‘ï¸ (cid:16) (cid:17) âˆ‘ï¸ğ‘§ (cid:18)ğ‘‘(cid:19)
probabilityâ‰¥1âˆ’ğ›¿/2forallP âˆˆL,whereğœ€ 1= ğ‘š 2ğ‘§3ğ›¿ â‰¤ Pr sup |fPâˆ’fP(D)| >ğ‘¡ â‰¤ ğ‘– exp(2ğ‘–âˆ’2ğ‘¡2ğ‘š).
isobtainedfromProposition22(replacingğ›¿byğ›¿/2,andusingthe ğ´ ğ‘“ PâˆˆFğ´ ğ‘–=1
upperboundtoğ‘ L(D)fromLemma16).Consequently,weseek Settingther.h.s.tobeâ‰¤ğ›¿/2,weobtainthefirstbound.
asufficientconditiontoensurethatPisreportedinoutput;this WenowfocusontheboundforqP(D).ForanyP âˆˆLğ´,recall
conditionisqÂ¯P(D) â‰¥ğœ‰âˆ’ğœ€ 1 â‰¥ğœ€,andalsoğœ‰ â‰¥ğœ€ 1+ğœ€,whereğœ€isas thefunctionsğ‘” P(ğ‘ ,â„“)=1[P âˆˆğ‘ ](â„“âˆ’ğœ‡),andletGğ´ ={ğ‘” P :P âˆˆ
definedinCorollary7.Combiningthisinequalitywiththeupper Lğ´}bethefamilyofsuchfunctions.Itisimmediatetoobserve
boundtoğ‘‘Ëœ(Râ˜…,ğœ‡Ë‡)ofTheorem15(settingğœ†=ğ›¿/2),weobtainthe thattheaveragevalueofğ‘”
P
overDisequaltoqP(D).Byusing
lowerboundtoqP inthestatement,whichholdswithprobability Lemma3.6of[36],weobtainthatthepseudodimensionofGğ´is
â‰¥1âˆ’ğ›¿fromaunionbound. â–¡ equaltotheVC-dimensionofFğ´,whichis2ğ‘£.Therefore,weapply
A.5.2 PoweranalysisofFSR-U. Thefollowingisarestatementof
Theorem23toGğ´,having
(cid:16) (cid:17)
Theorem5of[24],thatprovidesuniformconvergenceboundsfor Pr sup |qPâˆ’qP(D)| >ğ‘¡ â‰¤exp(2ğ‘£âˆ’2ğ‘¡2ğ‘š).
familiesoffunctionswithboundedpseudodimension[35,38]. ğ‘” PâˆˆGğ´
Theorem23. LetF beafamilyoffunctionsfromadomainXto Wecompletetheprooffollowingthesamestepsforthefrequencies.
â–¡
[ğ‘,ğ‘] âŠ‚Rwithpseudodimentionğ‘ƒ(F) â‰¤ğ‘Ÿ.LetS={ğ‘  1,...,ğ‘  ğ‘š}be
arandomsampleofsizeğ‘štakeni.i.d.fromadistributionğ›¾.Itholds
WearenowreadytoproveTheorem13.
Pr(cid:32) ğ‘“su âˆˆp F(cid:12) (cid:12) (cid:12)
(cid:12)
(cid:12)E S(cid:34) ğ‘š1 âˆ‘ï¸ ğ‘–ğ‘š =1ğ‘“(ğ‘  ğ‘–)(cid:35) âˆ’ ğ‘š1 âˆ‘ï¸ ğ‘–ğ‘š =1ğ‘“(ğ‘  ğ‘–)(cid:12) (cid:12) (cid:12)
(cid:12)
(cid:12)>ğ‘¡(cid:33) â‰¤exp(cid:18) ğ‘Ÿâˆ’ ğ‘Ëœ(ğ‘ğ‘¡2 âˆ’ğ‘š ğ‘)2(cid:19) , theP vr ao lo uf eo of fğœ€Th dee fio nre em di1 n3. thF ero stm ateth me eng tua isra an nte ue ps po ef rC boo uro nl dla tr oy t1 h7 e,
value ofğœ€ computed by FSR-U in Algorithm 1 with probability
whereğ‘Ëœisanabsoluteconstant.
â‰¥ 1âˆ’ğ›¿/3(sinceğœ† =ğ›¿/3inthedefinitionofğ‘ŸË†).Wenowprovea
Wenotethattheabsoluteconstantğ‘ËœintheTheoremaboveis conditiononthequalityqP forapatterntobereportedinoutput.
estimatedtobeatmost0.5[26]. FromProposition24(replacingğ›¿/2byğ›¿/3),apatternwithqP â‰¥ğœ‰
Usingtheresultabove,weprovethefollowingboundstothe has,withprobabilityâ‰¥1âˆ’ğ›¿/3,itsestimateqP(D) â‰¥ğœ‰âˆ’ğœ€ 1,where
supportsandqualitiesforallsubgroups. âˆšï¸„
ğœ€ =
2ğ‘§+ln(cid:0)(cid:205) ğ‘–ğ‘§ =1(cid:0)ğ‘‘ ğ‘–(cid:1)(cid:1)+ln(cid:0) ğ›¿3(cid:1)
.
1 2ğ‘š
18A.7 DetailsonCNNinterpretation
Moreover,fromtherelationbetweenqP(D)andqÂ¯P(D),itholds
qÂ¯P(D) â‰¥ ğœ‰ âˆ’ ğœ€ 1 âˆ’ ğœ€ ğ‘‡fP(D). Consequently, P is reported in Inthissectionweprovidealldetailsregardingtheapplicationof
output if qÂ¯P(D) â‰¥ ğœ‰ âˆ’ğœ€ 1 âˆ’ğœ€ ğ‘‡fP(D) â‰¥ ğœ€ +ğœ€ ğ‘‡fP(D), so if FSRtointerprettheactivationofneuronsinaCNN.Weconsidered
ğœ‰ â‰¥ğœ€ 1+2ğœ€ ğ‘‡fP(D)+ğœ€.UsingtheupperboundtofP(D)proved
theMNISThandwrittendigitdataset,andtrainaCNNtopredict
inProposition24(replacingğ›¿/2byğ›¿/3),theconditionqP â‰¥ğœ‰ â‰¥ thedigitcontainedineachimage.Followingtheexperimentalsetup
ğœ€ 1+2ğœ€ ğ‘‡(fP+ğœ€ 1)+ğœ€issufficienttoguaranteethat,withprobability of[14],weemployasimpleCNNcomposedby:twoconvolutional
â‰¥1âˆ’ğ›¿,Pisreportedinoutput,obtainingthestatement. â–¡ layers,withrespectively10and40filtersand3Ã—3kernels;each
convolutionallayerisfollowedby2Ã—2maxpoolinganddropoutof
A.6 Baselinemethods
rate0.25;afullyconnectedlayerwith64nodesandReLuactivations;
InthisSectionweprovideadditionaldetailsonthebaselinealgo-
adropoutlayerwithrate0.5;theoutputlayerofsize10withsoftmax
rithmFSR-U-UBconsideredinourexperimentalevaluation.As activations.Wetrainedthenetworkoverthe60000imagesofthe
anticipatedinSection5,itisnotpossibletoapplystandardstatis- trainingset,usingSGDbasedoncategoricalcrossentropyloss,
ticaltechniques(e.g.,Bonferronicorrection)toboundtheFWER
withlearningrate0.01,momentum0.9,12epochs,andbatchsizeof
whenthenumber|L|oftestedhypothesisisunbounded.Therefore, 128,obtaininganaccuracyof0.987onthe10000holdoutinstances.
toovercomethisissueweproceedasfollows.Recallthatğ‘ L(D)is Then,analogouslyto[14],wecomputedtheactivationsofneurons
thenumberofdistinctprojectionsofthelanguageLonthedataset inthefirstfilterofthefirstconvolutionallayeronthe10000testing
D(definedinAppendixA.5).ThekeyideaforFSR-U-UBistoapply instances,obtainingğ‘‘ = 676continuousfeaturesforğ‘š = 10000
aBonferronicorrectionontheğ‘ L(D)distincttestedhypothesis transactions. As binary target, we use the value 1 for all digits
only.Wedosowiththefollowingresult,thatdefinesthevalueofğœ€ containingstraightlinesonly(thedigits1and7),and0forallother
usedbyFSR-U-UBinAlgorithm1toboundtheFWER.Notethat
digits.Doingso,weobtainafractionğœ‡(D)=0.216ofsampleswith
FSR-U-UBdoesnotuseanyresamples,butusesğ‘ L(D)toobtain label1.WeranFSR-Conthisdataset,usingğ‘ =10resamplesand
ananalyticalvalueforğœ€instead. ğ‘§ = 1,toidentifysignificantsubgroupswithFWER â‰¤ 0.05.For
eachneuron,weidentifythemostsignificantsubgroupcontaining
Theorem25. LetDbeadatasetofğ‘šsamplestakeni.i.d.from aconditionoverthecorrespondingcontinuousfeatureğ‘¥.Wefocus
a distributionğ›¾. For anyğ›¿ âˆˆ (0,1), defineğœˆ ğ‘‡ â‰¥ ğœ‡(1âˆ’ ğœ‡),ğœˆ â‰¥ onconditionsofthetypeğ‘¥ â‰¥ ğ‘¡ andğ‘¥ < ğ‘¡,whereğ‘¡ isanyreal
ğœˆ ğ‘‡ sup PâˆˆLâ˜…{E D[fP(D)]},ğ‘Ë† â‰¥ğ‘ L(D),andğœ€as valuedthreshold;theconditionğ‘¥ â‰¥ğ‘¡ denotesthattheneuronğ‘¥ is
ğ‘ŸË†=âˆšï¸„ ln(4 ğ›¿ğ‘Ë† ) wac it ti hva ate vd a, luw eit ah tv mal ou se ts ğ‘¡a .tleastğ‘¡,whileğ‘¥ <ğ‘¡meansthatğ‘¥isinactive,
2ğ‘š
InFigure4weshowtheresultsofthisexperiment.Figures4-
ğ‘‘Ë†=ğ‘ŸË†+(cid:118)(cid:117)(cid:116)(cid:32)
2ğœˆ
ğ‘‡
ln(cid:0) ğ›¿4(cid:1)(cid:33)2
+
2ğ‘ŸË†ln(cid:0) ğ›¿4(cid:1)
+
2ğœˆ
ğ‘‡
ln(cid:0) ğ›¿4(cid:1) ( la a) bea ln 1d (( cb o) rs rh eo spw ot nh de ina gve tr oa tg he ea dc it giv ita sti 1on anv dal 7u )e as no dfa lall bn ele 0ur (o an lls ow thit eh
r
ğ‘š ğ‘š ğ‘š
digits).Then,inFigure4-(c)weshowtheneuronswithactivation
(cid:118)(cid:116) (cid:16) (cid:17) conditionssignificantlyassociatedtothetargetlabel1:neurons
ğœ€ (cid:17)ğ‘‘Ë†+
2ln(cid:0) ğ›¿4(cid:1) ğœˆ+2ğ‘‘Ë†
+
ln(cid:0) ğ›¿4(cid:1)
.
that are significantly activated, i.e., with conditionsğ‘¥ â‰¥ ğ‘¡, are
ğ‘š 3ğ‘š showninred,whileneuronsthataresignificantlyinactive,i.e.,with
Withprobabilityatleast1âˆ’ğ›¿overDitholds conditionsğ‘¥ <ğ‘¡,areshowninblue.Thecolorintensity(i.e.,toward
red or blue) depends on the threshold ğ‘¡: for activated neurons
Ps âˆˆu Lp â˜…{qP(D)}â‰¤ğœ€.
itsaturatesatthemaximumactivationvalue,whileforinactive
neuronsattheminimum.Interestingly,weobservethattheneurons
Proof. We follow similar steps taken in the proof of Theo-
inthisfilteraresignificantlyactivatedinthepresenceofacentral
rem 11; however, the key difference is in the upper boundğ‘ŸË† to
verticalstroke(redpixels),thatspecificallycharacterizesthedigits
E Râ˜…[ğ‘‘Ëœ(Râ˜…) |A].Wehave,usingHoeffdingâ€™sinequalityandan
1and7(Figure4-(a)).Weremark,however,thatthisobservation
unionbound,thatforanyğ‘¡ â‰¥0
isnotimmediatefromtheaverageactivationsalone,andmaybe
Pr (cid:16) ğ‘‘Ëœ(Râ˜… ) â‰¥ğ‘¡(cid:17) â‰¤ğ‘ L(D)exp(cid:16) âˆ’2ğ‘šğ‘¡2(cid:17) â‰¤ğ‘Ë†exp(cid:16) âˆ’2ğ‘šğ‘¡2(cid:17) . lostwhentheactivationvaluesarebinarized,sinceFSRidentifies
Râ˜… subgroupsthatpreciselyseparatethetwoclassesofdigitsbyusing
Thisimpliesthat,withprobabilityâ‰¥1âˆ’ğ›¿/4overRâ˜… ,itholds granularthreshouldvalues.Onthecountrary,neuronsthatare
âˆšï¸„ significantlyinactive(bluepixels)aretheonessurroundingthis
ğ‘‘Ëœ(Râ˜… ) â‰¤ ln(4 ğ›¿ğ‘Ë† ) . verticalarea,formingtworoundedshapes,whicharetypicalofthe
2ğ‘š otherdigits(Figure4-(b)).Interestingly,theseblueregionsseemto
Takingtheexpectationw.r.t.Râ˜… ,conditionallyonA,provesthat shapethenegativeofthedigits1and7.
E Râ˜…[ğ‘‘Ëœ(Râ˜…)|A] â‰¤ğ‘ŸË†andgivesthestatement. â–¡ FromthisexperimentweconcludethatFSRcanbeeffectively
appliedtoidentifycomplexpatterns,suchastheonesfortheinter-
pretationoftheactivationswithinaneurallayer.
190 0.6
5 0.5
0.4
10
0.3
15
0.2
20
0.1
25 0.0
0 5 10 15 20 25
(a) (b) (c)
Figure4:Averageactivationofneuronsofthefirstfilterinthefirstconvolutionallayer,forthedigits1and7(a)andforthe
otherdigits(b).(c):neuronsthataresignificantlyactivatedforthedigits1and7(inred)andinactive(inblue)identifiedbyFSR.
20