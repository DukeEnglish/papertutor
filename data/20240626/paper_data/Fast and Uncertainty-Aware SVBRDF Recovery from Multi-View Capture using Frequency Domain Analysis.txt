Fast and Uncertainty-Aware SVBRDF Recovery from Multi-View Capture
using Frequency Domain Analysis
RUBENWIERSMA,DelftUniversityofTechnology,AdobeResearch,TheNetherlands
JULIENPHILIP,AdobeResearch,NetflixEyelineStudios,UK
MILOÅ HAÅ AN,AdobeResearch,USA
KRISHNAMULLIA,AdobeResearch,USA
FUJUNLUAN,AdobeResearch,USA
ELMAREISEMANN,DelftUniversityofTechnology,TheNetherlands
VALENTINDESCHAINTRE,AdobeResearch,UK
Spherical Harmonics Relighting
Color Our estimate 5s Mitsuba estimate 70s
Metallicity
Roughness
Uncertainty
Fig.1. Wepresentfastmulti-viewmaterialacquisitionforobjectscapturedinuncontrolledsetups(left).Weproposetobuilduponandextendthesignal
processingframeworkforinverserenderingproposedbyRamamoorthiandHanrahan[2001]:weimprovethemodelwithshadowingandmaskingandpropose
alightweightobjectivefunctionforBRDFfittingusingsphericalharmonicspowerspectra(center).Usingthisobjective,weproposeanuncertaintyestimation
approachrelyingonstatisticalentropy.Weshowthatourmaterialestimationissignificantlyfasterthanpreviousworkandachievessimilarorbetterresults.
Relightableobjectacquisitionisakeychallengeinsimplifyingdigitalasset quantifytheuncertaintyoftheestimation,basedontheavailabledata,high-
creation.Completereconstructionofanobjecttypicallyrequirescaptur- lightingtheareasforwhichpriorsoradditionalsampleswouldberequired
inghundredstothousandsofphotographsundercontrolledillumination, forimprovedacquisitionquality.Wecompareourapproachtoprevious
withspecializedequipment.Therecentprogressindifferentiablerendering workandquantitativelyevaluateourresults,showingsimilarqualityas
improvedthequalityandaccessibilityofinverserenderingoptimization. previousworkinafractionofthetime,andprovidingkeyinformationabout
Nevertheless,underuncontrolledilluminationandunstructuredviewpoints, thecertaintyoftheresults.
thereisnoguaranteethattheobservationscontainenoughinformationtore-
CCSConcepts:â€¢Computingmethodologiesâ†’Reflectancemodeling;
constructtheappearancepropertiesofthecapturedobject.Wethuspropose
3Dimaging;Appearanceandtexturerepresentations.
toconsidertheacquisitionprocessfromasignal-processingperspective.
Givenanobjectâ€™sgeometryandalightingenvironment,weestimatethe AdditionalKeyWordsandPhrases:Objectacquisition,Appearancecapture,
propertiesofthematerialsontheobjectâ€™ssurfaceinseconds.Wedosoby Inverserendering
leveragingfrequencydomainanalysis,consideringtherecoveryofmate-
ACMReferenceFormat:
rialpropertiesasadeconvolution,enablingfasterrorestimation.Wethen
RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,El-
marEisemann,andValentinDeschaintre.2024.FastandUncertainty-Aware
Authorsâ€™addresses:RubenWiersma,rubenwiersma@gmail.com,DelftUniversityof SVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnal-
Technology,AdobeResearch,TheNetherlands;JulienPhilip,AdobeResearch,Netflix
ysis. 1,1(June2024),17pages.https://doi.org/10.1145/nnnnnnn.nnnnnnn
EyelineStudios,UK;MiloÅ¡HaÅ¡an,AdobeResearch,USA;KrishnaMullia,AdobeRe-
search,USA;FujunLuan,AdobeResearch,USA;ElmarEisemann,DelftUniversity
ofTechnology,TheNetherlands;ValentinDeschaintre,deschain@adobe.com,Adobe 1 INTRODUCTION
Research,UK.
Objectreconstructionishighlyattractiveforavarietyofapplica-
tions:fromcreatingassetsandenvironmentsformoviesandvideo
2024.XXXX-XXXX/2024/6-ART$15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn games,topreservingcultural-heritageobjectsdigitally.Completely
,Vol.1,No.1,Article.Publicationdate:June2024.
4202
nuJ
52
]VC.sc[
1v47771.6042:viXra2 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
capturing the appearance properties of an object would require Toallowmeaningfulanalysisorefficiencygains,wemakethe
hundredsofphotographsundercontrolledviewpointsandlighting assumptionthatthegeometryandlightingareestimatedorcap-
conditions.Unfortunately,finecontrolofthelightingandviewing turedusingexistingmethods.ForgeometrywecanuseSDFextrac-
conditionsisinconvenient,andimpossibleinmanysetups,suchas tion[RosuandBehnke2023]orscanning[Kuangetal.2023],while
outdoorsorinacrowdedmuseum.Insuchscenariosonlyamore lightingcanbecapturedusingachromeballoranomnidirectional
â€œpassiveâ€captureofobjectappearanceispossible.Inthiswork,we camera.Thisisunlikerecentinverserenderingmethods,which
thereforeassumenocontroloverlightingandsupposethatviews assumeallcomponentsareunknown[Munkbergetal.2022;Sun
arecapturedinanunstructuredmanner.Whilethistypeofcap- etal.2023].Ourunderlyinggoalistomakethebestuseoftheavail-
turecanbeenoughtorecoverthegeometryofanobject,itismore abledataandtobetterunderstandwheresignalismissing,before
challengingtoacquireaccurateappearanceproperties. resortingtodata-drivenoradhocpriors.
RecentapproachesforBRDFrecoveryfrom(under-constrained) FollowingRamamoorthiandHanrahan[2001],wemodelreflected
multi-viewcapturecanmainlybeclassifiedintotwocategories: lightfromasurfaceasaconvolutionofBRDFandincominglighton
(a)acquisitionfromonlyafewimages,relyingondeepnetwork thehemisphere.ToobtaintheBRDF,wereconstructthisconvolu-
priors[Deschaintreetal.2019]and(b)optimizingdirectlyforap- tionfilterandmapittoanalyticalBRDFparameters.Workinginthe
pearance parameters using differentiable rendering [Jakob et al. frequencydomain,aconvolutionisaper-coefficientmultiplication,
2022;Munkbergetal.2022].Themethodstypicallydonotprovide which greatly simplifies analysis and computational complexity.
accuracyguarantees,andthelatteronesoptimizeanill-posedsys- WeproposeseveralkeyimprovementstoRamamoorthiandHan-
tem,withoutprovidinganyuncertaintymeasure.Theoptimization rahanâ€™sapproach.First,wehandleirregularlight-fieldsampling
methodsareoftenslow,duetorequiringmanyiterationsoffull bytransformingtheobservationsofboththeoutgoingandincom-
differentiablerenderingforeveryview. inglightintosphericalharmonics,usinganefficientregularized
Itiseasytomissinformationaboutthespecularbehaviorofan least-squaresapproach.Hereby,wecanusesparseirregulardata
objectwhenlightingandviewpointsareuncontrolled,asitrequires fromtheviewsamplingaswellasregularFibonaccisamplesfrom
aluckyalignmentoflightsourcesandviewingdirections.Toshine theenvironmentlightinginacommonrepresentation.Next,we
ametaphoricallightonthismissinginformation,weproposeto includetheshadowingandmaskingtermsoftheBRDF,discarded
jointlyestimatetheobjectâ€™sSVBRDFparametersandtheassociated byRamamoorthiandHanrahan[2001],andupdatethespherical
uncertainty.Weimproveuponaseminalworkstudyinginverse harmonicscoefficientsduringaparametergradient-descentopti-
renderingproblemsfromasignal-processingperspectiveinthefre- mization.Weobtainresultsonparwithafull-featureddifferentiable
quencydomain[RamamoorthiandHanrahan2001].Movingtothe renderingsystem[Jakobetal.2022].Weleveragetherelationship
frequencydomainallowsonetogaininsightabouttheexpected betweenthesphericalharmonicpowerspectraofincomingandout-
stabilityofaninverserenderingsystemtosolve.Forexample,the goinglighttodefineanewobjectivefunctionforinverserendering.
incominglightmustcontainenoughamplitudeinhigh-frequency Asthisobjectiveisextremelylightweighttoevaluate,bothinterms
bandstorecovercertainroughnessvaluesforamicrofacetBRDF. oftimeandmemory,wecanevaluatetheerrorformanyparame-
Otherwise,noiseinthesignalcouldmaketheinversionunstable. tercombinationsinparallel.Weinterprettheerrorasaposterior
Without any amplitude, the inversion would be ill-conditioned, distribution,encodinghowlikelyeachmaterialparametercombi-
but this is unlikely to occur for natural lighting. Unfortunately, nationis,giventheobservations.Thisstatisticalperspectivelets
mappingtheanalysisinthefrequencydomaintopracticalalgo- uscomputetheentropyoftheposteriordistributionasameasure
rithmsisnon-trivial:Forinstance,samplesareoftenassumedto ofuncertainty.Intuitively,observationsthatcanbewellexplained
beequallyspacedforfrequencyanalysiswhilewedealwithun- bymanydifferentparametercombinationsleadtoaâ€˜spread-outâ€™
structuredsparsesamples.Moreover,initsoriginalformulation, probabilitydistributionwithhighentropy,whichreflectsahigher
theconclusionsfromRamamoorthiandHanrahan[2001]requirea uncertainty.Incontrast,whenonlyafewparametercombinations
prioriknowledgeoftheBRDFtoconcludewhethertheinversion arelikely,thedistributionisconcentratedwithlowentropy,reflect-
problemiswell-conditioned. inghighcertainty.Similarly,wecanestimatetheinformationgain
Inthiswork,wetackletheseproblemswithanimprovedfrequency- fromanewviewbyestimatingitsimpactonentropy,potentially
basedformulation,providingbothcomputationalefficiencyandin- providinginteractiveguidanceduringcapture.Thisuncertaintyis
sightintotheunderlyinguncertainty.OurSVBRDFestimationisas alsohighlyrelevanttoweighpriors,increasingpriorweightsfor
accurateasdifferentiablerendering-basedoptimizationand13âˆ’35 uncertainestimations.
timesfasterthanthestate-of-the-artdifferentiablepathtracer,Mit- Wevalidateourmaterialparametersanduncertaintyestimations
suba3[Jakobetal.2022].ByfinetuningourresultswithMitsuba, inbothsyntheticandrealacquisitionconditions,comparingthe
weachievebetterrelightingresults(+0.5dBPSNR)inlessthana estimationwithrecentmethods.Oursolutionperformsonparwith
thirdofthetime.Thankstoourextensionofthesignalprocessing state-of-the-artwhilebeing13timesfasterandprovidinguncer-
framework,weobtainanaccurateestimateofstatisticalentropy, tainty.Further,wevalidateourrefinedsignal-processingframework
interpretedasanuncertaintymeasureforeachsurfacepoint.We throughablationstudies,demonstratingclearimprovementover
showthatthisuncertaintycanbeusedtoimproveacquisitionby RamamoorthiandHanrahan[2001].Insummary,weenablefastma-
informationsharingorprovidinginformationabouttheinformation terialreconstructionanduncertaintyestimationviacontributions
providedbyagivenview. tothespaceofSVBRDFestimationfrommulti-viewcapturesunder
naturallighting:
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 3
â€¢ afrequency-spacemethodusingspherical-harmonicspower partofthematerialpropertiesarelikelyfaithfullyreconstructed
spectraforefficientBRDFapproximationandparameterex- andforwhichpartswesimplydonothaveenoughinformation.
plorationfromsparse,irregularsamples,
â€¢ weimprovetheconvolutionapproximationofRamamoorthi
2.2 DatapriorsforCapture
andHanrahanbyincorporatingshadowingandmasking,
â€¢ we quantify uncertainty in BRDF recovery by leveraging Various approaches propose using data-based priors to simplify
statisticalentropy, andenablelow-informationacquisition,allowingforestimating
â€¢ weevaluatevariousapplicationsforimprovedreconstruction (SV)BRDFsfromaslittleasasingleimage.Manysuchapproaches
basedonfastacquisitionanduncertainty. targetflatsurfaces,trainedonalargeamountofdatausingenvi-
ronmentallylitimage(s)[Lietal.2017;Martinetal.2022;Shietal.
Wewillreleaseourimplementationuponacceptance.
2020;Vecchioetal.2023]orflash-litimage(s)[Deschaintreetal.
2018,2019,2020;Guoetal.2021;Shahetal.2023;Zhouetal.2023;
2 RELATEDWORK ZhouandKalantari2021;ZhouandKhademiKalantari2022]for
acquisition.MaterialGAN[Guoetal.2020]andGaoetal.[2019]
Capturingreal-world,spatiallyvarying,surfacereflectancemodels
proposetooptimizeinlatentspacesofdeepneuralnetworks,hereby
fromseveralcameraviewshasbeenalong-standingchallengein
remaininginthemanifoldofvalidmaterials.Inthecontextof3D
computergraphics.Theoperatorthatmapsincominglightfroma
objectacquisition,methodsoftenfocusonmaterialextractionusing
givendirectiontooutgoinglightobservedatanotherdirectionis
afew(orevensingle)flashormulti-focalphotographs[Bossetal.
a6Dfunction,thespatiallyvaryingbidirectionalreflectancedistri-
2020;Deschaintreetal.2021;Fanetal.2023;Lietal.2018].These
butionfunction(SVBRDF).ObtainingSVBRDFsfrommulti-view
approachesareorthogonaltoourmethod,aswefocusonrecov-
imageshastypicallybeenaddressedthrough:optimization,using
eringtheSVBRDFfromtheprovidedsignalwithoutinitialprior,
simplifiedmodels,andusingdata-priorstrainedoneitherrealistic
quantifyingtheuncertaintyoftheprocess.Ouruncertaintycanin
orsyntheticSVBRDFs,orreal-worldmeasurements.
turnbeusedtobetterguidetheuseofpriorstosurfaceregions
whichmostneedit.
2.1 Optimization-basedCapture
Variousmethodsrecovertheassociatedmaterialpropertiesthrough
2.3 Frequency-basedlighttransport
optimization using a set of photographs of an object or surface.
Thistasktypicallyrequiresmanyphotographsandcontrolledlight- Ourworkbuildsonthefrequencyanalysisoflighttransport,in
ing[Aittalaetal.2013;DupuyandJakob2018;Nametal.2018]or particularwiththeideathatBRDFscanbeexpressedaslow-pass
objectorientations[Dongetal.2014]duringacquisitiontoguaran- filters[Durandetal.2005;RamamoorthiandHanrahan2001].From
teethatspeculareffectsaresufficientlyobserved.Someapproaches this,onecanexpressthereflectionoflightwithaBRDFasamulti-
reliedonspecializedhardware,forexampletocapturepolarimetric plicationinthefrequencydomain.Thisideahasbeensuccessfully
information[Hwangetal.2022].Othersproposetorelyonpriors, usedinthecontextofcontrolledillumination[Aittalaetal.2013;
suchasstationarityofthecapturedmaterials[Aittalaetal.2016, Ghoshetal.2007],controllingthefrequencyoflightpatternsto
2015;Henzleretal.2021;Xuetal.2016]tocompensateforlimited estimatetheBRDFfilterparameterthroughadeconvolutionofthe
information.Multiplemethods[Loubetetal.2019;Munkbergetal. reflectedlight.Wedonotassumecontrolofthelightandoperatein
2022;Nimier-Davidetal.2021;Vicinietal.2022]leveragedthere- thespherical-harmonicsfrequencydomainratherthantheFourier
centprogressindifferentiablerenderings[Changetal.2023;Jakob domain([Aittalaetal.2013])orcustombasisfunctions([Ghosh
etal.2022;Laineetal.2020;Nicoletetal.2021,2023;Nimier-David etal.2007]).Thisallowsouranalysistoworkwitharbitrarynatu-
etal.2022,2020,2019;Spielbergetal.2023;Wuetal.2023b;Xuetal. rallightingenvironments.Closesttoourapproachistheworkby
2023;Yanetal.2022]toproposejointoptimizationoflight,geometry, RamamoorthiandHanrahan[2001],whichexplicitlyderivesthe
andmaterialproperties.Recentapproachesbuildonnovelrepresen- conceptofreflectionasconvolutioninasignal-processingframe-
tationsforvolumetricscenes,suchasneuralnetworks[Mildenhall work.Theyfurtheroutlinetheimplicationsofthisperspectiveon
etal.2020]and3DGaussians[Kerbletal.2023],toincludeopti- thewell-posednessofBRDF-andlightestimationfrommulti-view
mizationformaterialproperties[Bietal.2020;Bossetal.2021a,b; inputsandoptimizeforBRDFparametersthroughthefrequency
Engelhardtetal.2024;Jinetal.2023;Maoetal.2023;Srinivasan domain.Ourworkdiffersinanumberofways:First,weaddtheo-
etal.2021;Wuetal.2023a;Zhangetal.2021a,b,2023].Ingeneral, reticalinsightsonuncertaintyandsampling.Weproposemethods
theseapproachescannotguaranteethattheoptimizedresultsare to quantify these concepts, so they can be used in downstream
accurate,asthereisnoguaranteethattheprovidedphotographs tasksandshowhowtoacceleratethisapproachusingthepower
samplethenecessarylight-viewanglepairstoqualifythespecu- spectrum.Second,ourapproachsupportsarbitrarylightsetupsand
larbehaviorandareunabletoprovideanymeasureofcertainty. treatsallfrequenciesinthesameframework,ratherthanseparating
Moreover,theyrelyonaheavyoptimizationprocess.Inspiredby highandlowfrequencylighting.Wedosobyrobustlyestimating
RamamoorthiandHanrahan[2001]whodescribedBRDFsasmul- sphericalharmoniccoefficientsdirectlyonsparse,irregularsamples
tiplicationsinthefrequencydomain,weproposetoleveragethe usingaregularizedleast-squaresmethod.Finally,weproposeto
efficiencyofthisframeworktojointlyestimatethematerialproper- improvetheBRDFmodeldescribedbyRamamoorthiandHanrahan
tiesandtheiruncertainty,providingkeyinformationaboutwhich toincludeshadowingandmaskingandshowhowtomapthemodel
,Vol.1,No.1,Article.Publicationdate:June2024.4 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
tothewidelyusedsimplifiedprincipledBRDF[BurleyandStudios functionfordegreeâ„“ andorderğ‘š.Thetotalnumberofspherical
2012]. harmonicsupto-andincludingamaximumdegree,â„“âˆ—,equals(â„“âˆ—+
1)2.Ausefulpropertyofsphericalharmonicsinoursettingisthat
2.4 Uncertaintyestimation
arotationalconvolutiononthesphereisequaltomultiplicationof
Uncertaintyestimationinthecontextofacquisitionishighlyde- coefficientsinthesphericalharmonicdomain.
sirable,asitcanguidethecapturingprocessandtheuseofpriors, Thepowerspectrumofasphericalfunctionğ‘“ canbecomputed
orsimplyinformontheexpectedqualityofagivenreconstruction. fromthesphericalharmoniccoefficientsperdegree
Lenschetal.[2003a],estimateanobjectâ€™smaterialpropertiesby â„“
âˆ‘ï¸
clusteringsimilarBRDFestimationswithinanobject.Toguidethe ğ‘† ğ‘“(â„“)= ğ‘“ â„“2 ğ‘š. (4)
clusteringanditssplitting,thecovarianceoftheparametersareused. ğ‘š=âˆ’â„“
InLenschetal.[2003b],theuncertaintyofBRDFparametersisesti- The power spectrum is invariant to rotations of the coordinate
matedusingsimilarcovariancematrices.Morerecently,Rodriguez- system.Inourcontextthatmeansthepowerspectrumisinvariant
Pardoetal.[2023]takinginspirationfromBayesianmethods([Gal toslightperturbationsofthenormalsateachpoint.
andGhahramani2016]),usedMonte-Carlodropouttoestimatethe
uncertaintyofmaterialestimationfromasinglepicture.Inthecon- 3.1.1 Computingsphericalharmoniccoefficients. Onecanfindthe
textofnovelviewsynthesis,Golietal.[2024]proposetoevaluate SHcoefficientsforafunction ğ‘“ bycomputingtheinnerproduct
theinherentvolumetricuncertaintyofNeRF[Mildenhalletal.2020] withthebasisfunctions
âˆ«
reconstructionsposteriortotraining.Theyuserayperturbations ğ‘“ â„“ğ‘š = ğ‘“(ğœƒ,ğœ™)ğ‘Œ â„“ğ‘š(ğœƒ,ğœ™)ğ‘‘ğœ”. (5)
andanapproximationoftheHessiantoquantifyit.Theyshowa ğ‘†2
correlationbetweenuncertaintyandabsoluteerror.Inthiswork,we A useful property holds for the coefficient of degree â„“ = 0, for
useamoreexplicitapproachtouncertaintyestimation.Weuseafast whichthesphericalharmonicisconstant;ğ‘Œ 00(ğœƒ,ğœ™)=(4ğœ‹)âˆ’1 2.The
BRDFestimationapproximationformanyparametercombinations correspondingcoefficient, ğ‘“ 00,isequaltotheintegralof ğ‘“ times
andinterprettheresultingerrorasanegativelog-likelihoodfrom thenormalizationconstant,(4ğœ‹)âˆ’ 21 .Thesphericalharmonicsfor
whichwederiveanentropymeasure.
higherdegreesallintegratetozero1.Thisisrelevantinthecontext
3 BACKGROUND ofrendering,becausethetotalintegratedincomingandoutgoing
ğ‘¡â„
radiancecanbereadfromthe0 degreecoefficientandthatcoeffi-
Ourmethodbuildsonpriorworkininverserenderingandspherical cientalone.Inthegeneralcase,weestimatethecoefficientforğ‘“
â„“ğ‘š
harmonics.Wesummarizerequiredbackgroundknowledgeand basedonsamplesofğ‘“.Thesamplingmethoddetermineshowthese
refertorelatedworkforfurtherdepth.
coefficientsareestimated.
3.1 SphericalHarmonics Regularsampling. Ifğ‘“ issampledonagridwithequallyspaced
Sphericalharmonicsareaseriesoforthonormalbasisfunctionson longitudinalandlatitudinalangles,thisintegralcanbeaccelerated
thesphere,indexedbytheirdegreeâ„“ andorderğ‘š.Weusethem usingafastFouriertransforminthelongitudinaldirectionğœ™ and
torepresentincomingandoutgoingradianceoverincomingand aquadratureruleinthelatitudinaldirectionğœƒ [DriscollandHealy
outgoingdirectionsontheunitsphere.Sphericalharmonicsare 1994].Inoursetting,thisapproachcanbeusedforenvironment
analogoustotheFourierseriesonaflatdomain,wherethefrequency mapsrepresentedasrectangulartextures.
oftheFourierseriescorrespondstothedegreeâ„“andorderğ‘š.We
Irregularsampling. Duringcapturethecameraisoftenplacedat
provideabriefoverviewofpropertiesrelevanttoourmethod.For irregularpositions,leadingtonon-uniform(ğœƒ,ğœ™)samples.Further,
furtherdetails,ahelpfulreferenceandsoftwarepackageispublished
apointonthesurfacemightbeobservedfromonlyafewpositions.
byWieczorekandMeschede[2018].
Wethereforeoftenneedtousesparseandirregularsamplestofit
Anyreal,square-integrablefunctiononthespherecanbeex-
sphericalharmoniccoefficients.Wedosobyfittingthecoefficients
pressedasaspherical-harmonicsseries:
usingleast-squares,expressingEquation1asalinearsystem
âˆ â„“
ğ‘“(ğœƒ,ğœ™)=âˆ‘ï¸ âˆ‘ï¸ ğ‘“ â„“ğ‘šğ‘Œ â„“ğ‘š(ğœƒ,ğœ™), (1) Ycâ‰ˆf, (6)
â„“=0ğ‘š=âˆ’â„“ wheref isavectorofğ‘›discretesamplesfromğ‘“,Yisamatrixof
whereğ‘“ â„“ğ‘šisthecoefficientforsphericalharmonicğ‘Œ â„“ğ‘š(ğœƒ,ğœ™),given sizeğ‘›Ã—(â„“âˆ—+1)2containingthesphericalharmonicssampledatthe
as
samelocationsasğ‘“,andcisavectorofthe(â„“âˆ—+1)2coefficientswe
âˆšï¸„ wanttofind.Wecanfindcbysolvingaleast-squaressystem
ğ‘ â„“ğ‘š =
(2âˆ’ğ›¿ ğ‘š0)(2â„“+1) (â„“âˆ’ğ‘š)!
(2) YâŠº Yc=YâŠº f. (7)
4ğœ‹ (â„“+ğ‘š)!
ğ‘Œ
â„“ğ‘š(ğœƒ,ğœ™)=(cid:40) ğ‘ğ‘ â„“â„“ ğ‘šğ‘š ğ‘ƒğ‘ƒ â„“â„“ğ‘š |ğ‘š( |c (o cs oğœƒ s) ğœƒc )o ss inğ‘š |ğ‘šğœ™
|ğœ™
ii ff ğ‘šğ‘š <â‰¥ 00 .,
(3)
T
s
mao
am
kb
p
ie
nle
gw
s,
te hwll ehp sio
c
yhs se
tc
ed
a
m, nth ubi
e
ns dcs ehy ras
-l
ct lee onm
ng si
tr
n
re agq inu
in
eir dte
h
.s
e
Wğ‘›
c
eo>
n pt
r(
e
oâ„“
x
pâˆ—
t
o+
o sf
e1 s)
tp
o2
a
ui rn
s
sed ee
s
ap
am
ce un
p
sd
l
tie onn mgt
,
ğ‘ â„“ğ‘š isanormalizationfactor,ğ›¿ ğ‘š0istheKroneckerdeltafunction, 1Becausethesphericalharmonicsareorthormal,theinnerproductbetweenanyspher-
whichevaluatesto1whenğ‘š=0,andğ‘ƒ â„“ğ‘š istheassociatedLegendre icalharmonicwithâ„“>0andtheconstantfunction(â„“,ğ‘š=0)equalszero.
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 5
SH Fit on Fibonacci samples BRDF as convolution Fresnel Shadowing, masking Optimization
Input lighting Section 4.2 Background in angular space Section 4.1 Section 4.3
f00
Shadowing Masking
+ f10
+ f11
Low pass filtering â€¦ Microsurface
Mixed
Multi-view capture
and Geometry
SH Fit on sparse samples BRDF as convolution Power spectrum parameter estimation Uncertainty
Section 4.2 Background Section 4.4 Section 4.5
f00 K s
Ã— =
+ f10 Î±
+ f11
â€¦ Incoming radiance Candidate BRDF Outgoing radiance
Frequency Domain
Fig.2. Anoverviewofourpipelineshowinginput,output,andtheproposedalgorithm.Theinputtoourapproachisasetofphotographsofanobjectfrom
multiplecamerapointsandtheassociatedcameraextrinsicsandintrinsics.Wealsoprovidetheinputlightingasanenvironmentmapandobjectgeometry.
Next,weproposetwomainvariantsofourapproach:amixedpipeline(top)andapipelinefullycontainedinthesphericalharmonicdomain(bottom).The
MixedpipelinefirstestimatessphericalharmoniccoefficientsfortheinputlightingonFibonaccisamples.ThelightisconvolvedwiththeBRDFfilterand
mappedbacktotheangulardomain,wheretheoutgoingradianceisattenuatedwithFresnel,shadowing,andmasking.Duringacquisition,weoptimizethe
BRDFparametersbycomparingtheoutgoinglightsamplestotheradiancecapturedintheinputphotographs.TheFrequencyDomainpipelinefirst
estimatessphericalharmoniccoefficientsonboththeincomingandoutgoingradianceandthenestimatestheeffectofdifferentBRDFfilterswithinthepower
spectrum.Thisisusedtocomputeameasureofuncertaintyonthepredictedparametersforacquisition.
regularizerinSection4.2forcaseswherethenumberofsamplesis cannotbeestimatedwithoutadditionalpriorsonplausiblespatial
toolow. parametervariations.ForthemicrofacetBRDF,thisleadstothe
followingconclusion:iftheincominglightonlycontainsfrequen-
3.2 ReflectionasConvolution ciesâ„“ <<ğ›¼âˆ’1,multiplyingthecoefficientsofthelightwiththose
Surfacereflectioncanbeapproximatedastheconvolutionofincom- oftheBRDFonlyresultsinasmalldifference,andtheinversion
ingradiance(fromthelightdirection)withaBRDF[Ramamoorthi
ofthisoperationisill-conditioned.Toaccuratelyestimateğ›¼,the
andHanrahan2001].Specifically,ifweassumeanisotropicmicro- incominglightusedduringthecaptureneedstoexhibitsufficiently
facetTorranceandSparrow[1967]BRDF,combinedwithaLamber- highfrequencies.
tianterm,wecanderivethefollowingapproximateequationfor Thisinsightisbasedonaderivationforthecoefficientsofthe
outgoingradianceğµatpointğ‘intheviewdirectionğœ” ğ‘œ microfacetmodel.ThenormalizedSH-coefficientsofthespecular
componentoftheBRDFfornormalincidence,ğ‘†,areapproximated
ğµ(ğ‘,ğœ” ğ‘œ)â‰ˆğ¾ ğ‘‘ğ¸(ğ‘)+ğ¾ ğ‘ ğ¹(ğœƒ ğ‘œ)[ğ‘† ğ›¼ âˆ—ğ¿(ğ‘)]ğœ”ğ‘œ, (8) by
whereğ¾
ğ‘‘
andğ¾
ğ‘ 
arediffuseandspecularterms;ğ¸(ğ‘)istheirradi-
anceintegratedoverthehemisphere;ğ¹(ğœƒ ğ‘œ)isasimplifiedFresnel ğ‘“Ë† â„“ğ‘š â‰ˆğ‘’âˆ’(ğ›¼â„“)2, (9)
term,whichonlydependsontheoutgoingdirection;ğ¿(ğ‘)isthein-
comingradiance;andğ‘† ğ›¼ isafilterparametrizedbythedistribution whichisaGaussianinthefrequencydomainwithawidthdeter-
width,ğ›¼.Thisfilterisderivedfromthenormaldistributionfunction minedbyğ›¼.ThekernelisderivedfromaBeckmannnormaldistribu-
ofthesurface.Theâˆ—operatorrepresentsconvolution.Aderivation tionfunctionandtheğ›¼ parametercorrespondstotheğ›¼ parameter
ofthisapproximationisincludedintheAppendix. there.NotethatthesecoefficientsdonotvarywiththeSphericalHar-
In this framework, estimating the specular BRDF parameters monicsorderğ‘š,sincethenormaldistributionfunctionisisotropic
comesdowntoestimatingtheconvolutionkernel.Thiscanbedone foroutgoingraysinthedirectionofthenormalvector(ğœƒ ğ‘œ =0).An
efficientlysinceaconvolutionintheangulardomaincanberep- importantapproximationemployedbyRamamoorthiandHanrahan
resentedasamultiplicationinthesphericalharmonicsfrequency is that this same kernel can be used for any outgoing direction.
domain.Usingthisrepresentation,onecanfindtheconvolution Whilethecorrectkernelvarieswiththeincomingandoutgoing
kernelthroughadivisionofthesphericalharmonicscoefficientsof direction,thisapproximationdoesnotleadtosignificanterrorfor
theoutgoingradiancebythoseoftheincomingradiance.Thisis inverserendering[RamamoorthiandHanrahan2001]astheynote
analogoustokernelestimationforimagedeblurringintheFourier thatâ€œitcanbeshownbyTaylor-seriesexpansionsandverifiednumer-
domain. ically,thatthecorrectionstothisfilteraresmall [forlowdegrees
Theaboveleadstocrucialinsightsregardingthewell-posedness â„“]â€.
ofBRDFrecovery.RamamoorthiandHanrahanstatethatthere- Inthispaper,weexpandonthetheoryestablishedbyRamamoor-
coveryofBRDFparametersisill-posediftheinputlightinghasno thi and Hanrahan by improving the reflection as a convolution
amplitudealongcertainmodesofthefilter(BRDF).Thosemodes modelâ€™saccuracyanddevelopingtheimplicationsforwell-posedness
,Vol.1,No.1,Article.Publicationdate:June2024.
noitazimitpO noitazilaitinI6 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
intoquantifiablemetricsonuncertaintywithouta-prioriknowledge especiallyifthemicrofacetdistributioniswide(highroughness).
onğ›¼. RamamoorthiandHanrahanarguethatthesetermscanbeignored,
becausetheymostlyaffectobservationsmadeatgrazingangles.
4 METHOD
Whilethisistrueformaterialswithlowroughness,wefindthat
Ourgoalistorecover(SV)BRDFspropertiesandquantifyuncer- ignoringthistermleadstoreconstructionerrorsforhighroughness
tainty from multi-view capture of an object under environment materialsâ€“weevaluatethetermsâ€™impactinTable4.Wethere-
lighting.TheinputtoourmethodisasetofimagesIcapturedfrom fore propose to introduce shadowing and masking terms to the
multiplecamerapositions.Thecameraextrinsics,intrinsics,object convolutionmodel.
geometryandHDRlightingareassumedtobeknownâ€“through Shadowingandmaskingeffectsaretypicallymodeledjointlyto
existingmethodsforcameracalibration,photogrammetry,andHDR avoidanover-correctionoftheradiance(Pharretal.[2023],Section
environmentcaptureâ€“butnotcontrolled. 9.6.3).However,thisjointtermcannotbeincludedinthesimplified
Foreachpointğ‘ ontheobjectsurface,weknowtheincoming convolutionmodelaspresentedinEquation8,becausethekernel
radianceğ¿(ğ‘,ğœ” ğ‘–)fromdirectionsğœ” ğ‘–.Thesevaluescanbesampled wouldneedtovarywithbothğœ” ğ‘– andğœ” ğ‘œ (the2Dkernelonlyvaries
fromtheenvironmentmap.Forhigheraccuracy,onecanattenuate witheitherğœ” ğ‘– orğœ” ğ‘œ).Therefore,weassumethatshadowingand
thelightbasedonself-occlusion,butwedonotexplorethisinour maskingeffectsareindependentandcanbemodeledseparatelyas
work.Byprojectingthecapturedimagesontothesurface,were- ğº ğ›¼(ğœ” ğ‘–)ğº ğ›¼(ğœ” ğ‘œ).Whilewedoobserveasmalloverestimationofthe
trievetheoutgoingradianceateachpoint,ğµ(ğ‘,ğœ” ğ‘œ).Ourtaskisto shadowingandmaskingeffect,weshowinTable4thattheaddition
recovertheBRDFğ‘“(ğ‘,ğœ” ğ‘œ,ğœ” ğ‘–)andcapturetheuncertaintyassoci- ofthetermstillleadstoimprovementsforBRDFacquisition.This
atedwithitsparameters.TheBRDFrelatestheincomingradiance waywecanfirstattenuatetheincominglightwiththeshadowing
oftheupperhemisphereÎ©totheoutgoingradianceas[Pharretal. term,thenconvolvewiththeBRDFandthenattenuatetheresult
2023]: withthemaskingterm
ğµ(ğ‘,ğœ”
ğ‘œ)=âˆ«
ğ‘“(ğ‘,ğœ” ğ‘œ,ğœ” ğ‘–)ğ¿(ğ‘,ğœ” ğ‘–)cosğœƒ ğ‘–ğ‘‘ğœ” ğ‘–. (10)
ğµ(ğ‘,ğœ” ğ‘œ)â‰ˆğ¾ ğ‘‘ğ¸(ğ‘)+ğ¾ ğ‘ ğ¹(ğœƒ ğ‘œ)ğº ğ›¼(ğœƒ ğ‘œ)[ğ‘† ğ›¼ âˆ—ğº ğ›¼(ğœƒ ğ‘–)ğ¿(ğ‘)]ğœ”ğ‘œ, (11)
Î© whereğº ğ›¼ istheshadowing-maskingfunctionintheTrowbridge
WeusetheTorranceandSparrow[1967]BRDFmodelwithparam- andReitz[1975]model(alsoreferredtoasGGX[Walteretal.2007]).
eters for diffuse reflectanceğ¾ ğ‘‘, specular reflectanceğ¾ ğ‘ , and the Theshadowingandmaskingtermsbothdependonğ›¼,whichisnot
slopeofthenormaldistributionfunctionğ›¼(Equation8).Wedenote knowna-priori.Thismeansthattheshadowingandmaskingterms
theseparametersasavectorofparameters,ğœ“.Insubsection4.6,we changeasweoptimizeğ›¼.Asaconsequence,weneedtoupdatethe
showhowtomapasimplifiedDisneyprincipledBRDF[Burleyand coefficientsfortheincominglightasğº ğ›¼(ğœƒ ğ‘–) changes.Whilethe
Studios2012]totheseparameters. estimationofsphericalharmoniccoefficientsisrelativelyfast,it
Toestimateğœ“,weproposetobuildontheframeworkproposed canstillbequitecumbersometoupdatethecoefficientsinevery
byRamamoorthiandHanrahan[2001].Inthefollowingsectionswe optimizationstep.Therefore,weonlyupdatetheshadowingterm
carefullyhighlighthowweimproveandextenditsusecompared eachğ‘šiterations.
totheoriginalformulation.Anoverviewofthepipelineisshown
4.2 FittingSphericalHarmonicCoefficients
inFigure2,wherewedenoteourcontributionsinblackandexist-
ingworkingray.Inparticular,wedescribetheextensionofthe Muchofourcomputationreliesonaconvolutionappliedinthe
existingconvolutionmodeltotakeshadowingandmaskingeffects sphericalharmonicsdomain,whichmeanswerequireagoodspher-
into account. We then describe an efficient spherical-harmonics icalharmonicstransform.Thisischallenging,becausetheoutgoing
fittingfromsparseandirregularsamplesofradiance,enablingun- lightfield,ğµ,issampledsparselyandnon-uniformly(Figure3,sec-
structuredcapturesetups.Wethenproposeacarefullyvalidated ondcolumn).Therefore,RamamoorthiandHanrahandonotdirectly
approximationoftheconvolutionmodeltodesignalightweight estimatesphericalharmoniccoefficientsonğµ,butonlyperformthe
lossfunction,leveragingthepowerspectrumforefficientlosseval- transformationfromthesphericalharmonicdomaintothedirec-
uation.TheseimprovementsenablequicksamplingoftheBRDF tionaldomain.Thisissimpler,becauseitonlyrequiresevaluating
parameterspace,Î¨,whichweusetoproposeanewformulation
thesphericalharmonicsatthesamplelocations(Equation1).For
forcapturinguncertaintyrelyingonstatisticalentropy.Finally,we theincominglight,theyrepresentlow-frequency(areasources)and
maptheTorrance-SparrowBRDFmodelparameterstothoseofthe high-frequencylighting(pointsources)separatelyandlimittheir
simplifiedDisneyprincipledBRDF[BurleyandStudios2012]for environmentstocontrolledâ€˜lightboxâ€™-likesettings.Wewouldlike
useinmodernrenderingpipelines. tocomputeanestimateofthesphericalharmoniccoefficientsfor
theoutgoingradiance,becausethiswouldenablealgorithmicanal-
4.1 ImprovingtheConvolutionModel
ysisfullywithinthefrequencydomain.Thisishighlyappealing,
The approximate reflection function in Equation 8 does not in- becauseithasthepotentialtogreatlysimplifytheanalysisofBRDF
cludetheshadowingormaskingtermspresentinmicrofacetmod- recovery,asshowcasedbyRamamoorthiandHanrahan[2001].
els[Pharretal.2023].Theshadowingandmaskingtermsmodel Nexttosparsesampling,asignificantchallengeisthatboththe
occlusiononincominglight(shadowing)andoutgoinglight(mask- incoming-andoutgoingradiancefieldsareonlysupportedontheup-
ing)duetotheconfigurationofthemicrofacets(Figure2,topright). perhemispherewhenconsideringreflection.Ifweweretoconsider
Lightatgrazinganglesismorelikelytobeoccludedbymicrofacets, incomingradianceonthelowerhemisphere,wewouldimplicitly
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 7
Incoming and outgoing radiance No regularizer Padded Constant regularizer Ours
101 101 101 101 101
Incoming light
103 Outgoing light 103 103 103 103
GT BRDF
Relative spectrum
105 105 105 105 105
0 2 4 6 8 0 2 4 6 8 0 2 4 6 8 0 2 4 6 8 0 2 4 6 8
Degree â€˜ Degree â€˜ Degree â€˜ Degree â€˜ Degree â€˜
Fig.3. Acomparisonoftheoptionsforfittingsphericalharmonicsonsparsesamples.Inthefirstcolumn,top:incomingradiance(synthetic)onthesphere
mappedtoalat-longgrid.Middle:synthesizedoutgoingradianceasaresultoffilteringincomingradiancewithEquation9,ğ›¼=0.2.Bottom:powerspectraof
incomingandoutgoingradianceandground-truthfilter(BRDF)plottedonalog-scale.Inthesecondtofifthcolumn,weshowtheresultoffittingspherical
harmonicscoefficientstosamplesandthentransformingbacktothespatialdomain.Weuse100samplesfromtheupperhemisphereoftheinputradiance(first
column)andsimulatemissingsamplesduetoocclusionormissedcamerapositionsbymaskingsomepoints,leaving88samples.Thesamplesareweighted
withcosğœƒ,whichisvisualizedasthetransparencyofthesamples.Wefindthatourmethodwithaweightedregularizerisabletosmoothlyinterpolatemissing
valuesandretrievesthecorrectBRDFfilterinthepowerspectrum,whereothervariantsoverfit,oradddarkregionsintheupperhemisphere.
modellightâ€˜leakingthroughâ€™thesurface.Onepossiblesolution andoutgoingradiancefitting,weareabletorecoverthecorrect
istosimplypadthelowerhemispherewithzeros(Figure3,third filter(bottomrow),eventhoughtherecoveredincomingradiance
column).Thisisnotpractical,becauseitintroduceshighfrequency looksblurrier(toprow).
variationattheboundary,whichdisruptsanypotentialanalysison Wefitthesignalsforwhichwehavecompletespatialinformation
thesphericalharmoniccoefficients(bottomrow).Anothersolution (e.g.,incomingenvironmentlight)bysamplingitinwithFibonacci
thatweexploredistorepresenttheradiancefieldswithhemispher- samplesonthesphere.Forpartiallyobservedsignal(e.g.,reflected
icalharmonics[Zhengetal.2019].Inpractice,thisisequivalentto light)weusetheavailablesampleswiththedescribedfittingtech-
mirroringtheradiancefieldsalongthemeridian,whichresultedin niqueforsparseandirregularsamples.Animportantconsideration
mismatcheswiththeconvolutionmodel. relatedtothenumberofsamples,isthefrequencyofthesignal
Weinsteadproposeasphericalharmonicsfittingapproachthatis thatwefitsphericalharmonicsto.Wehaveanin-depthanalysisof
robusttosparseandirregularsamples,andsupportsthelackoflower thisintheAppendix.Thepracticaltake-awayisthattheincoming
hemispheresamplesandgracefullyhandlesoccludedregions.First, signalshouldbebandlimitedtoroughlyğ‘›1 2 toavoidaliasing,where
analogtoideasfromcompressedsensing,weaddaregularization ğ‘›isthenumberofinputviews.Weensurethisisthecaseforthein-
termonthesphericalharmoniccoefficients.Atypicalchoicefor comingradiancebyapplyingthefilterinEquation9withğ›¼â€² =ğ‘›âˆ’ 21
thistermisanğ¿1norm,whichenforcessparsityinthespherical
ontheinputenvironmentmap.TheimpactonourBRDFestimation
harmonic coefficients. The resulting system can be solved with isthatwecannotaccuratelyrecoverğ›¼ < ğ›¼â€².Inourexperiments
linearprogramming.Weproposeinsteadtouseaweightedğ¿2norm
andanalysisintheAppendix,wefindthattherecoveredğ›¼ tends
whichcanbesolvedusingstandardlinearsolvers,whichwefound tobebetween0andğ›¼â€² inthosecases.Asecondfinetuningpass
tobefasterandmorestableforourusecase:
withadifferentiablepathtracer,liketheonewedemonstrateinthe
(YâŠº Y+ğœ†W)c=YâŠº f, (12) experiments,canhelprefinethoseregions.
4.3 OptimizingforSVBRDFParameters
whereWisadiagonalweightmatrix.Ifconstant,thisweightma-
trixleadstopoorfittingastheregularizationistoostrongonthe UsingourmorecompletemodeldescribedinEquation11,wecan
lowersphericalharmonicsdegrees(Figure3,fourthcolumn).We optimizefortheobjectâ€™smaterialparametersusinggradientdescent:
settheweightequaltoğ‘’â„“
,increasingthestrengthofregularization
forhighersphericalharmonicsdegrees.Thisisinformedbythe ğœ“âˆ—=argminâˆ‘ï¸ |ğµ ğœ“(ğ‘,ğœ” ğ‘œ)âˆ’ğµâ€²(ğ‘,ğœ” ğ‘œ)| (13)
ğœ“
observationthatmanynaturalimageshaveapowerspectrumwith ğ‘,ğœ”ğ‘œ
exponentialdecay[Flemingetal.2003].Intuitively,thisregularizer Withğµ ğœ“(ğ‘,ğœ” ğ‘œ)arenderingoperatorusingEquation11andğµâ€²
encouragesfillingunknownregionswithlow-frequencyinforma- theradiancevaluesprojectedontothesurfacepointsğ‘.Asdescribed
tion,akintosolutionswithasmoothnessterm(Figure3,right-most insubsection4.1,weoptimizetheparametersğœ“ foranumberof
column).Byapplyingthesameregularizationtobothincoming- iterationsbeforeupdatingtheshadowingterm,asthissteprequires
,Vol.1,No.1,Article.Publicationdate:June2024.
rewoP rewoP rewoP rewoP rewoP8 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
recomputingthesphericalharmonicfit.Themaskingtermisin- Next, we propose to use the power spectrağ‘† ğ¿ andğ‘† ğµ of the
cludedintheforwardrenderingstepandupdatedeveryiteration. sphericalharmonicsfittingsğ¿ â„“ğ‘š andğµ â„“ğ‘š,whichwecanexpressas
Becauseof thesimplicity ofthe convolution approximation,we â„“
areabletooptimizeforallpointsandcamerapositionsinonego, ğ‘† ğ¿(â„“)= âˆ‘ï¸ ğ¿ â„“2 ğ‘š (15)
ratherthanusingstochasticgradientdescentwithbatchesofrays. ğ‘š=âˆ’â„“
Thisletsusrunouroptimizationwithfeweriterationsthanother â„“
approaches.Similartoothermethods,weaddthetotalvariation ğ‘† ğµ(â„“)= âˆ‘ï¸ (ğ¾ ğ‘ ğ‘’âˆ’(ğ›¼â„“)2ğ¿ â„“ğ‘š)2 (16)
normontheparametersintexturespaceasaregularizertoenforce ğ‘š=âˆ’â„“
smoothness,weightedwith1Ã—10âˆ’3. â„“
=ğ¾ ğ‘ 2ğ‘’âˆ’2(ğ›¼â„“)2 âˆ‘ï¸ ğ¿ â„“2 ğ‘š (17)
4.4 ALightweightObjective
ğ‘š=âˆ’â„“
Inthissectionwedefineaparticularlyefficient-to-computeapprox- =ğ¾ ğ‘ 2ğ‘’âˆ’2(ğ›¼â„“)2ğ‘† ğ¿(â„“) (18)
imationoftheconvolutionBRDFmodeldescribedinEquation11.
fordegreesâ„“ >0.UsingthisrelationshipbetweentheBRDFparam-
Ourgoalistodevelopalgorithmstoanalyzetheinverserender-
ingproblemfullyinthesphericalharmonicdomain.Thiswould
eters(ğ¾ ğ‘ ,ğ›¼)andtheincomingandoutgoingradiancepowerspectra
simplifysuchanalysistremendously,asconvolutionissimplya
(ğ‘† ğ¿(â„“)andğ‘† ğµ(â„“),wecanformulatealightweightobjective:
per-frequencymultiplicationinthisdomain. â„“âˆ—
Forthisapproximation,weproposetoignoretheFresneland ğ·(ğ¾ ğ‘ ,ğ›¼)=âˆ‘ï¸ (ğ‘† ğµ(â„“)âˆ’ğ¾ ğ‘ 2ğ‘’âˆ’2(ğ›¼â„“)2ğ‘† ğ¿(â„“))2. (19)
shadowing and masking terms, letting us express the reflection â„“=1
functionentirelyintermsofsphericalharmoniccoefficients.We Intuitivelythisobjectiveevaluatesthedifferencebetweentheob-
showexperimentallyinSection5.4.2thattheimpactofthisapproxi- servedradianceandtheBRDF-convolvedincomingradiancewith
mationisacceptableontheunderlyingapplicationofthisobjective. agiven(ğ¾ ğ‘ ,ğ›¼)throughtheirrespectivepowerspectrum.Thisfor-
UsingEquation9forthecoefficientsofğ‘†weget: mulationreducesthecomputationfromâ„“âˆ—2 toâ„“âˆ— evaluationsof
ğµ â„“ğ‘š =(cid:40) ğ¾ğœ‹ ğ‘ âˆ’ ğ‘’1 2 âˆ’ğ¾ (ğ‘‘ ğ›¼ğ¸ â„“)( 2ğ‘ ğ¿) â„“ğ‘š+ ,ğ¾ ğ‘ ğ¿ â„“ğ‘š, i of thâ„“ e= rw0.
ise.
(14) t h uh noe w ceo rb t thj ae i isc nt tfi yav se et, vm e as la t uik ami tn ia og t nioit ans se i ssv ha k ol eu wya nt ti oo inn u Sn n ee l coa tcr ioki nin ns 4gt .a 5nn aet naan r d-e i cno au s nts a. bnW et ue (< ss e1h dmo aw s s)
Wenotethatthespecularcomponentforâ„“ = 0doesnotdepend initializationoftheoptimizationdescribedinSection5.6.
onğ›¼,becauseforâ„“ =0,Equation9equals1.Thetermğœ‹âˆ’1 2ğ¾ ğ‘‘ğ¸(ğ‘)
4.5 EntropyasUncertainty
representsthediffusecomponentasaconstantfunction.Weknow,
basedontheconservationofenergy,thatthediffusecomponent Inourcontextofpassiveacquisition,wehavenoguaranteethat
should integrate toğ¾ ğ‘‘ğ¸(ğ‘) on the upper hemisphere for outgo- theilluminationonthecapturedobjectsurfaceissufficienttofully
ing directions. Thus, the integral over the full sphere should be recoverthematerialparameters.Thisuncertaintyisparticularly
ğ¾ ğ‘‘2ğ¸(ğ‘).Equation5showsthattheSphericalHarmonicscoeffi- desirableinformationasitiskeytounderstandingthequalityof
cientfordegreeâ„“ =0shouldbeequalto(4ğœ‹)âˆ’1 2 timestheintegral: acquisition(e.g.fordigitaltwins),drivingtheuseofpriorsinuncer-
(4ğœ‹)âˆ’1 2ğ¾ ğ‘‘2ğ¸(ğ‘)=ğœ‹âˆ’1 2ğ¾ ğ‘‘ğ¸(ğ‘).Fromthisexpression,wemaketwo tainregionswhilepreservingthecorrectlyrecoveredsurfaceareas,
ordrivingtheacquisitionbymaximizingtheinformationprovided
observations.(a)Wecannotrecovertheratiobetweenğ¾
ğ‘‘
andğ¾
ğ‘ 
bynewviewswhenadditionalcapturesarepossible.Weproposeto
fromtheâ„“ =0alone,aswehavetwounknownsandonlyoneco-
useagridsearchoftheparameterspacetoinformouruncertainty
efficientand(b)wecannotderiveanyinformationonğ›¼ fromthe
estimation.Thisisnowtractable,thankstothepowerspectrum
0thdegree,asithasnoimpactthere.Itfollowsthatwecanonly
approximationdiscussedintheprevioussection.Byinterpreting
recoverğ¾ ğ‘  andğ›¼ fromdegreesâ„“ > 0.Onceğ¾ ğ‘  isknown,wecan
the error over the parameter space as a likelihood function, we
thenestimateğ¾ ğ‘‘ fromthe0th degree.Inotherwords,weknow
canexpressuncertaintyusingentropy,whichisacommonwayto
diffusereflectanceonceweknowthecontributionofthespecular
studyuncertainty.Wedetailthesecontributionsinthefollowing
component.Thisreducesouranalysisofuncertaintytothespecular
paragraphs.
componentontheparametersğ¾ ğ‘ andğ›¼.Notethatthissimplification
OnecaninterprettherecoveryoftherightBRDFparameters,ğœ“âˆ—
comesnaturallyinthefrequencydomain,becausewecanlimitour
asamaximizationoftheposteriorprobabilitydistributionofthe
analysistodegreesâ„“ >0.Thisisnon-trivialtoseparateoutinthe
parametersgiventheincomingandoutgoingpowerspectrum
directionaldomain.
Weuseourproposedsphericalharmoniccoefficientfittingde- ğœ“âˆ—=argmaxğ‘(ğœ“|ğ‘† ğ¿,ğ‘† ğµ). (20)
scribedinSection4.2torecoverğ¿ â„“ğ‘šandğµ â„“ğ‘š.ğµ â„“ğ‘šisestimatedfrom ğœ“
thesparse,irregularsamplesoftheobjectfromtheinputviewsas AccordingtoBayesrule,theposteriorisproportionaltotheproduct
describedinSection4.2.ğ¿ â„“ğ‘š isestimatedfromsamplesoftheenvi- ofthelikelihoodandpriorovertheparameters:
ronmentinthereflectiondirectionsoftheviewingpositions.This
ensuresthatthesphericalharmoniccoefficientsforğ¿ andğµ are
ğ‘(ğœ“|ğ‘† ğ¿,ğ‘† ğµ)âˆL(ğ‘† ğ¿,ğ‘† ğµ|ğœ“)ğ‘(ğœ“), (21)
comparableandthatwecananalyzethefrequenciesoftheobserved Assumingğ‘(ğœ“)tobeanuninformativeprior,i.e.auniformdistribu-
light. tionontherangeofallowedparametervalues(typically[0,1]for
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 9
BRDFparameters),wecanreformulatethisobjectivetoanequiva- Power spectrum Likelihood, Entropy H=0.25
0.0 1.0
1.0
lentnegativelog-likelihoodobjective Incoming
0.8 0.2 0.8
ğœ“âˆ—=argm ğœ“inâˆ’log(L(ğ‘† ğ¿,ğ‘† ğµ|ğœ“)). (22) 0.6 Outgoing (Î±=0.2,Ks=0.8) 0.4 0.6
0.4 0.6 0.4
WeinterpretthelightweightobjectivedescribedinEquation19as
theNegativeLogLikelihood(NLL)ofthejointprobability,given 0.2 0.8 0.2
parametersğœ“ =(ğ¾ ğ‘ ,ğ›¼): 0.0
0 2 4 6 8
1.0
0.0 0.2 0.4 0.6 0.8 1.0
0.0
Degree â€˜ Ks
L(ğ‘† ğ¿,ğ‘† ğµ|ğœ“)= âˆš1 ğ‘’âˆ’ 2ğœ1 2ğ·(ğ¾ğ‘ ,ğ›¼), (23) 1.0 Power spectrum 0.0 Likelihood, Entropy H=0.69 1.0
ğœ 2ğœ‹ Incoming
0.8 0.2 0.8
whereğ·(ğ¾ ğ‘ ,ğ›¼)isthesquarederrormeasuredefinedinEquation19.
0.6 0.4 0.6
Wecanviewthisasassumingthattheerror ofourmodelcaused
byapproximationsandmeasurenoiseisGaussianâˆ¼N(0,ğœ2).We 0.4 0.6 0.4
setğœ = 1ğ‘’âˆ’2,foundempiricallytocapturethechangeinlossob- 0.2 Outgoing (Î±=0.2,Ks=0.8) 0.8 0.2
servedwhennoticeablychangingğœ“.Thescalingconstantaboveis 0.0 1.0 0.0
0 2 4 6 8 0.0 0.2 0.4 0.6 0.8 1.0
optionalsincewewillrenormalizebelowinEquation24.Withğœ Degree â€˜ Ks
Power spectrum Likelihood, Entropy H=0.87
fixed,minimizingtheNLLfromEquation22isequivalenttomini- 1.0 0.0 1.0
mizingğ·(ğ¾ ğ‘ ,ğ›¼).
0.8
Incoming
0.2 0.8
creW tize ee dx ip nlo ğ‘›re vat lh ue esm inat te or ti aa ll ,p ğœ“a ğ‘–=ra 0.m .ğ‘›e (t âˆšer ğ‘›s pp ea rc ve af ro iar bğœ“ le)= .B( eğ¾ cğ‘  a, uğ›¼ s) e, td hi is s-
0.6 0.4 0.6
processcanbeparallelizedeasily,thissteptypicallytakesbetween 0.4 0.6 0.4
1âˆ’10msforcommonscenarios.Thegridsearchprovidesuswitha 0.2 0.8 0.2
Outgoing (Î±=0.2,Ks=0.1)
discretedistributionğ‘‘obtainedfromtheğ‘›samplesofğœ“:
0.0 1.0 0.0
0 2 4 6 8 0.0 0.2 0.4 0.6 0.8 1.0
ğ‘‘ ğ‘– = (cid:205)ğ‘› ğ‘–=L 1( Lğ‘† ğ¿ (, ğ‘†ğ‘† ğ¿ğµ ,ğ‘†|ğœ“ ğµğ‘– |) ğœ“ ğ‘–), (24) Fig.4. ExamplesofthDe egree l iâ€˜ kelihoodandentropyğ»resuK lts ingfromthreesets
ofpowerspectraforincomingandoutgoingradiance.Thelikelihoodis
whereğ‘‘ ğ‘– givestheprobabilitythataparameteriswithinarange sampledat100discretevalues.Top:Anidealsituation,wheretheincoming
of1/2ğ‘›fromğœ“ ğ‘–.Weusethediscretedistributiontocomputethe radianceisadiracdelta(allfrequenciesarepresent).Middle:Asituation
uncertaintywiththedistributionâ€™snormalizedentropy2:
wheretheincomingradiancedoesnothaveenoughamplitudeforhigher
ğ‘› degrees.Bottom:Asituationwheretheincomingradianceisideal,butthe
ğ» =âˆ’ 1 âˆ‘ï¸ ğ‘‘ ğ‘–log(ğ‘‘ ğ‘–). (25) specularcomponentistoolowtogetaproperrecoveryforğ›¼.
log(ğ‘›)
ğ‘–=1
Intuitively,thenormalizedentropydescribesthespreadofaproba-
bilitydistribution:lowentropymeansthattheprobabilitydistribu- 4.6 DisneyPrincipledBRDF
tionishighlyconcentrated,whichimpliescertainty.Highentropy
ManymodernrenderingpipelinesemployvariantsoftheDisney
meansthattheprobabilitydistributionisspreadout,whichimplies
BRDF[BurleyandStudios2012],whichisacombinationofadiffuse
uncertainty:manyoptionsshareasimilarlyhighprobability.
termandamicrofacettermwithauser-friendlyparametrization.
Weshowthreeexamplesofpowerspectra,theircorresponding
Themodelalsocontainssomeadditionalfeaturesbeyondthescope
likelihoodandentropyinFigure4.Thetoprowshowsincoming
ofthecurrentwork.Wecanformulateourmodelusingtheprin-
lightforadiracdeltalightsource(constantinthesphericalharmonic
cipled BRDF parameters, rather than the raw parameters of the
domain)andweseethatentropyislow(ğ» = 0.25)andthatitis
Torrance-Sparrowmodel.Weparameterizebasecolor,metallicity
simpletorecoverthecorrectparameters.Themiddleandbottom
androughness,mappingthesetotheTorrance-Sparrowmodelas
rowsareproblematiccases.Inthemiddlerow,thelightonlyhas
amplitudeinlowfrequenciesandmanyroughnessvaluesareequally
likely(ğ» =0.69),inlinewiththeconclusionsfromRamamoorthi ğ¾ ğ‘‘ =ğ‘… ğ‘, (26)
andHanrahan.Thebottomrowshowsamaterialwithverylow ğ¾ ğ‘  =1, (27)
specularreflectance,resultinginhighentropy(ğ» =0.87).Thiscould ğ‘… 0=0.04+(ğ‘… ğ‘âˆ’0.04)ğ‘š, (28)
resultinincorrectestimatesundernoisyconditions.Concluding, ğ¹(ğœƒ ğ‘œ)=ğ‘… 0+(1âˆ’ğ‘… 0)(1âˆ’cosğœƒ ğ‘œ)5, (29)
entropyasuncertaintygeneralizesandquantifiestheobservations
madebyRamamoorthiandHanrahanontheuncertaintyforcertain ğ›¼ =ğ‘Ÿ2, (30)
incominglightandmaterialparameters,withoutrequiringaprior
estimateoftheBRDFparameters. whereğ‘… ğ‘ isthebasecolor,ğ‘šisthemetallicityparameterandğ‘Ÿ is
theroughness.IntheablationswheretheFresneltermisnotused,
2Thisisequivalenttocomputingentropyonacontinuousprobabilitydensityfunction wesetğ¾ ğ‘  =ğ‘… 0.Notethatwesetğ¾ ğ‘  to1,becausethespecularterm
usingthelimitingdensityofdiscretepoints[Jaynes1957]. iscontainedintheFresneltermasğ‘… 0.
,Vol.1,No.1,Article.Publicationdate:June2024.
rewoP
rewoP
rewoP
Î±
Î±
Î±10 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
BaseColor Roughness Metallic Entropy Relighting1 Relighting2 Relighting3 Relighting4
Fig.5. WecompareourapproachtoMitsubaandphotographsforrelighting.Thefirstcolumnontheleftshowsmaterialparametersandtrainingphotographs,
whiletherightcolumnshowsrelitresultsandphotographsunderdifferentlighting.Weseethatourresultsmatchtheappearanceofthephotographsaswell-
orslightlybetterthanMitsuba.Weseethattheentropyislowerwhereinputsprovidemoreinformation(e.g.well-litregions).VideosintheSupplement.
,Vol.1,No.1,Article.Publicationdate:June2024.
sruO
abustiM
shpargotohP
sruO
abustiM
shpargotohP
sruO
abustiM
shpargotohP
stupnI
stupnI
stupnIFastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 11
5 EXPERIMENTS Table1. BenchmarkComparisonforNovelSceneRelightingfrom[Kuang
etal.2023].Allthemodelslistedinthistableweretrainedwiththeground-
Ourmethodyieldstwomainbenefits:fastfittingandameasure truth3Dscanandground-truth,in-the-wildenvironmentmaps.Wereport
ofuncertainty.Inourexperiments,wevalidatethesebenefitswith evaluationsonthesamedatasetandtaskunderdifferentacquisitioncondi-
comparisons,provideinsightintovariationsofthealgorithmin tionsintheAppendix.
ablations,andshowapplicationstodemonstratepotentialusecases.
PSNR-Hâ†‘ PSNR-Lâ†‘ SSIMâ†‘ LPIPSâ†“ Time
5.1 Implementation NVDiffRec[Munkbergetal.2022] 24.319 31.492 0.969 0.036 142.143s
Mitsuba[Jakobetal.2022] 26.595 34.185 0.977 0.032 69.96s
We implement our full pipeline in PyTorch. The output of our Ours 26.677 33.936 0.977 0.029 5.27s
methodisasetofPBRtextures(roughness,metallicity,basecolor) Ours-SpectrumOnly 24.478 31.117 0.971 0.037 1.96s
whicharemappedtotheinputmeshwithUV-coordinatesto512x512 Ours+Mitsuba(1epoch) 27.038 34.560 0.978 0.030 19.87s
Ours+Mitsuba(2epochs) 27.199 34.770 0.978 0.029 33.39s
textures. For re-renders, we feed the textures produced by our
methodintoMitsuba,whichispossibleduetothemappingtothe
principledBRDFdescribedinsubsection4.6.Eachtimingresult
isreportedonamachinewithanNVIDIARTX4090GPUandan
AMDRyzen97950X16-CoreCPU.Wewillpublishthecodeforour 5.3 Acquisitioncomparison
experimentswithscriptstoreplicateeachtableuponpublication.
OurmaincomparisontargetisMitsuba3[Jakobetal.2022],asit Wevalidatethatourimprovedconvolutionmodelresultsinhigh-
isawell-documented,open-source,andresearch-friendlypackage quality acquisition results. We also quantify the benefit of our
fordifferentiablerendering.MorerecentlySunetal.[2023]propose methodcomparedtoothermethodsregardingoptimizationtime.
to jointly optimize for lighting, material and geometry, but did WetestourapproachonStanfordORBandsyntheticscenes.
notyetreleaseapublicimplementation;giventhattheyrelyona
complexdifferentiablerenderer,webelieveMitsuba3tobethebest 5.3.1 StanfordORB. Thesimilaritymetricsforrelightingresults
proxyfortheirinversePBRstep.WhenoptimizingwithMitsuba, on Stanford ORB are presented in Table 1. We find that our ap-
wesampleonerayperpixelineachview.Thematerialparameters proachperformsonparwithMitsuba,whiledemonstratinga13
areoptimizedwithstochasticgradientdescent,wherethegradient timesspeedupwithlittleoptimizationonourside(e.g.,wedonot
foreachstepisestimatedwitharandomsetofraystoensuregood implementcustomCUDAkernelsandusepurePyTorch).Wealso
convergence.Eachprimaryrayissampled32times,allowingthe comparetoNVDiffRec,asitleveragesadifferentiablerasterizer,and
reflectiondirectionstobesampled.WerunanAdamoptimizeruntil showthatourmethodachievesbetterrelightingresults.ForNVD-
convergenceoramaximumof10epochs. iffRec,giventhatweoptimizeformaterialsonly,wemonitortheloss
andrecordthetimeforgoodconvergence.Weempiricallyfind2000
stepstobesufficientforthisdataset.Wequalitativelycompareour
5.2 Datasets
resultstoMitsubaandphotographsoftheobjectsunderthesame
Weperformexperimentsonarecentin-the-wildbenchmarkdataset, illuminationinFigure5andagainstNVDiffRecinsupplemental
StanfordORB[Kuangetal.2023]andonsyntheticscenes.Stanford material.Wepresentaviewofourmaterialchannelsprojectedon
ORBcontains14objects,eachcaptured3timesindifferentscenes thecapturedobjectandafewinputphotographs.Theentropyis
(lightingenvironments),selectedfromatotalof7scenes.Thelight- visualizedusingthe"Turbo"colormap.Onthefourrightcolumns,
ingenvironmentiscapturedthroughachromeballandstoredasa wepresentrenderingsofourresultsandMitsubaunderanovel
lat-longenvironmentmap.Eachobjectisalsoscannedinaseparate illuminationandcomparethemagainstphotographsoftheobject
stage,providinghigh-qualitygeometry.Forourevaluation,wefocus takenunderthatsameillumination.Wecanseethatourapproach
onthe(SV)BRDFrecoverystepandusetheprovidedgeometry.In recoverssimilarappearanceinafractionofthetime.
ourexperiments,weoptimizematerialparametersforeachobject,
foreachofthethreeenvironments,andtestagainstthephotographs 5.3.2 Synthetic. Forsyntheticdatasets,wecomparetherecovered
ofthesameobjectinthetwoenvironmentsthatwerenotobserved materialparameterswiththeground-truthparameters.Weshowthe
duringoptimization. resultsinTable2,demonstratingcomparableaccuracycomparedto
Forthesyntheticbenchmark,weselected15objectswithspatially Mitsubadespiteparticularlychallengingobjectsforourmethod(e.g.
varyingBRDFtexturesforbasecolor,roughnessandmetallicity. withsignificantinter-reflectionsâ€“metallicchesspiecesandself-
We selected four environment maps with varying challenges to occlusionâ€“donut).WealsoshowaqualitativeevaluationinFigure7,
rendertheobjects:twoindoorscenes,oneoutdoorscenewitha showingtheparametersinUVspacealongsidetheentropymaps
clear sky and sun, and one overcast outdoor scene. Because we (visualizedusingtheâ€œTurboâ€colormap)forresultsoptimizedfrom
haveground-truthmaterialtexturesforthesyntheticscenes,we imagesrenderedundertheâ€œruralasphaltroadâ€environmentlight.
canquantitativelyevaluateouroptimizationresultsandvalidate Ontherightcolumnswecomparererenderingsofourresultsand
uncertaintydirectlyontheoptimizedparameters.Theobjectsare Mitsubaâ€™stoground-truthrenderingsunderadifferentillumination,
renderedinMitsubaat512Ã—512resolutionand256samplesper showingoncemoreagoodappearancematch.Weincludevisual
pixel.RendersandgroundtruthviewsforbothStanfordORBand comparisonsonallsyntheticcasesaswellastheexr filesforall
thesyntheticbenchmarkareincludedintheSupplement. lightenvironmentsinSupplementalMaterial.
,Vol.1,No.1,Article.Publicationdate:June2024.12 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
Table2. Syntheticbenchmarkcomparison(MSE)ofMitsubaandourmethodtotheground-truthparameters.Foreachenvironmentwepresenttheerrorin
thefollowingway:Average(BaseColor,Roughness,Metallicity).Wealsoreportforeachenvironmentthecorrelationbetweentheentropywecomputewith
ourpowerspectrumapproximationandtheerrorinMitsubaâ€™soptimizationtoshowthatourentropyisusefulforgeneralinverserenderingpipelines.
PhotoStudio Overcast Museum RuralRoad Avg. Time
Mitsuba 0.04(0.01,0.03,0.07) 0.03(0.01,0.02,0.06) 0.04(0.01,0.04,0.08) 0.04(0.01,0.03,0.07) 0.04(0.01,0.03,0.07) 105.19s
Ours 0.07(0.02,0.09,0.10) 0.06(0.02,0.07,0.09) 0.07(0.02,0.08,0.11) 0.05(0.01,0.05,0.08) 0.06(0.02,0.07,0.09) 3.14s
Ours-SpectrumOnly 0.19(0.07,0.15,0.37) 0.20(0.06,0.14,0.40) 0.25(0.09,0.20,0.46) 0.22(0.06,0.16,0.43) 0.21(0.07,0.16,0.41) 1.20s
Error-Entropycorrelation 0.21 0.13 0.18 0.14 0.16 -
5.4 Uncertainty
isparticularlyvisibleonthediceexampleinthesyntheticSupple-
Wetestwhetherourproposedentropy-baseduncertaintymetricis mentalMaterialswhere3facesarewelllit,andtheiropposedfaces
indicativeoferrorininverserenderingresultsandrepresentative arenot).
foruncertaintyinotherinverserenderingframeworks.
5.5 Ablations
5.4.1 StanfordORB. Ourfirstclaimisthattheentropycomputed Ourablationsservetwogoals.First,wewanttovalidatethatourpro-
usingourpowerspectrumorotherdifferentiablerendererswill posedimprovementstoRamamoorthiandHanrahan[2001]makea
besimilar.Wevalidatethisbycomputingourproposedentropy significantdifference.Second,wewouldliketostudythesensitivity
ontheStanfordORBdatasetwithMitsuba,onagridof8Ã—8Ã—8 oftheapproachtosomehyperparameters(e.g.regularizerweight,
parameters(roughness,metallicity,basecolor).Wecomputethe numberofsphericalharmonicsdegrees).Wevaryourmethodand
Pearsoncorrelationcoefficient,ğœŒ,betweenentropycomputedwith reporttheresultsonStanfordORBandthesyntheticdataset.Further
ourpowerspectrumapproximationandtheonecomputedwith ablationsonspherical-harmonicsfittingareintheAppendix.
Mitsubaâ€™sfully-fledgeddifferentiablerenderer.Wefindahighcorre-
5.5.1 BRDFmodelvariants. Tounderstandwhetherourproposed
lationbetweenentropycomputedwithMitsubaandbothourmixed
improvementstotheBRDFmodelbyRamamoorthiandHanrahan
rendererğœŒ =0.90andthepowerspectrumapproximationğœŒ =0.89
[2001]resultinhigher-qualityacquisitionresults,westudyvariants
asshowninTable3.Thisvalidatesthattheentropywecompute
ofourmodelwithandwithouttheshadowingandmaskingterms.
withourpowerspectrumbasedmodelisindeedsimilartothatcom-
Werunourablationswithaconstantweightonallthesamples.The
putedwithafully-fledgeddifferentiablerenderer.Further,asour
resultsonStanfordORBarepresentedinTable4.Weobservethatthe
powerspectrumapproximationisembarrassinglyparallelizable,we
shadowing-andmaskingtermsimprovetheresultsindependently
obtainextremespeedupsoverboththemixedsphericalharmonics
andwegetthebestresultswithboth.
method(2645Ã—)andMitsuba(800,000Ã—)makingouruncertainty
estimationverypractical. 5.5.2 ConvolutionalonlyvsDirectional. Oneofthemainbenefits
ofourmethodisthatwecanstudytheeffectoftheBRDFfullyin
5.4.2 Synthetic dataset. We also evaluate whether low entropy thesphericalharmonicsdomain.WecanperformthefullBRDF
isassociatedwithlowererrorafteroptimization,evenforresults recoveryprocedureinthesphericalharmonicdomainorthepower
optimizedwithanotherapproach(Mitsuba),indicatingifenough
informationisintheinput.Ifentropyishigh,wehaveahigher
Table3. ComparingcorrelationbetweenentropycomputedwithMitsuba
likelihoodofincorrectparameters,thoughtheymightstillbegood.
andourapproximations.
Indeedwedonotexpectaone-to-onecorrelation(ğœŒ =1).Forexam-
ple,ifthelikelihoodforparametersinuncertainregionsisuniform,
lowerrorinahighentropypartisequallylikelyashigherror.That EntropyMitsubaâ†‘ Time
meansacorrelationof0.5isthemostwecanreasonablyexpect.We EntropyMitsuba 1.00Â±0.00 15m
studythisbycomputingthecorrelationbetweenentropycomputed Entropyangular 0.90Â±0.05 2.91s
usingthepowerspectrumapproximationandthesquarederror Entropypowerspectrum 0.89Â±0.06 0.0011s
betweentheground-truthmaterialparametersandtheparameters
optimizedwithMitsuba.Ontopofuncertainty,therecouldbeother Table4. WeablatethedifferentcomponentsoftheBRDF.Forthisablation
factorsforerror,whichcouldresultinlowercorrelation(suchas wedonotapplyacosineweightingtothesamples,betterhighlightingthe
globalilluminationapproximations,approximatelightenvironment, impactoftheshadowingandmaskingterms.
andincorrectgeometry).InthelastrowofTable2weshowthe
correlationscores.WeshowinFigure6resultsoptimizedfromim-
StanfordORB Synthetic
agesrenderedunderthelightingenvironmentâ€œruralasphaltroadâ€
Shadowing Masking PSNR-Hâ†‘ PSNR-Lâ†‘ SSIMâ†‘ LPIPSâ†“ Time MSE Time
whichpresentsastrongdirectionalillumination(sun,outdoor,see
- - 25.646 32.809 0.973 0.035 1.09s 0.16 2.57s
supplementalfolder).Wecanseethatareaswhicharenotdirectly âœ“ - 26.245 33.399 0.975 0.034 1.21s 0.14 2.81s
litbythesunintheinputimagesexhibithigherentropy,intuitively, - âœ“ 26.070 33.101 0.974 0.035 1.19s 0.13 2.89s
withoutenoughobservedspecularsignal,uncertaintyishigh(this
âœ“ âœ“ 26.411 33.557 0.975 0.034 1.31s 0.12 3.14s
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 13
One GT Estimated GT Estimated GT Estimated Estimation Our
InputView BaseColor BaseColor Roughness Roughness Metallicity Metallicity Error Entropy
Fig.6. Wedemonstratetheinformativenessofourfastapproximateentropyforotherinverserenderingframeworks(inthiscase,Mitsuba).Weinterleave
groundtruthpropertiesandpropertiesestimatedwithMitsuba(basecolor,roughness,metallicity).Ontheright,weshowtheaverageestimationerror
followedbyourentropyestimation,whichisindependentofMitsubaâ€™sestimation.Weobservethatlowentropyisindicativeoflowererror,suggestingthatit
capturesthesufficiencyofinformationintheinputsignal.Onthediceexample(toprow),theâ€˜oneâ€™-faceislitlessthanotherfacesandweobservehighlights
withlowerintensity,leadingtohigherentropy.Whilewestillrecoverthewhitealbedocorrectly,theestimationofroughnessandmetallicityforthedothasa
higherror.Similarly,theinsideandlowerpartsofthedoughnutarelessobservedandnotlitbystronglightsources.Again,entropyishighinregionsofhigh
error(especiallyinmetallicity).Thetriceratopscollarisdown-facingandnotwell-litandourentropycapturesthelackofobservationthatleadstohigherror
inthemetallicitypart.
spectrumdomain,asdoneforourinitializationanduncertainty. 5.6.1 Initialization. Inthecomparisons,ourmethoddemonstrated
WeshowtheimpactofevaluatingtheBRDFparametersfromthe a fast and high-quality estimate of BRDF parameters. However,
powerspectruminrowfourofTable1,comparedtorunningour thereisstillbenefittofinetuningourresultswithadifferentiable
ourmixedfrequency-directionaloptimization(thirdrow).Asthese pathtracer.Suchastepcouldfinetunepartsofthematerialthat
approximationsdonotaccountforeffectssuchasFresnelorshadow- areaffectedbyglobalillumination(e.g.,incorners,ornearhighly
ing/masking,weobservelowerappearancematching,asexpected. reflectivesurfaces).Inthisexperiment,weshowthebenefitofthis
Theapproximationshoweverstillresultinaverygoodappearance approach by initializing material textures with the results from
matchandextremelyfastcomputation.Mostofthereportedtimings ourmethodandoptimizingthemwithMitsubaforoneepochand
inTable1reflectsthefittingofthesphericalharmonics,whichonly only16samplesperpixel(halfthesamplesweusedfortheother
hastobedoneonce,lettinguseasilyexplorehundredstothousands experiments).Thisfinetuningpassonlycosts14s,foratotalof20s
of possible parameter combinations in a fraction of a second to combinedwithoutmethodasinitialization.Thisisoverthreetimes
computeuncertainty. fasterthanthe70srequiredwithoutthisinitialization(Table1).The
resultsinTable5showthatthecombinationofourapproachanda
5.6 Applications
finetuningpasswithMitsubaforoneortwoepochsachievesbetter
Inourapplications,weshowhowfastacquisitionanduncertainty
performancethanonlyusingMitsuba(+0.5dBPSNR-H,PSNR-L)
can be used in (SV)BRDF capture to improve results, and guide forlessthanathirdofthetime.Wealsosurpasstheresultsforonly
understandingoferror. ourmethod,whichistobeexpected.
5.6.2 Sharinginformation. Pointsonthesurfacewithlowentropy
Table5. Weapplyourresultsasaninitializationforashortfine-tuningpass havereasonablecertaintyandwilllikelyexhibitlowererrorthan
usinggradientdescentwithadifferentiablepathtracer(Mitsuba):weuse partswithhighentropy.Wecanusethisinformationtoselectthe
only1epochwith16samplesperpixelforthefirstthreerowsand2epochs
with32samplesperpixelforthefourthrow.Thefinalrowshowstheresult
Table6. Wecombinetheoptimizationresultsfrommultipleenvironments
ofafulloptimizationforMitsuba.
intoonetexturebyusingtheparameterwiththelowestcertainty.We
presenttheMSEinthefollowingway:Average(BaseColor,Roughness,
Initialization PSNR-Hâ†‘ PSNR-Lâ†‘ SSIMâ†‘ LPIPSâ†“ Totaltime Metallicity)
Constant 24.339 30.558 0.969 0.047 14.74s
Ours-SpectrumOnly 25.745 33.158 0.975 0.033 16.29s
Ours 27.038 34.560 0.978 0.030 19.87s MSESynthetic
Ours(2epochs) 27.199 34.770 0.978 0.029 33.39s Average 0.04(0.01,0.03,0.07)
Fulloptimization-Constant 26.595 34.185 0.977 0.032 69.96s argminEntropy 0.03(0.01,0.02,0.06)
,Vol.1,No.1,Article.Publicationdate:June2024.14 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
BaseColor Roughness Metallic Entropy Relighting1 Relighting2 Relighting3
Fig.7. WecompareourresultstoMitsubaandgroundtruthparametersonsyntheticdata.Weseethatweachievesimilarmatchingqualitywitha35x
speedupintheoptimization.Therelitrenderingsarefromtestviewsusingalightingenvironmentunseenduringoptimization.Heretooweseethatentropyis
higherwhereinputsprovidelessinformation(seesupplementalmaterialsforinputs).
,Vol.1,No.1,Article.Publicationdate:June2024.
sruO
abustiM
hturTdnuorG
sruO
abustiM
hturTdnuorG
sruO
abustiM
hturTdnuorGFastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 15
0.84 shadowingandmaskingtobetterreconstructthetargetappearance
0.075
andestimatedproperties,comparedtotheexistingsignalprocessing
0.070 0.82
frameworkforinverserendering.Ourmethodyieldsresultsthatare
0.065 0.80 onparwiththestate-of-the-artfora13xspeedupinoptimization
0.060 MSE Average entropy and,combinedwithstate-of-the-art,yieldsimprovedresultsforless
0.78
0.055 thanathirdofthetime.
0.050 0.76 Weseethefollowingchallengesforfuturework.Ourmethod
10 20 30 40 10 20 30 40 requiresHDRimagesasinput,becausethetruncationappliedfor
Number of views Number of views
LDRimagescouldintroducefrequenciesthatarenotpresentinthe
Fig.8. PlotsofMSEandEntropyforvaryinginputviewcountsonthesyn- originalsignal.Tomakeourmethodmoreaccessibleforusewith
theticbenchmarkwiththeRuralRoadenvironment,showingthatentropy LDRimages,itisofinteresttostudyhowtousesphericalharmonics
canbeusedasaproxyofaverageMSEforagivensetofviews. decompositionsonLDRimages.Thiscouldbeimplemented,for
example,asanamendmenttotheleast-squaresfittingprocedure.
Ourcurrentimplementationonlyconsidersdirectillumination,ne-
bestconditionstorecoverBRDFparameters,forexamplefromdif- glectingself-illuminationandself-shadowingwhichmayappear
ferentlightingsetups.Asaproofofconcept,wemergethetexture inchallengingconcaveobjects;ourmethodcouldbeextendedto
mapsfromthesyntheticscenesbasedonentropy:foreverytexel,we takethemintoaccountwitharaytracer,asourcoretheoretical
usetheparametersfromtheenvironmentwiththelowestentropy andalgorithmiccontributionsaredefinedforageneraldirectional
atthattexel.TheresultinTable6showsthatthissimpleapproach radiancefieldforpointsinspace.Nonetheless,ourmethodproduces
beatstheaverageoverseparateenvironmentsby25%.Thescoreis accurateestimationsofmaterialsandcanbeusedasaninitialization
equaltothebest-performingenvironmentinTable2.Withthis,we formorecomplete(andslower)differentiablerenderer[Jakobetal.
areabletoselectthebestparameterswithoutknowingtheground- 2022]forareasshowingeffectsthatwedonotcurrentlysupport.
truth. We believe that this approach would yield even stronger Webelievethatourrenewedexplorationandimprovementofthe
resultsinthecontextofmorecomplementaryenvironments. frequency-basedmodeldemonstratesthemeritsofthisframework.
Weareexcitedaboutfurtherapplicationsthattakeadvantageof
5.6.3 Guidingcapture. Entropycanbeappliedduringcaptureasa entropyasameasureofuncertaintyformaterialrecovery.
measuretodefinethemostinformativeviews.Ifaviewdecreases
entropy,itâ€™suseful;ifitdoesnot,wecoulddiscardit.Itisdifficult REFERENCES
toknowwhatinformationaviewwilladdwithoutknowingits
MiikaAittala,TimoAila,andJaakkoLehtinen.2016.Reflectancemodelingbyneural
contents.Asolutiontothiscouldbetocomputeanexpecteddecrease texturesynthesis.ACMTrans.Graph.35,4,Article65(jul2016),13pages. https:
inentropy(informationgain)incasepotentialviewsarenotknown. //doi.org/10.1145/2897824.2925917
MiikaAittala,TimWeyrich,andJaakkoLehtinen.2013.PracticalSVBRDFcapturein
Sincethisisnotpartofourcorecontribution,weleavethisfor
thefrequencydomain.ACMTrans.Graph.32,4(2013),110â€“1.
futurework.Instead,weshowthatentropyisusefultomeasure MiikaAittala,TimWeyrich,JaakkoLehtinen,etal.2015.Two-shotSVBRDFcapture
theinformativenessofviews.Weranthesyntheticbenchmarkfor forstationarymaterials.ACMTrans.Graph.34,4(2015),110â€“1.
SaiBi,ZexiangXu,PratulP.Srinivasan,BenMildenhall,KalyanSunkavalli,MilosHasan,
oneenvironment(RuralRoad)andrandomlydropoutviewsfor YannickHold-Geoffroy,DavidJ.Kriegman,andRaviRamamoorthi.2020.NeuralRe-
everyoptimization.InFigure8,weshowthecorrespondingaverage flectanceFieldsforAppearanceAcquisition.abs/2008.03824(2020).arXiv:2008.03824
MSEoverallshapesandchannelsandtheaverageentropyover https://arxiv.org/abs/2008.03824
MarkBoss,RaphaelBraun,VarunJampani,JonathanTBarron,CeLiu,andHendrik
allshapes.WeobserveaclearrelationshipbetweentheMSEand Lensch.2021a.Nerd:Neuralreflectancedecompositionfromimagecollections.In
entropy,demonstratingthatwecanuseentropyasaproxyforthe ProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.12684â€“
12694.
expectedsuccessofanoptimization.Ifoneweretouseentropyin
MarkBoss,VarunJampani,RaphaelBraun,CeLiu,JonathanBarron,andHendrik
realtime,thealternativestothepowerspectrumapproximation Lensch.2021b.Neural-pil:Neuralpre-integratedlightingforreflectancedecomposi-
quicklybecometedioustouse:foreveryframethatisconsidered, tion.AdvancesinNeuralInformationProcessingSystems34(2021),10691â€“10704.
MarkBoss,VarunJampani,KihwanKim,HendrikLensch,andJanKautz.2020.Two-
onewouldeitherhavetowaitacoupleofsecondsorminutesto shotspatially-varyingbrdfandshapeestimation.InProceedingsoftheIEEE/CVF
computetheentropy(Table3). ConferenceonComputerVisionandPatternRecognition.3982â€“3991.
BrentBurleyandWaltDisneyAnimationStudios.2012.Physically-basedshadingat
6 CHALLENGESANDCONCLUSION disney.InAcmSiggraph,Vol.2012.vol.2012,1â€“7.
WesleyChang,VenkataramSivaram,DerekNowrouzezahrai,ToshiyaHachisuka,Ravi
Ramamoorthi,andTzu-MaoLi.2023.Parameter-spaceReSTIRforDifferentiableand
Insummary,wepresentamaterialacquisitionanduncertaintyesti-
InverseRendering.InACMSIGGRAPH2023ConferenceProceedings(LosAngeles,
mationmethodformulti-viewcaptureofobjectsusingafrequency CA,USA)(SIGGRAPHâ€™23).AssociationforComputingMachinery,NewYork,NY,
domainanalysis.Wedosothroughefficientsphericalharmonics USA,10pages. https://doi.org/10.1145/3588432.3591512
ValentinDeschaintre,MiikaAittala,FredoDurand,GeorgeDrettakis,andAdrien
fittingandapowerspectrumapproximationthatletsusefficiently
Bousseau.2018.Single-imagesvbrdfcapturewitharendering-awaredeepnetwork.
compute the error associated with varying material parameters ACMTransactionsonGraphics(ToG)37,4(2018),1â€“15.
forasurface.Byinterpretingthiserrorasalikelihoodfunction, ValentinDeschaintre,MiikaAittala,FrÃ©doDurand,GeorgeDrettakis,andAdrien
Bousseau.2019. Flexiblesvbrdfcapturewithamulti-imagedeepnetwork.In
wecanuseentropyasameasureofuncertainty.Theresultsindi- Computergraphicsforum,Vol.38.WileyOnlineLibrary,1â€“13.
catecorrelationoflowentropywithlowerror,bothquantitatively ValentinDeschaintre,GeorgeDrettakis,andAdrienBousseau.2020. GuidedFine-
TuningforLarge-ScaleMaterialTransfer.ComputerGraphicsForum(Proceedingsof
andqualitatively.Weshowthatentropycanbeausefulproxyfor
theEurographicsSymposiumonRendering)39,4(2020). http://www-sop.inria.fr/
acquisitionquality.Wealsoproposeawaytotakeintoaccount reves/Basilic/2020/DDB20
,Vol.1,No.1,Article.Publicationdate:June2024.16 â€¢ RubenWiersma,JulienPhilip,MiloÅ¡HaÅ¡an,KrishnaMullia,FujunLuan,ElmarEisemann,andValentinDeschaintre
ValentinDeschaintre,YimingLin,andAbhijeetGhosh.2021.Deeppolarizationimaging Hendrik P.A. Lensch, Jochen Lang, Asla M. SÃ¡, and Hans-Peter Seidel. 2003b.
for3DshapeandSVBRDFacquisition.InProceedingsoftheIEEE/CVFConferenceon Planned Sampling of Spatially Varying BRDFs. Computer Graphics Fo-
ComputerVisionandPatternRecognition.15567â€“15576. rum 22, 3 (2003), 473â€“482. https://doi.org/10.1111/1467-8659.00695
YueDong,GuojunChen,PieterPeers,JiawanZhang,andXinTong.2014.Appearance- arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1111/1467-8659.00695
from-motion:Recoveringspatiallyvaryingsurfacereflectanceunderunknown XiaoLi,YueDong,PieterPeers,andXinTong.2017.Modelingsurfaceappearancefrom
lighting.ACMTransactionsonGraphics(TOG)33,6(2014),1â€“12. asinglephotographusingself-augmentedconvolutionalneuralnetworks. ACM
J.R.DriscollandD.M.Healy.1994.ComputingFourierTransformsandConvolutions TransactionsonGraphics(ToG)36,4(2017),1â€“11.
onthe2-Sphere. AdvancesinAppliedMathematics15,2(1994),202â€“250. https: ZhengqinLi,ZexiangXu,RaviRamamoorthi,KalyanSunkavalli,andManmohan
//doi.org/10.1006/aama.1994.1008 Chandraker.2018.Learningtoreconstructshapeandspatially-varyingreflectance
JonathanDupuyandWenzelJakob.2018.AnAdaptiveParameterizationforEfficientMa- fromasingleimage.ACMTransactionsonGraphics(TOG)37,6(2018),1â€“11.
terialAcquisitionandRendering.TransactionsonGraphics(ProceedingsofSIGGRAPH GuillaumeLoubet,NicolasHolzschuch,andWenzelJakob.2019. Reparameterizing
Asia)37,6(Nov.2018),274:1â€“274:18. https://doi.org/10.1145/3272127.3275059 DiscontinuousIntegrandsforDifferentiableRendering.TransactionsonGraphics
FrÃ©doDurand,NicolasHolzschuch,CyrilSoler,EricChan,andFranÃ§oisX.Sillion. (ProceedingsofSIGGRAPHAsia)38,6(Dec.2019). https://doi.org/10.1145/3355089.
2005.Afrequencyanalysisoflighttransport.ACMTrans.Graph.24,3(jul2005), 3356510
1115â€“1126. https://doi.org/10.1145/1073204.1073320 ShiMao,ChenmingWu,ZhelunShen,andLiangjunZhang.2023.NeuS-PIR:Learn-
AndreasEngelhardt,AmitRaj,MarkBoss,YunzhiZhang,AbhishekKar,Yuanzhen ingRelightableNeuralSurfaceusingPre-IntegratedRendering. arXivpreprint
Li,DeqingSun,RicardoMartinBrualla,JonathanT.Barron,HendrikP.A.Lensch, arXiv:2306.07632(2023).
andVarunJampani.2024.SHINOBI:SHapeandIlluminationusingNeuralObject RosalieMartin,ArthurRoullier,RomainRouffet,AdrienKaiser,andTamyBoubekeur.
DecompositionviaBRDFOptimizationIn-the-wild.ArXive-prints(2024). 2022.MaterIA:SingleImageHigh-ResolutionMaterialCaptureintheWild.Com-
ChongruiFan,YimingLin,andAbhijeetGhosh.2023. DeepShapeandSVBRDF puterGraphicsForum(Proc.EUROGRAPHICS2022)toappear,toappear(2022),to
EstimationusingSmartphoneMulti-lensImaging.ComputerGraphicsForum(2023). appear.
https://doi.org/10.1111/cgf.14972 BenMildenhall,PratulP.Srinivasan,MatthewTancik,JonathanT.Barron,RaviRa-
Roland W. Fleming, Ron O. Dror, and Edward H. Adelson. 2003. Real- mamoorthi,andRenNg.2020.NeRF:RepresentingScenesasNeuralRadianceFields
world illumination and the perception of surface reflectance proper- forViewSynthesis.InECCV.
ties. Journal of Vision 3, 5 (07 2003), 3â€“3. https://doi.org/10.1167/3.5.3 JacobMunkberg,JonHasselgren,TianchangShen,JunGao,WenzhengChen,Alex
arXiv:https://arvojournals.org/arvo/content_public/journal/jov/932825/jov-3-5- Evans,ThomasMÃ¼ller,andSanjaFidler.2022. Extractingtriangular3dmodels,
3.pdf materials,andlightingfromimages.InProceedingsoftheIEEE/CVFConferenceon
YarinGalandZoubinGhahramani.2016.Dropoutasabayesianapproximation:Repre- ComputerVisionandPatternRecognition.8280â€“8290.
sentingmodeluncertaintyindeeplearning.Ininternationalconferenceonmachine GiljooNam,JooHoLee,DiegoGutierrez,andMinH.Kim.2018.PracticalSVBRDF
learning.PMLR,1050â€“1059. Acquisitionof3DObjectswithUnstructuredFlashPhotography.ACMTransactions
DuanGao,XiaoLi,YueDong,PieterPeers,KunXu,andXinTong.2019.Deepinverse onGraphics(Proc.SIGGRAPHAsia2018)37,6(2018),267:1â€“12. https://doi.org/10.
renderingforhigh-resolutionSVBRDFestimationfromanarbitrarynumberof 1145/3272127.3275017
images.ACMTrans.Graph.38,4(2019),134â€“1. BaptisteNicolet,AlecJacobson,andWenzelJakob.2021.LargeStepsinInverseRen-
AbhijeetGhosh,ShruthiAchutha,WolfgangHeidrich,andMatthewOâ€™Toole.2007. deringofGeometry.ACMTransactionsonGraphics(ProceedingsofSIGGRAPHAsia)
BRDFAcquisitionwithBasisIllumination.In2007IEEE11thInternationalConference 40,6(Dec.2021). https://doi.org/10.1145/3478513.3480501
onComputerVision.IEEE,RiodeJaneiro,Brazil,1â€“8. https://doi.org/10.1109/ICCV. BaptisteNicolet,FabriceRousselle,JanNovÃ¡k,AlexanderKeller,WenzelJakob,and
2007.4408935 ThomasMÃ¼ller.2023.RecursiveControlVariatesforInverseRendering.Transactions
LilyGoli,CodyReading,SilviaSellÃ¡n,AlecJacobson,andAndreaTagliasacchi.2024. onGraphics(ProceedingsofSIGGRAPH)42,4(Aug.2023). https://doi.org/10.1145/
Bayesâ€™Rays:UncertaintyQuantificationinNeuralRadianceFields.CVPR(2024). 3592139
JieGuo,ShuichangLai,ChengzhiTao,YuelongCai,LeiWang,YanwenGuo,and MerlinNimier-David,ZhaoDong,WenzelJakob,andAntonKaplanyan.2021.Mate-
Ling-QiYan.2021.Highlight-awaretwo-streamnetworkforsingle-imageSVBRDF rialandLightingReconstructionforComplexIndoorSceneswithTexture-space
acquisition. ACMTrans.Graph.40,4,Article123(jul2021),14pages. https: DifferentiableRendering.InEurographicsSymposiumonRendering-DL-onlyTrack,
//doi.org/10.1145/3450626.3459854 Adrien Bousseau and Morgan McGuire (Eds.). The Eurographics Association.
YuGuo,CameronSmith,MiloÅ¡HaÅ¡an,KalyanSunkavalli,andShuangZhao.2020. https://doi.org/10.2312/sr.20211292
Materialgan:reflectancecaptureusingagenerativesvbrdfmodel.arXivpreprint MerlinNimier-David,ThomasMÃ¼ller,AlexanderKeller,andWenzelJakob.2022.Unbi-
arXiv:2010.00114(2020). asedInverseVolumeRenderingwithDifferentialTrackers.ACMTrans.Graph.41,
PhilippHenzler,ValentinDeschaintre,NiloyJMitra,andTobiasRitschel.2021.Gen- 4,Article44(July2022),20pages. https://doi.org/10.1145/3528223.3530073
erativeModellingofBRDFTexturesfromFlashImages.ACMTransGraph(Proc. MerlinNimier-David,SÃ©bastienSpeierer,BenoÃ®tRuiz,andWenzelJakob.2020.Radiative
SIGGRAPHAsia)40,6(2021). Backpropagation:AnAdjointMethodforLightning-FastDifferentiableRendering.
InseungHwang,DanielS.Jeon,AdolfoMuÃ±oz,DiegoGutierrez,XinTong,andMinH. TransactionsonGraphics(ProceedingsofSIGGRAPH)39,4(July2020). https://doi.
Kim.2022.SparseEllipsometry:PortableAcquisitionofPolarimetricSVBRDFand org/10.1145/3386569.3392406
ShapewithUnstructuredFlashPhotography.ACMTransactionsonGraphics(Proc. MerlinNimier-David,DelioVicini,TizianZeltner,andWenzelJakob.2019.Mitsuba2:
SIGGRAPH2022)41,4(2022). ARetargetableForwardandInverseRenderer.TransactionsonGraphics(Proceedings
WenzelJakob,SÃ©bastienSpeierer,NicolasRoussel,MerlinNimier-David,DelioVicini, ofSIGGRAPHAsia)38,6(Dec.2019). https://doi.org/10.1145/3355089.3356498
TizianZeltner,BaptisteNicolet,MiguelCrespo,VincentLeroy,andZiyiZhang.2022. MattPharr,WenzelJakob,andGregHumphreys.2023.Physicallybasedrendering:From
Mitsuba3renderer. https://mitsuba-renderer.org. theorytoimplementation.MITPress.
EdwinTJaynes.1957.Informationtheoryandstatisticalmechanics.Physicalreview RaviRamamoorthiandPatHanrahan.2001.Asignal-processingframeworkforinverse
106,4(1957),620. rendering.InProceedingsofthe28thannualconferenceonComputergraphicsand
HaianJin,IsabellaLiu,PeijiaXu,XiaoshuaiZhang,SongfangHan,SaiBi,Xiaowei interactivetechniques(SIGGRAPHâ€™01).AssociationforComputingMachinery,New
Zhou,ZexiangXu,andHaoSu.2023. TensoIR:TensorialInverseRendering. York,NY,USA,117â€“128. https://doi.org/10.1145/383259.383271
arXiv:2304.12461 C.Rodriguez-Pardo,H.Dominguez-Elvira,D.Pascual-Hernandez,andE.Garces.2023.
BernhardKerbl,GeorgiosKopanas,ThomasLeimkÃ¼hler,andGeorgeDrettakis.2023. UMat:Uncertainty-AwareSingleImageHighResolutionMaterialCapture.In2023
3DGaussianSplattingforReal-TimeRadianceFieldRendering.ACMTransactionson IEEE/CVFConferenceonComputerVisionandPatternRecognition(CVPR).IEEE
Graphics42,4(July2023).https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/ ComputerSociety,LosAlamitos,CA,USA,5764â€“5774. https://doi.org/10.1109/
ZhengfeiKuang,YunzhiZhang,Hong-XingYu,SamirAgarwala,ShangzheWu,andJia- CVPR52729.2023.00558
junWu.2023.Stanford-ORB:AReal-World3DObjectInverseRenderingBenchmark. RaduAlexandruRosuandSvenBehnke.2023.PermutoSDF:FastMulti-ViewReconstruc-
arXiv:2310.16044[cs.CV] tionwithImplicitSurfacesusingPermutohedralLattices.InIEEE/CVFConference
SamuliLaine,JanneHellsten,TeroKarras,YeonghoSeol,JaakkoLehtinen,andTimo onComputerVisionandPatternRecognition(CVPR).
Aila.2020. ModularPrimitivesforHigh-PerformanceDifferentiableRendering. VirajShah,SvetlanaLazebnik,andJulienPhilip.2023.JoIN:JointGANsInversionfor
ACMTransactionsonGraphics39,6(2020). IntrinsicImageDecomposition.arXiv(2023).
HendrikLensch,JanKautz,MichaelGoesele,WolfgangHeidrich,andHans-PeterSeidel. LiangShi,BeichenLi,MiloÅ¡HaÅ¡an,KalyanSunkavalli,TamyBoubekeur,Radomir
2003a.Image-basedReconstructionofSpatialAppearanceandGeometricDetail. Mech,andWojciechMatusik.2020. MATch:DifferentiableMaterialGraphsfor
ACMTransactionsonGraphics(TOG)22(042003),234â€“257. https://doi.org/10.1145/ ProceduralMaterialCapture.ACMTrans.Graph.39,6(Dec.2020),1â€“15.
636886.636891 AndrewSpielberg,FangchengZhong,KonstantinosRematas,KrishnaMurthyJataval-
labhula,CengizÃ–ztireli,Tzu-MaoLi,andDerekNowrouzezahrai.2023. Differ-
entiableVisualComputingforInverseProblemsandMachineLearning. CoRR
,Vol.1,No.1,Article.Publicationdate:June2024.FastandUncertainty-AwareSVBRDFRecoveryfromMulti-ViewCaptureusingFrequencyDomainAnalysis â€¢ 17
abs/2312.04574(2023). https://doi.org/10.48550/ARXIV.2312.04574arXiv:2312.04574 ProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.3848â€“3858.
PratulPSrinivasan,BoyangDeng,XiumingZhang,MatthewTancik,BenMildenhall, PeiyuXu,SaiBangaru,Tzu-MaoLi,andShuangZhao.2023.Warped-AreaReparameter-
andJonathanTBarron.2021. Nerv:Neuralreflectanceandvisibilityfieldsfor izationofDifferentialPathIntegrals.ACMTrans.Graph.42,6(2023),213:1â€“213:18.
relightingandviewsynthesis.InProceedingsoftheIEEE/CVFConferenceonComputer ZexiangXu,JannikBollNielsen,JiyangYu,HenrikWannJensen,andRaviRamamoorthi.
VisionandPatternRecognition.7495â€“7504. 2016.MinimalBRDFsamplingfortwo-shotnear-fieldreflectanceacquisition.ACM
ChengSun,GuangyanCai,ZhengqinLi,KaiYan,ChengZhang,CarlMarshall,Jia-Bin TransactionsonGraphics(TOG)35,6(2016),1â€“12.
Huang,ShuangZhao,andZhaoDong.2023.Neural-PBIRReconstructionofShape, KaiYan,ChristophLassner,BrianBudge,ZhaoDong,andShuangZhao.2022.Efficient
Material,andIllumination.InProceedingsoftheIEEE/CVFInternationalConference EstimationofBoundaryIntegralsforPath-SpaceDifferentiableRendering.ACM
onComputerVision.18046â€“18056. Trans.Graph.41,4(2022),123:1â€“123:13.
K.E.TorranceandE.M.Sparrow.1967. TheoryforOff-SpecularReflectionFrom KaiZhang,FujunLuan,QianqianWang,KavitaBala,andNoahSnavely.2021a.Physg:
RoughenedSurfacesâˆ—.J.Opt.Soc.Am.57,9(Sep1967),1105â€“1114. https://doi.org/ Inverserenderingwithsphericalgaussiansforphysics-basedmaterialeditingand
10.1364/JOSA.57.001105 relighting.InProceedingsoftheIEEE/CVFConferenceonComputerVisionandPattern
TSTrowbridgeandKarlPReitz.1975.Averageirregularityrepresentationofarough Recognition.5453â€“5462.
surfaceforrayreflection.JOSA65,5(1975),531â€“536. XiumingZhang,PratulPSrinivasan,BoyangDeng,PaulDebevec,WilliamTFree-
GiuseppeVecchio,RosalieMartin,ArthurRoullier,AdrienKaiser,RomainRouffet, man,andJonathanTBarron.2021b.Nerfactor:Neuralfactorizationofshapeand
ValentinDeschaintre,andTamyBoubekeur.2023.ControlMat:ControlledGenera- reflectanceunderanunknownillumination.ACMTransactionsonGraphics(ToG)
tiveApproachtoMaterialCapture.arXivpreprintarXiv:2309.01700(2023). 40,6(2021),1â€“18.
DelioVicini,SÃ©bastienSpeierer,andWenzelJakob.2022.DifferentiableSignedDistance YoujiaZhang,TengXu,JunqingYu,YutengYe,YanqingJing,JunleWang,JingyiYu,
FunctionRendering.TransactionsonGraphics(ProceedingsofSIGGRAPH)41,4(July andWeiYang.2023.Nemf:Inversevolumerenderingwithneuralmicroflakefield.
2022),125:1â€“125:18. https://doi.org/10.1145/3528223.3530139 InProceedingsoftheIEEE/CVFInternationalConferenceonComputerVision.22919â€“
BruceWalter,StephenRMarschner,HongsongLi,andKennethETorrance.2007. 22929.
Microfacetmodelsforrefractionthroughroughsurfaces.InProceedingsofthe18th YiZheng,KaiWei,BinLiang,YingLi,andXinhuiChu.2019.Zernikelikefunctions
EurographicsconferenceonRenderingTechniques.195â€“206. onsphericalcap:principleandapplicationsinopticalsurfacefittingandgraphics
Mark A. Wieczorek and Matthias Meschede. 2018. SHTools: Tools for rendering.OpticsExpress27,26(Dec.2019),37180. https://doi.org/10.1364/OE.27.
Working with Spherical Harmonics. Geochemistry, Geophysics, Geosys- 037180
tems 19, 8 (2018), 2574â€“2592. https://doi.org/10.1029/2018GC007529 XilongZhou,MiloÅ¡HaÅ¡an,ValentinDeschaintre,PaulGuerrero,KalyanSunkavalli,
arXiv:https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/2018GC007529 andNimaKhademiKalantari.2023. ASemi-ProceduralConvolutionalMaterial
HaoqianWu,ZhipengHu,LinchengLi,YongqiangZhang,ChangjieFan,andXinYu. Prior.InComputerGraphicsForum.WileyOnlineLibrary.
2023a. NeFII:InverseRenderingforReflectanceDecompositionwithNear-Field XilongZhouandNimaKhademiKalantari.2021.AdversarialSingle-ImageSVBRDF
IndirectIllumination.InProceedingsoftheIEEE/CVFConferenceonComputerVision EstimationwithHybridTraining.ComputerGraphicsForum(2021).
andPatternRecognition.4295â€“4304. XilongZhouandNimaKhademiKalantari.2022.Look-AheadTrainingwithLearnedRe-
LiwenWu,RuiZhu,MustafaBYaldiz,YinhaoZhu,HongCai,JanarbekMatai,Fatih flectanceLossforSingle-ImageSVBRDFEstimation.ACMTransactionsonGraphics
Porikli,Tzu-MaoLi,ManmohanChandraker,andRaviRamamoorthi.2023b.Factor- 41,6(122022). https://doi.org/10.1145/3550454.3555495
izedInversePathTracingforEfficientandAccurateMaterial-LightingEstimation.In
,Vol.1,No.1,Article.Publicationdate:June2024.