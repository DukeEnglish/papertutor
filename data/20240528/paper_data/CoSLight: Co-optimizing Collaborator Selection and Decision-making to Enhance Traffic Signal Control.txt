CoSLight: Co-optimizing Collaborator Selection and
Decision-making to Enhance Traffic Signal Control
JingqingRuanâ€  ZiyueLiâˆ— HuaWei
ruanjingqing2019@ia.ac.cn zlibn@wiso.uni-koeln.de hzw77@ist.psu.edu
InstituteofAutomation,Chinese UniversityofCologne ArizonaStateUniversity
AcademyofSciences EWIgGmbH Arizona,U.S.A
Beijing,China Cologne,Germany
HaoyuanJiangÂ§ JiamingLuâ€  XuantangXiong
jianghaoyuan@zju.edu.cn lujia_ming@126.com xiongxuantang2021@ia.ac.cn
SenseTimeResearch SenseTimeResearch InstituteofAutomation,Chinese
BaiduInc. ISTBIofFudanUniversity AcademyofSciences
Shenzhen,China Shanghai,China Beijing,China
HangyuMaoâˆ— RuiZhao
maohangyu@senstime.com zhaorui@sensetime.com
SenseTimeResearch SenseTimeResearch
Beijing,China QingYuanResearchInstituteof
ShanghaiJiaoTongUniversity
Beijing,China
ABSTRACT KEYWORDS
Effectivemulti-intersectioncollaborationispivotalforreinforcement- TrafficSignalControl,Multi-intersectionTransportation,Multia-
learning-basedtrafficsignalcontroltoalleviatecongestion.Existing gentSystems,Multi-agentReinforcementLearning
workmainlychoosesneighboringintersectionsascollaborators.
ACMReferenceFormat:
However,quiteanamountofcongestion,evensomewide-range
JingqingRuanâ€ ,ZiyueLiâˆ—,HuaWei,HaoyuanJiangÂ§,JiamingLuâ€ ,Xuan-
congestion,iscausedbynon-neighborsfailingtocollaborate.To
tangXiong,HangyuMaoâˆ—,andRuiZhao.2018.CoSLight:Co-optimizing
addresstheseissues,weproposetoseparatethecollaboratorselec- CollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalCon-
tionasasecondpolicytobelearned,concurrentlybeingupdated trol.InProceedingsofMakesuretoenterthecorrectconferencetitlefromyour
withtheoriginalsignal-controllingpolicy.Specifically,theselection rightsconfirmationemai(Conferenceacronymâ€™XX).ACM,NewYork,NY,
policyinreal-timeadaptivelyselectsthebestteammatesaccord- USA,25pages.https://doi.org/XXXXXXX.XXXXXXX
ingtophase-andintersection-levelfeatures.Empiricalresultson
bothsyntheticandreal-worlddatasetsproviderobustvalidation 1 INTRODUCTION
forthesuperiorityofourapproach,offeringsignificantimprove- TrafficSignalControl(TSC)playsacriticalroleinmanagingurban
mentsoverexistingstate-of-the-artmethods.Codeisavailableat trafficflowandalleviatingcongestion.Overthepastdecade,multi-
https://github.com/AnonymousAccountss/CoSLight. agentreinforcementlearning(MARL)hasemergedasapowerful
toolforoptimizingTSC[11,44].However,effectivelypromoting
CCSCONCEPTS
multi-intersectioncollaborationremainsapersistentchallengein
â€¢Computingmethodologiesâ†’Neuralnetworks;Partially-observable applyingMARLtoTSC.
Markovdecisionprocesses;Multi-agentreinforcementlearning; Traditionally,researchershavetreatedgeographicallyadjacent
Sequentialdecisionmaking. intersectionsasnaturalcollaborators,andcombinedMARLmeth-
odswithgraphneuralnetworks(GNNs)[4,7,19,27,43,47,51]
â€ TheseauthorsworkasresearchinternsatSenseTimeResearch.
andapproachesmulti-levelembeddings[10,12,17,25,29,55]to
Â§WorkdoneatSenseTimeResearch,nowinBaiduInc.
âˆ—Thecorrespondingauthor. modelmulti-intersectioncollaboration.However,thecollaboration
amongintersectionsmightbefarbeyondtopologicalproximityin
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor therealworld[48,58].Forinstance,duringmorningrushhours,
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation signalsfromresidentialtobusinessareasmustbestrategicallyco-
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe ordinatedtofacilitatedrivingintown.AsshowninFigure1(a),
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
intersectionsinupperstreamsshouldregulateincomingtrafficto
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/orafee.Requestpermissionsfrompermissions@acm.org. preventdownstreamcongestion,requiringthemtosynchronize
Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY withsignalsclosertobusinessdistricts,whichdirecttraffictowards
Â©2018Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM. parkingandalternateroutes.Thiscoordinationgoesbeyondmere
ACMISBN978-1-4503-XXXX-X/18/06
https://doi.org/XXXXXXX.XXXXXXX proximity,emphasizingtheneedfordynamicandnon-adjacent
4202
yaM
72
]AM.sc[
1v25171.5042:viXraConferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
Weconductcomprehensiveexperimentsusingbothsynthetic-
andrealdatawithdifferenttrafficflowandnetworkstructures.
Residential area
Ourmethodconsistentlyoutperformsstate-of-the-artRLmethods,
whichshowsthattheeffectivenessofcollaboratorselectionand
Business area
jointoptimizationwithdecisionpolicy.Wefurthershowcasethat
Coordination theselectedcollaboratorsarenotnecessarilygeographicneighbors,
andvisualizeseveralinterestingcollaborationstrategieslearnedby
(a) Morning Rush Hours (b) Evening Rush Hours
ourmethodtoshowthatourcollaboratorselectioniseffectiveand
generalizabletodifferentroadnetworks.
Ï ï¿½ w/o optimization Ï ï¿½,ï¿½ joint optimization
Insummary,ourcontributionisthefollowing:
â€¢ CoSLightisthefirstworktodecoupleandco-optimizethe
suboptimal
collaboratorselectionpolicyandsignalplanningpolicy.
ï¿½ ï¿½âˆ— ï¿½âˆ—
â€¢ Specifically,CoSLightcombinesaDual-FeatureExtractor,
capturingbothphase-andintersection-levelfeatures,witha
Î¸ Î¸
Multi-IntersectionCollaborationmoduledesignedtostrate-
(c) Fixed Ï, with Optimized Î¸ (d) Joint Optimization of Ï and Î¸ gicallychoosecooperatingintersections.Moreover,ajoint
optimizationstrategyisderivedtoco-trainthecollaborator
Figure1:(a)-(b):Thecoordinationbetweenareasofintersec-
selectionanddecision-makingpolicies,whichusesajoint
tionsduringrushhours;(c)-(d):Thecollaborationpolicyğ†
policygradienttoenhancethecumulativereturn,empha-
anddecisionpolicyğœ½ shouldbejointlyoptimizedtoprevent
sizingtheinterdependencebetweencollaborationselection
suboptimal.
anddecision-making.
â€¢ Extensiveevaluationsandmulti-dimensionalanalysisusing
collaborationacrossthenetwork.Likewise,duringeveningrush syntheticandreal-worlddatasetsdemonstratetheeffective-
hoursinFigure1(b),signalsfrombusinesstoresidentialareasalso nessandsuperiorityofCoSLight.
needtocooperateforbetterdrivingoutoftown.Thecoordination
2 RELATEDWORK
betweenareasofintersectionsinthemorningandeveningpeaks
mostlydifferduetodifferentorigin-destinationflowsandother Inthissection,wereviewexistingapproachesbasedonhowthey
factorssuchasweatherandtrippurpose. collaborate:implicitandexplicitcollaboration.
Inthispaper,weproposeCoSLighttoinvestigatethecollabo- Implicitcollaborationonlyaccessesinformationfromother
rationamongintersectionsbeyondtopologicalneighbors,which agentsduringtheupdatephasetoassistgradientbackpropagation.
comesalongwithtwoquestions: MPLightrepurposesFRAP[57]foramulti-agentcontext.IPPO[1]
â€¢Whomtocollaborateforbetterdecisions?Whileexisting andMAPPO[50]tackleTSCproblemsdirectlyfromtheMARLper-
methods relying on heavy GNNs to learn whom to collaborate spective.Workslike[15,35]extendthesingle-agentDQNsolution
requireinformationpropagationwithinthewholenetwork,inreal- tomulti-agentscenariosusingthemax-pluscoordinationalgorithm.
time,thecollaboratorselectionmustbelightandagile.Inthispaper, OthermethodssuchasIntelliLight[45]andPressLight[42]enrich
weutilizeasimpletwo-layerMLPstructurefortop-ğ‘˜collaborator thestatespacebyleveragingdifferenttypesofadditionalinforma-
selection,whichnotonlyreducescomputationalcomplexity[9,33, tion,likeimageframesormaxpressure,respectively.FMA2C[21]
41]butalsoachievesbetterperformanceinexperiments.Instead andFedLight[49]considercollaborativeoptimizationfromfed-
of counting on GNNs to learn the relationships by themselves, eratedRL.However,thesemethodsfocusonmulti-intersection
weincorporatetwogoldenrulesintheMLPcollaborationmatrix: informationfromanupdatemechanismorgradientdesignperspec-
thatâ€œyouareyourbiggestcollaboratorâ€andâ€œmutualreciprocityâ€, tive,whilethedecentralizedexecutionleadstoweakattentionand
whichpenalizethediagonaltobethelargestandthematrixtobe mayhinderefficientmulti-intersectioncollaboration.
symmetric.Theserulessignificantlyimprovecollaborationbenefits. Explicitcollaborationallowsaccessingotheragentsâ€™infor-
â€¢Howtocollaborateandoptimizedecisions?Thegoodness mationduringthedecision-makingprocesstoenhancecollabo-
ofcollaboratorselectionlargelyinfluencesthegoodnessofthede- ration.Toovercometheshortcomingsofweakcollaborationin
cisionpolicy.Forexample,thetraditionalpracticeistofirstselect implicitstrategies,explicitcollaborationmethodscanbefurther
collaboratorswithouttrainingandthentodecidethesignalpolicy, categorizedintotwosub-classes.Onelineofresearchfocuseson
asshowninFigure1(c),whichcomeswithtwodrawbacks:(1)the multi-intersectionrepresentationextraction,suchasCoLight[43],
decisionpolicyforoneintersectionmightneedalongertimetoad- DynSTGAT[47],IG-RL[7],MaCAR[51],andMetaGAT[19],which
justtoitscollaborators,(2)thedecisionpolicyisoptimizedtowards utilizeGNNsasthefeatureextractortomodelrepresentationsof
maximizing the cumulative reward, while the collaborators are thecurrentintersectionanditsneighbors.However,thesemeth-
selectedseparatelywithoutacknowledgmentoftheperformance odsriskintroducingnoise,suchasunrelatedintersectionfeatures,
ofdecisionpolicy.Toaddressthischallenge,inthispaper,wede- intocollaboration;italsosuffersfromthecomputationalcomplex-
signajointoptimizationschemethatsimultaneouslytrainsthe ity of matrix multiplication. Another line of research leverages
collaborationselectionpolicyanddecisionpolicytomaximizethe group-basedcooperation[22,28,29,39,40].MT-GAD[13],and
cumulativereturnthroughajointpolicygradient,reinforcingthe JointLight[16]usesheuristicgrouping,whichrequiresmanualde-
strongcouplingbetweencollaborationpolicyanddecisionpolicy. sign,whileCGB-MATSC[38]appliesKNNgroupingdirectlybasedCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
onstateobservation,anon-parametricmethod.GeneraLight[53] Multi-IntersectionTrafficSignalControl(TSC).Ateachin-
utilizesğ‘˜-meanstoexecutetheflowclusteringtolearndiversemeta- tersection,anRLagentisdeployedtomanagethetrafficsignal
parameters.GPLight[18]utilizesmutualinformationandgathering control.Duringeachtimeunitdenotedasğ‘¡ ,theRLagent
ğ‘‘ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘›
constraintstoderivelatentrepresentations,whicharesubsequently ğ‘–observesthestateoftheenvironment,representedasğ‘œğ‘–.Itthen
ğ‘¡
clusteredintogroups.However,theirgroupingstrategiescannot determinestheactionğ‘ğ‘–,whichdictatesthesignalphaseforinter-
ğ‘¡
bedirectlyco-optimizedwiththedecision-makingprocessusing sectionğ‘–.Theobjectiveoftheagentğ‘–istochooseanoptimalaction
therewardsignalinRL,leadingtoapotentiallysuboptimalsignal (i.e.,determiningthemostappropriatesignalphase)tomaximize
policy. thecumulativereward.
Incontrasttotheseexistingmethods,weintroduceadual-feature QueueLength.Thequeuelengthateachintersectionğ‘–isdefined
extractortoderivecollaboratorrepresentationsbeneficialforcol- astheaggregatelengthofvehiclequeuesinallincominglanes
laboration.Furthermore,weproposeCoSpolicyco-learnedwith towardtheintersection,denotedas:
decisionpolicywithMIRL.Thisallowsfortheselectionofoptimal
collaboratorsandprimitiveactionforeachintersection,guiding ğ‘„ ğ‘™ğ‘– ğ‘’ğ‘› =âˆ‘ï¸ ğ‘(ğ‘™),ğ‘™ âˆˆL ğ‘–ğ‘– ğ‘›, (1)
intensecollaborationamongmultipleintersections.
whereğ‘(ğ‘™)isthequeuelengthinthelaneğ‘™.
3 PRELIMINARYANDPROBLEMSTATEMENT
Pressure.Pressurecanbedividedintointersection-wiseand
phase-wise categories. Intersection-wise pressure measures the
3.1 Preliminary imbalancebetweenincomingandoutgoingvehiclequeuesatan
Firstly,weintroducesomefundamentalconceptsrelatedtotraffic intersection,indicatingtrafficloaddiscrepancies.Phase-wisepres-
signal control, including traffic movement, signal phase, traffic sureconcernsaspecificsignalphaseğ‘.Eachsignalphasepermits
intersection,multi-intersectiontrafficsignalcontrol,queuelength, severaltrafficmovements,eachmarkedby(ğ‘™,ğ‘š).Letğ‘¥(ğ‘™,ğ‘š)sig-
andpressure.InFigure2,wegiveavisualrepresentationofthese nifythevehiclecountdifferencebetweenlaneğ‘™ andlaneğ‘šfora
conceptstofurtheraidunderstanding. movement(ğ‘™,ğ‘š),andthephase-wisepressureğ‘ƒ(ğ‘)denotesthecu-
mulativesumofthepressuresofallpermissiblemovementswithin
thatphase,i.e.,(cid:205) (ğ‘™,ğ‘š)ğ‘¥(ğ‘™,ğ‘š).
A B C D
E F G H 3.2 ProblemStatement
(b) Twelve Movements (c) Eight Phases
38 25 Then,weformulateğ‘-intersectionproblembasedonmultiagent
Left Lane 6
Through Lane 1 47 Phases A B C D E F G H Markov decision processes (MMDPs) [5] as collaborator-based
Right Lane
.....
MMDPs,whichcanbeexpressedas<{I},S,O,{Cğ‘–} ğ‘–ğ‘ =1,{Ağ‘–} ğ‘–ğ‘ =1,
Time steps t = 1 2 3 T - 2 T - 1 T P,ğ‘Ÿ,ğ›¾ >.ğ‘– âˆˆ I istheğ‘–ğ‘¡â„ intersection,ğ‘ isthenumberofinter-
(a) Four-arm Intersection (d) Phase Selection sections, and S,O are the global state space and local observa-
tionspace.Cğ‘– andAğ‘– denotetheselectedcollaboratorandaction
Figure2:(a)Theillustrationofintersection.(b)Thereare12
spacefortheğ‘–ğ‘¡â„ intersection.Welabelğ’Šğ’…ğ’”:=(ğ’Šğ’…ğ’”1,...,ğ’Šğ’…ğ’”ğ‘) âˆˆC
movements:[North,South,West,East(fourapproaches)]Ã—
andğ’‚ := (ğ‘1,...,ğ‘ğ‘) âˆˆ A thejointcollaboratoridentifiersand
[Left,Go-through,Right(threedirections)].Usually,turning
actionsforallintersections.P(Â·|ğ‘ ,ğ’Šğ’…ğ’”,ğ’‚)isthetransitiondynam-
right isnâ€™t signal-controlled, so only 8 movements (index
ics.Allintersectionssharethesamerewardfunctionğ‘Ÿ(ğ‘ ,ğ’Šğ’…ğ’”,ğ’‚) :
from1-8in(a))aresignal-controlled.(c)Aphaseistwonon-
SÃ—CÃ—A â†’ R.ğ›¾ âˆˆ (0,1) denotesadiscountfactor.Here,we
conflictingmovementsthatcanbereleasedtogether.There
are8phases,e.g.,phase-Acombinesmovements1and5.(d)
candenoteğœ =(ğ‘ 0,ğ’Šğ’…ğ’”0,ğ’‚0,ğ‘ 1,...)asthetrajectoryinducedbythe
Thesignal-controlpolicyistoselectonephaseforthenext
policyğ…ğ‘ğ‘™ğ‘™ ={{ğœŒğ‘– Â·ğœ‹ğ‘–} ğ‘–ğ‘ =1},whereğœŒğ‘– denotesthecollaboratorse-
lectionpolicy,andğœ‹ğ‘– isthedecisionpolicy.Alltheintersections
timestepaccordingtothetrafficcondition.
coordinatetogethertomaximizethecumulativediscountedreturn
TrafficIntersection.Atrafficintersection,wheremultipleroads E icğ‰ yâˆ¼ ağ… sğ‘ tğ‘™ğ‘™ he(cid:2)(cid:205) prğ‘¡âˆ o=0 duğ›¾ cğ‘¡ tğ‘Ÿ( oğ‘  fğ‘¡ s, eğ’Šğ’… leğ’” cğ‘¡ t, iğ’‚ oğ‘¡ n)(cid:3) p. oW lice yc ğœŒan ande dfi dn ee cit sh ie onov pe or la icll yjo ğœ‹in bt ap seo dl-
intersect,usestrafficsignalstocontrolvehicleflow.Figure2depicts onBayesianchainrules.
afour-armintersection,equippedwithlanesdesignatedforleft
turns,straighttravel,andrightturns.Itfeaturesfourroadsand ğ‘
twelvelanesforbothenteringandexitingtraffic.Wedenotethe
ğ…ğ‘ğ‘™ğ‘™ (ğ’Šğ’…ğ’”,ğ’‚|ğ‘ )=(cid:214) ğœŒğ‘– (ğ’Šğ’…ğ’”ğ‘– |ğ‘œğ‘– )Ã—ğœ‹ğ‘– (ğ‘ğ‘– |ğ‘œğ‘–,ğ’Šğ’…ğ’”ğ‘– ). (2)
incomingandoutgoinglanesatintersectionğ‘–asLğ‘– andLğ‘– . ğ‘–=1
ğ‘–ğ‘› ğ‘œğ‘¢ğ‘¡
TrafficMovement.Itreferstotheprogressionofvehiclesacross 4 METHODOLOGY
anintersectioninaspecificdirection,namely,turningleft,going
4.1 MainModules
straight,orturningright.AsdepictedinFigure2,twelvedistinct
trafficmovementscanbeidentified.Right-turningvehiclesusually As shown in Figure 3, the dual-feature extractor pre-processes
proceedregardlessofthesignalstatus. eachintersectionbyobtainingphase-andintersection-levelrep-
SignalPhase.Itisasetoftwotrafficmovementsthatcanbe resentations.Subsequently,theCoSidentifiesthemostappropri-
releasedtogetherwithoutconflicts.AsillustratedinFigure2,the atecollaboratorsandcollectstheirinformationtoassistwiththe
intersectioncompriseseightdistinctphasesA-H. decision-makingprocess.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
Phase
A
...
1 Diagonal maximization cons. 1638 4725 E FRAP   1    1  Te...T ao m Tp m o-k pTa -ot  kep-  k  Symmetry cons. ids Mean D Poe lc ii cs yion 1
sigCnomlleanbtorator  Teammate 1
H ssS ige nle mc eti no tn 
Policy
0.4 0.1 0.1 0.1 0.2
(CoS) 
0.1 0.6 0.1 0.1 0.1 sample Decision         0.1 0.1 0.5 0.2 0.1 ids Mean Policy  Phase ... 0.1 0.2 0.3 0.3 0.1   Softmax... 0.2 0.1 0.2 0.1 0.4 
A
Softmax... Collaborator Matrix
1638 4725 E FRAP         Softmax ids Mean D Poe lc ii cs yion  


H
Dual-Feature Extractor Multi-Intersection Collaboration
Figure3:OverviewofourproposedCoSLight:integratingDual-FeatureExtractorforphase-andintersection-levelfeatures
withthemoduleofMulti-IntersectionCollaborationtoselectteammatesforcooperation.
4.1.1 Dual-FeatureExtractor. Tooptimizepolicy-makinginTSC, comprehensiveinsighttoprovidesufficientrepresentationforsub-
acomprehensiverepresentationoftrafficsituationsisvital.While sequentmodeling.
phase-levelfeaturesinformindividualintersections,theylackbroader
4.1.2 Multi-IntersectionCollaboration. Themodulefacilitatesco-
coordinationinsightsfromcorrelatedintersections.Thus,wecom-
operation among multiple intersections. By leveraging the rich
plementthesewithintersection-levelfeaturestobettercapture
network-widetrafficdynamicsformulti-intersectioncontrolbased
representationğ’†ğ‘–ğ‘Ÿ,wedesigntheCoStoselectsuitablecollabora-
torsforeachintersection.
onTransformer[37].
Asmentionedbefore,sincethecollaborationpolicy(CoS)will
Atthephaselevel,weadoptFRAP[57]toobtainthephase-
beco-optimizedwiththedecisionpolicy,aliteandfastmoduleis
levelrepresentation.Therawobservationsğ‘œ fromthesimulator
preferredtoavoidbecomingthecomputationbottleneck.Thus,we
includeğ¾features,suchasthenumberofvehicles,queuelength,the
pursueminimalism:tousetwo-stackedMLPs.Surprisingly,weare
currentphase,theflow,etc.Foranytrafficmovementğ‘šâˆˆ{1,...,8}
notalone:incomputervision,MLP-Mixer[33]isexclusivelybased
inanintersectionğ‘–,theğ‘˜-thfeatureintherawobservationcanbe
onMLPandattainscompetitivescoresasCNN-basedmethodsor
denotedasğ‘œğ‘– .Forbrevity,thesuperscriptğ‘–isomittedhereinafter.
ğ‘š,ğ‘˜ evenViT.Inthespatiotemporaldomain,MLPInit[9]alsoproves
Theprocesscanbesummarizedasfollows.
thatMLPscouldbe600Ã—fasterthanGNNandachievescomparable
ğ’†ğ‘š=|| ğ‘˜ğ¾ =1ğœ(MLP ğ‘˜(ğ‘œ ğ‘š,ğ‘˜)),ğ’†ğ‘ğ‘ğ‘Ÿ =FRAP(ğ’†ğ‘š1,...,ğ’†ğ‘š8), (3) resultssinceMLPisfreefrommatrixmultiplication.GFS[41]gives
aninsightfulandtheoretically-rigidexplanation:MLPswithgen-
ğ’†ğ‘– ğ‘ğ‘Ÿ =MLP(ğ’†ğ‘ğ‘ğ‘Ÿ), (4) erallayernormalizationprovidesimilarfunctionalityand
where||isconcatenation,ğœistheactivationfunction,andğ’†ğ‘šisthe effectivenessofaggregatingnodes.Moreover,anablationstudy
embeddingoftrafficmovement.ThenFRAP(Â·)module(detailsin byreplacingMLPswithGNNsinSection6.5empiricallyconfirms
AppendixB)isappliedtoextractthephasecompetitionrepresenta- theeffectivenessofMLPs.
tionğ’†ğ‘ğ‘ğ‘Ÿ,andwereshapeğ’†ğ‘ğ‘ğ‘Ÿ asavectorthroughflattenoperation. Thus, the top-ğ‘˜ Collaborator Selection (CoS) policy is imple-
Finally,ğ’†ğ‘–
ğ‘ğ‘Ÿ
isthephaserepresentationintheintersectionğ‘–. mentedbytwo-stackedMLPlayers,
Attheintersectionlevel,weadopttheTransformerencoder[23, ğœ¶ğ‘– =ğ‘“ ğ¶ğ‘œğ‘†(ğ’†ğ‘–ğ‘Ÿ)=MLP(ğ’†ğ‘–ğ‘Ÿ), (6)
24,52]asthebackbonetomodeltherelationshipacrossmultiplein-
tersections:ittakesinthephaserepresentationsğ’†ğ‘ğ‘Ÿ ={ğ’†ğ‘– ğ‘ğ‘Ÿ} ğ‘–ğ‘ =1,ğ’†ğ‘ğ‘Ÿ âˆˆ w dih ste rr ie buğœ¶ tiğ‘– or nep cr ae nse bn ets coth ne stl ro ug ci tt es df :romtheMLP.Thentheprobability
Rğ‘Ã—ğ‘‘,ğ‘‘ istheinputdimension.Attentioncanbecalculatedto
(cid:32) exp(ğ›¼ğ‘–) (cid:33)
o mb at ta ii on nt fh re omint de ir ffse ec reti no tn i- nle tev re sl er ce tp iore ns se â€™n rt ea pt rio esn enğ’†ğ‘– tğ‘Ÿ a, tia ott ne sn .dingtoinfor- Pğ‘– :=ğ¶ğ‘ğ‘¡ğ‘’ğ‘”ğ‘œğ‘Ÿğ‘–ğ‘ğ‘ğ‘™ (cid:205) ğ‘—â€²âˆˆIexpğ‘— (ğ›¼ğ‘– ğ‘—â€²),ğ‘— âˆˆ I , (7)
fromwhichtheindicesoftheselectedcollaboratorsfortheintersec-
ğ’†ğ‘–ğ‘Ÿ =TransformerEnc(ğ’†ğ‘ğ‘Ÿ), ğ’†ğ‘–ğ‘Ÿ âˆˆRğ‘Ã—ğ‘‘, (5) tionğ‘–canbesampled.Here,wesetthehyper-parameterğ‘˜as5.We
The TransformerEnc is the standard Transformer encoder with cansamplethetop-ğ‘˜collaboratoridentifierswithoutreplacement
multi-head,followedbyafeed-forwardnetwork. fromPğ‘–,whichmeanssamplingthefirstelement,thenrenormal-
Insummary,byextractingfeaturesfromboththephase-and izingtheremainingprobabilitiestosamplethenextelement.Let
intersection-level simultaneously, we are able to obtain a more ğ¼ğ·âˆ—,...,ğ¼ğ·âˆ— bean(ordered)samplewithoutreplacementfromthe
1 ğ‘˜
...
...
...
...
...
...
...
...
Transformer
Backbone
...
...
... ... ... ... ... ... ... ... ... ... ... ...
...
...
...
...CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
Pğ‘–,thenthejointprobabilitycanbeformulatedasfollows. thematrixsignifiestheprobabilityofcollaboratorselectionbetween
ğ‘ƒ(ğ¼ğ· 1âˆ—=ğ‘–ğ‘‘ 1âˆ—,...,ğ¼ğ· ğ‘˜âˆ— =ğ‘–ğ‘‘ ğ¾âˆ—)=(cid:214) ğ‘–ğ‘˜
=1
(cid:205)
ğœ„e âˆˆx Ip ğ‘–âˆ—( eğ›¼ xğ‘–ğ‘– pğ‘‘ ğ‘–âˆ— (ğ›¼) ğœ„ğ‘–), (8) t mhe iR zi aun tt l ie e or n1se : cc â€œ ot Yi noo sun ts ra ağ‘– r ia e nn y td o iu sğ‘—. r imb pig og see dst .Tc ool pla rib oo rr ita izt eor iâ€ t. sD deia cig so ion na -l mm aka ix ni g-
whereğ‘–ğ‘‘âˆ—,...,ğ‘–ğ‘‘âˆ— =argtop-ğ‘˜(Pğ‘–)isthesampledtop-ğ¾ realization foreachintersection,weenforcethediagonalmaximizationcon-
ofvariab1 lesğ¼ğ·âˆ—ğ‘˜
,...,ğ¼ğ·âˆ—,andIâˆ—=I\{ğ‘–ğ‘‘âˆ—,...,ğ‘–ğ‘‘âˆ— }isthedomain
straintonthematrixğ‘´ğœŒ,ensuringitremainsavalidprobability
1 ğ‘˜ ğ‘– 1 ğ‘–âˆ’1 distributionmatrix.Themainobjectiveistomaximizethesumof
(withoutreplacement)fortheğ‘–-thsampledelement.Summarized
thediagonalelementswhilecomplyingwithspecificconstraints
as ğ’Šğ’…ğ’”ğ‘– âˆ¼ ğœŒğ‘–(ğ’†ğ‘–ğ‘Ÿ),where ğ’Šğ’…ğ’”ğ‘– âˆˆ Z1Ã—ğ‘˜ referstotheindicesofthe
thatrequiretheelementstobenon-negative,andtherowsums
selectedcollaboratorsforintersectionğ‘–,andğœŒrepresentstheCoS,
mustequal1:
whoseparametersaresharedamongallintersections.
With ğ’Šğ’…ğ’”ğ‘– and ğ’†ğ‘–ğ‘Ÿ, we obtain theğ‘˜ collaboratorsâ€™ representa-
ğ‘ ğ‘
tions:ğ’†ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š = lookup(ğ’†ğ‘–ğ‘Ÿ,ğ’Šğ’…ğ’”ğ‘–),wherelookupoperatorextracts maxâˆ‘ï¸ ğ‘€ ğ‘–ğœŒ ğ‘– ğ‘ .ğ‘¡. ğ‘€ ğ‘–ğœŒ ğ‘— â‰¥0,âˆ€ğ‘–,ğ‘—; âˆ‘ï¸ ğ‘€ ğ‘–ğœŒ ğ‘— =1,âˆ€ğ‘–. (13)
thevectoratindex ğ’Šğ’…ğ’”ğ‘– âˆˆ Z1Ã—ğ‘˜ frommatrix ğ’†ğ‘–ğ‘Ÿ âˆˆ Rğ‘Ã—ğ‘‘,thus ğ‘–=1 ğ‘—=1
ğ’†ğ‘¡ğ‘–
ğ‘’ğ‘ğ‘š
âˆˆRğ‘˜Ã—ğ‘‘.Afterthat,mean-poolingisusedtoobtainthefinal
Rule2:â€œCollaborationshouldbemutualreciprocalâ€.Sym-
collaborationrepresentation. metry constraint is enforced. To encourage collaboration and
ğ’†Â¯ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š=mean-pooling(ğ’†ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š), ğ’†Â¯ğ‘¡ğ‘–
ğ‘’ğ‘ğ‘š
âˆˆR1Ã—ğ‘‘. (9) mutualconsiderationbetweenintersections,weincorporateasym-
Forthedecisionpolicyğœ‹ğ‘–,itreceivestheintersection-levelrep- metryconstraintintothetraining.Thesymmetryconstraint,calcu-
latedasthemeansquareddifferencebetweenthematrixğ‘€ğœŒ and
resentationandcollaboratorrepresentationandoutputstheaction
ğ‘ğ‘– fortheintersectionğ‘–.
itstranspose[ğ‘€ğœŒ]ğ‘‡,guidestheneuralnetworktolearnsymmetric
collaboratorselection.Mathematically,thesymmetryconstraintis
ğ‘ğ‘– =ğœ‹ğ‘–(Â·|[ğ’†ğ‘–ğ‘– ğ‘Ÿ||ğ’†Â¯ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š]). (10)
formulatedasfollows.
Wehaveintroducedtheinferenceprocessofthemainmodules.
Next,weproposeanend-to-endjointoptimizationschemetoobtain min 1 âˆ‘ï¸ğ‘ âˆ‘ï¸ğ‘ (ğ‘€ğœŒ âˆ’[ğ‘€ğœŒ ]T )2 . (14)
theoptimalCoSğœŒanddecisionpolicyğœ‹.
ğ‘2
ğ‘–=1 ğ‘—=1
ğ‘–ğ‘— ğ‘–ğ‘—
In summary, we can define the loss function for optimizing
4.2 OptimizationScheme
theCoSpolicy:
4.2.1 OverallOptimizationObjective. Theoverallobjectiveğœ‚isto
maximizethecumulativereturn,formulatedasfollows. L(ğœŒğœ‘)=âˆ’J(ğœ‘,ğœƒ)âˆ’âˆ‘ï¸ğ‘ ğ‘€ ğ‘–ğœŒ ğ‘–+ ğ‘1
2
âˆ‘ï¸ğ‘ âˆ‘ï¸ğ‘ (ğ‘€ ğ‘–ğœŒ
ğ‘—
âˆ’[ğ‘€ ğ‘–ğœŒ ğ‘—]T )2 . (15)
(cid:34)âˆ (cid:35) ğ‘–=1 ğ‘–=1 ğ‘—=1
m ğœ‘a ,ğœƒxJ(ğœ‘,ğœƒ)=m ğœ‘a ,ğœƒxE
ğ’Šğ’…ğ’”âˆ¼ğ†ğœ‘
âˆ‘ï¸ ğ›¾ğ‘¡ğ‘Ÿ(ğ‘ ğ‘¡,ğ’‚ğ’•) , (11)
Followingthemulti-agentpolicygradientoptimization[8,54],
ğ’‚âˆ¼ğ…ğœƒ(Â·|ğ‘ ,ğ’Šğ’…ğ’”) ğ‘¡=0
wecanderivethegradientforğœŒ :
ğœ‘
whereğ† = {ğœŒ1,...,ğœŒğ‘}andğ… = {ğœ‹1,...,ğœ‹ğ‘}arejointCoSpolicy
anddecisionpolicy,parameterizedby{ğœ‘1,...,ğœ‘ğ‘}and{ğœƒ1,...,ğœƒğ‘}, âˆ‡ğœ‘ğ‘–J(ğœ‘,ğœƒ)=âˆ« ğ‘†ğ‘ğœ‹ğ‘ğ‘™ğ‘™ (ğ‘ )(cid:205) ğ’Šğ’…ğ’”ğœŒğœ‘(ğ’Šğ’…ğ’”|ğ‘ )Â·
res Ape cc ct oi rv de il ny g.
toBellmanEquation[3,32],theQ-functionprovides
(cid:104) âˆ‡ğœ‘(cid:205) ğ‘–logğœŒ ğœ‘ğ‘– ğ‘–(ğ’Šğ’…ğ’”ğ‘–|ğ‘ )Â·(cid:205) ğ’‚ğœ‹(ğ’‚|ğ‘ ,ğ’Šğ’…ğ’”)(cid:105) Â·ğ‘„ ğœ‹ğ‘–(ğ‘œğ‘–,ğ‘ğ‘–)ğ‘‘ğ‘  . (16)
anestimatetoguidetheagenttowardtheoptimalpolicythatmaxi- âˆ’ N1âˆ‡ğœ‘ğ‘´ğœŒ+ N2 (cid:16) ğ‘´ğœŒ âˆ’[ğ‘´ğœŒ]T(cid:17) âˆ‡ğœ‘ğ‘´ğœŒ
mizescumulativerewards.Thus,theobjectivecanbewritten:
Thus,incorporatingtheseconstraintsintotheCoSpolicygra-
=J E(ğœ‘ ğ‘ğœ‹,ğœƒ ğ‘ğ‘™) ğ‘™,= ğœ‹ğ‘E ğ‘™ğ‘™ğ‘ âˆ¼ (cid:20) ğ‘–ğ‘ (cid:206)ğ‘ =ğœ‹ 1ğ‘ ğœŒğ‘™ğ‘™ ğœ‘ğ‘–,( (ğ’Š ğ’Šğ’… ğ’…ğ’”, ğ’”ğ’‚ ğ‘–) |âˆ¼ ğ‘œğœ‹ ğ‘–ğ‘ )ğ‘™ ğœ‹ğ‘™ ğœƒğ‘–(cid:104) (ğœ‹ ğ‘ğ‘ ğ‘–ğ‘™ |ğ‘™ ğ‘œ( ğ‘–ğ’Š ,ğ’… ğ’Šğ’…ğ’”, ğ’”ğ’‚ ğ‘–)|ğ‘  ğ‘„)ğ‘„ ğœ‹ğ‘–ğœ‹ (ğ‘ ğ‘œğ‘™ ğ‘–ğ‘™ ,( ğ‘ğ‘  ğ‘–, )ğ’‚ (cid:21)) ,(cid:105) (12) d l pai rbe on o mrt a oo t tp o et r cim oco oiz m pa ept ri aoo tsn ii vte i eon dna eb cpl ie r sos iogt nh re -e mssp aio v kl e ii nc lyy g.ğœŒ aA mğœ‘ s ot ao nr gl ee isa nur tn l et r,t sh t ehe ce to iopp noti slm i ,c ra y el scc uao ln tl-
-
whereğ‘ğœ‹ğ‘ğ‘™ğ‘™ denotesthestationarydistributioninducedbypol- inginenhancedtrafficsignalcontrolandimprovedtrafficflow
efficiency.
icyğœ‹ğ‘ğ‘™ğ‘™,ğ‘„ğœ‹ğ‘ğ‘™ğ‘™ isthejointaction-valuefunction,andğ‘„ğœ‹ğ‘– isthe
individualaction-valuefunction.Here,ğ‘„ğœ‹ğ‘– simplifiesthelearn- 4.2.3 OptimizingDecisionPolicy. Assumedwehaveğ’Šğ’…ğ’” âˆ¼ğ†ğ‘¡ to
ingprocessbyfocusingonlocalstate-actionpairsratherthanthe identifythemostappropriatecollaboratorsandthentooptimizethe
globalstate,effectivelymitigatingthescalabilityissueinlarge-scale multi-agentdecisionpolicyğ…ğ‘¡ asfollows.Forthedecisionpolicy,
environments. wecanderiveitsgradientwiththeEq.(12).
4.2.2 OptimizingCoSPolicy. TheCoSpolicyğ†ğ‘¡ aimstochoose âˆ‡ğœƒğ‘–J(ğœ‘,ğœƒ)=âˆ« ğ‘†ğ‘ğœ‹ğ‘ğ‘™ğ‘™ (ğ‘ )(cid:205) ğ’Šğ’…ğ’”ğœŒ(ğ’Šğ’…ğ’”|ğ‘ )(cid:205) ğ’‚ğœ‹ ğœƒ(ğ’‚|ğ‘ ,ğ’Šğ’…ğ’”)Â·
optimalcollaboratorsforintersections.Wefollowtworules:(a)
Intersectionsshouldprimarilyfocusontheirowndecisions.(b)
âˆ‡ğœƒ(cid:205) ğ‘–logğœ‹ ğœƒğ‘– ğ‘–(ğ‘ğ‘–|ğ‘œğ‘–,ğ’Šğ’…ğ’”ğ‘–)Â·ğ‘„ ğœ‹ğ‘–(ğ‘œğ‘–,ğ‘ğ‘–)ğ‘‘ğ‘ 
Theyshouldalsoaccountforandcollaboratewitheachotherâ€™s â‰ˆE (ğ‘ ,ğ’‚,ğ’Šğ’…ğ’”)âˆ¼D(cid:104) âˆ‡ğœƒ(cid:205) ğ‘–logğœ‹ ğœƒğ‘– ğ‘–(ğ‘ğ‘–|ğ‘œğ‘–,ğ’Šğ’…ğ’”ğ‘–)Â·ğ‘„ ğœ‹ğ‘–(ğ‘œğ‘–,ğ‘ğ‘–)(cid:105) (17)
d rue lc ei ssi io nns th.T eh cu os ll, at bw oo rak te oy rc so eln es ct tr ia oi nnt ps ra or ce ei sn s.troducedtoensurethese =E
(ğ‘ ,ğ’‚,ğ’Šğ’…ğ’”)âˆ¼ğ·
(cid:34) (cid:205)
ğ‘–
âˆ‡ğœƒ ğœ‹ğ‘– ğ‘–ğœ‹ ğ‘–ğœƒğ‘– (ğ‘– ğ‘( ğ‘–ğ‘ |ğ‘œğ‘– ğ‘–|ğ‘œ ,ğ’Šğ‘– ğ’…,ğ’Š ğ’”ğ’… ğ‘–ğ’” )ğ‘–) Â·ğ‘„ ğœ‹ğ‘–(ğ‘œğ‘–,ğ‘ğ‘–)(cid:35) ,
Firstly,wecandenotethedistributionsofğ†ğ‘¡ forallintersections ğœƒ
asacollaboratormatrixğ‘´ğœŒ âˆˆRğ‘Ã—ğ‘,whereeachelementğ‘€ ğ‘–ğœŒ
ğ‘—
in whereğœ‹ ğœƒğ‘–
ğ‘–
istheolddecisionpolicyusedforsampling.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
Algorithm1Theoptimizationprocess. thederivedlossforbackpropagationtraining.Thedetailedprocess
ispresentedinAlgorithm1.
1: Ensure:Collaboratorassignmentpolicy{ğœŒğ‘–} ğ‘–ğ‘ =1,collaborator-
Moreover,thenetworkdesignandhyper-parametersettingsare
basedmulti-agentactor{ğœ‹ğ‘–}ğ‘ ,andcritics{ğ‘„ğ‘–}ğ‘ ;
ğ‘–=1 ğ‘–=1 providedinAppendixA.
Initialize:ğ›¾,D â† âˆ…,ğ¿1,ğ¿2,ğµ;//ğ¿1,ğ¿2areintervals;ğµisthe
mini-batchsize. 6 EXPERIMENTS
2:
Initialize:theparametersğœƒğ‘–,ğœ‘ğ‘–,ğœ™ğ‘– forğœŒğ‘–,ğœ‹ğ‘–,andğ‘„ğ‘–;
6.1 Environments
3: foreachepisodedo
4: Resetstateâ†{ğ‘œğ‘– 0} ğ‘–ğ‘ =1;//dropğ‘–asğ’0forbrevity; TheevaluationscenarioscomefromtheSimulationofUrbanMobil-
5: foreachtimestepğ‘¡ do ity(SUMO)1,whichcontainsthreesyntheticscenariosandtworeal
6: Obtainthedual-featuresğ’†ğ‘–ğ‘Ÿ; roadnetworkmapsofdifferentscales,includingGrid4Ã—4,Avenue
7: foreachintersectionğ‘–do 4Ã—4,Grid5Ã—5,Cologne8,andNanshan.Asforeachscenario,each
8: Getthecollaboratorindices ğ’Šğ’…ğ’”ğ‘– = ğœŒğ‘–(Â·|ğ’†ğ‘–ğ‘Ÿ) foreach individualepisodelastsforatimespanof3600seconds,during
intersection; whichtheactionintervalisÎ”ğ‘¡ =15seconds.
9: Querythecollaboratorrepresentationğ‘’Â¯ ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š withğ’†ğ‘–ğ‘Ÿ
andğ’Šğ’…ğ’”ğ‘–; 6.2 Baselines
Gettheactionğ‘ğ‘– =ğœ‹ğ‘–(Â·|[ğ‘’ ğ‘–ğ‘– ğ‘Ÿ||ğ‘’Â¯ ğ‘¡ğ‘– ğ‘’ğ‘ğ‘š]); Weanalyzetheperformanceofourmethodbycomparingitwith
10: endfor twoconventionaltransportationtechniquesandsixstate-of-the-art
11: Takejointactionsğ’‚ğ‘¡; (SOTA)RL/MARLalgorithms.
12: Receiverewardğ’“ğ‘¡ andobservethenextstateoğ‘¡+1; ConventionalMethods:
13: Addtransition{ğ’ğ‘¡,ğ’Šğ’…ğ’”ğ‘¡,ğ’‚ğ‘¡,ğ’“ğ‘¡,ğ’ğ‘¡+1}intoD;
â€¢ FixedTimeControl(FTC)[26]withrandomoffsetexe-
14: endfor
cuteseachphasewithinaloop,utilizingapre-definedphase
15: ifepisodesâ‰¥ğ¿1then
duration.
16: Samplebatch{ğ’ğ‘—,ğ’Šğ’…ğ’”ğ‘—,ğ’‚ğ‘—,ğ’“ğ‘—,ğ’ğ‘—+1}ğµ ğ‘—=0âˆ¼D;
â€¢ MaxPressure[14,36]greedilychoosesthephasewiththe
17: UpdatetheCoSpolicyğœŒğ‘– using(16); maximumpressure,whichisaSOTAtransportationcontrol
18: Updatethedecisionpolicyğœ‹ğ‘– using(17); method.
19: Updatethecriticğœ™ğ‘– using(18);
RL-basedMethods:
20: endif
Updatingthetargetnetworkseveryğ¿2episodes; â€¢ IPPO[1,2]controlseachintersectionwithanindependent
PPOagent,whichistrainedwiththedatafromthecurrent
21: endfor
intersection.
â€¢ MAPPO[30,50]executeswithanindependentPPOagent
andistrainedcollectivelyusingthedatafromallintersec-
Thecriticisupdatedtominimizethedifferencebetweenthe
tions,enablinganoptimizedcoordinatedtrafficflow.
predictedandactualreturns,whichresemblestheaction-valueTD-
â€¢ MAT[46]isastrongbaselineinMARLwithcentralized
learning[31].Thelossfunctionforğ‘„ğœ‹ğ‘– isformulatedasfollows.
trainingwithcentralizedexecutionparadigm,modelingthe
L ğ‘„ğœ‹ğ‘–(ğœ™)=E
(ğ‘œğ‘–,ğ‘ğ‘–,ğ‘Ÿğ‘–,ğ‘œğ‘–â€²)âˆ¼D(cid:20)(cid:16)
ğ‘¦ğ‘– âˆ’ğ‘„ğœ‹ğ‘–
(ğ‘œğ‘–,ğ‘ğ‘–;ğœ™)(cid:17)2(cid:21)
, (18) â€¢
T FRSC Aa Ps [a 57s ]eq mu oe dn eti la sl pp hr ao sb ele cm om.
petitionandemploysdeepQ-
networkagentforeachintersectiontooptimizetrafficphase
whereğ‘¦ğ‘– =ğ‘Ÿğ‘– +ğ›¾max ğ‘ğ‘–â€²ğ‘„ (cid:101)ğœ‹ğ‘– (ğ‘œğ‘–â€²,ğ‘ğ‘–â€²)isthelearningtarget,ğ›¾ isthe operation.
discountedfactor,andğ‘„ (cid:101)ğœ‹ğ‘– isthetargetnetworkforintersectionğ‘–. â€¢ MPLight[6]utilizestheconceptofpressureasbothstate
ThejointoptimizationschemeensurestheCoSpolicyandthe andrewardtocoordinatemultipleintersections,whichis
collaborator-baseddecisionpolicyconvergeinthesamedirection basedonFRAP.
byoptimizingthesameobjectivefunction,whichistomaximize â€¢ CoLight[43]leveragesaGATtoextractneighboringin-
thecumulativediscountedreturninanend-to-endmanner.The formation,therebyassistingtheagentinoptimizingqueue
proposedmethodfacilitateseffectivedecision-makingandcollab- length.
orationamongintersections,allowingthetwopoliciestowork â€¢ Advanced-CoLight[56]combinesadvancedtrafficstate
togetherharmoniouslytowardachievingtheoverallgoal. forthetrafficmovementrepresentationwithapressureof
queuinganddemandofrunningforvehicleswithCoLight,
5 ALGORITHMICFRAMEWORK toenhancethedecision-makingprocess.
Hereweprovideadetailedpseudocodetoelaboratetheoverall â€¢ MetaGAT[19]leveragesGAT-basedcontexttoboostcoop-
erationamongintersections.
inferenceandtrainingprocess.Intheinferenceprocess,wefirst
select suitable teammate IDs ğ’Šğ’…ğ’”ğ‘– for each intersectionğ‘– based â€¢ DuaLight[20]introducesascenario-specificexperiential
onitsobservationsğ‘œğ‘–.Thenwecalculatetheteammatevectors weightmoduleandascenario-sharedco-trainmoduleto
ğ‘’Â¯ğ‘– according to the teammate IDs and concatenate them to facilitatetheinformationextractionofscenariosandinter-
ğ‘¡ğ‘’ğ‘ğ‘š sections.
theselfvectorğ‘’ğ‘– toobtaintheactionfordecisionmaking,and
ğ‘–ğ‘Ÿ
finallyinteractwiththeSUMOenvironment.Intraining,weuse 1https://www.eclipse.org/sumo/CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
AverageTripTime(seconds) AverageDelayTime(seconds)
Methods
Grid4Ã—4 Avenue4Ã—4 Grid5Ã—5 Cologne8 Nanshan Grid4Ã—4 Avenue4Ã—4 Grid5Ã—5 Cologne8 Nanshan
FTC 206.68Â±0.54 828.38Â±8.17 550.38Â±8.31 124.4Â±1.99 729.02Â±37.03 94.64Â±0.43 1234.30Â±6.50 790.18Â±7.96 62.38Â±2.95 561.69Â±37.09
MaxPressure 175.97Â±0.70 686.12Â±9.57 274.15Â±15.23 95.96Â±1.11 720.89Â±29.94 64.01Â±0.71 952.53Â±12.48 240.00Â±18.43 31.93Â±1.07 553.94Â±32.61
IPPO 167.62Â±2.42 431.31Â±28.55 259.28Â±9.55 90.87Â±0.40 743.69Â±38.9 56.38Â±1.46 914.58Â±36.90 243.58Â±9.29 26.82Â±0.43 577.99Â±42.22
MAPPO 164.96Â±1.87 565.67Â±44.8 300.90Â±8.31 97.68Â±2.03 744.47Â±30.07 53.65Â±1.00 1185.2Â±167.48 346.78Â±28.25 33.37Â±1.97 580.49Â±33.6
MAT 246.13Â±24.23 421.85Â±73.13 356.81Â±11.05 111.59Â±18.82 754.28Â±58.70 106.70Â±14.07 565.42Â±91.35 217.93Â±40.64 25.23Â±8.69 415.84Â±75.59
FRAP 161.58Â±1.9 383.71Â±4.42 238.41Â±10.66 88.61Â±0.33 709.18Â±21.46 50.02Â±0.93 794.13Â±42.52 203.95Â±8.92 27.5Â±0.24 542.43Â±21.51
MPLight 179.51Â±0.95 541.29Â±45.24 261.76Â±6.60 98.44Â±0.62 668.81Â±7.92 67.52Â±0.97 1083.18Â±63.38 213.78Â±14.44 34.38Â±0.63 494.05Â±7.52
CoLight 163.52Â±0.00 409.93Â±0.00 242.37Â±0.00 89.72Â±0.00 608.01Â±0.00 51.58Â±0.00 776.61Â±0.00 248.32Â±0.00 25.56Â±0.00 428.95Â±0.00
Advanced-CoLight 171.63Â±1.71 421.44Â±5.61 237.67Â±3.02 91.22Â±1.01 612.34Â±9.79 52.31Â±0.01 763.78Â±14.01 242.50Â±5.06 25.12Â±1.08 512.45Â±6.98
MetaGAT 165.23Â±0.00 374.80Â±0.87 266.60Â±0.00 90.74Â±0.00 676.42Â±0.00 53.20Â±0.00 772.36Â±0.00 234.80Â±0.00 26.85Â±0.00 503.42Â±0.00
DuaLight 161.0Â±0.00 396.65Â±0.00 221.83Â±0.00 89.74Â±0.00 609.89Â±0.00 49.32Â±0.00 756.99Â±69.44 237.71Â±0.00 25.35Â±0.00 429.49Â±0.00
CoSLight 159.1Â±3.12 364.21Â±4.78 220.32Â±1.71 90.46Â±0.55 621.23Â±7.17 46.11Â±1.21 744.98Â±16.49 178.54Â±4.34 24.79Â±1.23 476.57Â±17.12
Table1:Scenario-wiseevaluation.Ourmethodachieveseitherthebest(boldface)orthesecond-best(underlined)performance.
AverageRewards Intersection-wiseevaluation. Table2showsCoSLightachieves
Methods
Grid4Ã—4 Avenue4Ã—4 Grid5Ã—5 Cologne8 Nanshan thebestresultsinallscenarios.Comparedtothesecond-bestresult,
FTC -0.614Â±0.015 -4.503Â±0.025 -2.346Â±0.052 -2.114Â±0.021 -3.479Â±0.186 oursachieveda7.71%improvementonaverage.Thisconsistentper-
MaxPressure -0.393Â±0.003 -4.032Â±0.040 -1.132Â±0.013 -0.756Â±0.012 -3.055Â±0.162 formanceenhancementacrossintersection-wiseevaluationmetrics
IPPO -0.336Â±0.004 -2.558Â±0.213 -0.943Â±0.037 -0.646Â±0.015 -3.555Â±0.097 underlinestherobustnessofourproposedmethod.
MAPPO -0.308Â±0.006 -2.744Â±0.238 -1.273Â±0.107 -1.697Â±0.132 -4.161Â±0.195 Notably, these findings provide strong evidence that our al-
MAT -0.328Â±0.001 -3.100Â±0.279 -1.109Â±0.132 -1.811Â±0.117 -5.002Â±0.755 gorithm performs well not only in terms of global cooperation
FRAP -0.274Â±0.000 -2.573Â±0.012 -1.064Â±0.002 -0.705Â±0.020 -3.191Â±0.170 (scenario-wiseevaluation)butalsofromtheperspectiveofbene-
MPLight -0.414Â±0.012 -4.079Â±0.049 -1.087Â±0.041 -0.842Â±0.026 -3.117Â±0.116 fitsatindividualintersections(intersection-wiseevaluation).This
CoLight -0.309Â±0.006 -2.326Â±0.057 -0.918Â±0.042 -0.695Â±0.008 -2.939Â±0.092 dual-levelefficacyshowcasestheeffectivenessofourapproach,sig-
Advanced-CoLight -0.291Â±0.011 -2.317Â±0.018 -1.112Â±0.018 -0.607Â±0.001 -2.904Â±0.016 nifyingitsabilitytofosteroverallroadnetworkperformancewhile
MetaGAT -0.468Â±0.126 -2.538Â±0.077 -1.326Â±0.311 -0.805Â±0.168 -3.289Â±0.261 simultaneouslyoptimizingindividualintersectionoperations.
DuaLight -0.331Â±0.112 -2.711Â±0.005 -1.007Â±0.622 -0.724Â±0.338 -4.330Â±0.306
CoSLight -0.251Â±0.000 -2.309Â±0.068 -0.890Â±0.012 -0.538Â±0.007 -2.899Â±0.014 6.5 AblationAnalysisofThreeSettings
Table2:Intersection-wiseevaluation.Ourmethodconstantly
achievesthebestperformance.
6.3 EvaluationMetrics
Weutilizetwoevaluationmetricsinourstudy.Firstly,atthesce-
nariolevel[2],wecomputetheaveragedelay,andaveragetriptime
bytrackingvehiclesinthescenario.Specifically,delaysignifiesthe
(a) Ablating FRAP, Transformer, (b) Comparing collaborator (c) Ablating diagonal, symmetry,
holdupcausedbysignalizedintersections(eitherstoporapproach Teammate CoS; Replacing CoS, Dual matrix design (ours v.s. fixed or and both constraints in
Extractor with GNNs in Grid ğŸ“Ã—ğŸ“ random matrices) in Nanshan collaborator matrix in Cologne8
delay)foravehicle,andtriptimedenotesthecompletedurationof
Figure4:AblationStudies
avehicleâ€™sjourneyfromitsorigintoitsdestination.
Secondly,attheintersectionlevel,weemploytheexternalreward
AblationofComponents.Firstly,weselectivelyremovediffer-
oftheenvironmentasanevaluationcriterion,includingtheaverage
entmodules,specificallytheFRAP,Transformer,andCollaborator
delaytime,averagewaittime,averagequeuelength,andaverage
modules,tovalidatethenecessityofeachcomponentinCoSLight.
pressureforeachintersection.Thesemetricsarecalculatedateach
InFigure4(a),(1)itisevidentthattheTransformermodulethat
individualintersectionbyaveragingthevaluesacrossallvehicles.
aggregatesotherintersectionsâ€™informationandtheTeammateCoS
modulethatadaptivelyselectscollaboratorsarethemostimpor-
6.4 MainResults
tant.(2)Moreover,tojustifytheMLPdesignforCoS,wereplaceit
Scenario-wiseevaluation. AsillustratedinTable1,theperfor- inCoSwithGNNs,wherewecouldobserveasignificantslowdown
mancesmarkedinboldfaceandunderlinedrepresentthebestand ofconvergenceandperformancedropinCoSwithGNN,dueto
second-bestresults,respectively.CoSLightconsistentlyachieves GNNâ€™scomputationalcomplexityasthebottleneck.(3)Tojustify
substantialperformanceimprovements,reducingtheaveragedelay Transformerasabetterdesigntoaggregateotherintersectionsâ€™
timeby7.68%,theaveragetriptimeby1.98%,whichnotonlyvali- information,wereplacedthetransformermoduleinthedualextrac-
datestheeffectivenessofCoSLightbutalsohighlightsitspotential torwithGNNs(DualwithGNN).Weseesimilarperformancedrops.
toefficientlymanageandenhancemulti-intersectioncollaboration Suchafeatureextractorencourageslearningbetterembeddingfor
invarioustrafficscenarios. eachagentandunderstandingthembetter,showninFigure5.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
AblationoftheCollaboratorMatrix.Tofurtherassessthe 6.7 AnalysisofCollaboratorNumberğ‘˜
impactoftheco-learnedcollaboratormatrix,weconductexperi-
mentswherethematrixintheproposedCoSisreplacedwithboth 2.0
1.0
fixed(astopologicaladjacencymatrix)andrandom(freezingthe 2.5
collaboratorselectionafterrandomlyinitializingtop-ğ‘˜selection) 1.2
3.0
matrices.Figure4(b)showsthatusingco-learnedcollaboratorma- 1.4
3.5
tricesinCoScanboostperformance,highlightingthecriticalrole 1.6
4.0
ofthedynamicalcollaborationmatrixinachievingeffectivecoordi-
1.8
nation.Thus,thejointoptimizationofthecollaboratormatrixwith 2 4 6 8 10 12 14 16
The Number of Collaborators 2 4 6 8 1012141618202224
decisionpoliciesiskeyforoptimizingcumulativerewards. (a)Avenue4Ã—4 The ( bN )um Gb re idr o 5f C Ã—oll 5aborators
AblationofConstraintsonCollaboratorMatrix.InFigure Figure6:Violinplotsdisplaytheperformancetrade-offsat
4(c),wefurtherevaluatethecontributionsoftheconstraintsin varyingnumbersofcollaborators.
Eq(13)and(14)byremovingtheDiagonalconstraint,theSym-
metryconstraint,orboth.RemovingtheSymmetryconstraintsig- Figure6showsthetrade-offbetweenthenumberofcollabora-
nificantlydegradesperformance,whichunderlinesthesymmetric torsandperformance.Forexample,inAvenue4Ã—4(Figure6(a)),
interplaybetweeneachotherisessential.Conversely,theDiagonal ğ‘˜ =8yieldsthebestresults,suggestinganoptimalbalancebetween
constrainthasamarginalimpact,primarilyenhancingtheconver- usefulinformationandperformancegains.Informationfrommore
gencespeed.TheseinsightshighlightthevalueoftheSymmetry collaboratorsbeyondthispointdoesnotguaranteeimprovedresults
constraintforoptimalityandtheDiagonalconstraintforefficiency. andmayleadtohigherresourceusage.Thisfindingposesadirec-
Insummary,theablationsprovideempiricalevidencethateach tionforfutureworktodynamicallydeterminetheidealnumberof
dimensionofCoSisvital.Theco-learningofthecollaboratorma- collaborators,potentiallyenhancingthealgorithmâ€™sefficiency.
trix,theadherencetospecificconstraints,andtheintegrationof
crucialcomponentssuchastheFRAP,Transformer,andCollabo- 6.8 VisualizationofCollaboratorMatrix
ratormodulesallcontributetotherobustnessandeffectivenessof
At the beginning At the convergence At the beginning At the convergence
thesystem.Throughvalidation,wedemonstratethatourmodel
leadstoenhancedperformanceincomplexenvironments.
6.6 VisualizationAnalysisofDual-feature
Avenue ğŸ’Ã—ğŸ’ Cologne8
Figure7:Saliencymapsofcollaboratormatrix.Thedeeper
thecolor,thestrongerthecorrelation.CoSLighthaslearned
diagonalmaximizationandsymmetryconstraints.
Inthissection,wevisuallyanalyzethecollaboratormatrixto
offeranintuitiveunderstandingofattentiondistributionamong
(a)Avenue4Ã—4 (b)Nanshan
intersectionsduringtraining.Theresultsareshownatthestart
Figure5:VisualizationofDual-feature.Eachcolorrepresents andendoftrainingintheCologne8(8intersections)andAvenue4
aspecificintersection.CoSLighthascaptureduniquefeatures Ã—4(16intersections)scenarios,respectively.Thesaliencymapsin
ateachintersectionwithdistinctclusteringpatterns. Figure7depictthestateofthecollaboratormatrixatthebeginning
andtheendofthetraining,respectively.
Weanalyzethedual-featureembeddingsfromourDual-Feature Upontheconclusionofthetraining,wenoticeadeepeningofthe
Extractor.AsshowninFigure5,wetest10episodesforeachinter- coloralongthediagonalelementsofthesaliencymap.Thissignifies
sectionineachscenario,resultingin2400dual-featureembeddings anincreasedself-attention,indicatingthattheintersectionshave
visualizedusingthet-SNEtechnique[34]. adaptedtopaymoreheedtotheirownstates.Additionally,the
Theseembeddingsdemonstrateadistinctclusteringpattern,sug- symmetryapparentinthesaliencymapsuggestsmutualawareness
gestingthatourmodelcapturesuniquefeaturesateachintersection amongintersections.Asthetrainingprogresses,intersectionsnot
effectively.Thisallowsthemodeltogroupsimilarstatestogether, onlylearntofocusonthemselvesbutalsopayattentiontotheir
adaptingtovariationsintrafficconditionsandintersection-level peers,signifyingalearnedmutualcollaboration.
characteristics.Thisadaptabilityisacrucialadvantageofourap- Theseobservationsvalidatetheeffectivenessofourapproach
proach,contributingsignificantlytoitsperformanceimprovement. increatingacollaborativeenvironmentamongintersections,thus
Moreresultsofallfivescenariosundertheabovesettingsarein leadingtoenhancedperformance.
AppendixE-J.Inconclusion,throughrigorousexperimentsand
6.9 VisualizationofCollaboratorSelection
insightfulanalysis,ourstudyconfirmsthatourmethod,whichinte-
gratesdual-featureextractionandmulti-intersectioncollaboration, Figure8depictsthecollaboratorselectionprocess.Forğ¾ = 1in
providesaneffectiveandefficientsolutionfortheTSC. Figure8(b),self-selectionisprevalent;however,agent0displays
sdraweR
edosipE
egarevACoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
CoS Decisionpolicy CoSTraining DecisionTraining TotalTime
Grid4x4 0.153Â±0.008 0.143Â±0.008 1.522Â±0.112 2.940Â±0.163 4.758Â±0.179
Avenue4x4 0.161Â±0.006 0.152Â±0.006 1.423Â±0.176 3.050Â±0.203 4.785Â±0.276
Grid5x5 0.168Â±0.011 0.153Â±0.011 2.531Â±0.093 6.148Â±0.123 9.000Â±0.123
agent 0 agent 4 agent 7
Cologne8 0.111Â±0.007 0.105Â±0.007 2.001Â±0.096 2.336Â±0.192 4.553Â±0.186
Nanshan 0.190Â±0.008 0.181Â±0.008 1.321Â±0.124 4.130Â±0.511 5.822Â±0.507
(a) The topological layout of Cologne 8, emphasizes
8 signaled intersections and 3 detailed intersections. Avg(Percent) 0.156(2.83%) 0.147(2.66%) 1.760(31.29%) 3.721(63.21%) 5.778
Table3:Averageinferenceandtrainingtime(s).
collaboration.Moreover,wearethefirsttoproposeajointoptimiza-
tionregimetotraintheCoSanddecisionpoliciessimultaneously
formaximizingthecumulativediscountedreturn.Comprehensive
experimentsonbothsyntheticandreal-worlddatasetsvalidateour
approachâ€™ssuperiority.Theextensiveanalysisfurtherreinforces
theeffectivenessandefficacyofCoSLight.
(b) K=1 (c) K=3
Futureresearchcouldpotentiallyexploreanadaptivemecha-
Figure8:CollaboratorselectiononCologne8,showingself- nismtoefficientlydeterminetheoptimalnumberofcollaborators,
selectionandefficientcross-collaborationat(b)K=1with thereby enhancing the performance and effectiveness of traffic
predominantlysolodynamics,and(c)K=3withinter-agent signalcontrol.
collaborationwithnotjustthetopologicalselection.
variedcollaborationpatterns,likelyduetotheintricacyofitssignal
controltasks(refertoFigure8(a)),whichrequireengagingwith
multiplecollaboratorsforoptimaltrafficmanagement.Whenğ¾
increasesto3,asshowninFigure8(c),agentsexhibitbothself-
selectionandmutualcollaboration,formingcomplexinteraction
networks.Forexample,agent3largelycollaborateswithagents
2(non-neighbor)and4(neighbor);Similarly,agent4withagents
3(neighbor)and6(neighbor);Also,agent2withagents6(non-
neighbor)and7(non-neighbor).Specifically,agent2isquitefar
from6and7,buttheyformastrongcollaborationsinceagent2
isintheofficebuildingandagents6and7areinthecommunity
residentialregion.
Overall,suchlearnedpatternssuggeststrategicselectionbeyond
topologicalneighbors.Collectively,theseresultsaffirmthatthecol-
laboratorselectionmechanismisadaptivelyresponsivetoboththe
complexityoftraffictasksandthebenefitsofstrategiccollaboration
tooptimizetrafficflow.
6.10 AverageInferenceandTrainingTime
Wecollected100episodesover100trainingepochstoobtaintheav-
erageinferencetimeforCoSandDecisionpoliciesperepisodeand
averagetrainingtimeperepoch.Weexperimentedon4NVIDIA
TITANXpGPUs(12G).InTable3,acrossfivescenarios,CoSin-
ferenceandtrainingtimesaverage2.83%and31.29%,respectively,
whileDecisionpolicyaverages2.66%forinferenceand63.21%for
training.TheCoSstrategyaddsa34.42%timeoverhead,justifiable
byitsperformancebenefits.
7 CONCLUSION
Inthispaper,weintroduceaninnovativeapproachtotrafficsig-
nalcontrol,employingatop-ğ‘˜collaboratorselectionpolicywitha
dual-featureextractor.Thisuniquestrategyallowsfortheeffective
extractionofphase-andintersection-levelrepresentationswhile
adaptivelyselectingcollaboratorsforenhancedmulti-intersectionConferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
REFERENCES
[28] Ruan,J.,Hao,X.,Li,D.,andMao,H. Learningtocollaboratebygrouping:
[1] Ault,J.,Hanna,J.P.,andSharon,G.Learninganinterpretabletrafficsignal aconsensus-orientedstrategyformulti-agentreinforcementlearning. arXiv
controlpolicy.arXivpreprintarXiv:1912.11023(2019). preprintarXiv:2307.15530(2023).
[2] Ault,J.,andSharon,G.Reinforcementlearningbenchmarksfortrafficsignal [29] Ruan,J.,Xie,R.,Xiong,X.,Xu,S.,andXu,B. Made:Multi-scaledecision
control. InThirty-fifthConferenceonNeuralInformationProcessingSystems enhancementformulti-agentreinforcementlearning.InICASSP2024-2024IEEE
DatasetsandBenchmarksTrack(Round1)(2021). InternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP)(2024),
[3] Bellman,R.Dynamicprogramming.Science153,3731(1966),34â€“37. IEEE,pp.31â€“35.
[4] BÃ¶hmer,W.,Kurin,V.,andWhiteson,S.Deepcoordinationgraphs.InInter- [30] Schulman,J.,Wolski,F.,Dhariwal,P.,Radford,A.,andKlimov,O.Proximal
nationalConferenceonMachineLearning(2020),PMLR,pp.980â€“991. policyoptimizationalgorithms.arXivpreprintarXiv:1707.06347(2017).
[5] Boutilier,C.Planning,learningandcoordinationinmultiagentdecisionpro- [31] Sutton,R.S.Learningtopredictbythemethodsoftemporaldifferences.Machine
cesses.InTARK(1996),vol.96,pp.195â€“210. learning3(1988),9â€“44.
[6] Chen,C.,Wei,H.,Xu,N.,Zheng,G.,Yang,M.,Xiong,Y.,Xu,K.,andLi,Z. [32] Sutton,R.S.,andBarto,A.G.Introductiontoreinforcementlearning.1998.
Towardathousandlights:Decentralizeddeepreinforcementlearningforlarge- [33] Tolstikhin, I. O., Houlsby, N., Kolesnikov, A., Beyer, L., Zhai, X., Un-
scaletrafficsignalcontrol. InProceedingsoftheAAAIConferenceonArtificial terthiner,T.,Yung,J.,Steiner,A.,Keysers,D.,Uszkoreit,J.,Lucic,M.,
Intelligence(2020),vol.34,pp.3414â€“3421. andDosovitskiy,A.Mlp-mixer:Anall-mlparchitectureforvision.InAdvances
[7] Devailly,F.-X.,Larocqe,D.,andCharlin,L. Ig-rl:Inductivegraphrein- inNeuralInformationProcessingSystems(2021),pp.24261â€“24272.
forcementlearningformassive-scaletrafficsignalcontrol.IEEETransactionson [34] VanderMaaten,L.,andHinton,G.Visualizingdatausingt-sne.Journalof
IntelligentTransportationSystems23,7(2022),7496â€“7507. machinelearningresearch9,11(2008).
[8] Foerster,J.,Farqhar,G.,Afouras,T.,Nardelli,N.,andWhiteson,S.Coun- [35] VanderPol,E.,andOliehoek,F.A.Coordinateddeepreinforcementlearners
terfactualmulti-agentpolicygradients.InProceedingsoftheAAAIconferenceon fortrafficlightcontrol.Proceedingsoflearning,inferenceandcontrolofmulti-agent
artificialintelligence(2018),vol.32. systems(atNIPS2016)8(2016),21â€“38.
[9] Han,X.,Zhao,T.,Liu,Y.,Hu,X.,andShah,N.MLPInit:Embarrassinglysimple [36] Varaiya,P. Themax-pressurecontrollerforarbitrarynetworksofsignalized
GNNtrainingaccelerationwithMLPinitialization.InTheEleventhInternational intersections.Advancesindynamicnetworkmodelingincomplextransportation
ConferenceonLearningRepresentations(2023). systems(2013),27â€“66.
[10] Hao,Q.,Huang,W.,Feng,T.,Yuan,J.,andLi,Y.Gat-mf:Graphattentionmean [37] Vaswani,A.,Shazeer,N.,Parmar,N.,Uszkoreit,J.,Jones,L.,Gomez,A.N.,
fieldforverylargescalemulti-agentreinforcementlearning.InProceedingsofthe Kaiser,Å.,andPolosukhin,I.Attentionisallyouneed.InAdvancesinNeural
29thACMSIGKDDConferenceonKnowledgeDiscoveryandDataMining(2023), InformationProcessingSystems(2017),pp.5998â€“6008.
pp.685â€“697. [38] Wang,T.,Cao,J.,andHussain,A. Adaptivetrafficsignalcontrolforlarge-
[11] Jiang,H.,Li,Z.,Li,Z.,Bai,L.,Mao,H.,Ketter,W.,andZhao,R. Agen- scalescenariowithcooperativegroup-basedmulti-agentreinforcementlearning.
eralscenario-agnosticreinforcementlearningfortrafficsignalcontrol. IEEE TransportationresearchpartC:emergingtechnologies125(2021),103046.
TransactionsonIntelligentTransportationSystems(2024). [39] Wang,T.,Dong,H.,Lesser,V.,andZhang,C.Roma:Multi-agentreinforcement
[12] Jiang,J.,Dun,C.,Huang,T.,andLu,Z. Graphconvolutionalreinforcement learningwithemergentroles.arXivpreprintarXiv:2003.08039(2020).
learning.arXivpreprintarXiv:1810.09202(2018). [40] Wang,T.,Gupta,T.,Mahajan,A.,Peng,B.,Whiteson,S.,andZhang,C.Rode:
[13] Jiang,Q.,Li,J.,Sun,W.,andZheng,B.Dynamiclanetrafficsignalcontrolwith Learningrolestodecomposemulti-agenttasks.arXivpreprintarXiv:2010.01523
groupattentionandmulti-timescalereinforcementlearning.IJCAI. (2020).
[14] Kouvelas,A.,Lioris,J.,Fayazi,S.A.,andVaraiya,P. Maximumpressure [41] Wang,X.,Gu,P.,Wang,P.,Wang,B.,Zhou,Z.,Bai,L.,andWang,Y.Graph-free
controllerforstabilizingqueuesinsignalizedarterialnetworks.Transportation learningingraph-structureddata:Amoreefficientandaccuratespatiotemporal
ResearchRecord2421,1(2014),133â€“141. learningperspective.arXivpreprintarXiv:2301.11742(2023).
[15] Kuyer,L.,Whiteson,S.,Bakker,B.,andVlassis,N.Multiagentreinforcement [42] Wei,H.,Chen,C.,Zheng,G.,Wu,K.,Gayah,V.,Xu,K.,andLi,Z.Presslight:
learningforurbantrafficcontrolusingcoordinationgraphs.InMachineLearning Learningmaxpressurecontroltocoordinatetrafficsignalsinarterialnetwork.
andKnowledgeDiscoveryinDatabases:EuropeanConference,ECMLPKDD(2008), InProceedingsofthe25thACMSIGKDDinternationalconferenceonknowledge
pp.656â€“671. discovery&datamining(2019),pp.1290â€“1298.
[16] Labres,J.V.,Bazzan,A.L.,andAbdoos,M.Improvingtrafficsignalcontrol [43] Wei,H.,Xu,N.,Zhang,H.,Zheng,G.,Zang,X.,Chen,C.,Zhang,W.,Zhu,Y.,
withjoint-actionreinforcementlearning. In2021IEEESymposiumSerieson Xu,K.,andLi,Z.Colight:Learningnetwork-levelcooperationfortrafficsignal
ComputationalIntelligence(SSCI)(2021),pp.01â€“08. control.InProceedingsofthe28thACMInternationalConferenceonInformation
[17] Liang,E.,Su,Z.,Fang,C.,andZhong,R.Oam:Anoption-actionreinforcement andKnowledgeManagement(2019),pp.1913â€“1922.
learningframeworkforuniversalmulti-intersectioncontrol.InProceedingsof [44] Wei,H.,Zheng,G.,Gayah,V.,andLi,Z. Asurveyontrafficsignalcontrol
theAAAIConferenceonArtificialIntelligence(2022),vol.36,pp.4550â€“4558. methods.arXivpreprintarXiv:1904.08117(2019).
[18] Liu,Y.,Luo,G.,Yuan,Q.,Li,J.,Jin,L.,Chen,B.,andPan,R.Gplight:grouped [45] Wei,H.,Zheng,G.,Yao,H.,andLi,Z. Intellilight:Areinforcementlearning
multi-agentreinforcementlearningforlarge-scaletrafficsignalcontrol.InPro- approachforintelligenttrafficlightcontrol. InProceedingsofthe24thACM
ceedingsoftheThirty-SecondInternationalJointConferenceonArtificialIntelligence
SIGKDDInternationalConferenceonKnowledgeDiscovery&DataMining(2018),
(2023),pp.199â€“207. pp.2496â€“2505.
[19] Lou,Y.,Wu,J.,andRan,Y. Meta-reinforcementlearningformultipletraf- [46] Wen,M.,Kuba,J.,Lin,R.,Zhang,W.,Wen,Y.,Wang,J.,andYang,Y.Multi-
ficsignalscontrol. InProceedingsofthe31stACMInternationalConferenceon agentreinforcementlearningisasequencemodelingproblem. Advancesin
Information&KnowledgeManagement(2022),pp.4264â€“4268. NeuralInformationProcessingSystems35(2022),16509â€“16521.
[20] Lu,J.,Ruan,J.,Jiang,H.,Li,Z.,Mao,H.,andZhao,R.Dualight:Enhancingtraffic [47] Wu,L.,Wang,M.,Wu,D.,andWu,J. Dynstgat:Dynamicspatial-temporal
signalcontrolbyleveragingscenario-specificandscenario-sharedknowledge. graphattentionnetworkfortrafficsignalcontrol. InProceedingsofthe30th
arXivpreprintarXiv:2312.14532(2023). ACMInternationalConferenceonInformation&KnowledgeManagement(2021),
[21] Ma,J.,andWu,F.Feudalmulti-agentdeepreinforcementlearningfortraffic pp.2150â€“2159.
signalcontrol.InProceedingsofthe19thInternationalConferenceonAutonomous [48] Wu,Y.,Zhuang,D.,Labbe,A.,andSun,L.Inductivegraphneuralnetworks
AgentsandMultiagentSystems(AAMAS)(2020),pp.816â€“824. forspatiotemporalkriging.InProceedingsoftheAAAIConferenceonArtificial
[22] Mao,H.,Liu,W.,Hao,J.,Luo,J.,Li,D.,Zhang,Z.,Wang,J.,andXiao,Z.Neigh- Intelligence(2021),vol.35,pp.4478â€“4485.
borhoodcognitionconsistentmulti-agentreinforcementlearning.InProceedings [49] Ye,Y.,Zhao,W.,Wei,T.,Hu,S.,andChen,M.Fedlight:Federatedreinforcement
oftheAAAIconferenceonartificialintelligence(2020),vol.34,pp.7219â€“7226. learningforautonomousmulti-intersectiontrafficsignalcontrol.In202158th
[23] Mao,H.,Zhao,R.,Chen,H.,Hao,J.,Chen,Y.,Li,D.,Zhang,J.,andXiao,Z. ACM/IEEEDesignAutomationConference(DAC)(2021),IEEE,pp.847â€“852.
Transformerintransformerasbackbonefordeepreinforcementlearning.arXiv [50] Yu,C.,Velu,A.,Vinitsky,E.,Gao,J.,Wang,Y.,Bayen,A.,andWu,Y. The
preprintarXiv:2212.14538(2022). surprisingeffectivenessofppoincooperativemulti-agentgames.Advancesin
[24] Mao,H.,Zhao,R.,Li,Z.,Xu,Z.,Chen,H.,Chen,Y.,Zhang,B.,Xiao,Z.,Zhang, NeuralInformationProcessingSystems35(2022),24611â€“24624.
J.,andYin,J.Pdit:Interleavingperceptionanddecision-makingtransformers [51] Yu,Z.,Liang,S.,Wei,L.,Jin,Z.,Huang,J.,Cai,D.,He,X.,andHua,X.-S.
fordeepreinforcementlearning.arXivpreprintarXiv:2312.15863(2023). Macar:Urbantrafficlightcontrolviaactivemulti-agentcommunicationand
[25] Oroojlooy,A.,Nazari,M.,Hajinezhad,D.,andSilva,J.Attendlight:Universal actionrectification.InProceedingsoftheTwenty-NinthInternationalConference
attention-basedreinforcementlearningmodelfortrafficsignalcontrol.Advances onInternationalJointConferencesonArtificialIntelligence(2021),pp.2491â€“2497.
inNeuralInformationProcessingSystems33(2020),4079â€“4090. [52] Zhang,B.,Mao,H.,Li,L.,Xu,Z.,Li,D.,Zhao,R.,andFan,G.Stackelbergdeci-
[26] Roess,R.P.,Prassas,E.S.,andMcShane,W.R.Trafficengineering.2004. siontransformerforasynchronousactioncoordinationinmulti-agentsystems.
[27] Ruan,J.,Du,Y.,Xiong,X.,Xing,D.,Li,X.,Meng,L.,Zhang,H.,Wang,J.,and arXivpreprintarXiv:2305.07856(2023).
Xu,B.Gcs:Graph-basedcoordinationstrategyformulti-agentreinforcement [53] Zhang,H.,Liu,C.,Zhang,W.,Zheng,G.,andYu,Y.Generalight:Improving
learning.arXivpreprintarXiv:2201.06257(2022). environmentgeneralizationoftrafficsignalcontrolviametareinforcementlearn-
ing.InProceedingsofthe29thACMInternationalConferenceonInformation&CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
KnowledgeManagement(2020),pp.1783â€“1792.
[54] Zhang,K.,Yang,Z.,Liu,H.,Zhang,T.,andBasar,T. Fullydecentralized
multi-agentreinforcementlearningwithnetworkedagents. InInternational
ConferenceonMachineLearning(2018),pp.5872â€“5881.
[55] Zhang,L.,Wu,Q.,andDeng,J.Attentionlight:Rethinkingqueuelengthand
attentionmechanismfortrafficsignalcontrol.arXivpreprintarXiv:2201.00006
(2021).
[56] Zhang,L.,Wu,Q.,Shen,J.,LÃ¼,L.,Du,B.,andWu,J. Expressionmightbe
enough:representingpressureanddemandforreinforcementlearningbased
trafficsignalcontrol. InInternationalConferenceonMachineLearning(2022),
PMLR,pp.26645â€“26654.
[57] Zheng,G.,Xiong,Y.,Zang,X.,Feng,J.,Wei,H.,Zhang,H.,Li,Y.,Xu,K.,and
Li,Z.Learningphasecompetitionfortrafficsignalcontrol.InProceedingsofthe
28thACMinternationalconferenceoninformationandknowledgemanagement
(2019),pp.1963â€“1972.
[58] Zhong,L.,Yang,J.,Chen,Z.,andWang,S.Contrastivegraphconvolutionalnet-
workswithgenerativeadjacencymatrix.IEEETransactionsonSignalProcessing
71(2023),772â€“785.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
Appendices
A DETAILEDNETWORKARCHITECTUREANDHYPER-PARAMETERSDESCRIPTIONS
Thereisasummaryofalltheneuralnetworksusedinourframeworkaboutthenetworkstructure,layers,andactivationfunctions.
NetworkStructure Layers HiddenSize ActivationFunctions
FRAP FRAP1 - - -
PositionalEmbedding 1 64 None
TransformerBackbone EncoderLayer 2 64 ReLu
OutputLayer(MLP)3 1 32 ReLu
Top-kCollaboratorAssignment MLP 2 64 ReLu
Actor MLP+RNN+MLP 3 [64]+[64]+[32] ReLu
Critic MLP 2 64 ReLu
TableA1:TheSummaryforNetworkArchitecture
Thereareourhyper-parametersettingsforthetraining,showninTableA2.
Bytheway,wereferreaderstothesourcecodeinthesupplementarytocheckthedetailedhyper-parameters.
B THEDETAILSABOUTFRAP
Atthephaselevel,weadoptFRAP[57]toobtainthephase-wiserepresentation.Therawobservationsğ‘œ fromthesimulatorincludeğ¾
features,suchasthenumberofvehicles,queuelength,thecurrentphase,theflow,etc.Foranytrafficmovementğ‘š,ğ‘š âˆˆ {1,...,8}inan
intersectionğ‘–,theğ‘˜-thfeatureintherawobservationcanbedenotedasğ‘œğ‘– .Forbrevity,thesuperscriptğ‘–isomittedhereinafter.First,the
ğ‘š,ğ‘˜
embeddingoftrafficmovementğ‘šisobtainedbyMulti-LayerPerceptron(MLP):
ğ’†ğ‘š =|| ğ‘˜ğ¾ =1ğ‘†ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘(ğ‘€ğ¿ğ‘ƒ ğ‘˜(ğ‘œ ğ‘š,ğ‘˜)), (19)
where||denotesconcatenation,andğ‘†ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘ istheactivationfunction.ThenFRAPmoduleisappliedtoextractthephasecompetition
representation,denotedasfollows.
ğ’†ğ‘ğ‘ğ‘Ÿ =ğ¹ğ‘…ğ´ğ‘ƒ(ğ’†ğ‘š1,...,ğ’†ğ‘š8). (20)
Theprocesscanbesummarizedasfollows.
(1) Phaseembedding:Eachphaseğ‘consistsoftwomovementsğ‘š1,ğ‘š2,andwegetthephaseembeddingğ’†ğ‘ =ğ’†ğ‘š1+ğ’†ğ‘š2.
(2) Phasepairrepresentation:Foranypairğ‘ ğ‘˜,ğ‘
ğ‘™
fromdifferentphases,thepairwiserelationvectorisğ’†ğ‘ğ‘˜,ğ‘ğ‘™ =ğ’†ğ‘ğ‘˜||ğ’†ğ‘ğ‘™.Gatheringthe
vectorsofallphasepairscanobtainthepairdemandembeddingvolumeğ‘¬.Thenthephasepairrepresentationcanbedenotedas
ğ’†ğ‘ğ‘ğ‘Ÿ =ğ¶ğ‘œğ‘›ğ‘£1Ã—1(ğ‘¬),whereğ¶ğ‘œğ‘›ğ‘£1Ã—1istheconvolutionallayerwith1Ã—1filters.
(3) Phasecompetition:Letğ‘´ bephasecompetitionmask,andthephasecompetitionrepresentationcanbeobtainedby:ğ’†ğ‘ğ‘ğ‘Ÿ =
ğ¶ğ‘œğ‘›ğ‘£1Ã—1(ğ’†ğ‘ğ‘ğ‘Ÿ âŠ—ğ‘´),whereâŠ—istheelement-wisemultiplication.Here,wereshapeğ’†ğ‘ğ‘ğ‘Ÿ asavectorthroughflattenoperation.
Finally,anMLPisutilizedtominethephaserepresentationintheintersectionğ‘–asfollows.
ğ’†ğ‘–
ğ‘ğ‘Ÿ
=ğ‘€ğ¿ğ‘ƒ(ğ’†ğ‘ğ‘ğ‘Ÿ) (21)
C THEDETAILSABOUTEVALUATIONSETTINGS
InTableA3,wepresentdetailedstatisticsincludingthetotalnumberofintersections(#TotalInt.),alongwiththequantityof2-arm,3-arm,
and4-armintersectionsineachscenario.
Inreal-worldtrafficscenarios,manyintersectionsdonâ€™tconformtoastandardfour-armstructure,potentiallyhavingvariedlanecounts
andorientations.Toensurethebroadapplicationofourmethodacrossdiversescenarios,weintentionallyconductedexperimentsintwo
settingsthatfeaturenon-standardintersections:Cologne8andNanshan.
Thesescenariosincorporatenotjustthetypicalfour-armintersectionsbutalsoirregularoneswherethenumberanddirectionoflanes
deviatefromthestandard.Byrunningexperimentsinsuchenvironments,wedemonstratethatourapproachiseffectivenotonlyinhandling
standardintersectionsbutalsoexcelsinmanagingtheseirregularities.Thisfurtherunderscorestherobustnessandpotentialwide-scale
applicabilityofourmethodology.
1Refertotheimplementation:https://github.com/Chacha-Chen/MPLightCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
Description
textbfValue
optimizer ğ´ğ‘‘ğ‘ğ‘šğ‘Š
learningrate 5âˆ—10âˆ’4
groupembeddingsize 32
attentionhead 8
transformerlayer 2
actorembeddingsize 32
statekey [â€²ğ‘ğ‘¢ğ‘Ÿğ‘Ÿğ‘’ğ‘›ğ‘¡_ğ‘â„ğ‘ğ‘ ğ‘’â€²,â€²ğ‘ğ‘ğ‘Ÿ_ğ‘›ğ‘¢ğ‘šâ€²,â€²ğ‘ğ‘¢ğ‘’ğ‘¢ğ‘’_ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„â€²,
â€²ğ‘œğ‘ğ‘ğ‘¢ğ‘ğ‘ğ‘›ğ‘ğ‘¦â€²,â€²ğ‘“ğ‘™ğ‘œğ‘¤â€²,â€²ğ‘ ğ‘¡ğ‘œğ‘_ğ‘ğ‘ğ‘Ÿ_ğ‘›ğ‘¢ğ‘šâ€²,â€²ğ‘ğ‘Ÿğ‘’ğ‘ ğ‘ ğ‘¢ğ‘Ÿğ‘’â€²]
numberofactions 8
interactionsteps 300000
ğ›¼ 10âˆ’4
ğ›½1 0.9
ğ›½2 0.999
ğœ€-greedyğœ€ 10âˆ’5
clippingğœ– 0.2
seed [0,10)
numberofprocess 64
evalinterval 4000
evalepisodes 100
TableA2:Thehyper-parametersettings.
Dataset Country #TotalInt. #2-arm #3-arm #4-arm FlowType minFlow(/hour) maxFlow meanFlow
Grid4Ã—4 synthetic 16 0 0 16 multi-modalGaussian(m.m.G) 66 136 94.5
Avenue4Ã—4 synthetic 16 0 0 16 m.m.G 94.5 666 364.6
Grid5Ã—5 synthetic 25 0 0 25 m.m.G 120 1363 269.8
Cologne8 Germany 8 1 3 4 realflowinthemorningpeak(8AM-9AM) 134 212 139.0
Nanshan China 29 1 6 22 realflowintheeveningpeak(6PM-7PM) 160 1440 172.6
TableA3:Thedetailedstatisticsaboutevaluationscenarios
D ADDITIONALRESULTSOFHOPS
AsshowninFigureA1,wefurtherconductedexperimentsonGrid4Ã—4andGrid5Ã—5tosubstantiateourassertion:theoptimalnumberand
rangeofcollaboratingintersectionsvaryacrossdifferentscenarios.Forinstance,inGrid4Ã—4,theimpactofcollaborationremainslargely
consistentregardlessofincreasingdistances,suggestingthatthebenefitsofcollaborationmightbedistance-independentinthissetting.
Alternatively,itcouldindicatethatmerelyselectingtopologicallyadjacentintersectionsmightnotenhancethecollaborativeoutcomes.In
contrast,Grid5Ã—5displaysanegativeimpactwithone-hopcollaboration,whereastwo-hopcollaborationproducesthegreatestbenefits.
Thisunderscoresthesignificanceofpreciselyandjudiciouslyselectingcollaborators,highlightingthatnotjustthepresence,butthequality
andcontextofcollaborationmatters.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4Ã—4 (b)Grid5Ã—5
FigureA1:Gainsoverhops.
E ADDITIONALMAINRESULTSOFINTERSECTION-WISEEVALUATIONS
Inthesection,weprovidetheadditionalresultswiththeintersection-levelevaluationinTableA4.Ouralgorithmconsistentlyyielded
favorableresults,evenachievingsuperiorevaluationimprovementsinmanycases.Thisconsistentperformanceenhancementacross
intersection-wiseevaluationmetricsunderlinestherobustnessofourproposedmethod.
Notably,thesefindingsprovidestrongevidencethatouralgorithmperformswellnotonlyintermsofglobalcooperationbutalsofrom
theperspectiveofbenefitsatindividualintersections.Thisdual-levelefficacyshowcasestheeffectivenessofourapproach,signifyingits
abilitytofosteroverallroadnetworkperformancewhilesimultaneouslyoptimizingindividualintersectionoperations.
Moreover,theconsistentandsuperiorperformanceacrossvariousintersection-wiseevaluationssignifiesthealgorithmâ€™sabilitytohandle
differenttrafficscenariosanddynamicseffectively.Itâ€™sworthnotingthattrafficscenarioscanbewidelyvariedandunpredictable,thusthe
adaptabilityshownbyourmodelunderscoresitsreal-worldapplicationpotential.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
Model Intersection-wiseMetrics Grid4Ã—4 Avenue4Ã—4 Grid5Ã—5 Cologne8 Nanshan
Total -0.614Â±0.015 -4.503Â±0.025 -2.346Â±0.052 -2.114Â±0.021 -3.479Â±0.186
Delaytime -0.065Â±0.001 -0.660Â±0.004 -0.213Â±0.010 -0.214Â±0.000 -0.603Â±0.050
FTC Waittime -0.279Â±0.007 -1.175Â±0.010 -0.605Â±0.006 -1.210Â±0.013 -1.566Â±0.043
Queuelength -0.203Â±0.005 -2.294Â±0.018 -1.154Â±0.028 -0.564Â±0.007 -1.079Â±0.095
Pressure -0.066Â±0.001 -0.372Â±0.005 -0.373Â±0.015 -0.125Â±0.000 -0.229Â±0.052
Total -0.393Â±0.003 -4.032Â±0.040 -1.132Â±0.013 -0.756Â±0.012 -3.055Â±0.162
Delaytime -0.055Â±0.000 -0.600Â±0.009 -0.123Â±0.002 -0.143Â±0.002 -0.547Â±0.062
MaxPressure Waittime -0.173Â±0.002 -1.168Â±0.012 -0.379Â±0.008 -0.373Â±0.006 -1.398Â±0.032
Queuelength -0.115Â±0.000 -1.811Â±0.023 -0.447Â±0.009 -0.198Â±0.005 -0.958Â±0.066
Pressure -0.050Â±0.001 -0.453Â±0.006 -0.184Â±0.003 -0.042Â±0.001 -0.153Â±0.020
Total -0.274Â±0.000 -2.573Â±0.012 -1.064Â±0.002 -0.705Â±0.020 -3.191Â±0.170
Delaytime -0.051Â±0.001 -0.403Â±0.003 -0.120Â±0.001 -0.146Â±0.001 -0.600Â±0.012
Frap Waittime -0.107Â±0.001 -0.525Â±0.004 -0.352Â±0.002 -0.313Â±0.003 -1.391Â±0.021
Queuelength -0.079Â±0.000 -1.287Â±0.010 -0.392Â±0.002 -0.196Â±0.001 -0.985Â±0.090
Pressure -0.035Â±0.000 -0.436Â±0.002 -0.193Â±0.001 -0.042Â±0.000 -0.215Â±0.020
Total -0.336Â±0.004 -2.558Â±0.213 -0.943Â±0.037 -0.646Â±0.015 -3.555Â±0.097
Delaytime -0.053Â±0.000 -0.314Â±0.011 -0.104Â±0.005 -0.133Â±0.001 -0.586Â±0.027
IPPO Waittime -0.145Â±0.002 -0.395Â±0.064 -0.325Â±0.015 -0.314Â±0.001 -1.572Â±0.056
Queuelength -0.095Â±0.001 -1.103Â±0.029 -0.352Â±0.011 -0.164Â±0.004 -1.170Â±0.026
Pressure -0.043Â±0.001 -0.346Â±0.021 -0.162Â±0.009 -0.037Â±0.001 -0.227Â±0.017
Total -0.308Â±0.006 -2.744Â±0.238 -1.273Â±0.107 -1.697Â±0.132 -4.161Â±0.195
Delaytime -0.051Â±0.001 -0.390Â±0.039 -0.126Â±0.008 -0.207Â±0.013 -0.682Â±0.020
MAPPO Waittime -0.132Â±0.003 -0.497Â±0.060 -0.334Â±0.019 -0.899Â±0.064 -1.710Â±0.094
Queuelength -0.085Â±0.002 -1.433Â±0.139 -0.552Â±0.054 -0.443Â±0.042 -1.446Â±0.096
Pressure -0.040Â±0.001 -0.423Â±0.037 -0.260Â±0.031 -0.147Â±0.022 -0.323Â±0.010
Total -0.414Â±0.012 -4.079Â±0.049 -1.087Â±0.041 -0.842Â±0.026 -3.117Â±0.116
Delaytime -0.056Â±0.001 -0.656Â±0.022 -0.115Â±0.006 -0.150Â±0.002 -0.561Â±0.019
MPlight Waittime -0.182Â±0.006 -0.907Â±0.112 -0.362Â±0.008 -0.424Â±0.015 -1.430Â±0.053
Queuelength -0.124Â±0.003 -2.057Â±0.120 -0.429Â±0.018 -0.225Â±0.008 -0.964Â±0.043
Pressure -0.052Â±0.001 -0.459Â±0.013 -0.181Â±0.013 -0.045Â±0.002 -0.162Â±0.006
Total -0.309Â±0.006 -2.326Â±0.057 -0.918Â±0.042 -0.695Â±0.008 -2.939Â±0.092
Delaytime -0.051Â±0.000 -0.395Â±0.010 -0.099Â±0.004 -0.132Â±0.001 -0.559Â±0.041
CoLight Waittime -0.135Â±0.003 -0.440Â±0.015 -0.283Â±0.011 -0.351Â±0.005 -1.321Â±0.049
Queuelength -0.083Â±0.002 -1.114Â±0.032 -0.356Â±0.019 -0.171Â±0.003 -0.880Â±0.012
Pressure -0.039Â±0.001 -0.376Â±0.007 -0.180Â±0.017 -0.041Â±0.002 -0.179Â±0.006
Total -0.468Â±0.126 -2.538Â±0.077 -1.326Â±0.311 -0.805Â±0.168 -3.289Â±0.261
Delaytime -0.059Â±0.008 -0.399Â±0.009 -0.139Â±0.029 -0.144Â±0.009 -0.627Â±0.031
MetaGAT Waittime -0.195Â±0.042 -0.531Â±0.055 -0.377Â±0.045 -0.409Â±0.101 -1.424Â±0.08
Queuelength -0.153Â±0.06 -1.207Â±0.061 -0.55Â±0.155 -0.207Â±0.047 -1.022Â±0.13
Pressure -0.061Â±0.017 -0.402Â±0.014 -0.26Â±0.087 -0.046Â±0.012 -0.215Â±0.028
Total -0.251Â±0.000 -2.309Â±0.068 -0.890Â±0.012 -0.538Â±0.007 -2.899Â±0.014
Delaytime -0.041Â±0.000 -0.551Â±0.004 -0.090Â±0.006 -0.117Â±0.002 -0.532Â±0.011
Ours Waittime -0.100Â±0.002 -0.597Â±0.008 -0.281Â±0.011 -0.243Â±0.001 -1.39Â±0.037
Queuelength -0.061Â±0.001 -0.231Â±0.013 -0.358Â±0.007 -0.120Â±0.002 -0.801Â±0.031
Pressure -0.039Â±0.002 -0.492Â±0.005 -0.151Â±0.003 -0.020Â±0.007 -0.232Â±0.011
TableA4:Performanceonsyntheticandreal-worlddatausingintersection-wiseevaluation.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
F ADDITIONALABLATIONOFVARIOUSSETTINGS
F.1 AdditionalAblationofVariousCollaboratorMatrix
Weconductacomprehensiveablationstudyregardingdifferentcollaboratormatrices.Inthiscontext,theâ€œfixedmatrixâ€signifiesselecting
thenearestfourintersectionsasneighborsbasedonthetopology,centeredaroundoneself,andkeepingitconstantthroughouttheexperiment.
Meanwhile,theâ€œrandommatrixâ€referstorandomlychoosingfourintersectionsascollaboratorsateachinstance,makingitpossiblethat
differentintersectionstobeselectedatvarioustimes.
Theexperimentalresultsindicatethatourapproach,whichjointlyoptimizestheselectionofcollaborators,issuperior.Forinstance,in
scenarioslikeGrid4Ã—4andGrid5Ã—5,usingafixedorrandomcollaboratormatrixleadstoperformancedegradation,withtheperformance
deterioratingevenfurtherinthelatterstagesoflearning.Observingallfivescenarios,boththefixedandrandommatricesdemonstrate
similarperformancetrends.Thissuggeststhatsuchnon-learning-basedapproachesmaylackadaptabilitytothedynamicnatureoftraffic
scenariosandcanâ€™teffectivelycapturetheintricateinteractionsamongintersections.Incontrast,ourjointoptimizationparadigmisbetter
positionedtoleveragetheinterplayandachieveoptimalcollaborationforboostingtrafficsignalcontrol.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA2:Learningcurvesoftheablationstudyaboutvariouscollaboratormatrices.
F.2 AdditionalAblationabouttheConstraints
ToassessthesignificanceoftheconstraintsinEquations(13)and(14),weconductathoroughablationstudyacrossfivescenarios.Specifically:
â€¢ w/oDiagonal:Theconstraintfordiagonalmaximizationisremoved.
â€¢ w/oSymmetry:Thesymmetryconstraintisomitted.
â€¢ w/oBoth:Boththediagonalmaximizationandsymmetryconstraintsareeliminated.
Fromthissetup,weaimtounderstandtheindividualandcombinedrolesoftheseconstraintsintheoverallperformanceandadaptabilityof
ourmodelinvarioustrafficsituations.
AsdepictedinFigureA3,forscenarioslikeGrid4Ã—4andGrid5Ã—5,alltheseconfigurationscaneventuallyachievesimilarperformance
levels.However,whenincorporatingtheproposedconstraints,thereâ€™saclearadvantageintermsofquicklyreachingpeakperformance,thus
showcasingfasterconvergence.Specifically,intheGrid4Ã—4scenario,removingthediagonalmaximizationconstraintresultsinsignificant
performancedegradationintheearlystages.Thissuggeststhatdecisionsinthisscenariomightrelymoreheavilyonthefeaturesofthe
intersectionitself.Ontheotherhand,otherscenariosdisplaylargerperformancedropswhenthesymmetryconstraintisremoved,indicating
agreaterneedtoconsidermutualcharacteristicsformoredecisiveandinteroperabledecision-making.BothCologne8andNanshanscenarios
showatrendofstagnatinglearningwhenconstraintsareremoved.ThisimpliesthattheseconstraintsplayavitalroleinguidingthelearningCoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
process,especiallyinscenarioswithpotentiallyintricateinternaldynamics.Byaddingtheseconstraints,theexplorationspacebecomes
morecompact,makingiteasiertolearnaneffectivedecision-makingstrategy.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA3:Learningcurvesoftheablationstudyaboutvariousconstraints.
F.3 AdditionalAblationabouttheMainComponents
First,letusdelineatetheexperimentalsetupforthissection.
â€¢ w/oFRAP:RemovetheFRAPmodulefromthedual-featureextractor,retainingonlytheintersection-levelfeatures.
â€¢ w/oTransformer:EliminatetheTransformermodulefromthedual-featureextractor,keepingsolelythephase-levelfeatures.
â€¢ w/oTeammate:RemovetheCoSmodule,resultinginnoteammatecoordination.
â€¢ CoSwithGNN:ReplacetheMLPsintheCoSmodulewithGNNs.
Inthissection,wepresentmulti-dimensionaltrainingcurvesforvariousevaluationmetricsincludingaverageepisoderewards,average
delaytime,averagewaittime,averagequeuelength,andaveragepressureacrossdifferentscenarios.Theseresultssupplementourmain
ablationstudiesandprovideamorecomprehensiveunderstandingoftheperformanceandrobustnessofouralgorithmundervarious
conditions.
Ablationanalysisonaverageepisoderewards. AsshowninFigureA4,InexperimentsacrossGrid4Ã—4,Avenue4Ã—4,Grid5Ã—5,and
Cologne8,weobservedasignificantlyslowerconvergencerateforCoSwithGNN,takingmuchlongertoreachaplateaucomparedto
ouralgorithm.FortheNanshanmap,whichfeaturesanirregulartopologywith28intersections,theslowdownwaslesspronounced.We
speculatethatinsuchacomplexscenario,GNNsmightbebetteratcapturinginherentdynamicalinformation,thusresultinginadecent
convergencerateandperformance.However,forthissetting,trainingourCoSonasingleseed(300ktimestamps)tookjust13.1hours,
whereastheGNNvarianttookastaggering40.8hours.IntermsofGPUconsumptionforasingleprocess,theMLPversionofCoSpeakedat
1.5G,whiletheGNNversionutilizednearly12G.Thisclearlydemonstratesthatwhileachievingcompetitiveperformance,CoSwithMLPs
significantlysaveoncomputationalresources.
Theaboveisanevaluationofthetrainingcurveconcerningtheaverageepisodereward.Subsequently,thetrainingcurvesforfine-grained
evaluationsineachscenario,includingtheaveragedelaytime,averagewaittime,averagequeuelength,andaveragepressure,areprovided.
Ablationanalysisonaveragedelaytime. AsdepictedinFigureA5,whichpresentsthelearningcurvesfromtheablationstudyconcerningthe
averagedelaytime,ouralgorithmwithallitsmodulesdemonstratessignificantimprovementsinfouroutofthefivescenarios.Theone
exceptionwasNanshan,wheretheimpactofourfinely-designedmodulesappearedtobelesssubstantial.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA4:Learningcurvesoftheablationstudyofthevariouscomponentsabouttheaverageepisoderewards.
WehypothesizethatthisanomalymaybeduetothelargerscaleoftheNanshanmap.Thecomplexityinherentinlargermapsmight
dilutetheeffectsofourspecializedmoduleswhenitcomestoreducingdelaytimes.However,theconsistentimprovementsintheotherfour
scenariosunderscoretheoveralleffectivenessofouralgorithmanditscomponents,provingtheirvalueinoptimizingtrafficsignalcontrol
acrossamajorityofscenarios.
Ablationanalysisonaveragewaittime. FigureA6showsthelearningcurvesoftheablationstudyabouttheaveragewaittime.Intermsof
averagewaitingtime,ourcompletealgorithmhasshownconsistentperformanceadvantagesacrossallmaps.Thisindicatesthatthefull
suiteofmodulesinourapproachishighlyeffectiveinreducingwaittimes,acriticalfactorintrafficsignalcontrol.Theuniformsuccess
acrossallscenariosreinforcestherobustnessofourmethodanditspotentialforbroadapplicationindiversetrafficsituations.
Ablationanalysisonaveragequeuelength. AsillustratedinFigureA7,whichdisplaysthelearningcurvesoftheablationstudyaboutthe
averagequeuelength,ourfullalgorithmshowedconsistentperformanceimprovementsinallscenarios,exceptfortheAvenue4Ã—4.We
believethatthecomplexityandhightrafficflowoftheAvenue4Ã—4scenariomayhaveresultedinthelessnoticeableimprovementinqueue
lengthbyouralgorithm.
Thissuggeststhatwhileourmethodperformsexcellentlyacrossmostscenarios,certainsituationswithhighcomplexityandtraffic
densitymaypresentadditionalchallenges.Despitethis,theoverallperformanceadvantageinthemajorityofscenariosreinforcesthe
effectivenessofourapproach,demonstratingitscapabilitytomanagequeuelength-animportantfactorintrafficflowcontrol.
Ablationanalysisonaveragepressure. FigureA8showsthelearningcurvesoftheablationstudyabouttheaveragepressure.Ourcomplete
algorithmperformedbetterinallsituations,exceptfortheAvenue4Ã—4scenario.Weconjecturethatthehighcomplexityandsignificant
trafficvolumeoftheAvenueÃ—scenariomayhaveledtoalessnoticeableeffectinpressurereductionfromouralgorithm.
Thistrenddoesshedlightonapossiblelimitationofourmethod,whichmightyieldsmallerperformanceimprovementsinhighlycomplex
scenarioswithdensetrafficflow.However,thisshouldnotbeseenasasignificantshortcoming.Whencomparedtobaselinealgorithms,our
methodstilldisplayssubstantialadvantages.Additionally,ourcompletealgorithmachievedsignificantandconsistentimprovementsinall
otherscenarios,attestingtoitsrobustnessandgeneraleffectivenessinTSC.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA5:Learningcurvesoftheablationstudyabouttheaveragedelaytime.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA6:Learningcurvesoftheablationstudyabouttheaveragewaittime.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA7:Learningcurvesoftheablationstudyabouttheaveragequeuelength.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA8:Learningcurvesoftheablationstudyabouttheaveragepressure.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
G ADDITIONALANALYSISOFCOLLABORATORNUMBERğ‘˜
Inthissection,wepresentviolinplotsforallscenariosinFigureA9,demonstratingtheeffectofvaryingthenumberofcollaborators.Notably,
intheGrid4Ã—4scenario,thereisacleartrendofperformanceenhancementasthenumberofcollaboratorsincreases.Thisindicatesthat,in
suchastraightforwardgridenvironment,theperformanceimprovementsbroughtaboutbytargetedcollaborationbetweencollaborators
maynotbeassignificantasthosefromtheincorporationofinformationfromacrosstheentiremap.Inthissimplecase,theinformation
iseithernotredundant,orthedecision-makingisnotaffectedbyanyredundantinformation.IntheCologne8scenario,theperformance
improvementsbroughtaboutbyincreasingthenumberofcollaboratorsarenotapparent.Thissuggeststhat,inthisextremelysimplisticmap
withsparsetrafficandonlyeightintersections,collaborationbetweencollaboratorsmaynotbeascrucial.Inothermaps,abalancesimilar
towhatwementionedearlierisdisplayed.Itsignifiesthenuancedrelationshipbetweenthenumberofcollaboratorsandtheresulting
performanceimprovement.
Ineachmap,varyingthenumberofcollaboratorscaninfluencetheperformancedifferently,highlightingtheimportanceoftailoring
strategiestospecificscenarios.Forinstance,whileGrid4Ã—4benefitsmorefromaholisticinformationintegrationacrossallintersections,
Cologne8seeslimitedgainsfromextensivecollaboratorsduetoitssimplicityandsparsetraffic.Theanalysisalsounderscoresthefactthat
theenvironmentalcomplexityandspecificscenariofactorsheavilyinfluencethisrelationship.Thisfurtherhighlightstheimportanceof
adaptivelydeterminingtheappropriatenumberofcollaborators,apotentialareaforfutureexploration.
2.0
1.0
0.25
2.5
0.30 1.2
0.35 3.0 1.4
0.40 3.5 1.6
0.45
4.0
1.8
0.50
2 4 6 8 10 12 14 16 2 4 6 8 1012141618202224
2 4 6 8 10 12 14 16
The Number of Teammates The Number of Collaborators The Number of Collaborators
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
2.50
0.6 2.75
0.8 3.00
1.0 3.25
3.50
1.2
3.75
1.4
4.00
1.6
4.25
1 2 3 4 5 6 7 8 2 4 6 8 10 12 14 16 18 20 22 24 26 28
The Number of Teammates The Number of Teammates
(d)Cologne8 (e)Nanshan
FigureA9:Violinplotofanalysisaboutvariousnumberofcollaborators.
H ADDITIONALVISUALIZATIONANALYSISOFCOLLABORATORMATRIX
Inthissection,wepresentanextendedvisualizationanalysis,incorporatingheatmapsacrossallscenariosinFigureA10toprovidea
morecomprehensiveunderstandingofthelearningdynamics.Thisadditionalmaterialaffirmstheintriguingpatternthatwehavealready
discussed:intersectionsarenotonlylearningtoconcentrateontheirownstates,buttheyalsodevelopanawarenessoftheirpeers.This
revealsacollaborativelearningprocessamongintersections.
Eachintersectionmanagestostrikeabalancebetweenself-attentionandpeerattention,learningtorecognizewhencollaboration
couldbringaboutperformanceimprovements.Inthisway,weseethatouralgorithmhasfosteredalearnedmutualcollaborationamong
intersections.Theseobservationsofferabroadervalidationoftheeffectivenessofourapproachindevelopingacollaborativeenvironment
amongintersections,whichultimatelyleadstoperformanceenhancementacrossdifferentscenarios.
I ADDITIONALVISUALIZATIONANALYSISOFDUAL-FEATURE
Inthissection,weoffer2Dand3DTSNEvisualizationresultsforeachscenario,showninFigureA11andA12,respectively.Theseresults
consistentlydemonstrateadistinctiveclusteringcharacteristic.Whiletheembeddingsforeachintersectionmaydifferduetovaryingtraffic
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevA
sdraweR
edosipE
egarevAConferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
Teammate Matrix Teammate Matrix Teammate Matrix 0.12 Teammate Matrix 0.062600 0.0627 0.10 0.10
0.062575
0.08 0.062550 0.08 0.0626
0.062525
0.0625
0.06 0.062500 0.06
0.04 0.062475 0.04 0.0624
0.062450
0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15 0 1 2 3 4 5 6Inter7sectio8n ID9 10 11 12 13 14 15
(a)BeginninginGrid4Ã—4 (b)EndinginGrid4Ã—4 (c)BeginninginAvenue4Ã—4 (d)EndinginAvenue4Ã—4
Teammate Matrix Teammate Matrix Teammate Matrix Teammate Matrix 0.1255 0.08 0.04008 0.16
0.1254 0.07 0.04006
0.14 0.1253 0.06 0.04004
0.04002 0.12 0.1252 0.05
0.04000 0.1251
0.04 0.10
0.03998 0.1250
0.03 0.08 0.03996 0.1249
0.02 0.03994 0.06 0.1248
01234567891In0te1r1se1c2tio1n3 ID1415161718192021222324 01234567891In0te1r1se1c2tio1n3 ID1415161718192021222324 0 1 2 In3tersection 4ID 5 6 7 0 1 2 In3tersection 4ID 5 6 7
(e)BeginninginGrid5Ã—5 (f)EndinginGrid5Ã—5 (g)BeginninginCologne8 (h)EndinginCologne8
Teammate Matrix
Teammate Matrix
0.06 0.035720
0.035718
0.05
0.035716
0.04 0.035714
0.03 0.035712
0.035710
0.02
01234567891011Int1e2rs1e3c1t4ion15 ID161718192021222324252627 01234567891011Int1e2rs1e3c1t4ion15 ID161718192021222324252627
(i)BeginninginNanshan (j)EndinginNanshan
FigureA10:Additionalvisualizationofteammatrix.Thedeeperthecolor,thestrongerthecorrelation.
conditionsandintricaciesinherenttothelocation,theclusteringpatternindicatesthatthemodelsuccessfullyinterpretsanddistillsthese
uniquecharacteristicsintoitsdecision-makingprocess.Thisabilitytolearnandadapttotheuniquefeaturesofeachintersectionisakey
strengthofourapproachandprovidesasignificantcontributiontoperformanceimprovement.
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
012345678901DI
1n1oit2c1esr3e1tn4I151617181910212223242
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
012345678901DI
1n1oit2c1esr3e1tn4I151617181910212223242
01234567890111D2I
1no3i1tce4s1re5t1nI617181910212223242526272
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
0
1
2
D3I noitcesret4nI
5
6
7
01234567890111D2I
1no3i1tce4s1re5t1nI617181910212223242526272
0 1 2 3
4
5 6DI n7oitces8retnI9
01
11
21 31
41
51
0
1
2
D3I noitcesret4nI
5
6
7CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA11:2-DTSNEVisualizationofDual-feature.Eachcolorrepresentsaspecificintersection.
(a)Grid4Ã—4 (b)Avenue4Ã—4 (c)Grid5Ã—5
(d)Cologne8 (e)Nanshan
FigureA12:3-DTSNEVisualizationofDual-feature.Eachcolorrepresentsaspecificintersection.Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY TrovatoandTobin,etal.
J ADDITIONALVISUALIZATIONANALYSISOFCOLLABORATORASSIGNMENT
Inthissection,weprovideadditionalresultsforthevisualizationofthecollaboratorassignment.Specifically,weconductedtestsonthe
Cologne8andAvenue4Ã—4scenarios,withcollaboratorcountsof1,2,3,4,and5.Werefrainedfromtestingscenarioswithalargernumberof
intersectionsandcollaboratorsduetothediversityofbarcolors,whichcouldcomplicateobservationandpreventmeaningfulconclusions.
(a)K=1 (b)K=2 (c)K=3
(d)K=4 (e)K=5
FigureA13:VisualizationofthecollaboratorassignmentonCologne8.
InFigureA13,wepresenttheevolutionofthecollaboratorassignmentontheCologne8dataset.
â€¢ WehavepreviouslyanalyzedscenarioswhenthecollaboratornumberKequals1and3inthemainmanuscript.
â€¢ ForK=2,weobserveanintriguingmutualselectiontrendamongagents2and3,aswellasagents4and5.Throughthereconstruction
oftheoriginaltrafficflow,weidentifiedtrafficcorrelationsbetweentheseagentpairs,furthervalidatingtheefficacyofouradaptive
methodinselectingthemostsuitablecollaborators.
â€¢ WhenKisincreasedto4,agent4primarilychoosesagents4,2,1,and5ascollaborators,agent2predominantlyselectsagents2,3,1,
and6,whileagent1mainlyselectsagents1,2,4,and0.Thiscollaborativebehaviorsuggeststhatourapproachcanmanagemore
complexscenarioswheremultipleagentsareinvolved.
â€¢ UponfurtherincreasingKto5,weobserveanemergenceofcross-collaborationwithinthevirtualsubareas,whichsolidifiesour
earlierobservationsthatouralgorithmcaneffectivelyhandlecross-topologycollaboratorselection.
Thiscross-collaborationphenomenonalsodemonstratestheflexibilityofourmethodincreatingdynamic,adaptivecollaborations,evenin
complexenvironmentswithmultipleagents.Insummary,theseresultsstronglyindicatethatourlearning-basedstrategycanadaptively
selecttheoptimalcollaboratorsbasedontheintrinsicdynamicsandtheevolvingnatureofthetrafficflow.Thisadaptiveapproachto
collaboratorselectionprovidesamoreresponsiveandeffectivemechanismtomanagethecomplexitiesofreal-worldtrafficscenarios.
Subsequently,inFigureA14,wepresentanexaminationofcollaboratorassignmentontheAvenue4Ã—4datasettofurthersubstantiatethe
effectivenessofourapproach.
â€¢ AtK=1,thevastmajorityofagentsarecapableofselectingthemselvesascollaborators.Interestingly,agent0consistentlychooses
agent11asitscollaborator.Throughthereconstructionoftheoriginaltrafficnetwork,weobservedthatagents0and11aresituated
adjacenttoeachotheronthenetwork,withhighlycorrelatedtrafficflow.Thisfindingindirectlyconfirmsourmethodâ€™sabilityto
learninherenttrafficpatterns.Otherinstancesofmutualselectionareoccasionallyobserved,forexample,betweenagents4and5.
â€¢ WhenKisincrementedto2,agent0continuestoselectagent11andaddsitselftothelistofcollaborators.Amutualselectiontrendis
alsoobservedamongagentpairs5and10,1and11,aswellas4and13.
â€¢ ForK=3,agent0includesanewcollaborator,agent3,inadditiontoitselfandagent11.Correspondingly,agent3tendstochoose
agents3,0,and11asitscollaborators.Otheragentsalsodisplaymutualselectionwithintheircollaborativesubareas.CoSLight:Co-optimizingCollaboratorSelectionandDecision-makingtoEnhanceTrafficSignalControl Conferenceacronymâ€™XX,June03â€“05,2018,Woodstock,NY
(a)K=1 (b)K=2 (c)K=3
(d)K=4 (e)K=5
FigureA14:VisualizationofthecollaboratorassignmentonAvenue4Ã—4.
â€¢ AsKexpandsto4,agent0addsanothernewcollaborator,agent6,toitspreviouscollaborators(0,11,3).Thispatternofincrementally
addingnewcollaboratorsasthenumberofoptionsincreasesdemonstratesouralgorithmâ€™scapacitytorecognizetheintrinsictraffic
dynamicsandinterrelationamongmultipleintersections.
â€¢ WithK=5,uponcarefulanalysis,theaforementionedphenomenaandsupportingconclusionscontinuetohold.
Inconclusion,theseresultsconvincinglydemonstratethatourapproachiseffectiveinselectingcollaboratorsadaptivelyindifferentscenarios.
Notonlydoesitcapturetheintrinsicdynamicsofthetrafficbutalsodiscernstheinherentrelationsbetweenmultipleintersections,thus
establishingthevalueofourmethodindealingwithcomplextrafficscenarios.