CleanAgent: Automating Data Standardization
with LLM-based Agents
DanruiQi,JiannanWang
SimonFraserUniversity
{dqi,jnwang}@sfu.ca
ABSTRACT I want the output format of the date
InputTableğ‘»
columns as 'MM/DD/YYYYâ€™
Datastandardizationisacrucialpartindatasciencelifecycle.While Name Admission Countryof
toolslikePandasofferrobustfunctionalities,theircomplexityand Date Birth
Abby 2021-01-01 CA fromdataprep.clean\
themanualeffortrequiredforcustomizingcodetodiversecolumn Scott 2020.01.15 Canada importclean_country
typesposesignificantchallenges.Althoughlargelanguagemodels Bella 20/09/01 Canada fromdataprep.clean\
importclean_date
(LLMs)likeChatGPThaveshownpromiseinautomatingthispro- df=clean_date(
df=df,
cessthroughnaturallanguageunderstandingandcodegeneration, StandardizedTableğ‘»! column=â€˜AdmissionDateâ€™,
itstilldemandsexpert-levelprogrammingknowledgeandcontinu- Name Admission Countryof output_format=â€˜MM/DD/YYYYâ€™ Date Birth CleanAgent )
ousinteractionforpromptrefinement.Tosolvethesechallenges, df=clean_country(
Abby 01/01/2021 Canada df=df,
ourkeyideaistoproposeaPythonlibrarywithdeclarative,unified Scott 01/15/2020 Canada column=â€˜CountryofBirthâ€™
APIsforstandardizingcolumntypes,simplifyingtheLLMâ€™scode Bella 09/01/2020 Canada )
generationwithconciseAPIcalls.WefirstproposeDataprep.Clean
whichiswrittenasacomponentoftheDataprepLibrary,offersa
Figure1:Anexampleofautomaticdatastandardizationpro-
significantreductionincomplexitybyenablingthestandardization
cesswithCleanAgent.
ofspecificcolumntypeswithasinglelineofcode.Thenweintro-
ducetheCleanAgentframeworkintegratingDataprep.Cleanand
LLM-basedagentstoautomatethedatastandardizationprocess.
theâ€œYYYY.MM.DD"formatandâ€œ20/09/01"followstheâ€œYY/MM/DD"
WithCleanAgent,datascientistsneedonlyprovidetheirrequire-
format,whereâ€œYYYY/YY"representsyear,â€œMM"representsmonth,
mentsonce,allowingforahands-free,automaticstandardization
â€œDD"representsday.Thegoalofdatastandardizationistounifythe
process.Todemonstratethepracticalutilityof CleanAgent,it
formatofdataineachcolumninğ‘‡ meetingdatascientistsâ€™require- hasbeendevelopedasauser-friendlywebapplication,allowing
ments and to get the standardized tableğ‘‡â€². In Figure 1, the data
VLDBattendeestointeractwithitusingreal-worlddatasets.
scientistsinputtheirrequirementtostandardizeâ€œAdmissionDate"
ACMReferenceFormat: withtheâ€œMM/DD/YYYY"format.Andinğ‘‡â€²,datainthethreecells
DanruiQi,JiannanWang.2024.CleanAgent:AutomatingDataStandard- ofâ€œAdmissionDate"columnfollowsonlyonedateformat,i.e.the
izationwithLLM-basedAgents.In.ACM,NewYork,NY,USA,5pages.
â€œMM/DD/YYYY"format.
https://doi.org/10.1145/nnnnnnn.nnnnnnn
Traditionally,datascientistsheavilyrelyonlibrariessuchas
Pandas[1]fordatastandardizationtasks.EventhoughPandasisa
1 INTRODUCTION
powerfultool,achievingdatastandardizationoftenrequireswriting
Datastandardization,whichispivotalintherealmofdatascience, hundredsorthousandsoflinesofcode.Thestandardizationprocess
aimstotransformheterogeneousdataformatswithinasinglecol- forsinglecolumninvolvesidentifyingthecolumntype,applying
umnintoanunifieddataformat.Thiscrucialdatapreprocessing intricatemethodssuchasregularexpressionstoeachcellwithin
stepisessentialforenablingeffectivedataintegration,dataanalysis, thiscolumnforvalidation,andconvertingeachcellintodesired
anddecision-making. formats.Moreover,atablemaycontainmultiplecolumns,each
Example1.WeillustratethedatastandardizationtaskinFig- possiblyofadifferenttype,requiringbespokestandardizationcode
ure1.Givenaninputtableğ‘‡ whichneedstobestandardized,itis foreachcolumntype.
obviousthatdataintheâ€œAdmissionDate"columnandtheâ€œCountry Recently,theemergenceoflargelanguagemodels(LLMs),espe-
ofBirth"columnarewithdifferentformats.Datainthethreecells ciallyChatGPT,hasshownpotentialinrevolutionizingthisprocess.
ofâ€œAdmissionDate"columnincludesthreedifferentdateformats. Byleveragingtheirnaturallanguageunderstandingandcodegen-
â€œ2021-01-01"followstheâ€œYYYY-MM-DD"format,â€œ2021.01.01"follows erationability,thesemodelscouldsignificantlyaiddatascientists
byautonomouslygeneratingstandardizationcodeinresponseto
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor conversationalprompts.However,thismethodstillnecessitates
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation detailedpromptcraftingandofteninvolvesmulti-turndialogues,
onthefirstpage.Copyrightsforcomponentsofthisworkownedbyothersthanthe whichlimitsefficiencyandpracticality.
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
Toovercometheselimitations,ourkeyideaistointroducea
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/orafee.Requestpermissionsfrompermissions@acm.org. PythonlibraryinvolvingdeclarativeandunifiedAPIsspecifically
Conferenceâ€™17,July2017,Washington,DC,USA designedforstandardizingdifferentcolumntypes.Thisideasimpli-
Â©2024Copyrightheldbytheowner/author(s).PublicationrightslicensedtoACM. fiestheLLMâ€™stasktoconvertingnaturallanguage(NL)instructions
ACMISBN978-x-xxxx-xxxx-x/YY/MM
https://doi.org/10.1145/nnnnnnn.nnnnnnn intosuccinct,declarativeAPIcalls.Suchanapproachstreamlines
4202
raM
31
]GL.sc[
1v19280.3042:viXraConferenceâ€™17,July2017,Washington,DC,USA DanruiQi,JiannanWang
theLLMâ€™scodegenerationprocess,requiringjustafewlinesof withuser-friendlyinterfaceanddemonstrateitsutility.Wealso
code, open-sourcedtheimplementationof CleanAgentonGitHub4.
Thisaboveidea,however,introducestwoprimarychallenges.
Thefirstchallenge(C1)isthedesignofthedeclarativeandunified 2 TYPE-SPECIFICSTANDARDIZATIONAPI
APIsfordatastandardization,ensuringitcaneffectivelyreduce DESIGN
theintricaciesinvolvedinstandardizingspecificcolumntypes(ide-
Inthissection,wefirstdescribethecommonstepsofdatastan-
allyonelineofcodepercolumntype).Thesecondchallenge(C2)
dardization. Then we introduce the type-specific API design of
centersonoptimizingtheinteractionbetweendatascientistsand
Dataprep.Clean.
LLMs.Ourgoalistominimizehumaninvolvement,ideallyallow-
CommonStepsofDataStandardization.Inspiredbythesteps
ingdatascientiststoinputtheirstandardizationrequirementsin
humanstandardizingdatacell,weidentifythreecommonsteps
oneinstance,therebyenablinganautonomousandhands-offdata
ofdatastandardization.Wetakethedatetimecolumntypeasan
standardizationprocess.
exampletoillustratethesesteps.
TosolveC1,weproposethetype-specificCleanmoduleinDat-
Assumeadatascientistisdealingwithandatetimecolumn
aprepLibrary1,namedDataprep.Clean2.Byobservingthecom-
includingtworecords"ThuSep2510:36:282003"and"1996.07.10AD
monstepsofdatastandardizationforspecificcolumntypes,wede-
at15:08:56".Thedatascientistwantstounifythechaoticcolumn
signunifiedAPIsclean_type(df,column_name,target_format),
intoatargetformat"YYYY-MM-DDhh:mm:ss".
wherethetyperepresentsthedesiredstandardizationtype,such
(1)Split.Atthebeginning,thedatascientistneedstosplitthe
asdate,addressandphone,etc.TheseunifiedAPIsofferenhanced
datetimestringintoseveralsinglepartswhichincludeonekindof
expressivenesscomparedtorawPandascode,reducingthecomplex-
specificinformation.Inourexample,thedatascientistcangetsev-
ityofstandardizingspecificcolumntypes.WithDataprep.Clean,
eraltokens{â€™Thuâ€™,â€™Sepâ€™,â€™25â€™,â€™10â€™,â€™36â€™,â€™28â€™,â€™2003â€™}from
datascientistscanstandardizeonecolumntypewithonlyoneline
thefirstrecordbyusingspaceandcolonasseparators.Different
ofcode.
typehasitsownsplittingstrategywhichisnotalwayssplittinginto
TosolveC2,weproposetheCleanAgentframeworkwhich
tokens.Forexample,thedatascientistwillsplittheemailstring
automatesdatastandardizationwithDataprep.CleanandLLM-
intotheusernamepartandthedomainpart.
basedAgents[2,3].Onceusershaveenteredtheirfinalgoals,the
(2)Validate. Standardization can only be performed on valid
LLM-basedAgentscanfreetheirhands,autonomouslygenerate
inputs.Thusthesecondstepshouldbevalidation.Forexample,if
thoughtsandexecuteparticulartasks.CleanAgentleveragesboth
thestring"littlecat"isaninstanceofthedatetimecolumn,this
thecapabilitiesofbothDataprep.CleanandLLM-basedAgents.
stringisinvalidandthedatascientistwilltransformittoadefault
Datascientistsonlyneedtoinputthetablethatneedstobestan-
valuelikeNaN.Intuitively,astringisvalidmeansthateachpartof
dardizedandtheirrequirements,CleanAgentwillcompletethe
thisstringaftersplittingisvalid.Hence,validationofeachsplitpart
datastandardizationprocessautomaticallywiththreesteps:anno-
isimportant.Usually,thedatascientistwillrecognizeandvalidate
tatingthetypeofeachcolumn,generatingconcisePythoncodefor
eachpartbytheirdomainknowledge,somecorpusorsomerules.
standardizationandexecutingthegeneratedPythoncode.
Ifeverysplitpartisvalid,thestringisalsovalid.Forinstance,the
Example2.ContinuingwithExample1.Givenaninputtableğ‘‡
tokenâ€™Sepâ€™canberecognizedasavalidrepresentationofmonth,
whichneedstobestandardizedandthedatascientistsâ€™requirements,
andâ€™2003â€™canberecognizedasavalidyear.
theCleanAgentfirstrecognizesthattheâ€œAdmissionDate"column
(3)Transform.Thelaststepofstandardizationistotransform
belongstothedatetype,andtheâ€œCountryofBirth"columnbelongsto
eachsplitpartandcombinethemintotargetformat.Inourexample,
thecountrytype.Accordingtothecolumn-typeannotationresults,the
becausethetargetformatis"YYYY-MM-DDhh:mm:ss",themonth
CleanAgentgeneratesandexecutesPythoncodeforstandardization
bycallingâ€œclean_date"andâ€œclean_type"functions,thenreturnsthe Sep is transformed into number 09 and recombined with other
standardizedtableğ‘‡â€².
partstothetarget"2003-09-25 10:36:28".
CleanAgentisbuiltasawebapplication.WeallowtheVLDB
TheDesignofUnifiedAPIs.ThegoalofourAPIdesignisto
enabledatascientiststocompleteallthecommonstepsofdata
attendeestochoosesampledataandcommunicatewithClean-
standardizationofonecolumnwithasinglefunctioncall.Thesim-
Agentforstandardization.Weprovidethedemonstrationvideo
whichcanbefoundonYoutube3. plicityandconsistencyareconsiderderedasthepincipleofAPI
design.Theobservationonthecommonstepsofdatastandardiza-
Tosummarize,wemakethefollowingcontributions:(1)Wepro-
tionbringsthetype-specificAPIdesignidea.Thus,wedesignthe
poseDataprep.Clean,anopen-sourcedlibraryshowingreducing
APIinthefollowingform:
thecomplexityofimplementingstandardizationforspecificcolumn
typeswithtype-specificstandardizationfunctions.(2)Wepropose clean_type(df, column_name, target_format)
CleanAgent,whichautomatesthedatastandardizationprocess
whereclean_typeisthefunctionname,typerepresentsthe
bycombiningboththeadvantagesof Dataprep.CleanandLLM-
typeofthecurrentcolumn.Thefirstargumentdfrepresentsthe
basedAgents.(3)WedeployCleanAgentasawebapplication
inputDataFrame,thesecondargumentcolumn_nameisthecolumn
needstobestandardizedandthethirdargumenttarget_typeis
thetargetstandardizationformatusersspecified.OurAPIsdesign
1https://github.com/sfu-db/dataprep isflexibleandextensible,whichisconvenientforuserstoaddnew
2https://github.com/sfu-db/dataprep/tree/develop/dataprep/clean
3https://youtu.be/fSYXVM6qeqM 4https://github.com/sfu-db/CleanAgentCleanAgent:AutomatingDataStandardization
withLLM-basedAgents Conferenceâ€™17,July2017,Washington,DC,USA
receivesthetableinformationandleveragesLLMstoannotatethe
SystemMessage
type of each column in the input table. If the The Column-type
Annotator cannotfigureoutthespecifictypeofonecolumn,the
Column-typeAnnotatoroutputsâ€œIdonotknow".Theannotation
Tools resultisreturnedtotheChatManagerandstoredintheChatMan-
LLM-based agerâ€™smemory(â‘¡inFigure3).Thirdly,ThePythonProgrammer
Agent receiveshistoricalmessagesfromtheChatManagerincludingthe
column-typeannotationresults(â‘¢inFigure3),picksupthecorre-
spondingcleanfunctionsandgeneratesPythoncodeforthedata
standardizationprocess.ThegeneratedPythoncodeisalsoreturned
LLM Memory totheChatManagerandstoredintheChatManagerâ€™smemory(â‘£
inFigure3).Finally,TheCodeExecutorreceiveshistoricalmessages
fromtheChatManagerincludingthecolumn-typeannotationre-
sultsandthegeneratedPythoncode(â‘¤inFigure3),thenexecutes
thegeneratedPythoncode.Ifthegeneratedcodeexecuteswithout
Figure2:BasicStructureofLLM-basedAgent.
errors,thestandardizedtableğ‘‡â€²isreturned.Ifthegeneratedcode
executeswitherrors,theerrormessageisreturnedtotheChat
Managerandstoredinitsmemory(â‘¥inFigure3).ThenCleanA-
standardizationfunctionsdealingwithnewdatatypes.Currently, gentwillretrythewholeworkflowuntilitcancompletethedata
wehave142standardizationfunctionsinDataprep.Clean,repre- standardizationprocesssuccessfully.
senting142datatypes.
3 CLEANAGENTWORKFLOW
Inthissection,wefirstintroducethebasicstructureoftheLLM-
basedagent.ThenwedescribetheCleanAgentworkflowcon- 4 DEMONSTRATIONSCENARIOS
structedbyfouragents.Theautomaticdatastandardizationprocess Thedemonstrationsetupincludesatableneedtobestandardized
canbecompletedbythecooperationofthefouragentsinCleanA- andalaptop.ThelaptopmustconnecttotheInternetforvisitors
gent. can use CleanAgent smoothly with OpenAIâ€™s GPT service. If
BasicStructureofLLM-basedAgent.Accordingtotheprevious theconferenceInternetfails,amobilehotspot(establishedviacell
surveysonLLM-basedAgent[3],weconcludethebasicstructureof phone)canalsobeusedforrunningCleanAgent.
LLM-basedAgentshowninFigure2.AnLLM-basedagentincludes Figure4showstheuserinterfaceof CleanAgent.Asareaâ‘ 
fourmaincomponents:(1)anLLMusedtogeneraterepliesforinput shows,usersmustfirstuploadaCSVfilethatneedstobecleaned.
information (2) a memory used to store historical conversation ThenCleanAgentreceivesandshowsthebasicinformationof
messages(3)asystemmessagedefiningtheroleoftheagent(4)a theuploadedfile(numberofrowsandnumberofcolumns).Ifusers
setofexternaltoolswhichcanbecalledbytheLLM-basedagentto wantCleanAgenttostartthedatastandardizationprocess,they
completespecifictasks,suchaswebsearching,coderunning,etc. shouldjustclickâ€œStartStandardization"button.
DetailedWorkflow.Thedetailedworkflowof CleanAgentis After clicking the â€œStart Standardization" button, as area â‘¡
showninFigure3.TheCleanAgentiscomposedoffouragents, shows,theUser_Proxygeneratesthreedetailedstepstocomplete
includingaChatManager,aColumn-typeAnnotator,aPythonPro- thedatastandardizationtask.Firstly,theColumn-type Annotator
grammerandaCodeExecutor.Theycancommunicatewitheach receives messages from the Chat Manager, annotates and out-
otherandautomaticallycompletethedatastandardizationprocess putsthetypeofeachcolumn,asareaâ‘¢shows.ThenthePython
bycooperation.AsmentionedinFigure2,eachagenthasitsown ProgrammerpicksupstandardizationfunctionsfromDataprep.Clean
memorytostorethehistoricalconversationalmessagesbetweenit withrespecttothetypeofeachcolumn,andwriteproperPython
andotheragents.Itisimportanttohighlightthatthememoryof codetostandardizecolumnsintheinputtable,asareaâ‘£shows.
theChatManagerisuniquelycomprehensive,encompassingthe Thirdly,theCode ExecutorexecutesthePythoncodegenerated
entirehistoricalconversationalmessagesfromallagentswithin bythePython Programmerandcollectstheexecutionmessages,
theCleanAgentsystem.Thisextensivememoryenablesevery asareaâ‘¤shows.IftheCode Executorgetstheerrormessage
agentintheCleanAgenttogenerateresponsesthatareinformed whenexecutinggeneratedPythoncode,theerrormessageissent
bythecompletehistoricalmessages. totheChatManagerandbecomespartofthepromptofthenext
Theinputof CleanAgentincludesatableğ‘‡ thatneedstobe try.IftheCode Executorgetsthemessageofsuccessfulexecution,
standardized.Datascientistscanalsoinputextrarequirementssuch CleanAgentwillreportthatthedatastandardizationiscompleted,
asâ€œtheformatofthedatetypecolumnshouldbeMM/DD/YYYY". asareaâ‘¥shows.Moreover,userscanclicktheâ€œShowCleanedTa-
Byreceivingtheinputtableanddatascientistsâ€™extrarequirements, ble"buttontocheckwhetherthestandardizedtablematchesusersâ€™
CleanAgent storestheseinformationintotheChatManagerâ€™s requirements.Ifyes,userscandirectlydownloadthestandardized
memoryandstartstocompletethedatastandardizationprocess. table.Otherwise,userscaninputtheirextrarequirementswithnat-
TheChatManagerdeliversmessagesinitsmemorytotheColumn- urallanguage.CleanAgentwillstartanewdatastandardization
typeAnnotator(â‘ inFigure3).ThenTheColumn-typeAnnotator processaccordingtousersâ€™input.Conferenceâ€™17,July2017,Washington,DC,USA DanruiQi,JiannanWang
Tableğ‘» Standardized
+Userâ€™sRequirements Tableğ‘»!
CleanAgent
1 Historical 5 Historical
Message Chat Message
Manager
Column-type
2 ğ‘ª ğŸ:email 6 Success/Error
Code
ğ‘ª :phone Execution
Annotator ğŸ Executor
4 df=clean_email(
3 Historical
df,â€œemailâ€)
Message Tools
df=clean_date(
df, â€œ dateâ€)
Tools
Untilsuccessfully
Python 1 -6
standardizeinputtableğ‘»
Programmer
Figure3:TheWorkflowofCleanAgent.
1 44
2
5
3
6
Figure4:UserinterfaceofCleanAgent.
5 CONCLUSIONANDFUTUREWORK
Inthisdemopaper,weproposedCleanAgenttoautomatethe
datastandardizationprocesswithDataprep.CleanandLLM-basedCleanAgent:AutomatingDataStandardization
withLLM-basedAgents Conferenceâ€™17,July2017,Washington,DC,USA
Agents.WeimplementedCleanAgentasawebservicetovisu- arXiv:2308.08155
alizetheconversationsamongagents.Othertasksindatascience [3] ZhihengXi,WenxiangChen,XinGuo,WeiHe,YiwenDing,BoyangHong,Ming
Zhang,JunzheWang,SenjieJin,EnyuZhou,RuiZheng,XiaoranFan,XiaoWang,
lifecyclesuchasdatacleaninganddatavisualizationcanalsobe
LimaoXiong,YuhaoZhou,WeiranWang,ChanghaoJiang,YichengZou,Xi-
completedbyLLM-basedagents[4].Inthefuture,itispromising angyangLiu,ZhangyueYin,ShihanDou,RongxiangWeng,WensenCheng,Qi
thatthedatasciencelifecyclecanbeautomaticallyplannedand Zhang,WenjuanQin,YongyanZheng,XipengQiu,XuanjingHuan,andTaoGui.
2023. TheRiseandPotentialofLargeLanguageModelBasedAgents:ASur-
completedbyLLM-basedagentsâ€™cooperation. vey. CoRRabs/2309.07864(2023). https://doi.org/10.48550/ARXIV.2309.07864
arXiv:2309.07864
REFERENCES [4] SiqiaoXue,CaigaoJiang,WenhuiShi,FangyinCheng,KetingChen,Hongjun
Yang,ZhipingZhang,JianshanHe,HongyangZhang,GanglinWei,WangZhao,
[1] WesMcKinneyetal.2024.pandas:powerfulPythondataanalysistoolkit. https: FanZhou,DanruiQi,HongYi,ShaodongLiu,andFaqiangChen.2023. DB-
//pandas.pydata.org/Accessed:2024-01-25. GPT:EmpoweringDatabaseInteractionswithPrivateLargeLanguageMod-
[2] QingyunWu,GaganBansal,JieyuZhang,YiranWu,ShaokunZhang,Erkang els. CoRRabs/2312.17449(2023). https://doi.org/10.48550/ARXIV.2312.17449
Zhu, Beibin Li, Li Jiang, Xiaoyun Zhang, and Chi Wang. 2023. AutoGen: arXiv:2312.17449
Enabling Next-Gen LLM Applications via Multi-Agent Conversation Frame-
work.CoRRabs/2308.08155(2023). https://doi.org/10.48550/ARXIV.2308.08155