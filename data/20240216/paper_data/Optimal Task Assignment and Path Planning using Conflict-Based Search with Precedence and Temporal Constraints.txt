Optimal Task Assignment and Path Planning using
Conflict-Based Search with Precedence and Temporal Constraints
YuQuanChong JiaoyangLi KatiaSycara
CarnegieMellonUniversity CarnegieMellonUniversity CarnegieMellonUniversity
Pittsburgh,PA,USA Pittsburgh,PA,USA Pittsburgh,PA,USA
yuquanc@andrew.cmu.edu jiaoyangli@cmu.edu sycara@andrew.cmu.edu
ABSTRACT orderandwithincertaintimeframestoavoidproductdefects.Ex-
The Multi-Agent Path Finding (MAPF) problem entails finding istingMAPFalgorithms[3,4,14,24â€“26,29]donotincorporate
collision-freepathsforasetofagents,guidingthemfromtheir bothprecedenceandtemporalconstraintswhengeneratingpaths
starttogoallocations.However,MAPFdoesnotaccountforseveral aswellastheexecutiontimeofactionsatgoallocations.
practicaltask-relatedconstraints.Forexample,agentsmayneed Furthermore,inmanyreal-worldproblems,theunderlyinggoal
toperformactionsatgoallocationswithspecificexecutiontimes, istomaximizeauser-definedobjectiveinsteadofminimizingthe
adheringtopredeterminedordersandtimeframes.Moreover,goal makespanorsumofpathcosts,whichareusuallyoflowerpriority.
assignmentsmaynotbepredefinedforagents,andtheoptimization Thenotionofauser-definedobjectivecanbequantifiedthrough
objectivemaylackanexplicitdefinition.Toincorporatetaskassign- thereinforcementlearning(RL)frameworkviareturnsfromauser-
ment,pathplanning,andauser-definedobjectiveintoacoherent definedrewardfunction.Forexample,asparserewardfunction
framework,thispaperexaminestheTaskAssignmentandPath wouldonlygiveapositivereward(e.g.+1)whenataskiscompleted
FindingwithPrecedenceandTemporalConstraints(TAPF-PTC) and a reward of zero otherwise. Hence, generating an optimal
problem.WeaugmentConflict-BasedSearch(CBS)tosimultane- taskassignmentthatmaximizes theuser-defined objectivethat
ouslygeneratetaskassignmentsandcollision-freepathsthatadhere is typically unknown is also vital. In addition, task assignment
toprecedenceandtemporalconstraints,maximizinganobjective andpathplanningarehighlycoupledascertaintaskassignments
quantifiedbythereturnfromauser-definedrewardfunctionin couldleadtofewerconflictsduringpathplanning,increasingthe
reinforcementlearning(RL).Experimentally,wedemonstratethat probabilityoffindinganoptimalsolution.
ouralgorithm,CBS-TA-PTC,cansolvehighlychallengingbomb- Ingeneral,manymulti-agentproblemsbasedonreal-worldsce-
defusingtaskswithprecedenceandtemporalconstraintsefficiently narioscanbetheoreticallyframedasmulti-agentreinforcement
relativetoMARLandadaptedTargetAssignmentandPathFinding learning(MARL)problemswithauser-definedrewardfunction.
(TAPF)methods. However,usingMARLmethodstotrainagentstolearntosolve
tasksinvolvingpathplanningpresentsitselfwithmanychallenges
KEYWORDS suchassampleefficiency.Forexample,PRIMAL[23],aframework
thatcombinesRLwithimitationlearning(IL)fromanexpertcen-
Multi-AgentTaskAssignment,Multi-AgentPathFinding,Prece-
tralizedMAPFplannerlikeCBS[24]andODrM*[29]tosolveMAPF
denceConstraints,TemporalConstraints
problems,hadatrainingtimeof20days.Hence,ratherthantraining
ACMReferenceFormat: agentstolearnthepathplanningandadditionalskillsnecessary
YuQuanChong,JiaoyangLi,andKatiaSycara.2024.OptimalTaskAs-
tosolvetasksfromscratch,itwouldbeidealtodeviseasingle
signmentandPathPlanningusingConflict-BasedSearchwithPrecedence
coherentframeworkthatcanincorporatetaskassignment,path
andTemporalConstraints.InProc.ofthe23rdInternationalConferenceon
planning,andauser-definedobjectivetosolvetasks.
AutonomousAgentsandMultiagentSystems(AAMAS2024),Auckland,New
Therefore,weexaminetheTaskAssignmentandPathFinding
Zealand,May6â€“10,2024,IFAAMAS,9pages.
withPrecedenceandTemporalConstraints(TAPF-PTC)problem,
1 INTRODUCTION wherethegoalistosimultaneouslygeneratetaskassignmentswith
feasibleandcollision-freepathsforagentsthatadheretoprece-
Multi-AgentPathFinding(MAPF)isagrowingfieldwithapplica-
denceandtemporalconstraintstomaximizeauser-definedobjec-
tionsinfieldssuchastransportationandlogistics[19,27,30].Most
tiveandpresenttheConflict-BasedSearchwithTaskAssignment,
MAPFalgorithmsappliedincaseslikewarehousepick-and-place
PrecedenceandTemporalConstraints(CBS-TA-PTC)algorithm.Ex-
operationsgeneratecollision-freeplanstobringagentsfromtheir
perimentalresultsdemonstratethatCBS-TA-PTCcansolvehighly
starttogoallocations.However,inreal-worldscenarios,agentsof-
challengingbomb-defusingtaskswithprecedenceandtemporal
tenhaveinterdependenttasksthatrequireactionstobeperformed
constraintsefficientlyrelativetoMARLandadaptedTargetAssign-
inaspecificorder(precedenceconstraints)and/orwithinaspecific
mentandPathFinding(TAPF)[15]methods.
timeframe(temporalconstraints)atspecificlocations.Forexample,
agentsinmanufacturingplantsneedtoperformvariousinterde-
pendenttaskssuchaswelding,painting,andassemblyinaspecific
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems
2 BACKGROUND
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6â€“10,2024,
Auckland,NewZealand.Â©2024InternationalFoundationforAutonomousAgents
Inthissection,weprovideabriefoverviewofMAPF,CBS,MARL,
andMultiagentSystems(www.ifaamas.org).ThisworkislicencedundertheCreative
CommonsAttribution4.0International(CC-BY4.0)licence. andTAPF.
4202
beF
31
]IA.sc[
1v27780.2042:viXra2.1 Multi-AgentPathFinding(MAPF) 2.4 TargetAssignmentandPathFinding(TAPF)
MAPFischaracterisedbyanundirectedgraphğº = (ğ‘‰,ğ¸) anda TAPF is characterised by an undirected graphğº = (ğ‘‰,ğ¸) with
setofğ‘šagents{ğ‘ 1,...,ğ‘ ğ‘š},whereeachagentğ‘ ğ‘– possessesastart ğ¾ teams {ğ‘¡ğ‘’ğ‘ğ‘š 1,...,ğ‘¡ğ‘’ğ‘ğ‘š ğ¾},whereeachteamğ‘¡ğ‘’ğ‘ğ‘š ğ‘– consistof
vertexğ‘  ğ‘– âˆˆğ‘‰ andgoalvertexğ‘” ğ‘– âˆˆğ‘‰.Eachagentcaneithermove ğ¾ ğ‘– agents{ğ‘ğ‘– 1,...,ğ‘ğ‘– ğ¾ğ‘–}andaregivenuniquetargetgoalvertices
At so
tn
aa rtan
g
te oei ng ith
t
sâ€™b
s
go opr ai an lthg vev
i
rse tr eat xe sx
ae
no
q
dr
u
ter he
n
em
ce
pa ai on
tf
ha
a
ct
c
oi tt sis toc
n
isu sr thr te
h
en
a
ct
t
ov
b
me rr bint ie ngx
es
da it
t
cu ofn
r so
tit
m
oc fo
i
as
t
lst l. m{ğ‘” oğ‘– 1 v,. e. t. o,ğ‘” ağ‘– ğ¾ğ‘– u} n. iE qa uc eh ta ag re gn ettğ‘ gğ‘– oğ‘— ah la vs ea rtu en xiq ğ‘”u
ğ‘–
ğ‘—â€²e .s Ata gr et nv te sr it nex ğ‘¡ğ‘’ğ‘  ğ‘ğ‘– ğ‘— ğ‘šan ğ‘–d arm eu as st
-
signedtotargetsthroughapermutationbasedone-to-onemapping
a coct ni flo in cs tâŸ¨in
ğ‘
ğ‘–t ,h ğ‘e ğ‘—,p ğ‘£a ,ğ‘¡th âŸ©. iffW ğ‘e ğ‘–c ao nn ds ğ‘id ğ‘—e ar retw ato thty ep se as mo ef vc eo rn tefl xic ğ‘£ts a: t1 t) heVe sart mex
e
ğœ™, i.e.ğ‘”ğ‘–
ğ‘—â€²
= ğœ™ğ‘–(ğ‘ğ‘– ğ‘—). Beyond collisions between agents within a
t si am me est ee dp gğ‘¡ e,2 âŸ¨ğ‘¢) ,E ğ‘£d âŸ©g ie nc oo pn pfl oic st itâŸ¨ eğ‘ ğ‘– d, iğ‘ reğ‘—, cğ‘¢ ti, oğ‘£ n,ğ‘¡ sâŸ© bi eff twğ‘ ğ‘– ea en nd tiğ‘ mğ‘— et sr ta ev pe srs ğ‘¡e at nh de t i.e ea .m be, tT wA eP eF nc ao gn es nid te ğ‘r ğ‘– ğ‘—sc inol ğ‘¡l ğ‘’is ğ‘i ğ‘šon ğ‘–s ab ne dtw ae ge en nta ğ‘g ğ‘–e ğ‘—â€² â€²n it nso ğ‘¡ğ‘’f ğ‘d ğ‘šiff ğ‘–e â€².re Tn ht ete team ams,
ğ‘¡+1.AconstraintisatupleâŸ¨ğ‘ ğ‘–,ğ‘£,ğ‘¡âŸ©whereğ‘ ğ‘– isprohibitedfrom conflicts are adapted from MAPF as follows: 1) Vertex conflict
occupyingğ‘£attimestepğ‘¡.AsolutiontoMAPFisasetofconflict- âŸ¨ğ‘¡ğ‘’ğ‘ğ‘š ğ‘–,ğ‘¡ğ‘’ğ‘ğ‘š ğ‘–â€²,ğ‘£,ğ‘¡âŸ© iffğ‘ğ‘– ğ‘— andğ‘ğ‘– ğ‘—â€² â€² areatthesamevertexğ‘£ atthe
freepathsforallagentsandanoptimalsolutionisasolutionthat sametimestepğ‘¡,2)EdgeconflictâŸ¨ğ‘¡ğ‘’ğ‘ğ‘š ğ‘–,ğ‘¡ğ‘’ğ‘ğ‘š ğ‘–â€²,ğ‘¢,ğ‘£,ğ‘¡âŸ©iffğ‘ğ‘– ğ‘— and
givestheminimumforanobjectivefunction,whichistypicallythe ğ‘ğ‘–â€² traversethesameedge âŸ¨ğ‘¢,ğ‘£âŸ© inoppositedirectionsbetween
ğ‘—â€²
sumofpathcosts(sumofthepathcostsofallagentsâ€™paths)or timestepsğ‘¡ andğ‘¡+1.
themakespan(maximumpathcostofallagentsâ€™paths).Finding
anoptimalsolutionforMAPFisknowntobeanNP-hardproblem 3 PROBLEMDEFINITION
evenwhenapproximatingoptimalsolutions[11,14,16].
TAPF-PTC is characterised by an undirected graphğº = (ğ‘‰,ğ¸),
asetofğ‘ agents{ğ‘ 1,...,ğ‘ ğ‘},andataskğ‘‡,whichisasetofğ‘€
2.2 Conflict-BasedSearch(CBS)
goals{ğ‘”1,...,ğ‘”ğ‘€}withgiventemporalandprecedenceconstraints.
Eachagenthasaninitialstateğ‘  ğ‘– âˆˆ Sconsistingofastartvertex
CBS[24]isacompleteandoptimaltwo-levelMAPFalgorithm.The ğ‘£ ğ‘– âˆˆ ğ‘‰,whereğ‘£ ğ‘– âˆˆ ğ‘  ğ‘–.Eachgoalğ‘”ğ‘– isatuplecomprisingagoal
high-levelsearchisabest-firstsearchwithrespecttothecostofa actionğ‘”ğ‘–.ğ‘ğ‘ğ‘¡ âˆˆ A\Ağ‘£ andagoalvertexğ‘”ğ‘–.ğ‘£ âˆˆğ‘‰,whereA and
nodeaboutabinaryConstraintTree(CT),whereeachnodecontains
Ağ‘£ arethesetofallactionsandactionsforvertexmovements,
asetofpathconstraintsforvariousagents,asetofpathsforeach respectively.Weneedtofindabinaryğ‘ Ã—ğ‘€matrixğ¸thatassigns
agentconsistentwiththepathconstraints,andacostdepending
goalstoagentsviaamany-to-onemappingsuchthateachagent
o Cn Tt nh oe do eb wje ic thtiv ae no ef mt ph te yM seA tP oF fcp or no sb tl re am in. tsC aB nS ds gta er nt es rw ati et sh pt ah te hsro foo rt ğ‘ ğ‘– hasasequenceofğ‘™ ğ‘– goals [ğ‘” ğ‘–1,...,ğ‘” ğ‘–ğ‘™ğ‘–],where(cid:205) ğ‘–ğ‘ğ‘™ ğ‘– = ğ‘€.An
eachagentcomputedusingthelow-levelplanner.Thehigh-level
agentğ‘ ğ‘–reachesğ‘” ğ‘–ğ‘—.ğ‘£andperformsğ‘” ğ‘–ğ‘—.ğ‘ğ‘ğ‘¡forğ›¼(ğ‘”ğ‘—)timestepswhile
searchevaluatesthesetofpathsofeachagentforconflicts,where waitingthere.Wefurtheruseğœ‡(ğ‘” ğ‘–ğ‘— )andğœ(ğ‘” ğ‘–ğ‘— )todenotethetimestep
aconflict-freeCTnodeisreturnedasthegoalnode.Otherwise, whenagentğ‘ ğ‘– startandfinishperformingactionğ‘” ğ‘–ğ‘—.ğ‘ğ‘ğ‘¡ atvertex
i st ps lie tl se tc hts ea Cc To nn ofl dic et ib ne tt ow te we on cth he ildpa Ct Ths no of dt ew s,o anco dn afl pi pct ei nn dg sa age nn et ws, ğ‘” ğ‘–ğ‘—.ğ‘£,respectively,soğœ(ğ‘” ğ‘–ğ‘— )âˆ’ğœ‡(ğ‘” ğ‘–ğ‘— ) = ğ›¼(ğ‘” ğ‘–ğ‘— ).Apathsegmentfor
anagentğ‘ ğ‘– consistsofthesequenceofstatesandactionsfromthe
c foo rn bs it dra ei in tt ht eo re ca oc nh flc ih cti il nd gC aT gn eo nd tsef fo ror meac uh tia lig ze inn gt. tT hh ee cn oe nw flic co tn ins gtra ei dn gt es completionofğ‘” ğ‘–ğ‘—âˆ’1 tothecompletionofğ‘” ğ‘–ğ‘— ,withthefullpathbeing
thesequentialconcatenationofthepathsegmentsofğ‘™ ğ‘– goals.We
orvertexattheconflictingtimestep.Thelow-levelplannerthen
introducetwoadditionaltemporalconstraints:1)Absolutetemporal
recomputesthepathoftheconstrainedagentinthechildCTnodes
tobeconsistentwiththenewconstraintset.
rangeconstraintsTğ‘ğ‘ğ‘  and2)Inter-goaltemporalrangeconstraints
Tğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ,inadditiontotheprecedenceconstraintsTğ‘ğ‘Ÿğ‘’ğ‘ inCBS-PC
[33] and the vertex/edge constraints in CBS [24]. A solution to
2.3 Multi-AgentReinforcementLearning TAPF-PTCconsistsofagoalassignmentandasetofconflict-free
pathssatisfyingtheaboveconstraints.
(MARL)
MARLisabranchofRLwhoseobjectiveistotrainagentswhocan 3.1 AbsoluteTemporalRangeConstraints
learntocooperateorcompetewitheachotherincomplexenviron- ğ‘”ğ‘— ğ‘”ğ‘—
mentstoachieveacommonorindividualgoal.Inpartiallyobserv- AnabsolutetemporalrangeconstraintâŸ¨ğ‘¡ ğ‘™ğ‘œğ‘– ğ‘¤ğ‘’ğ‘Ÿ,ğ‘¡ ğ‘¢ğ‘– ğ‘ğ‘ğ‘’ğ‘Ÿ,ğ›¾âŸ© âˆˆTğ‘ğ‘ğ‘  is
ableMarkovgame[12]ofğ‘ agents,thesetofstates,actionsand ğ‘”ğ‘— ğ‘”ğ‘—
observationsaregivenbyS,A 1,...,Ağ‘ andO 1,...,Oğ‘ respec- a oftu thp ele rw anh ge ere oğ‘¡ fğ‘™ğ‘œğ‘– tğ‘¤ imğ‘’ğ‘Ÿ esa tn ed psğ‘¡ ğ‘¢ wğ‘– ğ‘ğ‘ hğ‘’ eğ‘Ÿ rere ep ir te hs ee rn tt hlo ew ee xr eca un td iou npp oe rr cb oo mu pn ld es
-
t si tv ae tely s.f Eo ar ce hac ah gea ng te on bt. taA ind sis at nri ob bu st eio rn vağœŒ tio: nS ,ğ‘œâ†’âˆ’
ğ‘–
:[ S0, â†’1 âˆ’]s Oel ğ‘–e ,c fots llt oh we sin ai sti ta ol
-
tiontimestep,denotedbyğ›¾ âˆˆ [ğœ,ğœ‡],foragentğ‘ ğ‘– forğ‘” ğ‘–ğ‘— mustfall
chasticpolicy,ğ…ğœƒğ‘– :Oğ‘–Ã—Ağ‘–â†’âˆ’ [0,1]thatgeneratesthenextstate within,i.e.,ğ‘¡ ğ‘™ğ‘” ğ‘œğ‘–ğ‘—
ğ‘¤ğ‘’ğ‘Ÿ
â‰¤ ğ›¾(ğ‘” ğ‘–ğ‘— ) â‰¤ ğ‘¡ ğ‘¢ğ‘” ğ‘– ğ‘ğ‘— ğ‘ğ‘’ğ‘Ÿ.Itallowstheusertodefine
f ao nl dlo rw ei cn eg ivt eh se ast ra et wet ar ra dn ,s ğ‘Ÿi ğ‘–ti :o Snf Ã—un Act ğ‘–io â†’âˆ’n, RT .E: aS cÃ— hA ag1 eÃ— ntÂ· aÂ· iÂ· mÃ— sA toğ‘ mâ†’âˆ’ axS
i-
thetemporalrangewhereğ‘” ğ‘–ğ‘— muststartexecutionorbecompleted.
m thi eze toi tt as lo dw isn cot uo nta tl edex rp ee wc ate rd dfr re otu mrn ti, mğº eğ‘¡ s= tep(cid:205) ğ‘¡ğ‘‡ ğ‘˜ ,ğ‘¡ wğ‘’ğ‘Ÿğ‘š heğ›¾ rğ‘˜ eğ‘Ÿ ğ›¾ğ‘¡+ ağ‘˜ n+ d1, ğ‘‡w ğ‘¡ğ‘’h ğ‘Ÿğ‘šich ari es U ras nin gg ecc oo nm flp icle tt oio cn cut ri sm wes ht ğ‘”ee ğ‘—np ta hs ea r ğ‘”n e ğ‘—ee xx ia sm tsp ğ‘”l ğ‘–ğ‘—e, wa in thab ths eol au bt se ot le um tep to er mal -
thediscountrateandtheterminaltimesteprespectively. poralrangeconstraintâŸ¨ğ‘¡ ğ‘™ğ‘œğ‘– ğ‘¤ğ‘’ğ‘Ÿ,ğ‘¡ ğ‘¢ğ‘– ğ‘ğ‘ğ‘’ğ‘Ÿ,ğœâŸ© âˆˆTğ‘ğ‘ğ‘  andthefollowingoccurs:ğœ(ğ‘” ğ‘–ğ‘— ) <ğ‘¡ ğ‘™ğ‘” ğ‘œğ‘–ğ‘—
ğ‘¤ğ‘’ğ‘Ÿ
orğœ(ğ‘” ğ‘–ğ‘— ) >ğ‘¡ ğ‘¢ğ‘” ğ‘– ğ‘ğ‘— ğ‘ğ‘’ğ‘Ÿ.Amotivatingexamplein Algorithm1TaskpartitionforCBS-TA-PTC
therealworldcouldbeinthecontextofarestaurantwithauto- Input: Graphğº,initialstatesğ‘†,taskğ‘‡,numberofgoalsperğ‘‡ ğ‘ ğ‘¢ğ‘ ğ›½
matedfoodserviceusingrobotwaiters,whereabsolutetemporal Output: Pathforeachagentforgivenğ‘‡
rangeconstraintscanbeusedtoenforcethetimeinwhichthe 1: solutionâ†âˆ…
ordereditemsmustbeservedtocustomersfromthetimeoftheir 2: ğ‘‡ â†HeuristicSort(ğº,ğ‘†,ğ‘‡)
orderforgoodcustomerservice. 3: ğ‘‡ â†Partition(ğ‘‡,ğ›½)
4: forğ‘‡ ğ‘ ğ‘¢ğ‘ inğ‘‡ do
3.2 Inter-GoalTemporalConstraints 5: ğ‘‡ ğ‘ ğ‘¢ğ‘ solutionâ†CBS-TA-PTC(ğº,ğ‘†,ğ‘‡ ğ‘ ğ‘¢ğ‘,solution)
Aninter-goaltemporalconstraintisatupleconsistingoftwogoals 6: solution.append(ğ‘‡ ğ‘ ğ‘¢ğ‘ solution)
ğ‘” ğ‘–ğ‘— andğ‘” ğ‘–ğ‘— â€²â€² withatemporalconstraintbetweentheirrespectiveexe- 7 8:
:
e ren td urf nor
solution
cutionorcompletiontimesteps.Forexample,thefollowingrelation:
ğœ(ğ‘” ğ‘–ğ‘— â€²â€² )âˆ’ğœ(ğ‘” ğ‘–ğ‘— ) â‰¤ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ isdenotedbyâŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ(ğ‘” ğ‘–ğ‘— â€²â€² ),ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘ŸâŸ© âˆˆTğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ.
Itallowstheusertodefinethetemporalrangewhereğ‘”ğ‘—â€²
.ğ‘ğ‘ğ‘¡ must Hence,findinganoptimalsolutionwithrespecttomakespanor
ğ‘–â€²
beexecutedorcompletedrelativetotheexecutionorcompletionof sumofpathcostsforTAPF-PTCisalsoNP-Hard[11,14,16].
ğ‘” ğ‘–ğ‘—.ğ‘ğ‘ğ‘¡.Consideringcompletiontimestepsforbothğ‘” ğ‘–ğ‘— andğ‘” ğ‘–ğ‘— â€²â€² asan
4 RELATEDWORK
example,aninter-goaltemporalconflictoccurswithinter-goaltem-
poralconstraintâŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ(ğ‘” ğ‘–ğ‘— â€²â€² ),ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘ŸâŸ© âˆˆTğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ whenthefollowing CBSwithPrecedenceConstraints(CBS-PC)[33],isacompleteand
relationğœ(ğ‘” ğ‘–ğ‘— â€²â€² )âˆ’ğœ(ğ‘” ğ‘–ğ‘— ) >ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ istrue.Returningtotheautomated o stp rt ai im nta sl ba elg twor ei eth nm gof ao lr s.M CA BP SF wb iu tht Tfa ai sls kt Ao sc so ign ns mid ee nr tte (Cm Bp So -r Ta Al )co [8n ]-
foodservicecontext,inter-goaltemporalconstraintscanbeused
andtheConflict-BasedMin-Cost-Flow(CBM)algorithm[15]are
toensurethatordersforcustomersdiningtogethermustallarrive
completeandoptimalforTAPFbutfailtoconsiderprecedenceand
withinaspecifiedtimeframeuponthearrivalofthefirstitemin
temporalconstraintsbetweengoals.Asenumeratingalltaskas-
theorder.Thiswouldensurethatcustomersdiningtogetherwould
signmentsisunfeasiblecombinatorics-wise,CBS-TA[8]generates
nothavetowaitforlongforeachothermealstoarrivetohave
assignmentsondemandusinganyoptimalassignmentalgorithm
theirmealstogetheraspartofgoodcustomerservice.
(e.g.Hungarianmethod[10])tofindtheoptimalsolution.Using
targetswappingfromaninitialarbitrarytargetassignment,TSWAP
3.3 PrecedenceConstraints
iscompleteandhighlyscalablebutsub-optimalforTAPF[20].An-
Aprecedenceconstraintisatupleconsistingoftwogoalsğ‘” ğ‘–ğ‘— and otherframeworkusesamarginal-costassignmentheuristicanda
ğ‘”ğ‘—â€²
wheretheirrespectiveexecutionorcompletiontimestepsare meta-heuristicimprovementstrategybasedonLargeNeighbour-
ğ‘–â€²
constrainedprecedence-wise.Forexample,âŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ‡(ğ‘” ğ‘–ğ‘— â€²â€² )âŸ© âˆˆTğ‘ğ‘Ÿğ‘’ğ‘ h mo ino id mS ie za atr ic oh n[ o2 f5 m]t eo trm ici sn si um ci hze asto tt ha el st ura mve ol fd pe al ta hy c[ o2 s] t. sH oo rw me av ke er s, pth ane
assertsthefollowingrelation:ğœ(ğ‘” ğ‘–ğ‘— ) <ğœ‡(ğ‘” ğ‘–ğ‘— â€²â€² ),i.e.theexecutionof
neednotmaximize(andcanevenreduce)thereturningeneral.
ğ‘” ğ‘–ğ‘— â€²â€² .ğ‘ğ‘ğ‘¡ mustoccurafterthecompletionofğ‘” ğ‘–ğ‘—.ğ‘ğ‘ğ‘¡.Itallowstheuser Hence,theirframeworkscannotbeleveraged.Inaddition,allof
todefinetheorderinwhichactionsatgoalverticesmustbeexe- theabovefailstoconsidertheexecutiontimeofactions.
cutedorcompletedrelativetotheexecutionorcompletionofother
actions,whichexpandsbeyond[33]thataddressesprecedencecon- 5 CBS-TA-PTC
straintsforcompletiontimestepsonly,i.e.âŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ(ğ‘” ğ‘–ğ‘— â€²â€² )âŸ© âˆˆTğ‘ğ‘Ÿğ‘’ğ‘, Inthissection,weintroduceCBS-TA-PTCandprovideanoverview
with zero execution time. This is insufficient given many cases ofitshigh-levelconflictresolutionandlow-levelpathplanning.
whereitisnecessaryforanactiontoexecuteonlyafterthecom- Incaseswhereğ‘€ issignificantlylargerthan ğ‘,wepartitionğ‘‡
pletionofanotheraction(e.g.assemblingtasks).Consideringcom- intosubtasks {ğ‘‡ ğ‘ ğ‘¢ğ‘} usingAlgorithm1,formingeachğ‘‡ ğ‘ ğ‘¢ğ‘ asa
pletiontimestepsforbothğ‘” ğ‘–ğ‘— andğ‘” ğ‘–ğ‘— â€²â€² asanexample,aprecedence TAPF-PTCinstanceandsolvedbyCBS-TA-PTCinAlgorithm2.In
conflictoccurswithprecedenceconstraintâŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ(ğ‘” ğ‘–ğ‘— â€²â€² )âŸ© âˆˆTğ‘ğ‘Ÿğ‘’ğ‘ A orl dg eo rri oth fm the1, ga oau ls se fr o-d re thfi ene tad sh ke ğ‘‡ur ai sst sic hois wu nse ind lt io neso 2rt inth Ae lge ox re ic tu ht mion
1.
whenthefollowingrelationğœ(ğ‘” ğ‘–ğ‘— ) â‰¥ğœ(ğ‘” ğ‘–ğ‘— â€²â€² )istrue.Notethatprece- Theorderedgoalsarethenpartitionedusingahyperparameterğ›½,
denceconstraintsintroducedhereandin[33]canbeseentobea thenumberofgoalspersubtask,toformasubtaskğ‘‡ ğ‘ ğ‘¢ğ‘ asshown
specialcaseofinter-goaltemporalconstraintsdefinedinSection3.2 inline3toensurecomputationallyfeasibletaskassignments.
giventhatğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ canbeanyrealnumber.Returningtotheauto-
matedfoodservicecontext,precedenceconstraintscanbeusedto 5.1 High-LevelofCBS-TA-PTC
ensurethatitemsofaspecificattributearenotservedbeforeothers,
Fromlines1â€“13inAlgorithm2,thegoalsfromthesubtaskare
e.g.dessertsarenotservedbeforethemaincourse.
usedtogenerateallpossiblecombinationsofassignmentstoagents,
whereeachuniquetaskassignmentcorrespondstoarootCTnode
3.4 TheoreticalOverview
insertedtoOPEN.Animportantpropertyforrootnodeswouldbe
TheMAPFproblemisaspecificsubclassoftheTAPF-PTCproblem thereturnasshowninline7,whichisgeneratedbyevaluating
whereğ‘ =ğ‘€,ğ¸isapermutationmatrixandthetimesteprequired
thesolutionfromthelowlevel,withpastsolutionsfromprevious
toexecutetheactionis0,i.e.ğ›¼(ğ‘” ğ‘–ğ‘— )=0,Tğ‘ğ‘ğ‘  =Tğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ =Tğ‘ğ‘Ÿğ‘’ğ‘ =âˆ…. subtasks,onanoraclethatsimulatestheenvironmentbasedonAlgorithm2CBS-TA-PTC() asitislogicaltoensurethatactionsareperformedinthecorrect
Input: Graphğº,initialstatesğ‘†,subtaskğ‘‡ ğ‘ ğ‘¢ğ‘,pastsolutions orderbeforeassertingthattheyarecorrectlyspacedaparttempo-
Output: Pathforeachagentforgivenğ‘‡ ğ‘ ğ‘¢ğ‘ rally.Inaddition,itisalsolikelyresolvingaprecedenceconflict
1: forassignmentinCombinations(ğ‘‡ ğ‘ ğ‘¢ğ‘)do wouldresolveanyrelatedinter-goaltemporalconflict.
2: Râ†newnode Thefollowingdetailstheconflictresolutionforinter-goaltem-
3: R.constraintsâ†âˆ… poralconflictsusingcompletiontimestepsforallactions.Whenan
4: R.assignmentâ†assignment inter-goaltemporalconstraintâŸ¨ğœ(ğ‘” ğ‘–ğ‘— ),ğœ(ğ‘” ğ‘–ğ‘— â€²â€² ),ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘ŸâŸ©isviolated,i.e.
5: R.solutionâ†PathsfromLowLevel() ğœ(ğ‘” ğ‘–ğ‘— â€²â€² )âˆ’ğœ(ğ‘” ğ‘–ğ‘— ) >ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ,CBS-TA-PTCgeneratestwochildCTnodes
6: R.costâ†SumOfPathCost(R.solution) withoneofthefollowinginter-goaltemporalcompletiontimestep
7: R.returnâ†Return(S,R.solution,pastsolutions) constraintsaddedtoeitherchildCTnodes,lettingğœ(ğ‘”ğ‘—â€² ) =ğ‘¡â€² at
8: R.conflictsâ†Conflicts(R.solution) thecurrentCTnode: ğ‘–â€²
109 :: if rR e.r te ut ru nrn Ris .sm ola ux tii om numreturnthen (1) ğœ(ğ‘” ğ‘–ğ‘— ) â‰¥ ğ‘¡â€² âˆ’ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ:Agentğ‘ ğ‘– istocompleteğ‘” ğ‘–ğ‘— atorafter
11: endif timestepğ‘¡â€²âˆ’ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ.Agentğ‘ ğ‘–â€™spathinthecorrespondingchild
12: insertRtoOPEN CTnodeisreplannedandtheinter-goaltemporalconflictis
11 43 :: e wn hd ilf eo Or PENnotemptydo (2) ğœre (s ğ‘”o ğ‘–ğ‘—l )ve <d ğ‘¡. â€²âˆ’ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ:Agentğ‘ ğ‘–istocompleteğ‘” ğ‘–ğ‘— beforetimestep
15: Pâ†nodefromOPENwiththehighestreturn ğ‘¡â€²âˆ’ğ‘¡ ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘Ÿ,whichisalreadysatisfied.Giventheinter-goal
16: ifP.returnismaximumreturnthen temporalconstraint,thisforcesagentğ‘ ğ‘–â€² tocompleteğ‘” ğ‘–ğ‘— â€²â€² at
17: return P.solution leastonetimestepearlierthanbeforewhenreplanningits
18: endif pathinthecorrespondingchildCTnode,i.e.ğœ(ğ‘”ğ‘—â€² ) â‰¤ğ‘¡â€²âˆ’1.
ğ‘–â€²
19: conflictâ†conflictinPw.r.tconflictresolutionorder Hence,ğœ(ğ‘”ğ‘—â€² )inthechildCTnodeisguaranteedtodecrease
20: constraintsâ†ResolveConflict(conflict) ğ‘–â€²
byonetimestep.
21: forconstraintinconstraintsdo
22: Qâ†newnode Agentğ‘ ğ‘–â€² isunlikelytofindapathfollowinginter-goaltemporal
23: Q.constraintsâ†P.constraints.append(constraint) constraint(2)giventhatğ‘¡â€²islikelytobetheearliestpossiblecom-
24: ifQ.constraintsisunsolvablethen pletiontimestepforğ‘” ğ‘–ğ‘— â€²â€² foragentğ‘ ğ‘–â€².Hence,thechildCTgenerated
25: continue byitislikelytobepruned.Forconciseness,absolutetemporalrange
26: endif andprecedenceconflictscanbeexplainedsimilarly.Line14â€“35of
27: Q.assignmentâ†P.assignment Algorithm2highlightsCBS-TA-PTCâ€™sconflictresolutionprocess,
28: Q.solutionâ†P.solution whereline19generatesconflictsbasedonthestatedpriorityor-
29: UpdateQsolutionforagentğ‘ ğ‘– inconstraint derandline20resolvestheconflictbygeneratingthenecessary
30: Q.costâ†SumOfPathCost(Q.solution) constraintstobeinsertedinchildCTnodestobepushedtoOPEN.
31: Q.returnâ†Return(S,Q.solution,pastsolutions) Thesolutionnodetobereturnedisthenodewiththemaximum
32: Q.conflictsâ†Conflicts(Q.solution) returnasevaluatedbytheoracle.Thesolutionfortheentiretaskis
33: insertQtoOPEN thencomposedofthesolutionsofthesubtasksequentially.
34: endfor
35: endwhile 5.2 Low-LevelofCBS-TA-PTC
Multi-LabelA*(MLA*)[5]isusedtogenerateaminimumsumof
theuser-definedrewardfunctionanddynamics.Inpractice,the pathcostssolutionforataskassignmentundertheconstraints
oracleistypicallyimplementedasauser-designedRLenvironment ontheCTnode.Tospeedupthelowlevel,alinearprogramming
basedontheGymnasiumAPI[28],wherethesolutionfromthelow moduleusingoneoftheHiGHSsolvers[6,9]isimplementedto
levelwithpastsolutionsfromprevioussubtaskscanberolledout pruneCTnodesthatareunsolvablegiventheirconstraintsfrom
asasingletrajectoryviatheresetandstepfunctionsfromthe thevarioustypesofconflictsbeforetheMLA*searchasshownin
EnvclassinGymnasium.Thereturncanbesimplycalculatedby lines24â€“26inAlgorithm2.
summinguptherewardsacrosstimestepsandagentsreturnedby
thestepfunction.Notethatasolutionwiththemaximumreturn 5.3 TheoreticalPropertiesofCBS-TA-PTC
impliesaconflict-freesolutionbythedesignoftherewardfunction Byusinguser-definedheuristicstodecomposethetaskintosub-
(rewardispositivelycorrelatedwithconflictresolution). tasks, CBS-TA-PTC is an incomplete and suboptimal algorithm.
CBS-TA-PTCusesthefollowingconflictresolutionpriorityor- However,withtheentiretaskasasinglesubtask,thefollowingwill
dering:1)Absolutetemporalrange,2)Precedence,3)Inter-goal showthatCBS-TA-PTCisacompleteandoptimalalgorithmand
temporal,and4)Vertex/Edge,tomaximizethelikelihoodofgener- presentitsboundedsub-optimalsolver.
atingaCTnodewiththemaximumreturn.Thenaturalfirstorder
ofpriorityistoaddresstheabsolutetemporalrangeconflictsas 5.3.1 OptimalityofCBS-TA-PTC. CBS-TA-PTCenumeratesallpos-
theyarebasedontemporalrangesindependentfromothergoals. sibleassignmentsandaddsthenextbestpossibletaskassignment
Precedenceconflictstakepriorityoverinter-goaltemporalconflicts withrespecttothereturntoOPENwheneverarootCTnodeisexpanded.Unlikethesumofpathcosts,giventhattherewardfunc- Table1:EnvironmentParameters
tionisuser-defined,themaximumreturnthatanoptimalsolution
givesisalwaysknownthroughtheoracle.Naturally,thereturnof Parameters Values
aCTnodeisalowerboundtothemaximumreturn.Itisprovenin MissionLength(min) 15
Lemma2in[24]thatforeachvalidsolutionğ‘,thereexistsatleast SecondsperTimestep [1,3]
oneCTnodeğ‘ inOPENsuchthatğ‘ permitsğ‘,implyingthatthere NumberofBombsperRegion [1,15]
isatleastoneCTnodeinOPENthatpermitstheoptimalsolution BombFuseLength(min) [1,15]
atalltimes.CBS-TA-PTCexpandsCTnodesinabest-firstmanner BombDependencyChainLength [1,4]
withrespecttoreturnandtheMLA*algorithmusedforlowlevel
isoptimal[5].Hence,wecanadaptTheorem1in[24]forCBSto
showthatCBS-TA-PTCreturnsanoptimalsolution. asequence.Eachagenthaswire-cuttertoolswith2outofthe3
colorsthatremovethematchingcolorfromtheorderedsequence
5.3.2 CompletenessofCBS-TA-PTC. Completenessincludesthe
ofabomb.Inaddition,eachbombhasacountdowntimer(e.g.15
followingclaims:1)CBS-TA-PTCwillreturnasolutionifoneexists
seconds)thattriggers/resetsuponacorrectdefusingstep,where
and2)CBS-TA-PTCwillidentifyanunsolvableproblem.Toprove
thenextsequencemustbedefusedbeforethecountdown.Each
the stated claims, we assume that every trajectory is a Markov
bombalsohasafusetimer(e.g.3minutes)thatindicatesthetime
gamethatterminateswithafixedterminaltimestep,whichisa
whenitmustbefullydefused.Furthermore,certainbombshave
reasonableassumptiongiventhatasignificantnumberoftasks
dependencieswithotherbombs,whichdictatesthatthebombitis
intherealworldhavepracticaldeadlines.Asaresult,thesetof
dependentonmustbefullydefusedorhaveexplodedbeforeany
possibleconstraintsthatcanbeaddedtoCTnodesisfinite.Hence,
defusingstepsonitself.Failuretoadheretotheaboveconstraints
there is a finite number of CT nodes with a specific return for
wouldresultinthebombexploding.Afullydefusedbombgives
everyreturn(avariantofTheorem2in[24]).AstheMLA*used
ateamrewardproportionatetothesequencelengthofthebomb
inthelowleveliscomplete[5],Theorem3in[24]canthenbe
(e.g.RGB:3Ã—10=30).Figure1highlightstheenvironmentcom-
easilyadaptedtoshowclaim(1)thatCBS-TA-PTCwillreturnan
prisingthreeregions:Forest,Village,andDesert,derivedfroman
optimalsolutionifoneexists,giventheoptimalityofCBS-TA-PTC
implementationinagamecalledMinecraft[17].Asegmentation
proveninSection5.3.1.NotethatthereturnofeveryCTnodeis
algorithmisimplementedtoobtainagraphrepresentationofthe
notmonotonicallynon-decreasing,unlikethesumofpathcosts,as
mapwithapproximately40nodesperregionofthemapthatare
theresolutionofaconstraintmaygeneratemoreconflictsthatlead
generallyequallyspacedapartandrepresentanequalareaoftra-
toacorrespondingreductioninreturn.
versablegrids.Notethatanodecancontainmultiplebombs.The
Forclaim(2),notethatCBSonitsownisunabletoidentifyan
motivationforagraphrepresentationinsteadofagridworldisto
unsolvableinstanceandrequiresanindependenttestbyYuand
reducethestatespacetoaidlearningforMARLmethods.
Rus[32]todeterminethesolvabilityofagivenMAPFinstance.This
istheconsequenceofalackofaterminaltimehorizon,resultingin
6.2 Setup
aninfinitesetofconstraintsthatcanbeaddedtoCTnodes.Asimple
exampleisprovidedin[24]oftwoagentsattemptingtoswitch 6.2.1 EnvironmentSetup. Table1highlightsthevaluesusedto
locations,wheretheCTgrowsindefinitelythroughtheaddition instantiatetheenvironment.Thesecondspertimestepparameter
of unlimited constraints and the algorithm does not terminate. servestoconvertreal-timeintotimestepstodefinetheunderlying
Fortunately,giventheinitialassumptionofafixedterminaltimestep kinematicsanddynamicsoftheenvironment.Forsimplicity,node
andhenceafinitesetofpossibleconstraintstobeaddedtotheCT, traversalandadefusingsteptakethesamenumberoftimesteps.All
byexhaustivesearchovertheCTandnotfindingasolutionnode agentsstartatthesamerandomlyselectedlocation.Eachbombâ€™slo-
withthemaximumreturn,CBS-TA-PTCwillbeabletoidentifythat cation,sequence,andfuselengtharerandomlyselected.Anumber
theproblemisunsolvable. ofbombsperregionarerandomlyselectedfromtherangespecified
bythebombdependencychainlengthparametertoformabomb
5.3.3 BoundedSub-OptimalCBS-TA-PTC. Aboundedsub-optimal dependencychain.Notethatarandomlygeneratedenvironment
variantofCBS-TA-PTCcanbesimplyimplementedbysearchingfor instancemaybeunsolvable.Tothebestofourknowledge,thereare
aCTnodewiththemaximumreturnmultipliedbyasuboptimality noefficientoptimal,andcompletesolversfortheTAPF-PTCprob-
factorğœ–. lemtofilterunsolvablecases.Theonlyoptionavailablewouldbe
CBS-TA-PTCwiththeentiretaskasasubtaskaselaboratedinSec-
6 EXPERIMENTS tion5.3,whichisprohibitivelyexpensivetoruncombinatorics-wise
Thefollowingsectionsdetailtheenvironment,experimentalsetup, withanincreasingnumberofbombs.Toincreasethelikelihoodthat
andresults.AllcodeisimplementedinPython. arandomlygeneratedenvironmentissolvable,weallowformulti-
pleagentstoworkonbombsonthesamenodeatthesametimestep.
6.1 Environment Hence,collisionsbetweenagentsarenotconsidered,whichisnot
akeyfactorgiventhesmallnumberofagents.
Intheenvironment,threeagentsaretaskedtodefuseallthebombs
onthemapbyaspecifictimelimit.Eachbombhasanordered 6.2.2 AlgorithmSetup. CBS-TA-PTCparametersareasfollows:1)
sequenceofcolors:red(R),green(G),orblue(B),withasequence Numberofbombspersubtaskand2)Taskallocationheuristic.The
lengthrangingfrom[1,3],(e.g.RGB),withnorepeatedcolorsin numberofbombspersubtaskisaproxyparameterforthenumberFigure1:Aninstanceofthebomb-defusingtaskenvironment
ofgoalspersubtaskinAlgorithm1,asthebombsequencecan
bebrokendownintogoalswithdefusingactionsofasinglecolor
sequence.Tokeepthecombinatoricsoftaskallocationfeasible,the
numberofbombspersubtaskusedwillbeintherange[1,3].The
taskallocationheuristicistheheuristicusedforHeuristicSort()at
line2inAlgorithm1.Weusethefuselengthheuristicthatsorts
thebombsinascendingorderoffuselength.Foreachcombination
ofparameters,5trialsareexecutedwithatimeoutof5minutes,
andthesuccessrate,optimalityratio,andruntimearerecorded.
Successisdefinedasfindinganoptimalsolutionbeforethetimeout.
Theoptimalityratioistheratiobetweenreturnandoptimalreturn.
Theruntimeincludesonlyoptimalsolutionsandallsolutions(with
casesduetotimeoutornooptimalsolutionfound).
Figure2:EvaluatedmeanreturnofMAPPOfrom16rollouts
ForcomparisonswithCBS-TA-PTC,weconsiderastate-of-the-
arton-policyMARLalgorithm,Multi-AgentProximalPolicyOp-
timisation(MAPPO)[31],whichhasshowngenerallybetterper- withvertex/edgeconflictsonly.UnderCBS-TA,upontheexplosion
formanceinenvironmentssuchastheStarCraftMulti-AgentChal- ofabombatagiventimestep,CTnodesaregeneratedinanaive
lenge(SMAC)[22],theHanabichallenge[1]andthemulti-agent mannerwithvertexconflictsforeachagentforthattimestep,i.e.
particle-worldenvironment(MPE)[13,18]relativetovariousstate- atleastoneagentisdoingsomethingwrongatthattimestep.This
of-the-artoff-policyMARLmethodssuchasMADDPG[13]and variantofCBS-TAcanbeseenasCBS-TA-PTCwithoutabsolute
QMIX[21].ThekeymotivationforconsideringMAPPOasabase- temporalrange,inter-goaltemporalandprecedenceconflicts,It
lineistoevaluatewhetherthestate-of-the-artMARLmethodsare attemptstosolvetheTAPF-PTCproblembyrelyingsolelyonver-
capableoflearningthenecessarypathplanningandbomb-defusing texconflictstoresolvetheunderlyingprecedenceandtemporal
skillstosolvetasksinthegivenenvironmentfromscratchandtheir conflictsthroughamoreexhaustiveandinefficientbest-firstsearch
sampleefficiencyintermsofwall-clocktrainingtime.Suchcom- throughtheCTwithmoreCTnodesrelativetoCBS-TA-PTC.Nev-
parisonswouldascertainiftheunderlyingmotivationbehindour ertheless,itisworthhighlightingthatthisvariantofCBS-TAis
workisvalid,thatisMARLmethodscanbehighlysampleineffi- optimalandcompletelikeCBS-TA-PTCaselaboratedinSection5.3,
cientintrainingandanalternativesolutionthatincorporatestask undertheassumptionthattheentiretaskisasinglesubtask.
assignment,pathplanningandauser-definedobjectivetosolve
tasksismorepractical.MAPPOistrainedineachregionandthe 6.2.3 HardwareSetup. MAPPOistrainedusingasingleQuadro
wholemap,whereeachregionhas15bombswithoutfusesand RTX6000GPU.CBS-basedalgorithmsareimplementedonalaptop
dependencies,amissionlengthof15minutes,secondspertimestep withthefollowingspecifications:2.30GHzIntelCorei7-11800H
parameterof1,andfullobservabilityovertheenvironmentforall with16GBRAM.
agents.
6.3 Results
ForcomparisonswithMAPFbaselines,weimplementavariant
ofCBS-TA[8]thatmaximizesreturnunderthesamesubtaskassign- 6.3.1 MAPPO. Given15bombsperregion,theexpectedmaximum
mentframeworkasCBS-TA-PTChighlightedinAlgorithm1but returnis300perregion.Figure2highlightstheevaluatedmean(a)Numberofbombsperregion (c)Secondspertimestep
Figure3:EvaluatedresultsforCBS-basedalgorithms
6.3.2 CBS. Figure3highlightstheresultsobtainedfromtheCBS-
basedalgorithmsaveragedacrossalltrials.CBS-TA-PTCissuperior
to CBS-TA across all parameters in general as CBS-TA-PTC al-
wayshasasignificantlyhighersuccessrateandoptimalityratio
comparedtoCBS-TA.Whilethesuccessrateandoptimalityratio
naturallydecreasewithanincreasingnumberofbombsperregion
forbothCBS-TA-PTCandCBS-TA,thetwometricsdecaylinearly
forCBS-TA-PTCinsteadofexponentiallyforCBS-TAasshown
inFigure3a.Inaddition,CBS-TA-PTCâ€™sruntimescaleslinearly
withrespecttothenumberofbombsperregioningeneralwitha
runtimeofapproximatelyaminuteforsuccessfulinstanceswith
thehighestnumberofbombsperregion,i.e.15.Ontheotherhand,
CBS-TAâ€™sruntimequicklyplateaustowardsthetimeoutof5min-
utes,whichisexpectedgivenitsnaiveandinefficientmannerof
expandingtheCT.
FromFigure3b,thesuccessrateandoptimalityratioimprove
linearlyasthenumberofbombspersubtaskincreasesforCBS-TA-
(b)Numberofbombspersubtask PTC,whichisexpectedasalargersubtaskallowsforCBS-TA-PTC
toproducesubtasksolutionsofhigherqualitybyconsideringmore
constraints.Furthermore,withasmallernumberofsubtasks,given
returnforMAPPOfrom16evaluationrollouts.MAPPOisincapable thefactthatthesolutionfortheentiretaskiscomposedoftheso-
ofsolvingthebomb-defusingtaskoptimallydespitebeinggiven lutionsofthesubtasksequentially,itiseasiertofindagoodquality
asignificantlyeasiertaskwithoutbombfusesanddependencies solutionforagivensubtaskgivenagoodinitializationfrompast
aswellasthesmallestsecondspertimestepparameter.Inaddition, subtasksolutions.Ontheotherhand,CBS-TAdoespoorlyinterms
thewall-clocktrainingtimeforMAPPOwasapproximatelytwo ofsuccessrateandoptimalityratioregardlessofthenumberof
weeksforthestatedresults,highlightingthesampleinefficiencyof bombspersubtaskgivenitsnaiveandinefficientmannerofex-
MARLmethods. pandingtheCT.Nevertheless,itcanbeobservedthattheruntime
increasesexponentiallyingeneralwithrespecttothenumberofbombspersubtaskinFigure3b.Thisisexpectedgiventhecombi- thenextbesttaskassignmentthatmaximizesthereturnisgenerally
natorialenumerationoftaskassignmenttoOPENbeforeanyCT unknown.Therefore,arandomtaskassignmentthathasyettobe
expansionasshowninline1â€“13ofAlgorithm2. generatedwouldbeused,unlesstask-specificdomainknowledge
FromFigure3c,thesuccessrateandoptimalityrationaturally canbeutilizedtogenerateabiastowardsspecifictypesoftask
decreasewithanincreasingsecondspertimestepparameterfor assignment.Forexample,asimpleheuristicthatcanbeappliedto
bothCBS-TA-PTCandCBS-TAgiventhegrowingdifficultyofthe bothvariantsofCBSmethodswouldbetofavortaskassignments
taskwithshorterbombfusesandcountdownsintermsoftimesteps. wherethenumberofgoalsassignedtoeachagentisapproximately
Bycalculatingtheaverageinter-nodedistanceandusingthedefault equal.Naturally,amajordrawbackwouldbetheincreaseinrun-
walkingspeedof4.317ğ‘šğ‘ âˆ’1inMinecraft,wefindthat2seconds timebyexpandingtheCTofunfeasibletaskassignmentsinterms
pertimestepisthebestapproximationoftheMinecraftdynamics, ofoptimality.Hence,thebetteralternativewouldbetoparallelize
towhichwehaveasuccessrateofapproximately0.65forCBS-TA- thegenerationoftherootnodestoOPENfromcombinationsof
PTCcomparedto0.15forCBS-TA.Hence,itisclearthattheusage taskassignmentbyleveragingtheusageofmultipleparalleloracles
ofvertexandedgeconflictsaloneinCBS-TAisinsufficienttosolve thataretypicallyimplementedasauser-designedRLenvironment
TAPF-PTCproblemsefficientlyingeneral. basedontheGymnasiumAPI[28]toevaluatethereturnofagiven
taskassignmentasshowninline7ofAlgorithm2,aroutinethat
consumesthemostruntimeforthetaskassignmentenumeration.
7 DISCUSSION
Givenmoderncomputingresources,theparallelizationcanbeim-
AsCBS-TA-PTCisanincompleteandsuboptimalalgorithmbyde- plementedpracticallyandefficientlyandwouldgreatlyameliorate
composingthetaskintosubtasksusinguser-definedheuristics,we theruntimedrawbackoftheCBS-TA-PTCfromthecombinato-
discussguidelinestoselectgoodheuristicstosorttheorderofthe rialenumerationoftaskassignment,makingCBS-TA-PTChighly
goalsfortheentiretaskasshowninline2inAlgorithm1.Ingeneral, viableforreal-worldapplications.
agoodcriterionwouldbetoselectaheuristicbasedonattributes Lastly, it is important to note that CBS-TA-PTC is unable to
thatdetermineabsolutetemporalrangeconstraints,giventhatthey addressstochasticityinenvironments,whicharebestaddressed
arehardconstraintsthatarethenaturalfirstorderofpriority.In withlearningmethodsthatcanpotentiallygeneralizetonoveland
thecaseofthebomb-defusingenvironment,theattributethatdeter- stochasticevents.DespitethefailureofMARLmethodsforthe
minesabsolutetemporalrangeconstraintsisthebombfuselength. bomb-defusingenvironment,futureworkcouldinvolvetheusage
Hence,thetaskallocationheuristicusedsortsthebombsinascend- ofCBS-TA-PTCasanexpertpolicytogeneratetrajectoriestoassist
ingorderoffuselength.Returningtotheautomatedfoodservice MARLmethodsviaimitationlearninginasimilarmannerasshown
contextasareal-worldmotivationmentionedinSection3,theabso- inPRIMAL[23],alongwithmethodsfromcurriculumlearning(e.g.
lutetemporalrangeconstraintisdeterminedbytheorderinwhich scalingdifficultyofthetaskastrainingprogresses).Webelievethat
customersarrive,leadingtoapracticalfirst-come-first-serveheuris- thestatedtrainingpipelinecangreatlyhelptheMARLmethods
tic.Incasesoftaskswithoutabsolutetemporalrangeconstraints,a becomemoresample-efficientinlearningandhencepotentially
sensibleheuristicwouldbetousetheK-Meansclusteringalgorithm moreviableandpracticalforapplicationsinreal-worldscenarios
[7],whereğ‘˜ =numberofgoalspersubtask//numberofagents,to andtasks.
clustergoalsbasedontheirlocationsandarrangethemsuchthat
agentswouldvisitthenearestclusterfromtheirpreviouslocation. 8 CONCLUSION
AshighlightedinSection6.3.2,akeylimitationofCBS-TA-PTC Inthispaper,weproposetheCBS-TA-PTCalgorithmthatsimulta-
isitscombinatorialenumerationoftaskassignmenttoOPENbefore neouslygeneratestaskassignmentsaswellasfeasibleandcollision-
anyCTexpansionasshowninline1â€“13ofAlgorithm2thatcauses freepathsthatadheretoprecedenceandtemporalconstraintsfor
itsruntimetoscaleexponentiallytothenumberofbombspersub- agentstomaximizeauser-definedobjectivetosolvereal-world
task.Theunderlyingmotivationistoensurethatanyrootnode problems.WeevaluateCBS-TA-PTCinahighlychallengingbomb-
insertedtoOPENtobeexpandedhasthehighestreturnpossible defusingenvironmentwithprecedenceandtemporalconstraints
byorderingtheentiretaskassignmentbasedonreturnasshown andshowthatitcanefficientlysolvetasksrelativetoMARLand
inline15inAlgorithm2.Hence,thecorrespondingCTgenerated adaptedTAPFmethods.
fromtherootnodeswouldideallyhaveasfewconflictsaspossible
beforetheoptimalsolutionisfoundtohelpreduceruntime.Further- ACKNOWLEDGMENTS
more,itispossibletochanceuponanoptimalconflict-freesolution
ThisworkwaspartiallysupportedbyDARPAawardHR001120C0036
duringtheenumerationasshowninline9â€“11inAlgorithm2.A
andAFOSRawardFA9550-18-1-0097.WethankInioluwaOguntola
consequenceofthisdesignchoiceforCBS-TA-PTCisthatitpushes
forhiscontributionstothedevelopmentoftheenvironmentfor
thecombinatorialenumerationoftaskassignmentasthekeycon-
thebomb-defusingtask.
tributortotheruntimeratherthantheconflictresolutionprocess
showninline14â€“35ofAlgorithm2. REFERENCES
Toaddresstheaboveissue,anoptionwouldbetodesignavari-
[1] NolanBard,JakobNFoerster,SarathChandar,NeilBurch,MarcLanctot,HFrancis
antofCBS-TA-PTCwherethetaskassignmentisgeneratedon Song,EmilioParisotto,VincentDumoulin,SubhodeepMoitra,EdwardHughes,
demandsimilartothehighlevelofCBS-TA[8].However,unlike etal.2020. Thehanabichallenge:Anewfrontierforairesearch. Artificial
Intelligence280(2020),103216.
CBS-TAwherethenexttaskassignmentcanbegeneratedusing
[2] ZheChen,JavierAlonso-Mora,XiaoshanBai,DanielDHarabor,andPeterJ
anyoptimalassignmentalgorithm(e.g.Hungarianmethod[10]), Stuckey.2021. Integratedtaskassignmentandpathplanningforcapacitatedmulti-agentpickupanddelivery.IEEERoboticsandAutomationLetters6,3(2021), Intelligence321(2023),103946.
5816â€“5823. [21] TabishRashid,MikayelSamvelyan,ChristianSchroederDeWitt,GregoryFar-
[3] CorneliaFerner,GlennWagner,andHowieChoset.2013.ODrM*optimalmulti- quhar,JakobFoerster,andShimonWhiteson.2020.Monotonicvaluefunction
robotpathplanninginlowdimensionalsearchspaces.In2013IEEEInternational factorisationfordeepmulti-agentreinforcementlearning.TheJournalofMachine
ConferenceonRoboticsandAutomation.IEEE,3854â€“3859. LearningResearch21,1(2020),7234â€“7284.
[4] MeirGoldenberg,ArielFelner,RoniStern,GuniSharon,NathanSturtevant, [22] MikayelSamvelyan,TabishRashid,ChristianSchroederdeWitt,GregoryFar-
RobertCHolte,andJonathanSchaeffer.2014. Enhancedpartialexpansiona. quhar,NantasNardelli,TimG.J.Rudner,Chia-ManHung,PhiliphH.S.Torr,
JournalofArtificialIntelligenceResearch50(2014),141â€“187. JakobFoerster,andShimonWhiteson.2019.TheStarCraftMulti-AgentChallenge.
[5] FlorianGrenouilleau,Willem-JanvanHoeve,andJohnNHooker.2019.Amulti- CoRRabs/1902.04043(2019).
labelA*algorithmformulti-agentpathfinding.InProceedingsoftheInternational [23] GuillaumeSartoretti,JustinKerr,YunfeiShi,GlennWagner,TKSatishKumar,
ConferenceonAutomatedPlanningandScheduling,Vol.29.181â€“185. SvenKoenig,andHowieChoset.2019.Primal:Pathfindingviareinforcement
[6] JHall,IGalabova,LGottwald,andMFeldmeier.[n.d.].HiGHSâ€“highperformance andimitationmulti-agentlearning. IEEERoboticsandAutomationLetters4,3
softwareforlinearoptimization. (2019),2378â€“2385.
[7] JohnAHartiganandManchekAWong.1979. AlgorithmAS136:Ak-means [24] GuniSharon,RoniStern,ArielFelner,andNathanRSturtevant.2015.Conflict-
clusteringalgorithm. Journaloftheroyalstatisticalsociety.seriesc(applied basedsearchforoptimalmulti-agentpathfinding.ArtificialIntelligence219(2015),
statistics)28,1(1979),100â€“108. 40â€“66.
[8] WolfgangHÃ¶nig,ScottKiesel,AndrewTinka,JosephDurham,andNoraAyanian. [25] PaulShaw.1998.Usingconstraintprogrammingandlocalsearchmethodstosolve
2018.Conflict-basedsearchwithoptimaltaskassignment.InProceedingsofthe vehicleroutingproblems.InInternationalconferenceonprinciplesandpracticeof
InternationalJointConferenceonAutonomousAgentsandMultiagentSystems. constraintprogramming.Springer,417â€“431.
[9] QiHuangfuandJAJulianHall.2018. Parallelizingthedualrevisedsimplex [26] DavidSilver.2005.Cooperativepathfinding.InProceedingsoftheaaaiconference
method.MathematicalProgrammingComputation10,1(2018),119â€“142. onartificialintelligenceandinteractivedigitalentertainment,Vol.1.117â€“122.
[10] HaroldWKuhn.1955.TheHungarianmethodfortheassignmentproblem.Naval [27] RoniStern,NathanSturtevant,ArielFelner,SvenKoenig,HangMa,Thayne
researchlogisticsquarterly2,1-2(1955),83â€“97. Walker,JiaoyangLi,DorAtzmon,LironCohen,TKKumar,etal.2019. Multi-
[11] StevenMLaValle.2006.Planningalgorithms.Cambridgeuniversitypress. agentpathfinding:Definitions,variants,andbenchmarks.InProceedingsofthe
[12] MichaelLLittman.1994.Markovgamesasaframeworkformulti-agentrein- InternationalSymposiumonCombinatorialSearch,Vol.10.151â€“158.
forcementlearning.InMachinelearningproceedings1994.Elsevier,157â€“163. [28] MarkTowers,JordanK.Terry,ArielKwiatkowski,JohnU.Balis,Gianlucade
[13] RyanLowe,YiWu,AvivTamar,JeanHarb,PieterAbbeel,andIgorMordatch.2017. Cola,TristanDeleu,ManuelGoulÃ£o,AndreasKallinteris,ArjunKG,Markus
Multi-AgentActor-CriticforMixedCooperative-CompetitiveEnvironments. Krimmel,RodrigoPerez-Vicente,AndreaPierrÃ©,SanderSchulhoff,JunJetTai,
NeuralInformationProcessingSystems(NIPS)(2017). AndrewTanJinShen,andOmarG.Younis.2023.Gymnasium. https://doi.org/
[14] HangMa,DanielHarabor,PeterJStuckey,JiaoyangLi,andSvenKoenig.2019. 10.5281/zenodo.8127026
Searchingwithconsistentprioritizationformulti-agentpathfinding.InProceed- [29] GlennWagnerandHowieChoset.2015.Subdimensionalexpansionformultirobot
ingsoftheAAAIConferenceonArtificialIntelligence,Vol.33.7643â€“7650. pathplanning.Artificialintelligence219(2015),1â€“24.
[15] HangMaandSvenKoenig.2016.Optimaltargetassignmentandpathfinding [30] PeterRWurman,RaffaelloDâ€™Andrea,andMickMountz.2008. Coordinating
forteamsofagents.arXivpreprintarXiv:1612.05693(2016). hundredsofcooperative,autonomousvehiclesinwarehouses.AImagazine29,1
[16] HangMa,CraigTovey,GuniSharon,TKKumar,andSvenKoenig.2016.Multi- (2008),9â€“9.
agentpathfindingwithpayloadtransfersandthepackage-exchangerobot- [31] ChaoYu,AkashVelu,EugeneVinitsky,JiaxuanGao,YuWang,AlexandreBayen,
routingproblem.InProceedingsoftheAAAIConferenceonArtificialIntelligence, andYiWu.2022.Thesurprisingeffectivenessofppoincooperativemulti-agent
Vol.30. games.AdvancesinNeuralInformationProcessingSystems35(2022),24611â€“24624.
[17] MojangStudios.2011.Minecraft.https://www.minecraft.net/. [32] JingjinYuandDanielaRus.2015. Pebblemotionongraphswithrotations:
[18] IgorMordatchandPieterAbbeel.2017.EmergenceofGroundedCompositional Efficientfeasibilitytestsandplanningalgorithms.InAlgorithmicFoundationsof
LanguageinMulti-AgentPopulations.arXivpreprintarXiv:1703.04908(2017). RoboticsXI:SelectedContributionsoftheEleventhInternationalWorkshoponthe
[19] RobertMorris,CorinaSPasareanu,KasperSÃ¸eLuckow,WaqarMalik,HangMa, AlgorithmicFoundationsofRobotics.Springer,729â€“746.
TKSatishKumar,andSvenKoenig.2016.Planning,SchedulingandMonitoring [33] HanZhang,JingkaiChen,JiaoyangLi,BWilliams,andSvenKoenig.2022.Multi-
forAirportSurfaceOperations..InAAAIWorkshop:PlanningforHybridSystems. AgentPathFindingforPrecedence-ConstrainedGoalSequences.InProceedingsof
608â€“614. theInternationalJointConferenceonAutonomousAgentsandMultiagentSystems.
[20] KeisukeOkumuraandXavierDÃ©fago.2023.Solvingsimultaneoustargetassign- 1464â€”-1472.
mentandpathplanningefficientlywithtime-independentexecution.Artificial