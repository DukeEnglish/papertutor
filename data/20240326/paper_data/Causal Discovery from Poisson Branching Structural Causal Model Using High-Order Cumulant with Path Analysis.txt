Causal Discovery from Poisson Branching Structural Causal Model Using
High-Order Cumulant with Path Analysis
JieQiao1*,YuXiang1*,ZhengmingChen1 ,RuichuCai1,2â€  ,ZhifengHao3
1SchoolofComputerScience,GuangdongUniversityofTechnology,Guangzhou,China
2PengChengLaboratory,Shenzhen,China
3CollegeofScience,ShantouUniversity,Shantou,China
{qiaojie.chn,thexiang2000,chenzhengming1103,cairuichu}@gmail.com,haozhifeng@stu.edu.cn
Abstract
Countdatanaturallyariseinmanyfields,suchasfinance,neu-
roscience,andepidemiology,anddiscoveringcausalstructure
amongcountdataisacrucialtaskinvariousscientificand
industrialscenarios.Oneofthemostcommoncharacteristics
ofcountdataistheinherentbranchingstructuredescribedby
abinomialthinningoperatorandanindependentPoissondis-
(a) BranchingStructure (b) CausalGraph
tributionthatcapturesbothbranchingandnoise.Forinstance,
in a population count scenario, mortality and immigration
contributetothecount,wheresurvivalfollowsaBernoulli Figure1:Illustrationofbranchingstructurecausalmodeling.
distribution,andimmigrationfollowsaPoissondistribution.
However,causaldiscoveryfromsuchdataischallengingdue
tothenon-identifiabilityissue:asinglecausalpairisMarkov andScheines2000;Zhangetal.2018;Glymour,Zhang,and
equivalent,i.e.,X â†’Y andY â†’X aredistributedequiva- Spirtes2019;Caietal.2018).Inparticular,constraint-based
lent.Fortunately,inthiswork,wefoundthatthecausalorder
methods(Pearl2009;Spirtes,Meek,andRichardson1995),
from X to its child Y is identifiable if X is a root vertex
score-basedmethods(Chickering2002;Tsamardinos,Brown,
andhasatleasttwodirectedpathstoY,ortheancestorof
andAliferis2006)identifythecausalstructurebyexploring
XwiththemostdirectedpathtoXhasadirectedpathtoY
theconditionalindependencerelationamongvariables,but
withoutpassingX.Specifically,weproposeaPoissonBranch-
ingStructureCausalModel(PB-SCM)andperformapath thesemethodsonlyfocusonthecategorydomainandcan
analysisonPB-SCMusinghigh-ordercumulants.Theoretical onlyidentifyuptotheMarkovequivalentclass(Pearl2009).
resultsestablishtheconnectionbetweenthepathandcumu- Thus,propercountdatamodelingisrequiredtofurtheriden-
lantanddemonstratethatthepathinformationcanbeobtained tify the causal structure beyond the equivalence class. Re-
fromthecumulant.Withthepathinformation,causalorderis centworkby(ParkandRaskutti2015)introducesaPoisson
identifiableundersomegraphicalconditions.Apracticalalgo- Bayesiannetworktomodelthecountdataandshowsthatit
rithmforlearningcausalstructureunderPB-SCMisproposed
isidentifiableusingtheoverdispersionpropertiesofPoisson
andtheexperimentsdemonstrateandverifytheeffectiveness
BNs.Subsequently,ithasbeenextendedbyaccommodating
oftheproposedmethod.
abroaderspectrumofdistributions(ParkandRaskutti2017).
Inaddition,themodelingofthezero-inflatedPoissondata
Introduction
(Choi,Chapkin,andNi2020)andtheordinalrelationdata
Causaldiscoveryfromobservationaldataespeciallyforcount (NiandMallick2022)anditsidentifiabilityofcausalstruc-
dataisacrucialtaskthatarisesinnumerousapplicationsin tureareinvestigated.However,themajorityofthesemethods
biology(WiufandStumpf2006),economic(WeiÃŸandKim modelthecountdatausingBayesiannetworkignoringthe
2014),networkoperationmaintenance(Qiaoetal.2023;Cai inherentbranchingstructureamongthecountingrelationship
etal.2022),etc.Inonlineservices,forinstance,thereason whichisfrequentlyencountered(WeiÃŸ2018).
forthenumberofproductpurchasesisofparticularinterest, TakeFigure1asanexample,thecauseofthepurchasing
while finding the underlying causal structure among user event can be inherited from some of the searching events,
behavior from purely observational data is appealing and the pop-up ads event, or exogenously occurs. As a result,
pivotalforonlineoperation. the causal relationship among counts constitutes a branch-
Muchefforthasbeenmadetoaddresstheidentificationof ing structure that can be modeled by a binomial thinning
causalstructurefromobservationaldata(Spirtes,Glymour, operator â€˜â—¦â€™ (Steutel and van Harn 1979) with an additive
independentPoissondistributionforinnovation.Thatis,the
*Theseauthorscontributedequally.
purchasing count (Y) is affected by the pop-up ads count
â€ Correspondingauthor.
(X )andthesearchingcount(X )whichcanbemodeledby
CopyrightÂ©2024,AssociationfortheAdvancementofArtificial 2 1
Intelligence(www.aaai.org).Allrightsreserved. Y =a â—¦X +a â—¦X +Ïµwhereaâ—¦X â‰”âˆ‘X Î¾(a),and
1 1 2 2 n=1 n
4202
raM
52
]LM.tats[
1v32561.3042:viXraÎ¾ n(a) âˆ¼ Bern(a),Ïµ âˆ¼ Pois.Generallyspeaking,thethinning nomialthinningoperationwithÎ¾ n(Î±) i.iâˆ¼.d. Bern(Î±),Bern(Î±)
operatormodelsthebranchingstructurethatnoteveryclick istheBernoullidistributionwithparameterÎ±.
willleadtopurchasingwhiletheadditionalnoisemodelsthe
Wefurtherdefinesomegraphicalconcepts.WeusePiâ†j =
generalcountofexogenousevents.Thatis,acountrepresents
therandomsizeofanimaginarypopulation,andthethinning {Piâ†j
}âˆ£Piâ†jâˆ£
denotesthesetofalldirectedpathsfromvertex
operation randomly deletes some of the members of this k k=1
populationwhileconcurrentlyintroducingnewimmigration.
itoj,whereP kiâ†j = (i,k 1,k 2,...,k p,j),p = âˆ£P kiâ†j âˆ£âˆ’2,
denotethek-thdirectedpathfromvertexitoj.Foreachdi-
Thismodelingapproachfindswidespreadutilityacrossvari-
ousdomains,notablywithinthecontextoftheinteger-value rectedpathPiâ†j ,weuseAiâ†j =(Î± ,Î± ,...,Î± )
k k i,k1 k1,k2 kp,j
autoregressivemodel(WeiÃŸ2018),whichisfirstproposed iâ†j
denotethecorrespondingcoefficientssequenceofpathP .
byAl-OshandAlzaid(1987);McKenzie(1985).Despiteits WeletPiâ†i ={Piâ†i }alsobeavaliddirectedpathforsk
im-
extensiveused,howtoidentifythecausalstructureinsuch
typ Te oo ef xm plo icd ie tl lyfr ao cm cop uu nr te fly oro tb hs eer bv ra at nio chn ia nl gda st ta rui cs tust ri ell ,u wn ec ple ra or -. p Î±l ii ,c ki 1ty â—¦. XB ie dsi ed ne os t, ew toe pu es re foA rmi kâ† aj câ—¦ oX nsi ecâ‰” utiÎ± vk ep t, hj iâ—¦ nnâ‹¯ ingâ—¦ oÎ± pek r1 a,k ti2 oâ—¦
n
pose a Poisson Branching Structural Causal Model (PB- onX ibasedonthepathsequence.
SCM).Weestablishtheidentifiabilitytheoryfortheproposed Goal:Giveni.i.d.samplesD ={x 1(j),...,x âˆ£( Vj) âˆ£}m j=1fromthe
PB-SCMusinghigh-ordercumulantwithpathanalysis.The-
jointdistributionP(X),ourgoalistoidentifytheunknown
oreticalresultssuggestthatforanyadjacentvertexX and
causal structure G from D, assuming the data generative
Y,thecausalorderisidentifiableifX isarootvertexand
mechanismfollowsPB-SCM.
has at least two directed paths to Y, or the ancestor of X
with the most directed path to X has a directed path to Y Preliminary
withoutpassingX.Basedontheresultsofthecausalorder
ToaddresstheidentificationofPB-SCM,cumulantareused
wefurtherproposeanefficientcausalskeletonlearningap-
inourworkforbuildingaconnectiontothepath,providing
proachfeaturedwithFFTacceleration.Wedemonstratethe
a solution to the identifiability issue. Here, we recall the
effectivenessoftheproposedcausaldiscoverymethodusing
definitionofcumulantandsomebasisproperties.
syntheticdataandrealdata.
Definition 2 (k-th order joint cumulant tensor). The k-
PoissonBranchingStructuralCausalModel th order joint cumulant tensor of a random vector X =
Inthissection,wefirstformalizethePoissonbranchingstruc- [X 1,...,X n]T is the k-way tensor T X(k) in RnÃ—â‹¯Ã—n â‰¡
turalcausalmodel,andthenweintroducethepreliminaryof (Rn )k whoseentryin(i ,...,i )isthejointcumulant:
1 k
cumulantandsomenecessarypropertiesinthismodel.
ProblemFormulation
T( Xk)
i1,...,ik
=Îº(X i1,...,X ik)âˆ¶=
Our framework is in the causal graphical models. We use âˆ‘ (âˆ’1)Lâˆ’1 (Lâˆ’1)!E[âˆ X j]â‹¯E[âˆ X j], (2)
Pa(i) = {jâˆ£j â†’i}, An(i) = {jâˆ£j â† i} denote the set (B1,...,BL) jâˆˆB1 jâˆˆBL
ofparents,ancestorsofvertexiinadirectedacyclicgraph
wherethesumistakenoverallpartitions(B ,...,B )of
(DAG),respectively,andAn(i,j)=An(i)âˆ©An(j)denote 1 L
themultiset{i ,...,i }.
thesetofcommonancestorsofvertexiandvertexj.More- 1 k
over,wedefineadirectedpathP =(i ,i ,...,i )inGisa Inthiswork,weusethefollowingspecificcumulantform:
0 1 n
sequenceofverticesofGwherethereisadirectededgefrom Definition3(2Dsliceofjointcumulanttensor). Foraran-
i oj ft eo aci j h+ e1 df go er .a Tn hy e0 sâ©½ etj ofâ©½ vn erâˆ’ tic1 esw ci ath nt bh ee ac ro raef nfi gc ei den intÎ± ci aj u,i sj a+1
l
dom vector X with k-th order joint cumulant tensor T X(k)
wherek â‰¥ 2,denoteits2Dmatrixsliceofk-thorderjoint
order,suchthatnolatervariablecausesanyearliervariable.
cumulanttensorasC(k),where
Now,weshowthecausalrelationshipinacausalgraphcan
b Me of do er lm (a Pl Biz -e Sd Ca Ms )th .e LeP to Xiss =on {B Xra ,n .c .h .i ,n Xg Str }uc dt eu nra ol teC sa au ss ea tl C i( ,k j) âˆ¶=Îº(X i,X j,â‹¯,X j). (3)
1 âˆ£Vâˆ£ (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)
ofrandomPoissoncounts,ofwhichthecausalrelationship kâˆ’1times
consist of a causal DAG G(V,E) with the vertex set V =
Cumulant has the property of multilinearity such that
{1,2,...,âˆ£Vâˆ£}andedgesetE suchthateachcausalrelation Îº(X + Y,Z ,...) = Îº(X,Z ,...) + Îº(Y,Z ,...). Fur-
followsthePB-SCM: 1 1 1
thermore,anycumulantinvolvingtwo(ormore)independent
Definition1(PoissonBranchingStructuralCausalModel). randomvariablesequalszero,i.e.,Îº(Ïµ ,Ïµ ,...)=0ifÏµ and
i j i
ForeachrandomvariableX i âˆˆX,letÏµ i âˆ¼Pois(Âµ i)bethe Ïµ jareindependent.Moreimportantly,anytwovariablesincu-
noisecomponentofX i,thenX iisgeneratedby: mulantareexchangeable,e.g.,Îº(X,Y,...)=Îº(Y,X,...).
X = âˆ‘ Î± â—¦X +Ïµ , (1)
i j,i j i Identifiability
jâˆˆPa(i)
In this section, we deal with the identification problem of
whereÎ±
j,i
âˆˆ(0,1]isthecoefficientfromvertexjtoi,Pa(i)
causal structure under PB-SCM. Due to our identifiability
istheparentsetofX inG,andÎ±â—¦X âˆ¶=âˆ‘Xi Î¾(Î±)isaBi- resultbenefitfromtheâ€˜reducibilityâ€™ofcumulantinPoisson
i i n=1 nFig.3(a)andFig.4(a).Interestingly,wehaveC(2) =C(3)in
2,1 2,1
thereversedirection(Fig.4(a))butC(2) â‰ C(3)inthecausal
1,2 1,2
direction (Fig. 3(a)), i.e., there exists an asymmetry in the
inequalityrelationsofcumulants.Suchasymmetryintriguing
possibilitytoidentifythecausalorderbetweentwovariables
usingthecumulant.
Figure2:Triangularstructure.Forsimplicity,wedenotedi-
Tounderstandhowthisasymmetryoccursandhenceuse
rectedpathP âˆ¶X âˆ’â†’a X andP âˆ¶X âˆ’b â†’1 X âˆ’b â†’2 X with ittoidentifythecausalrelations.Wefirstdiscusstheiden-
1 1 2 2 1 3 2
sequenceofpathcoefficientsA =(a)andA =(b ,b ). tificationinthesimplescenariothatthecausevariableisa
1 2 1 2
rootvertexinG,andthenwegeneralizesuchresultsintothe
scenariothatthecausevariableisnotroot.
distribution,wefirstcharacterizesuchpropertyinTheorem
1.Afterwhich,anexampleisprovidedtorevealtheintrinsic IdentificationWhenCauseVariableIsRoot
relationbetweenthecumulantandthepathinacausalgraph Westartwiththecasethatthecausevariableisrootvertex,
underPB-SCM.Basedonsuchconnection,wecompletethe inwhichourgoalistoidentifycausaldirectioneventhough
identifiabilityresultsthataredividedintothecasewhenthe we do not know it is a root vertex. Recall the previous ex-
cause variable is root (Theorem 3) and the case when the ample,thekeyofidentificationistheinequalityC(2) â‰ C(3)
causevariableisnotroot(Theorem6). 1,2 1,2
renderinganasymmetryforacausalpair.Tounderstandhow
Wefirstintroduceafundamentalpropertyofcumulantin
itoccurs,weseektocharacterandleveragesuchinequality
PB-SCMthatthecumulantisreducible:
constraintsofcumulantsinacausalgraphtoinferthecausal
Theorem1(Reducibility). GivenaPoissonrandomvariable order(Theorem4).
ÏµandndistinctsequencesofcoefficientsA 1,...,A n,wehave Here,webeginwithtwobasicobservations,whichillus-
Îº(A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ) tratethatinequalityconstraintsofcumulantsaredrivenby
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) the number of paths between two variables. As shown in
k1times kntimes (4) Fig.3(a),onemayseethat(i)thedecompositionofC
1,2
is
=Îº(A 1â—¦Ïµ,...,A nâ—¦Ïµ) composedbyaseriesofcumulantsofthecommonnoise(Ïµ
1
in this example) between X and X , which is due to the
whereeachA â—¦Ïµrepeatsk â‰¥1timesintheoriginalcumu- 1 2
i i factthatanycumulantinvolvingtwo(ormore)independent
lantandonlyappearsonceinthereducedcumulant.
randomvariablesequalszero;(ii)moreover,suchdecomposi-
SucharesultisageneralizationofthepropertyofthePois- tionrelatestothenumberofpathsbetweenX andX since
1 2
sondistributionsincethecumulantofthePoissondistribution X = A â—¦Ïµ +A â—¦Ïµ +b â—¦Ïµ +Ïµ andbymultilinear-
2 1 1 2 1 2 3 2
isidenticalineveryorder. ity,thecumulantwillbesplitexponentiallyastheorderof
cumulantincrease.Withtheseobservations,thereasonwhy
MotivatingExample C(2) â‰  C(3) is that there exists more than one path in the
1,2 1,2
Beforedescribingourtheoreticalresults,weuseamotivating causaldirectionwhilezeropathinthereversedirection,i.e.,
example to show the challenges of the non-identifiability âˆ£P1â†2 âˆ£ = 2,âˆ£P2â†1 âˆ£ = 0. As a result, C(2) = C(k) for all
issues and then introduce the basic intuition regarding in 2,1 2,1
k â‰¥2ordercumulantinthereversedirection.
whatcaseandhowcanweidentifythePB-SCM.
Inthefollowing,wearticulatetheunderlyinglawofthe
To see the non-identifiability issue, we can show that a
cumulant in PB-SCM and propose a closed-form solution
reversedmodelalwaysexistsinatwo-variablesystem.
to it. The first important observation is that due to the re-
Remark1. Foranytwovariablescausalgraph,thecausal
ducibility and the exchangeability of cumulant, the
C(k)
direction of PB-SCM is not identifiable and a distributed 1,2
for k â‰¥ 3 is only composed by three distinct cumulants:
equivalentreversedmodelexists.
Îº(Ïµ ,A â—¦Ïµ ),Îº(Ïµ ,A â—¦Ïµ ),andÎº(Ïµ ,A â—¦Ïµ ,A â—¦Ïµ )
1 1 1 1 2 1 1 1 1 2 1
Forinstance,considerX 1 â†’X 3inFig.2,thedistributed withvaryingnumberofthesecumulants.Inparticular,ifwe
equivalentreversemodelsatisfiesX =Ë†b â—¦X +ÏµË† ,where definethesummationofcumulantsthatonlycontainsone
1 1 3 1
Ë†b 1 =b 1Âµ 1/(b 1Âµ 1+Âµ 3)andÏµË† 1 âˆ¼Pois(Âµ 1âˆ’b 1Âµ 1)suchthat pathasÎ›1 1â†2 (Ïµ 1 â†X 2)â‰”Îº(Ïµ 1,A 1â—¦Ïµ 1)+Îº(Ïµ 1,A 2â—¦Ïµ 1)
thisdirectionisnotidentifiable. andthesummationofcumulantsthatcontainstwopathsas
Fortunately,wefindthatthecausaldirectionisstillpossi- Î›1â†2 (Ïµ â†X )â‰”Îº(Ïµ ,A â—¦Ïµ ,A â—¦Ïµ ),wewillhavethe
2 1 2 1 1 1 2 1
bletoidentifyinamoregeneralstructure.Consideringthe followingclosed-formsolution:
causalrelationshipbetweenX andX inFig.2,herewepro-
1 2
videanintuitiveexampletoshowhowtoidentifysuchcausal 3
directionbyutilizingtherelationshipbetweencumulantand C 1(4 ,2) =Î›1 1â†2 (Ïµ 1â†X 2)+ âˆ‘ (m m )Î›1 2â†2 (Ïµ 1â†X 2) (5)
1 2
path. Considering the cumulant C
1,2
with different orders, mm1 1+ ,mm 22 >= 03
wecanobservedifferentbehaviorsofcumulantinthecausal
directionandthereversedirection.Thankstothereducibility where( 3 )isthemultinomialcoefficient,indicatingthe
inTheorem1,e.g.,Îº(A â—¦Ïµ ,Ïµ )=Îº(A â—¦Ïµ ,Ïµ ,Ïµ ),the numberm o1 fm w2 aysofplacing3distinctobjectsinto2distinct
1 1 1 1 1 1 1
cumulantswithdifferentordersforX andX isshownin binswithm objectsinthefirstbin,m objectsinthesecond
1 2 1 2(2)
(2) ğ¶ğ¶3,2 =ğœ…ğœ…(ğ‘‹ğ‘‹3,ğ‘‹ğ‘‹2)=ğœ…ğœ… Ïµ3,ğ‘ğ‘2âˆ˜ğœ–ğœ–3 +ğœ…ğœ… ğ‘ğ‘1âˆ˜Ïµ1,A1âˆ˜ğœ–ğœ–1 +ğœ…ğœ… ğ‘ğ‘1âˆ˜Ïµ1,A2âˆ˜ğœ–ğœ–1
ğ¶ğ¶1,2 =ğœ…ğœ… ğ‘‹ğ‘‹1,ğ‘‹ğ‘‹2 = ğœ…ğœ… Ïµ1,A1âˆ˜ğœ–ğœ–1 +ğœ…ğœ… Ïµ1,A2âˆ˜ğœ–ğœ–1 â‰”(ğ‘ğ‘1,ğ´ğ´1) â‰”(ğ‘ğ‘1,ğ´ğ´2)
â‰”(1,ğ´ğ´1) â‰”(1,ğ´ğ´2) split ğœ…ğœ…ov Ïµe 3r
,ğ‘ğ‘2 âˆ˜ğœ–ğœ–3,ğ‘‹ğ‘‹2 +ğœ…ğœ…
ğ‘ğ‘1âˆ˜Ïµ1,A1âˆ˜ğœ–ğœ–1,s ğ‘‹ğ‘‹pl 2it o +v e ğœ…ğœ…r
ğ‘ğ‘1 âˆ˜Ïµ1,A2âˆ˜ğœ–ğœ–1,ğ‘‹ğ‘‹2
split over (3)
(3) ğœ…ğœ… Ïµ1,A1âˆ˜ğœ–ğœ–1,ğ‘‹ğ‘‹2 +ğœ…ğœ… Ïµ1,A2âˆ˜ğœ–ğœ–1,ğ‘‹ğ‘‹2 ğ¶ğ¶3,2 = X2 X2
ğ¶ğ¶1,2 = X2 ğœ…ğœ… Ïµ3,ğ‘ğ‘2âˆ˜ğœ–ğœ–3,ğ‘ğ‘2âˆ˜ğœ–ğœ–3 + ğ‘ğ‘1,A1,A1 + ğ‘ğ‘1,A1,A2 + ğ‘ğ‘1,A2,A1 + ğ‘ğ‘1,A2,A2
1,A1,A1 + 1,A1,A2 + 1,A2,A1 + 1,A2,A2 2Ã—Î›1 2â†2 (ğ‘ğ‘âˆ˜ğœ–ğœ–1â†ğ‘‹ğ‘‹2)
ğ¶ğ¶1( ,4 2) = 1,A1,A1,A1 +
1,A12 ,AÃ— 1,Î› A1 22â†
+
2
â‹¯
(1 +âˆ˜ 1ğœ–ğœ– ,1 A2â† ,A2ğ‘‹ğ‘‹ ,2 A)
1 + 1,A2,A2,A2
ğ¶ğ¶3( ,4 2) =ğœ…ğœ… Ïµ3,ğ‘ğ‘F2ro âˆ˜ğœ–ğœ–m3 , ğ‘‹ğ‘‹ğ‘ğ‘ 32âˆ˜to ğœ–ğœ– 3 ğ‘‹ğ‘‹, 2ğ‘ğ‘2âˆ˜ğœ–ğœ–3 + ğ‘ğ‘1,A1 F,A ro1, mA1
th
6+
e
Ã—coğ‘ğ‘ Î›1
m1
2, â†A m21 ,
o
(A ğ‘ğ‘n1
âˆ˜
, aA ğœ–ğœ–n12
c
â†e+
st
ğ‘‹ğ‘‹oâ‹¯
2r
)+ ğ‘ğ‘ to1, A2,A2,A2
(a) Cumulantdecomp 6os Ã—it Î›io1 2â†n2o (f 1t âˆ˜he ğœ–ğœ–1c â†au ğ‘‹ğ‘‹sa2)lpairX 1â†X 2(b) Cumulantdecompositiono fthecausalpairX
3
â†X
2
ğ‘‹ğ‘‹w 1he ğ‘‹ğ‘‹re 2X 3is
whereX isroot. notroot.
1
Figure 3: Illustration of decomposing the cumulant of causal direction, C and C , in triangular structure (Fig. 2). For
1,2 3,2
simplicity,wedenoteÎº(Ïµ ,A â—¦Ïµ ,...,A â—¦Ïµ )by(1,A ,...,A )anddenoteÎº(b â—¦Ïµ ,A â—¦Ïµ ,...,A â—¦Ïµ )by(b ,A ,...,A ).
i i i j i i j 1 i i i j i 1 i j
where( nâˆ’1 )= (nâˆ’1)! isthemultinomialcoeffi-
(2) (2)
m1m2â‹¯mk m1!m2!â‹¯mk!
ğ¶ğ¶2,1=ğœ…ğœ…ğ´ğ´1âˆ˜ ğœ–ğœ–1,ğœ–ğœ–1+ ğœ…ğœ…(ğ´ğ´2âˆ˜ ğœ–ğœ–1,ğœ–ğœ–1) ğ¶ğ¶2,3= ğœ…ğœ…ğ‘ğ‘2 âˆ˜ğœ–ğœ–3,ğœ–ğœ–3 + ğœ…ğœ…ğ´ğ´1 âˆ˜ğœ–ğœ–1,ğ‘ğ‘1 ğœ–ğœ–1+ ğœ…ğœ…(ğ´ğ´2 âˆ˜ğœ–ğœ–1,ğ‘ğ‘1 ğœ–ğœ–1) cients.
â‰”(ğ´ğ´1,1) â‰”(ğ´ğ´2,1) â‰”(ğ´ğ´1,ğ‘ğ‘1) â‰”(ğ´ğ´2,ğ‘ğ‘1)
ğ¶ğ¶2 (( 4,3 1 )) = ğ´ğ´1,1,1 +(ğ´ğ´2,1,1) ğ¶ğ¶ ğ¶ğ¶2 2( (,3 ,43 3)
)
== ğœ…ğœ…ğœ…ğœ…
F
ğ‘ğ‘rğ‘ğ‘ 2o2
âˆ˜m
âˆ˜ ğœ–ğœ–ğœ–ğœ– 3,3 ğœ–ğœ–, 3ğœ–ğœ– ,3
ğœ–ğœ–t
3o,ğœ–ğœ–
,
ğœ–ğœ–3 3+
+
ğ´ğ´ ğ´ğ´1 1, ,ğ‘ğ‘ ğ‘ğ‘11
F
,, ğ‘ğ‘rğ‘ğ‘ 1o1
,m
ğ‘ğ‘1+ +( ğ´ğ´ (2 ğ´ğ´t,
o
2ğ‘ğ‘
,
1 ğ‘ğ‘, 1ğ‘ğ‘ ,ğ‘ğ‘1 1)
,ğ‘ğ‘1)
o thf
eT
th
jh oee io
c
nar te
u
cm
s ua
ml2
o
up
r ld
ala
e
ny
r
ts
a
asa nn diti pim
n
atp
tr
hoo dr it nua fcn oet
rs
mro
th
ale
e
tiocin
no
.nth
n
Me
e
oci
t
rd
i
eoe onn vt ebifi
re
,c
tw
sa it neio
e
cnn
e
(
sğ¶ğ¶
a
it2
)
i,1 oC=
nğ¶ğ¶2u
(ğ´ğ´
,2 1
om)1
=
f, ğ¶ğ¶u1 X2,
(l
,31 1a), =1
n â†ğ¶ğ¶t
2(+
,4d X1)
=( eğ´ğ´
c
ğœ…ğœ…2 .o, ğ‘‹ğ‘‹1 m2, ,1 ğ‘‹ğ‘‹p, 11 o)
-( Xb) .C umu ğ¶ğ¶l2 (
ağ‘‹ğ‘‹
,2
3n)3
t =d
ğ¶ğ¶ğ‘‹ğ‘‹ e2(3
c,3 3o) m =p ğ¶ğ¶2o( ,4 3s) it =io
ğœ…ğœ…nğ‘‹ğ‘‹1
ğ‘‹ğ‘‹o2f
,ğ‘‹ğ‘‹ğ‘‹ğ‘‹ X33
2 â† e Ev qe .r (y 3o ),rd ae nr do tf ht uh se e2 vD ers yli oc re dj eo rin ot fc Î›um ku cala nn at lc sa on bb ee oo bb tt aa ii nn ee dd bb yy
2 1 3
solvingtheequationinEq.(C.1).ByusingÎ› weareableto
k
understandtheidentifiabilityinthefollowingtheorem:
Figure4:Illustrationofdecomposingthecumulantofreverse
direction,C andC ,intriangularstructure(Fig.2).
2,1 2,3 Theorem3(Identifiabilityforrootvertex). Foranyvertexi
andj,whereiistherootvertexingraphG,ifC(3)âˆ’C(2) â‰ 0,
i,j i,j
bin.Asaresult,wewilleventuallyhave6Ã—Î›1 2â†2 (Ïµ 1 â†X 2) thenC(3)âˆ’C(2) =0andX istheancestorofX .
asshowninFig.3(a).Generally,wedefineÎ›iâ†j (Aâ—¦Ïµ â† j,i j,i i j
k i
X j)asthesummationofcumulantsthatcontainkpathsfrom Intuitively,basedonTheorem2,wehaveC(3) âˆ’C(2) =
rootvertexitoj: i,j i,j
Definition4(k-pathcumulantssummationforrootvertex).
Î›i 2â†j (1â—¦Ïµ iâ†X j),andthusC i( ,3 j) âˆ’C i( ,2 j) â‰  0indicatesthat
Giventwoverticesiandj,fork
â©½âˆ£Piâ†j
âˆ£,thek-pathcumu-
thereexistsmorethanonepathfromitoj thanthereverse
direction.Thatis,thecausaldirectionforrootvertexisiden-
lantssummationfromvertexitoj isgivenby:
tifiableifthereareatleasttwodirectedpaths:
Î›iâ†j (Aâ—¦Ïµ â†X )
k i j Theorem4(GraphicalImplicationofIdentifiabilityforRoot
= âˆ‘ Îº(Aâ—¦Ïµ i,Ai l1â†j â—¦Ïµ i,...,A li kâ†j â—¦Ïµ i), (6) Vertex). Forapairofverticesiandj ingraphG,ifvertexi
1â‰¤l1<l2<...<lkâ‰¤âˆ£Piâ†jâˆ£ isarootvertexandexistsatleasttwodirectedpathsfromi
where l ,...,l âˆˆ
Z+
, A is an arbitrary sequence of co-
toj,i.e.,âˆ£Piâ†j âˆ£â‰¥2,thenthecausalorderbetweeniandj
1 k
efficients. For k > âˆ£Piâ†j âˆ£, Î›iâ†j â‰¡ 0 and for k = 1, isidentifiable.
k
Î›iâ†i (Aâ—¦Ïµ â†X )=Îº(Aâ—¦Ïµ ,Ïµ ),andk >1,Î›iâ†i â‰¡0.
1 i i i i k
IdentificationWhenCauseVariableIsNotRoot
Intuitively,Eq.(6)isasummationofallcumulantsthat
contain k paths information from vertex i to j , and
Î›iâ†i
1 Inthissection,weaimtogeneralizetheidentificationresult
denotes the relation from the noise to itself. Based on the
fromtherootvertextothenon-rootvertex.
k-path cumulants summation,
C(n)
can be decomposed as
i,j Whenvertexiisnotroot,themaindifferenceisthatthere
follows:
mightexistmorethanonecommonnoisebetweentwovari-
Theorem 2. For any two vertices i and j where i is root
ablesduetothepossiblecommonancestor.Therefore,one
vertex,i.e.,vertexihasanemptyparentset,the2Dsliceof
may extend the result from the root vertex by considering
jointcumulantC(n)satisfies:
eachnoisetermastheseparatedrootvertex.Wepresenta
i,j
generalversionofk-pathcumulantssummationasfollows,
C i( ,n j) =âˆ‘n k=âˆ’ 11 âˆ‘ (
m
1n mâˆ’ 2â‹¯1
m
k)Î›i kâ†j (1â—¦Ïµ iâ†X j). w cuh mic uh lac na tsn sb ue me mx ap tr ie os ns se fd oras tht eh re ooa tg vg ere rtg ia ct ei so .n of the k-path
m1+â‹¯ m+ lm >k 0=nâˆ’1
(7) Definition 5 (k-path cumulants summation). The k-pathcumulantssummationfromvertexitovertexj isgivenby:
Î›Ëœ (X â†X )=Î›iâ†j (1â—¦Ïµ â†X )
k i j k i j
âˆ£Pmâ†iâˆ£ (a) Notidentifiable. (b) Identifiable.
+ âˆ‘ âˆ‘ Î›mâ†j (Amâ†iâ—¦Ïµ â†X ).
k h m j
mâˆˆAn(i,j)âˆª{j} h=1 Figure5:IllustrationoftheidentifiabilityofX â†’Y.
(8)
whereÎ› isthek-pathcumulantssummationforrootvertex,
k
âˆ£Pmâ†i âˆ£isthenumberofdirectedpathsfrommtoi. Inaddition,thek-pathcumulantssummationÎ›Ëœ k(X
i
â†
X )willbeâ€˜dominatedâ€™bythevariables(mightbethecom-
Withthegeneralk-pathcumulantssummation,thegeneral j
monancestororiitself)thathasthemostpathstoj sinceit
jointcumulantcanbedecomposedasfollows:
istheaggregationofallthedirectedpathsfrombothcom-
Theorem 5. For any two vertices i and j, the 2D slice of mon ancestor and i. Therefore, for a non-root vertex, it is
jointcumulantC(n)satisfies: possibletobenon-identifiablebyTheorem3ifthedominant
i,j
variableisthecommonancestor.Specifically,weprovidethe
C i( ,n j)=âˆ‘ kn =âˆ’ 1 m1 1+â‹¯âˆ‘ +mk=nâˆ’1(m 1n mâˆ’ 2â‹¯1 m k)Î›Ëœ k(X iâ†X j), (9) Tgr ha ep oh ric ea mlim 7p (Glic raat pi ho in cao lf Is muc ph lii cd ae tn ioti nfia ob fil Ii dty eng ti iv fie an bia ls itf yo )l .lo Fw os r:
ml>0 a pair of causal relationship i â†’ j. The causal order of
where( nâˆ’1 )= (nâˆ’1)! isthemultinomialcoeffi- i,j isidentifiablebyTheorem6,if(i)vertexiisarootver-
cients. m1m2â‹¯mk m1!m2!â‹¯mk! tex and âˆ£Piâ†j âˆ£ â‰¥ 2; or (ii) there exists a common ances-
tork âˆˆargmax{âˆ£Plâ†i âˆ£âˆ£lâˆˆAn(i,j)}hasadirectedpath
Toseetheconnectionwiththecaseofrootvertex,wetake
l
X 3 â†’X 2inFig.2asexample.SinceX 3canbeexpressedas fromktoj withoutpassingiinG.
X =b â—¦Ïµ +Ïµ ,asshowninFig.3(b),wecanseparatethe
3 1 1 3 OneoftheexamplesisgiveninFig.5,inwhichFig.5(a)is
cumulantintotwopartsÎº(Ïµ ,X ),Îº(b â—¦Ïµ ,X ),whichcan
3 2 1 1 2 notidentifiablebutFig.5(b)isidentifiable.Thereasonisthat
beconsideredasthecumulantstartingfromvertexX toX
3 2 ZisthedominantcommonancestorofX,Y,andalldirected
andX toX ,respectively.Asaresult,thegeneralk-path
1 2 pathsfromZtoY willpassXmakingitunidentifiablebased
cumulantssummationcanbeexpressedastheaggregateof
onTheorem7.Incontrast,Fig.5(b)includesanadditional
alldifferentÎ› startingwiththecorrespondingnoiseterms.
k directed path Z â†’ C â†’ Y without passing X making
Forinstance,forX â†’X inFig.2,wehave:
3 2 X â†’Y identifiable.Thisintriguinglyimpliesthatadenser
Î›Ëœ (X â†X ) structurewouldfacilitatetheeffectivenessofourmethod.
2 3 2
Generallyspeaking,oncethecausalorderisidentified,one
=Î›3 2â†2 (1â—¦Ïµ 3 â†X 2)+Î›1 2â†2 (b 1â—¦Ïµ 1 â†X 2)â‰ 0, (10) mayidentifythecompletecausalstructurebyorientingedges
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)
=0 =Îº(b1â—¦Ïµ1,A1â—¦Ïµ1,A2â—¦Ïµ1) basedonthecausalorderinthecausalskeleton.Suchimple-
mentationwillbeprovidedinthenextsection.Bythis,the
whereEq.(10)containstwodifferenttermsstartingfromÏµ
3 identifiabilityofcausalstructureunderPB-SCMisanswered.
andÏµ ,respectively.Inparticular,sincethereonlyexistsone
1
directedpathfromX 3 toX 2,Î›3 2â†2 iszerowhileX 1 toX 2 LearningCasualStructureForPB-SCM
hastwopathsandthusÎ›1â†2
isnotzero.Similarly,forthe
2 Inthissection,weproposeacausalstructurelearningalgo-
reversedirection,wehave
rithmforPB-SCM.Ourmethodinvolvestwosteps:learning
Î›Ëœ (X â†X )=Î›2â†3 (1â—¦Ïµ â†X )+Î›3â†3 (b â—¦Ïµ â†X ) the skeleton of DAG G and inferring the causal direction
2 2 3 (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)3 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)3 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)3 (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) usingtheresultsdevelopedinTheorem6.
=0 =0
+Î›1â†3 (A â—¦Ïµ â†X )+Î›1â†3 (A â—¦Ïµ â†X )=0, LearningCausalSkeleton Tolearnthecausalskeleton,
2 1 1 3 2 2 1 3 insteadofusingtheconstraint-basedmethod,weproposea
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)
=0 =0 likelihood-basedmethod.Thisboostssampleefficiencyas
(11)
thelikelihoodofPB-SCMcapturesitsbranchingstructure
whereÎ›Ëœ iszerosincethereare0directedpathfromX to
2 2 buttheconstraint-basedmethoddoesnot.
X andonly1directedpathfromX orÏµ toX .Intuitively,
3 1 3 3 Given a set of count data D and model parameters
t tuh re eg se thn eer na ul mk- bp ea rt oh fc du im reu ctl ea dnt ps as tu hm sfm roa mtio thn eÎ›Ëœ c( oX mi mâ† onX anj c) ec sa top r- Î˜ = {A=[Î± i,j]âˆˆ[0,1]âˆ£Vâˆ£Ã—âˆ£Vâˆ£,Âµ=[Âµ i]âˆˆRâˆ£ â‰¥V 0âˆ£ }, the
toj.Moreover,foranytwoadjacencyvertexiâ†’j andtheir log-likelihoodisMarkovrespecttoG,thatisL(G,Î˜;D)=
c jo im sgm ro ean tea rnc oe rs eto qr um al, toth te hn atu fm rob mer mofd toir ie ,c ate nd dp that uh ss ,f thro em cam ust ao
l
âˆ‘ jâˆ£D =1âˆ£âˆ‘âˆ£ iV =1âˆ£logP Î˜(X
i
=x( ij) âˆ£X
Pa(i)
=x( Pj a) (i)). However,
calculatingthelikelihooddirectlyusingtheprobabilitymass
ordercanbeidentifiedusingthefollowingstrategy:
function is costly. Therefore, we propose to calculate the
Theorem6(IdentificationofPB-SCM). Ifthereexistk
âˆˆZ+
probabilitymassfunctionbyusingtheprobability-generating
suchthatÎ›Ëœ (X â†X )â‰ 0andÎ›Ëœ (X â†X )=0forany function(PGF).Indetail,foreachconditionaldistributionof
k i j k j i
twoadjacencyvertexiandj,thenX istheparentofX . X ,thelikelihoodcanbecalculatedasfollows:
i j iTheorem8. LetG Xiâˆ£XPa(i)(s)bethePGFofrandomvari- Algorithm1:CausalDiscoveryforPB-SCM
ableX givenitsparentsvariableX ,wehave:
i Pa(i) Input:DatasetD,MaxorderK
P(X i=kâˆ£X Pa(i)=x Pa(i))= k1 !âˆ‚kG X (i âˆ‚âˆ£X s)P ka(i)(s)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)s=0
1
GOu â€² â†tpu et m:L pe tyar gn rin ag phC ,a Lus âˆ— pal â†G âˆ’ra âˆph ;G
// Learning Causal Skeleton
= âˆ‘ Âµt iiexp(âˆ’Âµ i) âˆ (x j)tjÎ± jtj ,i(1âˆ’Î± j,i)xjâˆ’tj , 2 whileLâˆ— p(Gâˆ— ,Î˜âˆ— ;D)<Lâ€² p(Gâ€² ,Î˜â€² ;D)do
ti+ âˆ‘ tj=k t i! jâˆˆPa(i) t j! 3 Gâˆ— â†Gâ€² withlargestLâ€² p(Gâ€² ,Î˜â€² ;D)
jâˆˆPa(i) (12) 4 foreveryGâ€² âˆˆV(Gâˆ— )do
â€² â€² â€² â€²
wheret â‰¤ x ,(x ) â‰”
x j!
isthefallingfactorial,
5 EstimateÎ˜ andrecordscoreL p(G,Î˜;D)
j j j tj (x
j
âˆ’t j)!
6
Gâ†TransferGâˆ—
toaskeleton
Âµ =E[Ïµ ],andÏµ isthenoisecomponentofX .
i i i i // Learning Causal Direction
TheresultofEq.(G.1)canbeconvertedtoapolynomial 7 foreachpairX iâˆ’X j âˆˆGdo
coefficientaftertakingpolynomialmultiplication,whichcan 8 fork â†1âˆ¶K do
be accelerated via Fast Fourier Transform (FFT) (Cormen 9 ObtainÎ›Ëœ k ateachsidebysolvingEq.(E.1)
eta Gl. e2 n0 e2 ra2 l) l. yA ,thd eet la ii kle ed lihd ois oc du -s bs aio sen dis mg eiv the on din wt ih le lts eu np dpl te om pe rn ot -. 10 TestwhetherÎ›Ëœ k equalto0foreachside
duceexcessiveredundantcausaledges.Sucheffectcanbe 11 ifÎ›Ëœ k(X iâ†X j)â‰ 0âˆ§Î›Ëœ k(X jâ†X i)=0then
alleviatedbyintroducingtheBayesianInformationCriterion 12 Orientâ€œX i â†’X jâ€inG
(BIC)penaltydlog(m)/2intotheL(G,Î˜;D),wheredis 13 ifÎ›Ëœ k(X iâ†X j)=0âˆ§Î›Ëœ k(X jâ†X i)â‰ 0then
thenumberofedgeofGandmisthesizeofdatasetD.The 14 Orientâ€œX i â†X jâ€inG
penalizedobjectivefunctionisupdatedasfollows:
L (G,Î˜;D)=L(G,Î˜;D)âˆ’dlog(m)/2 (13) 15 ReturnG
p
WemaximumtheobjectivefunctionL (G,Î˜;D)byusing
p
aHill-Climbing-basedalgorithmasshowninLines2-6of
A fol rg mor ait sh tm ruc1 t. uI rt em sea ain rcl hy inco gn ss ci hst es mo ef btw yo tap kh ina gse os n. eFi sr ts et p,w ade dp ine gr-
,
Eq. (13) is O(âˆ‘m j=1âˆ‘âˆ£ iV =1âˆ£ ( (âˆ£ âˆ£V Vâˆ£ âˆ£+ âˆ’x i)( ij !x)âˆ’ i(ji )) !! ), by using
âˆ— FFT acceleration, this complexity can be reduced to
deleting,andreversingthegraphG inthelastiteration,i.e.,
in Line 4, V(Gâˆ— ) represents a collection of the one-step O(âˆ‘m j=1âˆ‘âˆ£ iV =1âˆ£ (âˆ£Vâˆ£âˆ’i+1)2x i(j)log(âˆ£Vâˆ£âˆ’i+1)2x( ij) ),
âˆ— â€² wheremisthesamplesize.
modifiedgraphofG .Second,byfixingthegraphG,we
â€²
estimatetheparameterÎ˜ ofthemodelviaoptimizerwith
Experiment
initialvaluesfromapproximatedcovarianceestimatesand
â€² â€² â€²
thencalculatetheL (G,Î˜;D)inLines5.Iteratingthetwo SyntheticExperiments
p
stepsaboveuntilthelikelihoodnolongerincreases.Inthe
âˆ— Inthissection,wetesttheproposedPB-SCMonsynthetic
end,wetransformG intoaskeleton(Line6).Thecorrect-
data.Wedesigncontrolexperimentsusingsyntheticdatato
nessofsuchaprocedurecanbeguaranteedbytheconsistent
testthesensitivityofsamplesize,numberofvertices,and
propertyofBICwhichisdiscussedin(Chickering2002).
differentindegreerate.ThebaselinemethodsincludeOCD
Learning Causal Direction Given the learned skeleton, (NiandMallick2022),PC(Spirtes,Glymour,andScheines
weorienteachundirectededgeusingthek-pathcumulants 2000),GES(Chickering2002).Wefurtherprovidetheresults
summation,accordingtoTheorem6.Indetail,foreachundi- usingthetrueskeletonaspriorknowledge(PB-SCM-P)to
rected edge (i,j) âˆˆ E, we calculate Î›Ëœ (X â† X ) and demonstratetheeffectivenessoflearningcausaldirection.
k i j
Î›Ëœ (X â† X ) for k = 1,...,K until one of them being Inthesensitivityexperiment,wesynthesizedatawithfixed
k j i parameterswhiletraversingthetargetparameterasshownin
zeroorkreachestheupperlimitK.Wethenorientthedirec-
Fig.6.Thedefaultsettingsareasfollows,samplesize=30000,
tionbasedonTheorem6(Lines11-14).
To assess whether Î›Ëœ is equal to 0, a bootstrap hypoth- number of vertices=10, indegree rate=3.0, range of causal
k coefficientÎ± âˆˆ [0.1,0.5],rangeofthemeanofPoisson
esis test is conducted (Efron and Tibshirani 1994) while a i,j
noise Âµ âˆˆ [1.0,3.0], the max order of cumulant K = 4.
thresholdcanbeusedfororientationoncesuchtestingfails. i
In detail,we calculatethe statistic
Î›Ëœ+
from N resampling
Eachsimulationisrepeated30times.
k As shown in Fig.6, we conduct three different control
+ + +
datasetD âˆˆ{D iâˆ£D
i=1,..,N
âŠ‚D,}.Then,weestimatethe
experimentsforPB-SCM.Overall,ourmethodoutperforms
distributionP(Î›Ëœ+
)bykerneldensityestimatorandcentralize allthebaselinemethodsinallthreecontrolexperiments.
k
ittomeanzero.Finally,thep-valueofÎ›Ëœ fromtheoriginal In the control experiments of the indegree rate given in
k
datasetcanbeobtained. Fig.6(a),astheindegreeratecontrolsthesparseofcausal
Complexity Analysis We provide the complexity structure,thehighertheindegreerate,thelesssparseincausal
of calculating likelihood in the worst casesâ€”when structureleadingtoadecreaseofperformanceofthebaseline
graph is complete. Specifically, the complexity of methods.Incontrast,PB-SCMkeepsgivingthebestresults1.00 1.00 1.00
0.75 Algorithm 0.75 Algorithm 0.75 Algorithm
PB-SCM-P PB-SCM-P PB-SCM-P
0.50 PB-SCM 0.50 PB-SCM 0.50 PB-SCM
PC PC PC
0.25 GES 0.25 GES 0.25 GES
OCD OCD OCD
0.00 0.00 0.00
2.0 2.5 3.0 3.5 3 5 7 10 13 15 1000 3000 5000 700010000200003000050000
Avg. Indegree Rate Number of vertices Sample Size
(a) SensitivitytoAvg.IndegreeRate (b) SensitivitytoNumberofvertices (c) SensitivitytoSampleSize
Figure6:F1intheSensitivityExperiments
inallindegreerates.Thereasonisthatourmethodbenefits Cause(X) Effect(Y) X â†’Y Y â†’X
fromthesparsityofthegraphandthedenserstructurewould
resultinmorecausalorderbeingidentifiedwhichverified Yellowcard Î›Ëœ â‰ 0 Î›Ëœ =0
k=2 k=2
thetheoreticalresultinourwork. Foul 2ndY.card Î›Ëœ â‰ 0 Î›Ëœ =0
k=3 k=2
Inthecontrolexperimentsofthenumberofverticesgiven Redcard Î›Ëœ =0 Î›Ëœ =0
inFig.6(b).Ourmethodoutperformsallthebaselinemethods,
k=1 k=1
2ndY.card Î›Ëœ â‰ 0 Î›Ëœ =0
showingaslightdecreaseasthenumberofnodesincreases, Yellowcard k=3 k=2
yetstilldemonstratingreasonableperformance.Thereason Substitution Î›Ëœ k=2 â‰ 0 Î›Ëœ k=2 =0
might be that with an increasing number of vertices, the 2ndY.card Redcard Î›Ëœ â‰ 0 Î›Ëœ =0
k=2 k=2
number of paths for both directions also increases, which
requires a higher-order cumulant to obtain the asymmetry.
Table1:Theresultofreal-worlddatasetexperiment.
However,estimatinghigh-ordercumulantisdifficultandhas
alargevariancewhichleadstoadecreaseinperformance.
InthecontrolexperimentsofsamplesizeshowninFig.6(c),
asthesamplesizeincreases,ourmethodâ€™sperformancecon-
tinuestoimproveandoutperformsallthebaselinemethods.
Thissuggestsasufficientsamplesizeisbeneficialforesti- (a) GroundTruth (b) Result
matingaccuratecumulant.
Figure7:FootballDatasetResult(F:Foul,Y :Yellowcard,
RealWorldExperiments 1
Y :Secondyellowcard,R:Redcard,S:Substitution).
2
WealsotesttheproposedPB-SCMonareal-worldfootball
eventsdataset1,whichcontains941,009eventsfrom9,074
footballgamesacrossEurope.Forthisexperiment,wefocus ThissuggestsahiddenconfounderbetweenFoulandYellow
onthecausalrelationinthefollowingcountofevents:Foul, card,possiblyrelatedtothefootballteamâ€™sstylewhichalso
Yellowcard,Secondyellowcard(abbreviatedas2ndY.card), coincideswithotherpathfindings.Moreover,thecausaldi-
Redcard,andSubstitution.Theseeventspossessclearcausal rection between Yellow card and Substitution is identified
relationshipsaccordingtotherulesofthefootballgame.Our suggesting a hidden confounder or indirect relation exists.
goalistoidentifythecausalrelationshipfromtheobserved This result suggests the effectiveness of our method when
count data while reasoning the possible number of paths dealingwithcomplexreal-worldscenarios.
betweentwoeventsasabyproductofourmethod.
Conclusion
In detail, we employ the bootstrap hypothesis test with
0.05 significance level to test whether Î›Ëœ is equal to zero. Inthiswork,westudytheidentificationofthePoissonbranch-
k
TheresultisshowninTable1.ThecolumnofXâ†’Y shows ingstructuralcausalmodelusinghigh-ordercumulant.We
thehighestorderofcumulantssummationÎ›Ëœ (Xâ†Y)that establishalinkbetweencumulantsandpathsinthecausal
k
isnotequaltozerowhilethecolumnofY â†’X showsthe graphunderPB-SCM,showingthatcumulantsencompass
lowestorderofcumulantssummationthatequalszero. informationaboutthenumberofpathsbetweentwovertices,
TheresultsaregiveninFig.7(b).Generally,PB-SCMsuc- whichisretrievable.Byleveragingthislink,weproposethe
cessfullyidentifiesfivecause-effectpairs,exceptforFoulâ†’ identifiabilityofthecausalorderofPB-SCManditsgraphi-
Redcard.Thepossiblereasonmightbeattributedtotheweak calimplication.Withtheidentifiabilityresult,weproposea
causalinfluencesinceonlyafewseriousfoulswillresultina causalstructurelearningalgorithmforPB-SCMconsisting
redcard.Interestingly,WefindÎ›Ëœ (Foulâ†’Yellowcard)â‰  oflearningcausalskeletonandlearningcausaldirection.Our
2
0,indicatingtwopathsfromF oritsancestortoYellowcard. theoreticalresultsandthepracticalalgorithmwillhopefully
furtherinspireaseriesoffuturemethodstodealwithcount
1https://www.kaggle.com/datasets/secareanualin/football- dataandmovetheresearchofcausaldiscoveryfurthertoward
events achievingreal-worldimpactsindifferentrespects.
1F 1F 1FAcknowledgments Spirtes,P.;Meek,C.;andRichardson,T.1995. Causalin-
ferenceinthepresenceoflatentvariablesandselectionbias.
ThisresearchwassupportedinpartbyNationalKeyR&D
InProceedingsoftheEleventhconferenceonUncertaintyin
ProgramofChina(2021ZD0111501),NationalScienceFund
artificialintelligence,499â€“506.
forExcellentYoungScholars(62122022),NaturalScience
FoundationofChina(61876043,61976052),themajorkey Steutel,F.W.;andvanHarn,K.1979. Discreteanaloguesof
projectofPCL(PCL2021A12).ZMâ€™sresearchwassupported self-decomposabilityandstability.TheAnnalsofProbability,
bytheChinaScholarshipCouncil(CSC). 893â€“899.
Tsamardinos,I.;Brown,L.E.;andAliferis,C.F.2006. The
References max-minhill-climbingBayesiannetworkstructurelearning
algorithm. Machinelearning,65:31â€“78.
Al-Osh,M.A.;andAlzaid,A.A.1987. First-orderinteger-
valuedautoregressive(INAR(1))process. JournalofTime WeiÃŸ,C.H.2018. Anintroductiontodiscrete-valuedtime
SeriesAnalysis,8(3):261â€“275. series. JohnWiley&Sons.
WeiÃŸ,C.H.;andKim,H.-Y.2014. Diagnosingandmodeling
Cai,R.;Qiao,J.;Zhang,Z.;andHao,Z.2018.Self:structural
extra-binomialvariationfortime-dependentcounts. Applied
equational likelihood framework for causal discovery. In
StochasticModelsinBusinessandIndustry,30(5):588â€“608.
ProceedingsoftheAAAIConferenceonArtificialIntelligence,
volume32. Wiuf,C.;andStumpf,M.P.2006. Binomialsubsampling.
ProceedingsoftheRoyalSocietyA:Mathematical,Physical
Cai,R.;Wu,S.;Qiao,J.;Hao,Z.;Zhang,K.;andZhang,X.
andEngineeringSciences,462(2068):1181â€“1195.
2022. THPs: Topological Hawkes Processes for Learning
CausalStructureonEventSequences. IEEETransactionson Zhang,K.;SchÃ¶lkopf,B.;Spirtes,P.;andGlymour,C.2018.
NeuralNetworksandLearningSystems. Learningcausalityandcausality-relatedlearning:somere-
centprogress. Nationalsciencereview,5(1):26â€“29.
Chickering, D. M. 2002. Optimal Structure Identification
withGreedySearch. Journalofmachinelearningresearch,
3(Nov):507â€“554.
Choi, J.; Chapkin, R.; and Ni, Y. 2020. Bayesian causal
structurallearningwithzero-inflatedpoissonbayesiannet-
works. Advancesinneuralinformationprocessingsystems,
33:5887â€“5897.
Cormen,T.H.;Leiserson,C.E.;Rivest,R.L.;andStein,C.
2022. Introductiontoalgorithms. MITpress.
Efron,B.;andTibshirani,R.J.1994. Anintroductiontothe
bootstrap. CRCpress.
Glymour, C.; Zhang, K.; and Spirtes, P. 2019. Review of
causaldiscoverymethodsbasedongraphicalmodels. Fron-
tiersingenetics,10:524.
McKenzie,E.1985. Somesimplemodelsfordiscretevari-
ate time series 1. JAWRA Journal of the American Water
ResourcesAssociation,21(4):645â€“650.
Ni,Y.;andMallick,B.2022. Ordinalcausaldiscovery. In
UncertaintyinArtificialIntelligence,1530â€“1540.PMLR.
Park,G.;andRaskutti,G.2015.Learninglarge-scalepoisson
dagmodelsbasedonoverdispersionscoring. Advancesin
neuralinformationprocessingsystems,28.
Park,G.;andRaskutti,G.2017.LearningQuadraticVariance
Function(QVF)DAGModelsviaOverDispersionScoring
(ODS). Journal of Machine Learning Research, 18(224):
1â€“44.
Pearl,J.2009. Causality. Cambridgeuniversitypress.
Qiao, J.; Cai, R.; Wu, S.; Xiang, Y.; Zhang, K.; and Hao,
Z.2023. StructuralHawkesProcessesforLearningCausal
StructurefromDiscrete-TimeEventSequences. InProceed-
ingsoftheThirty-SecondInternationalJointConferenceon
ArtificialIntelligence,IJCAI-23,5702â€“5710.
Spirtes,P.;Glymour,C.N.;andScheines,R.2000.Causation,
prediction,andsearch. MITpress.SupplementaryMaterialofâ€œCausalDiscoveryfromPoissonBranchingStructuralCausalModel
UsingHigh-OrderCumulantwithPathAnalysisâ€
A ProofofTheorem1
Theorem1(Reducibility). GivenaPoissonrandomvariableÏµandndistinctsequencesofcoefficientsA ,...,A ,wehave
1 n
Îº(A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ)=Îº(A â—¦Ïµ,...,A â—¦Ïµ)
1 1 n n 1 n
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (A.1)
k1times kntimes
whereeachA â—¦Ïµrepeatsk timesintheoriginalcumulantandonlycontainsonetimeinthereducedcumulant.
i i
OutlineofProof
Firstofall,weintroducethemoment-generatingfunction(MGF)andcumulant-generatingfunction(CGF).
Definition6(Moment-generatingfunction). ForX =[X ,...,X ]T,ann-dimensionalrandomvector,themoment-generating
1 n
functionofX isgivenby:
M
(t)âˆ¶=E[etTX ]=E[et1X1+t2X2+â‹¯+tnXn]
(A.2)
X
wheret=[t ,...,t ]isafixedvector.
1 n
Definition 7 (Cumulant-generating function). For X = [X ,...,X ]T, an n-dimensional random vector, the cumulant-
1 n
generatingfunctionofX isgivenby:
K (t)=lnM (t) (A.3)
X X
whereM (t)isthemoment-generatingfunctionofX.
X
WithCGF,wecancalculatethejointcumulantofagivenrandomvectorX bytakingdeviateofCGF:
Îº(X 1,X 2,...,X n)=
âˆ‚nK
âˆ‚tX
1âˆ‚(t
t1
2, â‹¯t
2
âˆ‚.. t. n,t n)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0
(A.4)
Furthermore,ifeachX intherandomvectorX repeatedk times,thenweonlyneedtotakek timesofderivativesoftheCGF
i i i
withrespecttothecorrespondingt ,i.e.,
i
Îº(X (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1 (cid:210) k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210), 1(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210). (cid:210)(cid:210) t(cid:209). im. (cid:210)(cid:210)(cid:210), (cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)X (cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1 (cid:210)(cid:210)(cid:210)(cid:207), (cid:205)X (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210) k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210), 2(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210). (cid:210)(cid:210) t(cid:209). im. (cid:210)(cid:210)(cid:210), (cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)X (cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)2 (cid:210)(cid:210)(cid:210)(cid:207),...,X (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n (cid:210)(cid:210) k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n, (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210). (cid:210)(cid:210)(cid:209) t. i. m(cid:210)(cid:210)(cid:210), (cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)X (cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n (cid:210)(cid:210)(cid:210)(cid:210)(cid:207))=
âˆ‚k1+k2+ âˆ‚â‹¯
tk
1+ 1k âˆ‚n tK
k 22X
â‹¯( âˆ‚t
1
t,
k
nt n2...,t n)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0
(A.5)
Therefore,Theorem1isequivalenttoshowthefollowingequalityhold:
âˆ‚nK
âˆ‚tX
1âˆ‚(t
t1
2, â‹¯t
2
âˆ‚.. t. n,t n)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0
=
âˆ‚k1+k2+ âˆ‚â‹¯
tk
1+ 1k âˆ‚n tK
k
22X
â‹¯( âˆ‚t
1
t,
k
nt n2...,t n)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0.
(A.6)
Todoshow,wewillprovethatthe
âˆ‚nKX(t1,t2...,tn)
hastheformofexponentialfunction,i.e.
âˆ‚t1âˆ‚t2â‹¯âˆ‚tn
âˆ‚nK X(t 1,t 2...,t n) =Î²et1+t2+â‹¯tn,
(A.7)
âˆ‚t âˆ‚t â‹¯âˆ‚t
1 2 n
whichisafunctionthatremainsunchangedwhentakingderivativeswithrespecttoanyt andthustheEq.(A.6)holds.
i
Followingthisoutline,considerarandomvectorR=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T,A â‰ A ,whereÏµrepresentsthePoisson
1 2 n i j
noisecomponentofavertexX ingraphG,andA isasequenceofpathcoefficientscorrespondingtoadirectpathfromX to
i
oneofitsdescendantvertices.ThenaccordingtothedefinitionofMGF,wehave:
M
(t)=E[etTR ]=E[et1Ã—A1â—¦Ïµ+â‹¯+tnÃ—Anâ—¦Ïµ
] (A.8)
R
wheret=[t ,t ,...,t ]T isafixedvector.
1 2 n
Followingtheoutline,wefirstprovideanintuitionofproofthroughaspecificcasethateachvertexareconditionalindependce
bytherootvertexÏµ.ProofofSpecificCase
GivenaPoissonrandomvariableÏµ âˆ¼ Pois(Âµ)andndistinctsequencesofcoefficientsA ,...,A ,inwhichA = (a(i) )âˆ£Aiâˆ£
1 n i k k=1
wherea(i)isthek-thcoefficientsofA
.
k i
Assumethereexistnok =1,2,...min(âˆ£A iâˆ£,âˆ£A jâˆ£)betweenanytwoA iandA
j
suchthat(a( li) )k
l=1
=(a( lj) )k l=1,whichmeans
thatthereexistnotwopathsP andP sharingthesamepartfromthesourcepoint.
i j
WeconsidertherandomvectorR=(A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ),whereeachrandomvariableA â—¦X appearsuniquely.The
1 2 n i
momentgeneratingfunction(MGF)ofRis:
M
(t)=E[et1Ã—A1â—¦Ïµ+â‹¯+tnÃ—Anâ—¦Ïµ
]. (A.9)
R
Accordingtothelawoftotalexpectation,wehave:
n
M
R(t)=E[E[et1Ã—A1â—¦Ïµ+â‹¯+tnÃ—Anâ—¦Ïµ âˆ£Ïµ]]=E[âˆE[etiÃ—Aiâ—¦Ïµ
âˆ£Ïµ]], (A.10)
i=1
sinceA â—¦Ïµâˆ£ÏµâŠ¥âŠ¥A â—¦Ïµâˆ£Ïµforalliâ‰ j.
i j
Next,accordingtothepropertyofthinningoperation,wehaveA iâ—¦Ïµâˆ£Ïµ=d Binorm(n=Ïµ,p=âˆâˆ£ jA =1iâˆ£a( ji) ),whereâ€˜=d â€™means
distributionequalityandBinorm(n,p)isthebinomialdistribution,thentheE[exp(t iÃ—A
iâ—¦Ïµ)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)Ïµ]istheMGFofabinomial
variableA â—¦Ïµâˆ£Ïµ,wehave:
i
Ïµ
E[exp(t iÃ—A
iâ—¦Ïµ)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)Ïµ]=â›
âœ
â1âˆ’âˆâˆ£ jA =i 1âˆ£
a(
ji)+âˆâˆ£ jA =i 1âˆ£
a(
ji)etiâ
âŸ
â 
. (A.11)
Substitutingequation(A.11)intoequation(A.10),wehave:
M
R(t)=Eâ¡ â¢â¢â¢â¢â¢â¢â¢
â£âˆ
i=n
1
â›
âœ
â1âˆ’âˆâˆ£ jA =i 1âˆ£
a(
ji)+âˆâˆ£ jA =i 1âˆ£
a(
ji)etiâ
âŸ
â Ïµâ¤ â¥â¥â¥â¥â¥â¥â¥
â¦=
k+
âˆ‘
=âˆ 0â¡ â¢â¢â¢â¢â¢â¢â¢â¢
â£P(Ïµ=k)âˆ
i=n
1
â›
âœ
â1âˆ’âˆâˆ£ jA =i 1âˆ£
a(
ji)+âˆâˆ£ jA =i 1âˆ£
a(
ji)etiâ
âŸ
â kâ¤ â¥â¥â¥â¥â¥â¥â¥â¥
â¦
=
k+
âˆ‘
=âˆ 0â¡ â¢â¢â¢â¢â¢â¢â¢â¢ â£Âµk ke !âˆ’Âµ
âˆ
i=n
1
â›
âœ
â1âˆ’âˆâˆ£ jA =i 1âˆ£
a(
ji)+âˆâˆ£ jA =i 1âˆ£
a(
ji)etiâ
âŸ
â kâ¤ â¥â¥â¥â¥â¥â¥â¥â¥
â¦
(A.12)
+âˆ [Âµâˆn i=1(1âˆ’âˆâˆ£ jA =1iâˆ£a( ji)+âˆâˆ£ jA =1iâˆ£a( ji)eti)]k
=exp(âˆ’Âµ)âˆ‘ .
k!
k=0
Accordingtothepowerseriesexpansionfortheexponentialfunction,i.e.expx=âˆ‘+âˆ xn
,wehave:
x=0 n!
M
R(t)=exp(âˆ’Âµ)expâ¡ â¢â¢â¢â¢â¢â¢â¢
â£Âµâˆ
i=n
1
â›
âœ
â1âˆ’âˆâˆ£ jA =i 1âˆ£
a(
ji)+âˆâˆ£ jA =i 1âˆ£
a(
ji)etiâ
âŸ
â â¤ â¥â¥â¥â¥â¥â¥â¥
â¦, (A.13)
thenthecumulant-generatingfunction(CGF)ofRisgivenby:
n â› âˆ£Aiâˆ£ âˆ£Aiâˆ£ â
K (t)=logM (t)=Âµâˆ âœ1âˆ’âˆa(i)+âˆa(i)etiâŸâˆ’Âµ, (A.14)
R R j j
i=1 â j=1 j=1 â 
Weobtainthecumulantbythepartialderivativesofthecumulantgeneratingfunction:
âˆ‚nK R(t) =Âµâˆn âˆâˆ£Aiâˆ£
a(i)eti.
(A.15)
âˆ‚t âˆ‚t â‹¯âˆ‚t j
1 2 n i=1 j=1
Since
âˆ‚nKR(t)
hastheformoftheexponentialfunction,furtherpartialderivativesofitwillalsoretainthesameform:
âˆ‚t1âˆ‚t2â‹¯âˆ‚tn
âˆ‚k1+k2+â‹¯knK R(t)
=
âˆ‚nK R(t) =Âµâˆn âˆâˆ£Aiâˆ£
a(i)eti. (A.16)
âˆ‚tk 11âˆ‚tk 22â‹¯âˆ‚tk nn âˆ‚t 1âˆ‚t 2â‹¯âˆ‚t n i=1 j=1 jTherefore,wehave:
Îº(A 1â—¦Ïµ,A 2â—¦Ïµ,...,A nâ—¦Ïµ)= âˆ‚tâˆ‚ 1n âˆ‚K
t
2R â‹¯(t âˆ‚)
t
n(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0=Âµâˆ i=n
1
âˆâˆ£ jA =i 1âˆ£ a( ji),
(A.17)
Îº(A
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ
(cid:210)(cid:210)
k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)
1(cid:210)(cid:210)(cid:210)(cid:210)(cid:210).
(cid:210)(cid:210) t(cid:209)
i. m. (cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)(cid:210)
e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)A
s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ (cid:210)(cid:207),...,A
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ
(cid:210)
k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210),
(cid:210)
n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210).
(cid:210)(cid:210)
t(cid:209). im. (cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)(cid:210)(cid:210)
e(cid:210)(cid:210)(cid:210)A
(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ (cid:210)(cid:207))= âˆ‚k âˆ‚1 t+
k
1k 12 âˆ‚+ tâ‹¯
k
22k â‹¯nK âˆ‚R
tk
n( nt)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0=Âµâˆ i=n
1
âˆâˆ£ jA =i 1âˆ£ a( ji),
whichfinishestheproof:
Îº(A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ)=Îº(A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ)
1 1 n n 1 2 n
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (A.18)
k1times kntimes
TheaboveproofofspecificcasehighlightsthatthewaytocalculatetheMGFinvolvesdecomposingtheexpectationE[etTR
]
usingthelawoftotalexpectationtoestablishconditionalindependence.Inthespecificcase,theconditionalindependencecanbe
simplyestablishedbyconditionontheÏµsincethereisnocommonsub-sequencebetweenanyA andA .
i j
However,givenÏµisnotenoughtobuildtheconditionalindependenceifA andA sharethesamesub-sequence,i.e.there
i j
existak suchthat(A i) 1âˆ¶k =(A j) 1âˆ¶k.
Before going into the formal proof, we provide an example to illustrate why simply conditioning on Ïµ cannot establish
conditional independence. Subsequently, we further show how to establish conditional independence in the presence of a
commonsub-sequence.
AnExamplewhenCommonsub-sequenceExists
Considerrandomvariables:
A â—¦Ïµ=bâ—¦aâ—¦Ïµ,A â—¦Ïµ=câ—¦aâ—¦ÏµandA â—¦Ïµ=câ—¦dâ—¦Ïµ,
1 2 3
whereA =(a,b), A =(a,c), A =(d,c)andA andA hasthecommonsub-sequence(a).Thegeneratingprocesscanbe
1 2 3 1 2
representedthroughatreestructure,asshowninFig.1.
ğœ–
ğ‘ ğ‘‘
ğ‘âˆ˜ğœ– ğ‘‘âˆ˜ğœ–
ğ‘ ğ‘ ğ‘
ğ‘âˆ˜ğ‘âˆ˜ğœ– ğ‘âˆ˜ğ‘âˆ˜ğœ– ğ‘âˆ˜ğ‘‘âˆ˜ğœ–
Figure1:GeneratingprocessofA â—¦Ïµ,A â—¦Ïµ, A â—¦Ïµ,eachleafnodecorrespondstoanoriginalrandomvariable.
1 2 3
Now, if we condition on Ïµ, we obtain conditional independence A â—¦Ïµâˆ£ÏµâŠ¥âŠ¥A â—¦Ïµâˆ£Ïµ and A â—¦Ïµâˆ£ÏµâŠ¥âŠ¥A â—¦Ïµâˆ£Ïµ, how-
1 3 2 3
ever, A â—¦Ïµâˆ£ÏµâŠ¥/âŠ¥A â—¦Ïµâˆ£Ïµ. This is because both A â—¦Ïµâˆ£Ïµ and A â—¦Ïµâˆ£Ïµ are dependent on the binomial random variable
1 2 1 2
aâ—¦Ïµâˆ£Ïµ=d B(n=Ïµ,p=Î±)generatedbythecommonsub-sequence(Î±).
Suchdependenceoccursduetoperformingthethinningoperationâ—¦onarandomvariable,resultinginthecreationofanew
randomvariable,distinctfromthestraightforwardlinearoperationsinvolvingmerecoefficientmultiplication.
Therefore,tobuildconditionalindependencebetweenA â—¦Ïµâˆ£ÏµandA â—¦Ïµâˆ£Ïµ,weneedtofurtherconditiononaâ—¦Ïµâˆ£Ïµ.Sucha
1 2
processofestablishingconditionalindependencestepbystepcanberepresentedthroughthetreestructureinFig.1,asshownin
Fig.2.
Specifically,theMGFofR=[A â—¦Ïµ,A â—¦Ïµ,A â—¦Ïµ]T isgivenby
1 2 3
M (t ,t ,t
)=E[et1Ã—A1â—¦Ïµ et2Ã—A2â—¦Ïµ et3Ã—A3â—¦Ïµ ]=E[et1Ã—bâ—¦aâ—¦Ïµ et2Ã—câ—¦aâ—¦Ïµ et3Ã—câ—¦dâ—¦Ïµ
]
R 1 2 3
=E
[E[et1Ã—bâ—¦aâ—¦Ïµ et2Ã—câ—¦aâ—¦Ïµ et3Ã—câ—¦dâ—¦Ïµ
âˆ£Ïµ]] (A.19)
Ïµ
=E
[E[et1Ã—bâ—¦aâ—¦Ïµ et2Ã—câ—¦aâ—¦Ïµ âˆ£Ïµ]E[et3Ã—câ—¦dâ—¦Ïµ
âˆ£Ïµ]],
Ïµ
whereE[et1bâ—¦aâ—¦Ïµet2câ—¦aâ—¦Ïµ âˆ£Ïµ]andE[et3câ—¦dâ—¦Ïµ
âˆ£Ïµ]correspondtotheblueboxandthegreenboxinFig.2,respectively.
The next step is to establish conditional independence and separate
E[et1bâ—¦aâ—¦Ïµet2câ—¦aâ—¦Ïµ
âˆ£Ïµ]. By applying the law of total
expectationtoit,weobtain
E[et1bâ—¦aâ—¦Ïµ et2câ—¦aâ—¦Ïµ âˆ£Ïµ]=E[E[et1bâ—¦aâ—¦Ïµ âˆ£aâ—¦Ïµ]E[et2câ—¦aâ—¦Ïµ âˆ£aâ—¦Ïµ]âˆ£Ïµ], (A.20)ğœ– ğœ– ğœ–
ğ‘ ğ‘‘ Condition ğ‘ ğ‘‘ Condition ğ‘ ğ‘‘
on ğœ– on ğ‘âˆ˜ğœ–|ğœ–
ğ‘âˆ˜ğœ– ğ‘‘âˆ˜ğœ– ğ‘âˆ˜ğœ–|ğœ– ğ‘‘âˆ˜ğœ–|ğœ– ğ‘âˆ˜ğœ–|ğœ– ğ‘‘âˆ˜ğœ–|ğœ–
ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘
ğ‘
ğ‘âˆ˜ğ‘âˆ˜ğœ– ğ‘âˆ˜ğ‘âˆ˜ğœ– ğ‘âˆ˜ğ‘‘âˆ˜ğœ– ğ‘âˆ˜ğ‘âˆ˜ğœ–|ğœ– ğ‘âˆ˜ğ‘‘âˆ˜ğœ–|ğœ– ğ‘âˆ˜ğ‘âˆ˜ğœ–|ğ‘âˆ˜ğœ– ğ‘âˆ˜ğ‘‘âˆ˜ğœ–|ğœ–
ğ‘âˆ˜ğ‘âˆ˜ğœ–|ğœ–
ğ‘âˆ˜ğ‘âˆ˜ğœ–|ğ‘âˆ˜ğœ–
Figure2:Obtainconditionalindependenceaccordingtothehierarchicalstructureofthetree
whichiscalculablesinceE[et1bâ—¦aâ—¦Ïµ âˆ£aâ—¦Ïµ]istheMGFofBinorm(n=aâ—¦Ïµ,p=b)andthesameforE[et2câ—¦aâ—¦Ïµ âˆ£aâ—¦Ïµ].
Motivatedbytheaboveexample,whenconditioningonavertexinatree,conditionalindependenceisestablishedamongthe
randomvariablescorrespondingtoeachsubtreeofthatvertex(ifthesubtreeexists),enablingtheseparationofexpectations.
Therefore, one can calculate the MGF by conditioning the random variables layer by layer according to the hierarchical
structureofthetreeinthegeneratingprocess.
Here,toformalizethecomputationoftheMGF,weintroducethefollowingdefinitionofatreetomodelthegeneratingprocess
oftherandomvectorR=(A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ).
1 2 n
Definition 8 (Tree representation of the generating process of random vector in PB-SCM). For a given random vector
R=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T,âˆ€ A â‰ A ,thegeneratingprocessofeachrandomvariableinRcanbesummarizedby
1 2 n i,j i j
atreeT R.Let{T 0,T 1,T 2,...}denotealltheverticesofT R,whereT
0
=ÏµistherootvertexofthetreeandT
j
=Î±
iâ†’j
â—¦T i.Let
L={L ,L ,...,L }withindexi=1,2,...,ndenotetheleafverticesinthetree,suchthatL =A â—¦Ïµ
1 2 n i i
Moreover,letAj
i
denotesthesub-sequenceofA ithatstartfromT j.Forexample,A
i
={Î± 0â†’1,Î± 1â†’2,Î± 2â†’3},thenA0
i
=A
i
andA1
i
={Î± 1â†’2,Î± 2â†’3}.LetL(T i)={kâˆ£T
k
isleafâˆ§k âˆˆL(T i)}denotesthesetofleafvertexinthetree.
TherecursiverelationofMGF
Based on this definition, several lemmas are introduced to establish the recursive relation for the MGF of
R=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T.
1 2 n
Lemma1(StartfromrootvertexT ). ForagivenrandomvectorR=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T anditstreerepresentation
0 1 2 n
T ,A â‰ A ,theMGFofRsatisfy
R i j
â¡ â¤
M R(t)=E[eâˆ‘n i=1tiÃ—Aiâ—¦Ïµ ]=E T0â¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tj)tiÃ—Aj iâ—¦Tjâˆ£T 0]â¥â¥â¥â¥â¥â¥â¥ (A.21)
â£jâˆˆCh(T0) â¦
Proof. TheresultisstraightforwardsinceT thetherootofthetree,thengiventheconditionofT eachchildofT willbe
0 0 0
conditionalindependence:
M
(t)=E[eâˆ‘n i=1tiÃ—Aiâ—¦Ïµ
]
R
=E[eâˆ‘n i=1tiÃ—Aiâ—¦T0]
â¡ â¤
=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tj)tiÃ—Aj iâ—¦Î±0â†’jâ—¦T0âˆ£T 0]â¥â¥â¥â¥â¥â¥â¥ (A.22)
â£jâˆˆCh(T0) â¦
â¡ â¤
=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tj)tiÃ—Aj iâ—¦Tjâˆ£T 0]â¥â¥â¥â¥â¥â¥â¥
â£jâˆˆCh(T0) â¦
ByLemma1,MGFcanbedecomposedintoseparatedconditionalexpectationinthefirstlevelofthetree.Next,wewill
investigatehowsuchconditionalexpectationcanbefurtherdecomposed.
Lemma2(FromvertexT toT ). ForagivenrandomvectorR=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T anditstreerepresentation
j k 1 2 n
T .LetT beanodeinalevelthatdecomposedtheconditionalexpectationintotheproductofitschild.Then,oneofsuch
R jdecomposedexpectationofitschildT ,canbefurtherdecomposedifT isnotleaf,
k k
â¡ â¤
E[eâˆ‘ iâˆˆL(Tk)tiÃ—Ak iâ—¦Tkâˆ£T j]=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Tlâˆ£T k]âˆ£T jâ¥â¥â¥â¥â¥â¥â¥ (A.23)
â£lâˆˆCh(k) â¦
andifT isleaf,
k
E[eâˆ‘ iâˆˆL(Tk)tiÃ—Ak iâ—¦Tkâˆ£T j]=[M B(Î±jâ†’k)(t L(Tk))]Tj. (A.24)
Proof. IfT isnotleaf,wecanseparatetheexpectationaccordingitschild:
k
â¡ â¤
E[eâˆ‘ iâˆˆL(Tk)tiÃ—Ak iâ—¦Tkâˆ£T j]=E[eâˆ‘ lâˆˆCh(Tk)âˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Î±kâ†’lâ—¦Tkâˆ£T j]=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ eâˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Î±kâ†’lâ—¦Tkâˆ£T jâ¥â¥â¥â¥â¥â¥â¥. (A.25)
â£lâˆˆCh(k) â¦
Then,accordingtothelawoftotalexpectation,wehave
â¡ â¤ â¡ â¤
Eâ¢â¢â¢â¢â¢â¢â¢ âˆ eâˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Î±kâ†’lâ—¦Tkâˆ£T jâ¥â¥â¥â¥â¥â¥â¥=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Î±kâ†’lâ—¦Tkâˆ£T k]âˆ£T jâ¥â¥â¥â¥â¥â¥â¥
â£lâˆˆCh(k) â¦ â£lâˆˆCh(k) â¦
(A.26)
â¡ â¤
=Eâ¢â¢â¢â¢â¢â¢â¢ âˆ E[eâˆ‘ iâˆˆL(Tl)tiÃ—Al iâ—¦Tlâˆ£T k]âˆ£T jâ¥â¥â¥â¥â¥â¥â¥
â£lâˆˆCh(k) â¦
IfT isleaf,whichmeansi=L(T )istheexactlyindexoftheleafvertexandAk isempty,andthenwehave:
k k i
E[eâˆ‘ iâˆˆL(Tk)tiÃ—Ak iâ—¦Tkâˆ£T j]=E[etL(Tk)Ã—Tkâˆ£T j]=E[etL(Tk)Ã—Î±jâ†’kâ—¦Tjâˆ£T
j]. (A.27)
Accordingtothedefinitionofthinoperator,wehaveÎ± jâ†’kâ—¦T
j
=âˆ‘T l=j 1Î¾ l(Î±jâ†’k) withÎ¾ l(Î±jâ†’k) i.iâˆ¼.d. B(Î± jâ†’k),whereB(Î± jâ†’k)is
BernoullidistributionwithparameterÎ± .Thus,
jâ†’k
E[etL(Tk)Ã—Î±jâ†’kâ—¦Tjâˆ£T ]=E[etL(Tk)Ã—âˆ‘T l=j 1Î¾ l(Î±jâ†’k)
âˆ£T
]=E[âˆTj etL(Tk)Ã—Î¾ l(Î±jâ†’k)
âˆ£T
]=âˆTj E[etL(Tk)Ã—Î¾ l(Î±jâ†’k) ]=E[etL(Tk)Ã—Î¾ l(Î±jâ†’k) ]Tj
.
j j l=1 j l=1
(A.28)
NotethatE[etL(Tk)Ã—Î¾ l(Î±jâ†’k) ]istheMGFofÎ¾(Î±jâ†’k)
.Intheend,weobtain:
l
E[etL(Tk)Ã—Î¾ l(Î±jâ†’k) ]Tj =[M (t )]Tj. (A.29)
B(Î±jâ†’k) L(Tk)
Torepresenttherecursiverelation,wenowintroducetheprobability-generatingfunction(PGF):
Definition 9 (Probability-generating function). For X = [X ,...,X ]T, where each X is adiscrete random variable, the
1 n i
probability-generatingfunctionofX isgivenby:G
(z)âˆ¶=E[zX1zX2â‹¯zXn],wherez=[z
,...,z ].
X 1 2 n 1 n
Then,followinglemmadisclosetherecursiverelationofMGF.
Lemma 3. For a given random vector R = [A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T and its tree representation T . Let M (t) âˆ¶=
1 2 n R j,k
E[eâˆ‘ iâˆˆL(Tk)tiÃ—Ak iâ—¦Tkâˆ£T j] and MËœ j,k(t L(Tk)) = [M j,k(t L(Tk))]T1 j, where t
L(Tk)
= {t iâˆ£i âˆˆ L(T k)}. The joint MGF can be
expressedasfollows:
â› â
M (t)=G âœ âˆ MËœ (t )âŸ, (A.30)
R T0â 0,j L(Tj)
â 
jâˆˆCh(T0)
where
MËœ j,k(t L(Tk))={G MB(Î±jâ†’k)( (tâˆ lâˆˆCh )(k)MËœ k,l(t L(Tk))) i of thT ek rwis in seotleafvertex . (A.31)
B(Î±jâ†’k) L(Tk)Proof. First,byLemma2,wehavethefollowingrecursiveformula
E[âˆ M (t )âˆ£T ] ifT isnotleafvertex
M j,k(t L(Tk))={
[M
lâˆˆCh( (k t) )]Tk j,l L(Tl) j othek
rwise
(A.32)
B(Î±jâ†’k) i
andthus
â¡ â¤
M R(t)=E
T0â¢â¢â¢â¢â¢â¢â¢
âˆ M 0,j(t
L(Tj))â¥â¥â¥â¥â¥â¥â¥.
(A.33)
â£jâˆˆCh(T0) â¦
Then,sinceMËœ j,k(t L(Tk))=[M j,k(t L(Tk))]T1 j,basedontherecursiveformulainEq.(A.32),wehave
MËœ j,k(t L(Tk))=M j,k(t L(Tk))T1 j
1
={(E[âˆ lâˆˆCh(k)MËœ k,l(t L(Tl))Tkâˆ£T j])Tj ifT
k
isnotleafvertex
M (t ) otherwise (A.34)
B(Î±jâ†’k) i
=â§ âªâªâª â¨(E[(âˆ lâˆˆCh(k)MËœ k,l(t L(Tl)))Î±jâ†’kâ—¦Tj âˆ£T j])T1 j ifT
k
isnotleafvertex
âªâªâªM
(t ) otherwise
â© B(Î±jâ†’k) L(Tk)
ConsidertheexpectationinEq.(A.34)whenT isnotleafvertex.SinceT isconditionedsuchthatÎ± â—¦T followsthe
k j jâ†’k j
distributionBinorm(n=T j,p=Î± jâ†’k),thenbytheprobabilitygeneratingfunctionofBinomialdistribution,wehave
Eâ¡
â¢â¢â¢â¢â¢â¢â¢â¢ â£â›
âœ
â
lâˆˆâˆ Ch(k)MËœ k,l(t
L(Tl))â
âŸ
â Î±jâ†’kâ—¦Tj
âˆ£T
jâ¤
â¥â¥â¥â¥â¥â¥â¥â¥
â¦=G
B(Î±jâ†’k)â›
âœ
â
lâˆˆâˆ Ch(k)MËœ k,l(t
L(Tl))â
âŸ
â Tj
. (A.35)
whereG (â‹… )istheprobabilitygeneratingfunctionofBernoullidistributionaccordingtotherelationbetweenBernoulli
B(Î±jâ†’k)
andBinomialdistribution.SubstitutingEq.(A.35)intoEq.(A.34)wehave
MËœ j,k(t L(Tk))={G MB(Î±jâ†’k)( (tâˆ )lâˆˆCh(k)MËœ k,l(t L(Tl))) oif thT ek rwis isn eotleafvertex . (A.36)
B(Î±jâ†’k) i
AsforthejointMGF,similarly,wehave
M R(t)=E
T0â¡ â¢â¢â¢â¢â¢â¢â¢
â£jâˆˆCâˆ h(T0)M 0,j(t
L(Tj))â¤ â¥â¥â¥â¥â¥â¥â¥
â¦=E
T0â¡ â¢â¢â¢â¢â¢â¢â¢â¢ â£â›
âœ
â
jâˆˆCâˆ h(T0)MËœ 0,j(t
L(Tj))â
âŸ
â T0â¤ â¥â¥â¥â¥â¥â¥â¥â¥
â¦=G
T0â›
âœ
â
jâˆˆCâˆ h(T0)MËœ 0,j(t
L(Tj))â
âŸ â , (A.37)
whichfinishestheproof.
Afterderivingtherecursiverelation,wenowstepintotheformalproofofTheorem1followingtheproofoutline.
FormalProofofTheorem1
AccordingtotheLemma3,foragivenrandomvectorR=[A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ]T anditstreerepresentationT ,the
1 2 n R
MGFofitisM (t)=G (âˆ MËœ (t )),whereT =Ïµâˆ¼Pois(Âµ)isaPoissonrandomvariable.Thecumulant
R T0 jâˆˆCh(T0) 0,j L(Tj) 0
generatingfunctionofRisgivenby:
K (t)=logM (t)=logexp[Âµ(âˆ MËœ (t )âˆ’1)]=Âµ(âˆ MËœ (t )âˆ’1). (A.38)
R R jâˆˆCh(T0) 0,j L(Tj) jâˆˆCh(T0) 0,j L(Tj)
OurgoalistoshowthederivativeofK (t)isoftheexponentialform:
R
âˆ‚nK R(t) =Î²et1+t2+â‹¯+tn.
(A.39)
âˆ‚t âˆ‚t â‹¯âˆ‚t
1 1 n
Westartwith
âˆ‚nK (t) âˆ‚n â› â âˆ‚n
R = Âµâœ âˆ MËœ (t )âˆ’1âŸ=Âµ âˆ MËœ (t ), (A.40)
âˆ‚t 1âˆ‚t 1â‹¯âˆ‚t
n
âˆ‚t 1âˆ‚t 1â‹¯âˆ‚t
n â jâˆˆCh(T0)
0,j L(Tj)
â 
âˆ‚t 1âˆ‚t 1â‹¯âˆ‚t
n jâˆˆCh(T0)
0,j L(Tj)whereMËœ (t )isafunctioninvolvingonly{t âˆ£iâˆˆL(T )},wethenhave:
0,j L(Tj) i j
âˆ‚n âˆ‚âˆ£L(Tj)âˆ£
Âµ âˆ MËœ (t )=Âµâˆ MËœ (t ). (A.41)
âˆ‚t 1âˆ‚t 1â‹¯âˆ‚t
n jâˆˆCh(T0)
0,j L(Tj) jâˆˆCh(T0) âˆ iâˆˆL(Tj)âˆ‚t
i
0,j L(Tj)
Wethenintroducetherecursiverepresentationof âˆ‚âˆ£L(Tj)âˆ£ MËœ (t ).
âˆ iâˆˆL(Tj)âˆ‚ti 0,j L(Tj)
Lemma4. ThehigherorderpartialderivativeofMËœ (t )canbegivenby:
j,k L(Tk)
âˆ‚âˆ£L( âˆTk) iâˆ£ âˆˆM LËœ (j T,k k)(t âˆ‚L t( iTk)) =â§ âªâªâª â¨
âªâªâª
â©Î± Î±j jâ†’ â†’k keâˆ tL(l Tâˆˆ kC )h ,(k) âˆ‚âˆ£L âˆ(Tl t) iâˆ£ âˆˆMËœ Lk (T,l l( )t âˆ‚L t( iTl)), oif thT ek rwis in seo .tleafvertex, (A.42)
Proof. WhenT isnotaleafvertex,accordingtotheLemma3,wehave:
k
âˆ‚âˆ£L(Tk)âˆ£MËœ (t ) âˆ‚âˆ£L(Tk)âˆ£ â› â
j,k L(Tk) = G âœ âˆ MËœ (t )âŸ
âˆ iâˆˆL(Tk)âˆ‚t i âˆ iâˆˆL(Tk)âˆ‚t i B(Î±jâ†’k) â lâˆˆCh(k) k,l L(Tl) â 
âˆ‚âˆ£L(Tk)âˆ£ â› â
= âˆ iâˆˆL(Tk)âˆ‚t i âœ â1âˆ’Î± jâ†’k+Î± jâ†’k lâˆˆâˆ Ch(k)MËœ k,l(t L(Tl))âŸ â  (A.43)
âˆ‚âˆ£L(Tk)âˆ£
=Î±
jâ†’kâˆ
âˆ‚t
âˆ MËœ k,l(t L(Tl)).
iâˆˆL(Tk) i lâˆˆCh(k)
SinceMËœ (t )isafunctioninvolvingonly{t âˆ£iâˆˆL(T )},wehave:
k,l L(Tl) i l
âˆ‚âˆ£L(Tk)âˆ£ âˆ‚âˆ£L(Tl)âˆ£MËœ (t )
Î±
jâ†’kâˆ âˆ‚t
âˆ MËœ k,l(t L(Tl))=Î±
jâ†’k
âˆ
âˆ
k,l âˆ‚L t(Tl) . (A.44)
iâˆˆL(Tk) i lâˆˆCh(k) lâˆˆCh(k) iâˆˆL(Tk) i
Otherwise,whenT isaleafvertex,wehave:
k
âˆ‚âˆ£L( âˆTk)âˆ£MËœ j,k(t âˆ‚L t(Tk)) = âˆ‚M B( âˆ‚Î±j tâ†’k)(t L(Tk)) = âˆ‚(1âˆ’Î± jâ†’ âˆ‚k t+Î± jâ†’ketL(Tk)) =Î± jâ†’ketL(Tk), (A.45)
iâˆˆL(Tk) i L(Tk) L(Tk)
whichfinishestheproof.
According to Lemma 4, as the recursion terminates with an exponential function upon reaching the leaf vertex, we can
deducethattheexpansionof âˆ‚nKR(t) resultsintheproductofeti foralliâˆˆ[n],alongwithaseriesofcorrespondingpath
âˆ‚t1âˆ‚t1â‹¯âˆ‚tn
coefficients.Moreover,ourfocusdoesnotlieinthespecificformofthesecoefficients,andthuswedenotethecoefficientasÎ².
Weconclude:
âˆ‚nK R(t) =Î²et1+t2+â‹¯+tn.
(A.46)
âˆ‚t âˆ‚t â‹¯âˆ‚t
1 1 n
Finally,weobtain:
Îº(A 1â—¦Ïµ,A 2â—¦Ïµ,...,A nâ—¦Ïµ)=
âˆ‚tâˆ‚ 1n âˆ‚K
t
2R
â‹¯(t âˆ‚)
t
n(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0=Î²,
Îº(A
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ
(cid:210)(cid:210)
k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)
1(cid:210)(cid:210)(cid:210)(cid:210)(cid:210).
(cid:210)(cid:210) t(cid:209)
i. m. (cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)(cid:210)
e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)A
s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)1
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ (cid:210)(cid:207),...,A
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ
(cid:210)
k(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210),
(cid:210)
n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210).
(cid:210)(cid:210)
t(cid:209). im. (cid:210)(cid:210)(cid:210),
(cid:210)(cid:210)(cid:210)(cid:210)
e(cid:210)(cid:210)(cid:210)A
(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)n
(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)â—¦ (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)Ïµ (cid:210)(cid:207))=
âˆ‚k âˆ‚1 t+
k
1k 12 âˆ‚+ tâ‹¯
k
22k â‹¯nK
âˆ‚R
tk
n( nt)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)t1=0,...,tn=0=Î², (A.47)
whichfinishestheproof:
Îº(A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ,...,A â—¦Ïµ)=Îº(A â—¦Ïµ,A â—¦Ïµ,...,A â—¦Ïµ).
1 1 n n 1 2 n
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (A.48)
k1times kntimesB ProofofRemark1
Remark1. Foranytwovariablescausalgraph,thecausaldirectionofPB-SCMisnotidentifiableandadistributedequivalent
reversedmodelexists.
Proof. WeprovebytheequalityofPGFsofbothdirections.GivenatwovariablescausalgraphX
âˆ’â†’Î±
Y,whereX =Ïµ ,Y =
X
Î±â—¦X+Ïµ ,Ïµ âˆ¼Pois(Âµ ),andwedenotethereversemodelbyY âˆ’â†’Î±Ë† X,whereY =ÏµË†,X =Î±Ë†â—¦Y +ÏµË† .Wenowshowthe
Y i i Y X
solutionofÎ±Ë†,ÏµË† andÏµË†.
X Y
Forthecausaldirection,thePGFisgivenby:
G (z ,s
)=E[zX zÎ±â—¦X+ÏµY]
X,Y 1 2 1 2
=E[zÏµXzÎ±â—¦ÏµX]E[zÏµY]
1 2 2
=G (z G (z ))G (z ) (B.1)
ÏµX 1 B(Î±) 2 ÏµY 2
=G (z (1âˆ’Î±+Î±z ))G (z )
ÏµX 1 2 ÏµY 2
=eÂµX(z1(1âˆ’Î±+Î±z2)âˆ’1)eÂµY(z2âˆ’1).
Forthereversedirection,thePGFisgivenby:
GË† (z ,z )=E[zÎ±Ë†â—¦Y+ÏµË†XzY ]
X,Y 1 2 1 2
=E[zÎ±Ë†â—¦Y zY ]E[zÏµË†X]
1 2 1
=G (z G (z ))G (z ) (B.2)
Y 2 B(Î±Ë†) 1 ÏµË†X 1
=G (z (1âˆ’Î±Ë†+Î±Ë†z ))G (z )
Y 2 1 ÏµË†X 1
=eE[Y](z2(1âˆ’Î±Ë†+Î±Ë†z1)âˆ’1)eÂµË†x(z1âˆ’1).
Ifthesetwomodelsareequivalent,wehaveG (z ,z )=GË† (z ,z ),i.e.
X,Y 1 2 X,Y 1 2
Âµ (z (1âˆ’Î±+Î±z )âˆ’1)+Âµ (z âˆ’1)=E[Y](z (1âˆ’Î±Ë†+Î±Ë†z )âˆ’1)+ÂµË† (z âˆ’1). (B.3)
X 1 2 Y 2 2 1 X 1
AsY isarootvertexinthereversemodel,wehaveÏµ âˆ¼Pois(E[Y])=Pois(Î±Âµ +Âµ ).Thenwehave:
Y X Y
Âµ (z (1âˆ’Î±+Î±z )âˆ’1)+Âµ (z âˆ’1)=(Î±Âµ +Âµ )(z (1âˆ’Î±Ë†+Î±Ë†z )âˆ’1)+ÂµË† (z âˆ’1). (B.4)
X 1 2 Y 2 x y 2 1 X 1
Expandingtheexpressionandsimplifying,weobtain
Î±Âµ z z +Âµ (1âˆ’Î±)z +Âµ z âˆ’Âµ âˆ’Âµ
X 1 2 X 1 Y 2 X Y
(B.5)
=(Î±Âµ +Âµ )Î±Ë†z z +ÂµË† z + (Î±Âµ +Âµ )(1âˆ’Î±Ë†)z âˆ’ (Î±Âµ +Âµ )âˆ’ÂµË†
X Y 1 2 X 1 X Y 2 X Y X
Toensuretheequalityholds,weequatethecoefficients,resultinginfollowingsystemofequations:
Î±Âµ =(Î±Âµ +Âµ )Î±Ë†
X X Y
Âµ (1âˆ’Î±)=ÂµË†
X X
(B.6)
Âµ =(Î±Âµ +Âµ )(1âˆ’Î±Ë†)
Y X Y
Âµ +Âµ =(Î±Âµ +Âµ )+ÂµË† ,
X Y X Y X
wherethesolutionofitisÎ±Ë† =Î±Âµ /(Î±Âµ +Âµ ), ÂµË† =Âµ (1âˆ’Î±).Thiscompletestheproof.
X X Y X X
C ProofofTheorem2
Theorem2. Foranytwovertexiandj whereiisrootvertex,i.e.,vertexihasemptyparentset,the2Dsliceofjointcumulant
C(n)satisfies:
i,j
C i( ,n j) =âˆ‘n k=âˆ’ 11 âˆ‘ ( m 1mn 2âˆ’ â‹¯1 m k)Î›i kâ†j (1â—¦X iâ†X j). (C.1)
m1+â‹¯ m+ lm >k 0=nâˆ’1
where( nâˆ’1 )= (nâˆ’1)! isthemultinomialcoefficients.
m1m2â‹¯mk m1!m2!â‹¯mk!Proof
Foranytwovertexiandj,whereiisrootvertex,letPiâ†j ={Piâ†j ,Piâ†j ,...,Piâ†j
}bethesetofpathsfromvertexitoj
1 2 âˆ£Piâ†jâˆ£
withthecorrespondingsetofsequencesofcoefficientsAiâ†j ={Aiâ†j ,Aiâ†j ,...,Aiâ†j }.AccordingtothedefinitionofC(n),
1 2 âˆ£Piâ†jâˆ£ i,j
wehave:
â› â â› â
C i( ,n j) =ÎºâœâœX i,X j,...,X jâŸâŸ=ÎºâœâœÏµ i,X j,...,X jâŸâŸ (C.2)
â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â  â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â 
nâˆ’1times nâˆ’1times
thenweexpandX accordingtothestructuralequationofX :
j j
C(n) =Îº(Ïµ ,Aiâ†j â—¦Ïµ +â‹¯+Aiâ†j â—¦Ïµ ,...,Aiâ†j â—¦Ïµ +â‹¯+Aiâ†j â—¦Ïµ ).
i,j i 1 i âˆ£Piâ†jâˆ£ i 1 i âˆ£Piâ†jâˆ£ i
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207) (C.3)
âˆ£Piâ†jâˆ£times
(cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:209)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)
nâˆ’1times
Byapplyingthemultilinearityofcumulant,weobtainthefollowingdecomposition:
âˆ£Piâ†jâˆ£ âˆ£Piâ†jâˆ£
C(n) = âˆ‘ â‹¯ âˆ‘ Îº(Ïµ ,Aiâ†j â—¦Ïµ ,Aiâ†j â—¦Ïµ ,...,Aiâ†j â—¦Ïµ ), (C.4)
i,j i l1 i l2 i lnâˆ’1 i
l1=1 lnâˆ’1=1
whichyieldsâˆ£Piâ†j âˆ£Ã— (nâˆ’1)cumulanttermwhereeachtermcorrespondenttoadifferentcombinationofcoefficientAiâ†j .
l
iâ†j iâ†j
TocharacterizethecombinationsofA withineachcumulantinEq.(C.3),wecanconceptualizethatchoosedifferentA
l l
intonâˆ’1boxfromâˆ£Piâ†j âˆ£numberofdifferentcoefficient,,i.e.,wecanselectaAiâ†j fromAiâ†j ={Aiâ†j ,Aiâ†j ,...,Aiâ†j
}
l 1 2 âˆ£Piâ†jâˆ£
foreachpositioninthedecomposedcumulant.
Toestablishtheconnectionbetweenthecumulantandthek-pathsummation,wefirstrecallthedefinitionofÎ›iâ†j (1â—¦X â†
k i
X ):
j
Î›iâ†j (1â—¦Ïµ â†X )= âˆ‘ Îº(1â—¦Ïµ ,Aiâ†j â—¦Ïµ ,...,Aiâ†j â—¦Ïµ ),
k i j i l1 i lk i (C.5)
1â‰¤l1<l2<...<lkâ‰¤âˆ£Piâ†jâˆ£
iâ†j
whichisthesumofcumulantsandeachcumulantinvolvekdistinctA .
l
Notethatduetothereducibility,theC(n)canbereducedtoseveraldistinctcumulants.Inparticular,thek-pathsummation
i,j
containsallthedistinctcumulantsofC(n)whichinvolvekdistinctAiâ†j
.Therefore,theconnectionbetweenEq.(C.5)andEq.
i,j l
iâ†j
(C.4)canbeformulatedashowmanynumbersforeachdistinctA occursafterthereducing.
l
ForeachdistinctcumulantinÎ›iâ†j (1â—¦Ïµ â†X ),thenumberofoccurrencesisthesamebecauseeachcumulantisconstructed
k i j
bykdifferentpathssharingthesamepropertyintermofnumber.
Thus, we only need to count the number of each distinct cumulant for some specific k paths. Without loss of generality,
considerthecumulantwithk pathinformation:Îº(1â—¦Ïµ ,Aiâ†j â—¦Ïµ ,...,Aiâ†j â—¦Ïµ ).Sincebeforethereducingstep,thereare
i 1 i k i
nâˆ’1positionsforeachA,andthecountcanbeformulatedbycountingthenumberofwaystoplacekdistinguishableAinto
nâˆ’1indistinguishableboxeswithreplacementsuchthateachballmustappearatleastonce.Suchanumbercanbecalculated
by âˆ‘ ( nâˆ’1 ),whichisthecoefficientofÎ›iâ†j (1â—¦Ïµ â†X ).Bycombiningeachorderofk,wecanobtainthe
m1+â‹¯ m+ lm >k 0=nâˆ’1
m1m2â‹¯mk k i j
close-formsolutionofC(n)inEq.(C.3).Thiscompletestheproof.
i,j
D ProofofTheorem3andTheorem4
Theorem3(Identifiabilityforrootvertex). Foranyvertexiandj,whereiistherootvertexingraphG,ifC(3)âˆ’C(2) â‰ 0,then
i,j i,j
C(3)âˆ’C(2) =0andX istheancestorofX .
j,i j,i i j
Proof. Forthereversedirection,sinceX isarootvertex,wehave:
i
â›âˆ£Piâ†jâˆ£
â
C j( ,2 i) =Îº(X j,X i)=Îºâœâœ âˆ‘ Ai lâ†j â—¦Ïµ i,Ïµ iâŸâŸ,
â l=1 â 
(D.1)
â›âˆ£Piâ†jâˆ£
â
C j( ,3 i) =Îº(X j,X i,X i)=Îºâœâœ âˆ‘ Ai lâ†j â—¦Ïµ i,Ïµ i,Ïµ iâŸâŸ.
â l=1 â BasedonTheorem1,Eq.(D.1)canbereducedasfollow:
â›âˆ£Piâ†jâˆ£
â
â›âˆ£Piâ†jâˆ£
â
C j( ,3 i) =Îºâœâœ âˆ‘ Ai lâ†j â—¦Ïµ i,Ïµ i,Ïµ iâŸâŸ=Îºâœâœ âˆ‘ Ai lâ†j â—¦Ïµ i,Ïµ iâŸâŸ=C j( ,2 i) (D.2)
â l=1 â  â l=1 â 
thusC(3)âˆ’C(2) =0.
j,i j,i
Forthecausaldirection,basedonTheorem2,wehave:
C(2) =Î›iâ†j (X â†X )
i,j 1 i j
(D.3)
C(3) =Î›iâ†j (X â†X )+2Î›iâ†j (X â†X )
i,j 1 i j 2 i j
ThenwehaveC(3)âˆ’C(2) =2Î›iâ†j (X â†X )â‰ 0whichmeansthattherearemorethanonepathfromitoj,i.e.âˆ£Piâ†j âˆ£â‰¥2.
i,j i,j 2 i j
Therefore,X istheancestorofX .Thiscompletestheproof.
i j
Theorem4(GraphicalImplicationofIdentifiabilityforRootVertex). Forapairofverticesiandj ingraphG,ifvertexiisa
rootvertexandexistsatleasttwodirectedpathsfromitoj,i.e.,âˆ£Piâ†j âˆ£â‰¥2thenthecausalorderbetweeniandjisidentifiable.
Proof. Supposethecausalorderbetweeniandj cannotbeidentifiedbyTheorem3.Thentheremustbeinthefollowingcases:
(i)C(3)âˆ’C(2) =0;(ii)C(3)âˆ’C(2) â‰ 0.
i,j i,j j,i j,i
For(i),sinceÎ›iâ†j (1â—¦Ïµ â†X )=C(3)âˆ’C(2) =0indicatingthatthereexistszerooronepathfromitoj whichcontradict
2 i j i,j i,j
tothefactthatâˆ£Piâ†j âˆ£â‰¥2.
For(ii),C(3)âˆ’C(2) â‰  0iscontradictedtoTheorem3thatC(3)âˆ’C(2) = 0whenC(3)âˆ’C(2) â‰  0.Bycombiningthesetwo
j,i j,i j,i j,i i,j i,j
cases,wecompletetheproof.
E ProofofTheorem5
Theorem5.
Foranytwovertexiandj,the2DsliceofjointcumulantC(n)satisfies:
i,j
C i( ,n j) =âˆ‘n k=âˆ’ 11 âˆ‘ ( m 1mn 2âˆ’ â‹¯1 m k)Î›Ëœ k(X iâ†X j). (E.1)
m1+â‹¯ m+ lm >k 0=nâˆ’1
where( nâˆ’1 )= (nâˆ’1)! isthemultinomialcoefficients.
m1m2â‹¯mk m1!m2!â‹¯mk!
Proof. Sinceiisnotarootvertex,thestructuralequationofX isX =âˆ‘ âˆ‘âˆ£Pmâ†iâˆ£Amâ†iâ—¦Ïµ +Ïµ ,whereAmâ†i is
i i mâˆˆAn(i) h=1 h m i h
thesequenceofcoefficientscorrespondingtotheh-thpathfromm,oneoftheancestorofi,toi.
AccordingthestructuralequationofX ,wehave:
i
â› â â›
âˆ£Pmâ†iâˆ£
â
C i( ,n j) =ÎºâœâœX i,X j,...,X jâŸâŸ=Îºâœâœ âˆ‘ âˆ‘ Am hâ†iâ—¦Ïµ m+Ïµ i,X j,...,X jâŸâŸ (E.2)
â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â  âmâˆˆAn(i) h=1 (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â 
thenwedecomposeC(n)accordingtothestructuralequationofX
,wehave:
i,j i
âˆ£Pmâ†iâˆ£
â› â â› â
C i( ,n j) = âˆ‘ âˆ‘ ÎºâœâœAm hâ†iâ—¦Ïµ m,X j,...,X jâŸâŸ+ÎºâœâœÏµ i,X j,...,X jâŸâŸ
mâˆˆAn(i) h=1 â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â  â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â 
(E.3)
âˆ£Pmâ†iâˆ£
â› â â› â
= âˆ‘ âˆ‘ ÎºâœâœAm hâ†iâ—¦Ïµ m,X j,...,X jâŸâŸ+ÎºâœâœÏµ i,X j,...,X jâŸâŸ
mâˆˆAn(i,j) h=1 â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â  â (cid:205)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) n(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) âˆ’(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) 1(cid:210)(cid:210)(cid:210)(cid:209) ti(cid:210) m(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) e(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210) s(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:207)â 
Asthosecumulantsinvolveindependentnoisecomponentsequaltozero,misthecommonancestorofiandj intheEq.(E.3).
Now,weconsiderthedecompositionofcumulant:(i)Îº(Amâ†iâ—¦Ïµ
,X ,...,X )and(ii)Îº(Ïµ ,X ,...,X ).For(i),the
h m j j i j j
termÎº(Amâ†iâ—¦Ïµ
,X ,...,X )hasthesimilarformasthecumulantweprovedinTheorem2,i.e.,
h m j j
âˆ£Pmâ†jâˆ£ âˆ£Pmâ†jâˆ£
Îº(Amâ†iâ—¦Ïµ ,X ,...,X )= âˆ‘ â‹¯ âˆ‘ Îº(Amâ†iâ—¦Ïµ ,Amâ†j â—¦Ïµ ,Amâ†j â—¦Ïµ ,...,Amâ†j â—¦Ïµ ) (E.4)
h m j j h m l1 m l2 m lnâˆ’1 m
l1=1 lnâˆ’1=1wheretheonlydifferenceisthefirstnoisecomponent,whichisAmâ†iâ—¦Ïµ
insteadofÏµ .Thisvariationdoesnotimpactthe
h m m
resultinTheorem2leadingto
Îº(Am hâ†iâ—¦Ïµ m,X j,...,X j)=n âˆ‘âˆ’1 âˆ‘ ( m mnâˆ’ â‹¯1 m )Î›m kâ†j (Am hâ†iâ—¦Ïµ m â†X j) (E.5)
1 2 k
k=1m1+â‹¯ m+ lm >k 0=nâˆ’1
For(ii),Îº(Ïµ ,X ,...,X )hasthesameformasthecumulantweprovedinTheorem2,wehave:
i j j
Îº(Ïµ i,X j,...,X j)=âˆ‘n k=âˆ’ 11 âˆ‘ ( m 1mn 2âˆ’ â‹¯1 m k)Î›i kâ†j (1â—¦X i â†X j). (E.6)
m1+â‹¯ m+ lm >k 0=nâˆ’1
SubstitutingEq.(E.5)andEq.(E.6)intoEq.(E.3),wehave
C i( ,n j) = âˆ‘ âˆ£P âˆ‘mâ†iâˆ£n âˆ‘âˆ’1 âˆ‘ ( m mnâˆ’ â‹¯1 m )Î›m kâ†j (Am hâ†iâ—¦Ïµ m â†X j)
1 2 k
mâˆˆAn(i,j) h=1 k=1m1+â‹¯ m+ lm >k 0=nâˆ’1
(E.7)
+âˆ‘n k=âˆ’ 11 âˆ‘ ( m 1mn 2âˆ’ â‹¯1 m k)Î›i kâ†j (1â—¦X i â†X j).
m1+â‹¯ m+ lm >k 0=nâˆ’1
ByrewritingEq.(E.7),wehave
C i( ,n j) =n kâˆ‘ =âˆ’ 11
m1+â‹¯
mâˆ‘
+ lm >k
0=nâˆ’1( m 1mn 2âˆ’ â‹¯1 m k)â¡ â¢â¢â¢â¢â¢â¢â¢â¢ â£mâˆˆAâˆ‘ n(i,j)âˆ£P hâˆ‘m =â† 1iâˆ£ Î›m kâ†j (Am hâ†iâ—¦Ïµ m â†X j)+Î›i kâ†j (1â—¦X i â†X j)â¤ â¥â¥â¥â¥â¥â¥â¥â¥
â¦
(E.8)
nâˆ’1 nâˆ’1
= âˆ‘ âˆ‘ ( m m â‹¯m )Î›Ëœ k(X i â†X j).
1 2 k
k=1m1+â‹¯ m+ lm >k 0=nâˆ’1
Thiscompletestheproof.
F ProofofTheorem6andTheorem7
Theorem6(IdentificationofPB-SCM). Ifthereexistk âˆˆZ+ suchthatÎ›Ëœ (X â†X )â‰ 0andÎ›Ëœ (X â†X )=0foranytwo
k i j k j i
adjacencyvertexiandj,thenX istheancestorofX
i j
Proof. ForthecasethatX isarootvertex.SupposeX isnottheancestorofX ,thenX andX areindependentsinceX is
i i j i j i
therootvertexandX isnottheancestorofX .Inthiscase,theÎ›Ëœ (X â†X )=0foreachksinceX andX areindependent.
j i k i j i j
ForthecasethatX isnotarootvertex.SupposeX isnottheancestorofX ,thentheremustexistkpathfromthecommon
i i j
ancestortoX sinceÎ›Ëœ (X â†X )â‰ 0.However,thiscontradictstheconditionÎ›Ëœ (X â†X )=0asitindicatesthattherenot
i k i j k j i
existkpathsfromthecommonancestortoX .Hence,weconcludethatX istheancestorofX .
i i j
Theorem7(GraphicalImplicationofIdentifiability). Forapairofverticesiandj,ifiisanancestorofj.Thecausalorder
of i,j is identifiable by Theorem 6, if (i) vertex i is a root vertex and âˆ£Piâ†j âˆ£ â‰¥ 2; or (ii) there exists a common ancestor
k âˆˆargmax{âˆ£Plâ†i âˆ£âˆ£lâˆˆAn(i,j)}hasadirectedpathfromktoj withoutpassingiinG.
l
Proof. (i)Ifvertexiisarootvertexandâˆ£Piâ†j âˆ£â‰¥2,wehave
Î›Ëœ (X â†X )=Î›iâ†j (1â—¦Ïµ â†X )â‰ 0
2 i j 2 i j
âˆ£Pjâ†iâˆ£ (F.1)
Î›Ëœ (X â†X )= âˆ‘ Î›jâ†i (Ajâ†iâ—¦Ïµ â†X )=0
2 j i 2 h i i
h=1
Sincethereareâ©¾2pathsfromitoj andnotwopathsfromitoi(fromnoisecomponentofitoi),wehaveÎ›Ëœ (X â†X )â‰ 0
2 i j
andÎ›Ëœ (X â†X )=0.BasedonTheorem6,iistheancestorofj.
2 j i
(ii)Accordingtotheacyclicconstraints,thenumberofpathsfromtheircommonancestorstoj iseitherequalormorethan
thenumberofpathsfromtheircommonancestorstoi,sinceiisanancestorofj andthosepathstoimustreachj.
Ifthereexistsacommonancestork âˆˆargmax{âˆ£Plâ†i âˆ£âˆ£lâˆˆAn(i,j)}hasadirectedpathfromktoj withoutpassingiinG,
l
itimpliesthatthenumberofpathsfromktojgreaterthanthattoi,Consequently,theremustexistavaluen=âˆ£Pkâ†j
âˆ£suchthat
Î›Ëœ (X â†X )â‰ 0andÎ›Ëœ (X â†X )=0,andthecausalorderofi,j isidentifiablebasedonTheorem6.
n i j n j iG ProofofTheorem8
Theorem8. LetG (s)bethePGFofrandomvariableX givenitsparentsvariableX ,wehave:
Xiâˆ£XPa(i) i Pa(i)
P(X
i
=kâˆ£X
Pa(i)
=x Pa(i))= k1 !âˆ‚kG X (i âˆ‚âˆ£X s)P ka(i)(s)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)s=0
= âˆ‘
Âµt iiexp(âˆ’Âµ i)
âˆ
(x j) tjÎ± jtj ,i(1âˆ’Î± j,i)xjâˆ’tj
,
(G.1)
t ! t !
ti+ âˆ‘ tj=k i jâˆˆPa(i) j
jâˆˆPa(i)
wheret â‰¤x ,(x ) = xj! isthefallingfactorial,Âµ =E[Ïµ ],andÏµ isthenoisecomponentofX .
j j j tj (xjâˆ’tj)! i i i i
Proof. ForprobabilitymassfunctionP(X âˆ£X ),whichcanbedecomposedasfollow:
i Pa(i)
P(X âˆ£X )=P(Ïµ ) âˆ P(Î± â—¦X âˆ£X ).
i Pa(i) i j,i j j (G.2)
jâˆˆPa(i)
LetG Ïµi(s)representtheprobabilitygeneratingfunction(PGF)ofP(Ïµ i),whichisthenoisecomponentofX i,andG Î±j,iâ—¦Xjâˆ£Xj(s)
denotethePGFofP(Î± â—¦X âˆ£X ),wehave:
j,i j j
G Xiâˆ£XPa(i)(s)=G Ïµi(s) âˆ G Î±j,iâ—¦Xjâˆ£Xj(s),
(G.3)
jâˆˆPa(i)
whereG Ïµi(s)=exp[Âµ i(sâˆ’1)]andG Î±j,iâ—¦Xjâˆ£Xj(s)=(1âˆ’Î± j,i+Î± j,is)Xj.
AccordingtothepropertyofPGF,wecancalculatetheprobabilitymassfunctionbytakingderivativesofG (s),and
Xiâˆ£XPa(i)
thederivativeisexpressedas:
âˆ‚kG Xiâˆ£XPa(i)(s)
=
âˆ‚k (G Ïµi(s)âˆ jâˆˆPa(i)G Î±j,iâ—¦Xjâˆ£Xj(s))
(G.4)
(âˆ‚s)k (âˆ‚s)k
Accordingtotheproductruleofhigherderivatives,i.e.
n (k) k n
(âˆf i) = âˆ‘ (
t ,t ,...,t
)âˆf i(ti)
1 2 n
i=1 t1+t2+â‹¯+tn=k i=1
(G.5)
k! n n f(ti)
= âˆ‘ âˆf(ti) =k! âˆ‘ âˆ i ,
t !t !â‹¯t ! i t !
t1+t2+â‹¯+tn=k 1 2 n i=1 t1+t2+â‹¯+tn=k i=1 i
wehave:
âˆ‚kG Xiâˆ£XPa(i)(s)
=k! âˆ‘
G( Ïµt ii) (s)
âˆ
G Î±(t jj ,) iâ—¦Xjâˆ£Xj(s)
. (G.6)
(âˆ‚s)k
ti+ âˆ‘ tj=k
t i!
jâˆˆPa(i)
t j!
jâˆˆPa(i)
Furthermore,wehave
G(ti) (s)=Âµtiexp(Âµ (sâˆ’1)),
Ïµi i i
G(tj) (s)={(X j) tjÎ± jtj ,i(1âˆ’Î± j,i)Xjâˆ’tj t j â©½X j . (G.7)
Î±j,iâ—¦Xjâˆ£Xj 0 t >X
j j
GivenX
i
=x i,X
Pa(i)
=x Pa(i),alongwiththemodelparameterÎ˜={A=[Î± i,j]âˆˆ[0,1]âˆ£Vâˆ£Ã—âˆ£Vâˆ£,Âµ=[Âµ i]âˆˆRâˆ£ â‰¥V 0âˆ£ },wecan
computetheprobabilitymassfunctionP(X âˆ£X )asfollow:
i Pa(i)P(X
i
=kâˆ£X
Pa(i)
=x Pa(i))= k1 !âˆ‚kG Xiâˆ£X (P âˆ‚a s(i ))= kxPa(i)(s)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)(cid:187)s=0
=
1
âˆ‘
G( Ïµt ii) (0)
âˆ
G Î±(t jj ,) iâ—¦Xjâˆ£Xj=xj(0)
k! t ! t !
ti+ âˆ‘ tj=k i jâˆˆPa(i) j
jâˆˆPa(i)
=
1
âˆ‘
G( Ïµt ii) (0)
âˆ
G Î±(t jj ,) iâ—¦Xjâˆ£Xj=xj(0) (G.8)
k! t ! t !
ti+ âˆ‘ tj=k i jâˆˆPa(i) j
jâˆˆPa(i)
= âˆ‘
Âµt iiexp(âˆ’Âµ i)
âˆ
(x j) tjÎ± jtj ,i(1âˆ’Î± j,i)xjâˆ’tj
,
t ! t !
ti+ âˆ‘ tj=k, i jâˆˆPa(i) j
jâˆˆPa(i)
wheret â©½x .Thiscompletestheproof.
j j
AcceleratingLikelihoodComputationUsingFFT
Tocomputethelikelihoodfunction,wehavetocalculatetheEq.(G.8).However,thistaskremainscomputationallyintensivedue
tothenumerousparametercombinationssatisfyingthespecificsummationconditiont + âˆ‘ t =kandt â©½x .
i j j j
jâˆˆPa(i)
Toaddressthisissue,weshowthatthelikelihoodinEq.(G.1)canbeformulatedastheproblemofobtainingthecoefficientof
apolynomialproduct.
Specifically,theproductionofpolynomialscanbeconstructedasfollows:
F(y)=(Âµ0
i
exp(âˆ’Âµ
i) +
Âµ1
i
exp(âˆ’Âµ
i) y+â‹¯+
Âµk
i
exp(âˆ’Âµ
i) yk
)
0! 1! k!
Ã— âˆ
((x j) 0Î± j,i(1âˆ’Î± j,i)xj
+
(x j) 1Î± j,i(1âˆ’Î± j,i)xjâˆ’1
y+â‹¯+
(x j) xjÎ± j,i(1âˆ’Î± j,i)xjâˆ’xj
yxj)
(G.9)
0! 1! x !
jâˆˆPa(i) j
ThenthelikelihoodinEq.(G.8)isexactlythecoefficientofykaftertheproduction.Toobtainthecoefficientofsuchproduction,
wecanemploytheFastFourierTransform(FFT).Indetail,wecancreateaseriesofvectorsofthecoefficientofeachpolynomial
in(G.9),andpadthelistwith0sincethehighestpowerofxiskÃ— âˆ£Pa(i)âˆ£:
â¡ â¤
a
0
=â¢â¢â¢â¢â¢â¢â¢â¢â¢Âµ0
i
exp 0( !âˆ’Âµ i) ,Âµ1
i
exp 1( !âˆ’Âµ i) ,...,Âµk
i
exp k( !âˆ’Âµ i)
, 0 (cid:205)(cid:210)(cid:210)(cid:210)(cid:210), (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210). (cid:210)(cid:210)(cid:209).. (cid:210)(cid:210)(cid:210), (cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)0
(cid:210)(cid:210)(cid:210)(cid:207)
â¥â¥â¥â¥â¥â¥â¥â¥â¥
â£ kÃ—âˆ£Pa(i)âˆ£âˆ’k+1timesâ¦
a
jp
=â¡ â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢ â£(x jp) 0Î± jp,i( 01 !âˆ’Î± jp,i)xjp ,(x jp) 1Î± jp,i(1 1!âˆ’Î± jp,i)xjpâˆ’1 ,...,(x jp) xjpÎ± jp,i( x1 jpâˆ’ !Î± jp,i)xjpâˆ’xjp
, kÃ—âˆ£Pa((cid:205)0
i(cid:210)
)(cid:210)(cid:210)(cid:210),
(cid:210)(cid:210) âˆ£(cid:210)(cid:210)(cid:210)(cid:210)(cid:210)
âˆ’. (cid:210)(cid:210)(cid:209). x. (cid:210)(cid:210)(cid:210),
(cid:210)(cid:210) j(cid:210)(cid:210)(cid:210)(cid:210)
p(cid:210)(cid:210)0
(cid:210)(cid:210)(cid:210)(cid:207)
+1timesâ¤ â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥
â¦
(G.10)
wherej âˆˆPa(i)andp=1,2,...,âˆ£Pa(i)âˆ£.ThenthecoefficientvectoroftheexpansionofEq.(G.9)isgivenby:
p
aË† =IFFT(FFT(a )âŠ™FFT(a )âŠ™â‹¯âŠ™FFT(a )) (G.11)
0 j1 j âˆ£Pa(i)âˆ£
Here,âŠ™istheelement-wisemultiplication,FFT(â‹… )andIFFT(â‹… )istheimplementationoffastFouriertransformandInversefast
Fouriertransformrespectively.Consequently,thek+1-thelementinthevectoraË†isthecoefficientofyk intheexpansionofEq.
(G.9),whichisthelikelihoodgivenEq.(G.8).
H AdditionalExperiments
ThemainpaperhasshowntheF1scoresandotherbaselinesinsyntheticdataexperiments.Here,wefurtherprovidethePrecision,
Recall,andStructuralHammingDistance(SHD)intheseexperiments,asshowninFig.3,Fig.4andFig.5.           
           
           
     $ O J R U L W K P      $ O J R U L W K P      $ O J R U L W K P
 3 %  6 & 0  3  3 %  6 & 0  3  3 %  6 & 0  3
 3 %  6 & 0  3 %  6 & 0  3 %  6 & 0
     3 &      3 &      3 &
 * ( 6  * ( 6  * ( 6
     2 & '      2 & '      2 & '
                                                                      
 $ Y J   , Q G H J U H H  5 D W H  1 X P E H U  R I  Y H U W L F H V  6 D P S O H  6 L ] H
(a) SensitivitytoAvg.IndegreeRate (b) SensitivitytoNumberofvertices (c) SensitivitytoSampleSize
Figure3:PrecisionintheSensitivityExperiments
           
           
           
     $ O J R U L W K P      $ O J R U L W K P      $ O J R U L W K P
 3 %  6 & 0  3  3 %  6 & 0  3  3 %  6 & 0  3
 3 %  6 & 0  3 %  6 & 0  3 %  6 & 0
     3 &      3 &      3 &
 * ( 6  * ( 6  * ( 6
     2 & '      2 & '      2 & '
                                                                      
 $ Y J   , Q G H J U H H  5 D W H  1 X P E H U  R I  Y H U W L F H V  6 D P S O H  6 L ] H
(a) SensitivitytoAvg.IndegreeRate (b) SensitivitytoNumberofvertices (c) SensitivitytoSampleSize
Figure4:RecallintheSensitivityExperiments
  
  
  
     
  
     
  
     
 $ O J R U L W K P  $ O J R U L W K P  $ O J R U L W K P
    3 %  6 & 0  3     3 %  6 & 0  3     3 %  6 & 0  3
 3 %  6 & 0  3 %  6 & 0  3 %  6 & 0
    3 &  3 &     3 &
  
 * ( 6  * ( 6  * ( 6
   2 & '  2 & '    2 & '
 
                                                                      
 $ Y J   , Q G H J U H H  5 D W H  1 X P E H U  R I  Y H U W L F H V  6 D P S O H  6 L ] H
(a) SensitivitytoAvg.IndegreeRate (b) SensitivitytoNumberofvertices (c) SensitivitytoSampleSize
Figure5:SHDintheSensitivityExperiments
Table1:SensitivitytothemaxorderofcumulantK
Scoretype
K
F1 Precision Recall SHD
2 0.69Â±0.04 0.56Â±0.05 0.90Â±0.05 23.38Â±3.88
3 0.82Â±0.06 0.82Â±0.08 0.83Â±0.06 9.53Â±2.71
4 0.82Â±0.06 0.82Â±0.07 0.83Â±0.06 9.47Â±2.78
5 0.83Â±0.05 0.82Â±0.07 0.84Â±0.05 9.47Â±2.68
 Q R L V L F H U 3
 O O D F H 5
 ' + 6
 Q R L V L F H U 3
 O O D F H 5
 ' + 6
 Q R L V L F H U 3
 O O D F H 5
 ' + 6