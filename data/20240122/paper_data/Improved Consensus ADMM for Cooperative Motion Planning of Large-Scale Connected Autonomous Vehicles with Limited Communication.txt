1
Improved Consensus ADMM for Cooperative
Motion Planning of Large-Scale Connected
Autonomous Vehicles with Limited Communication
Haichao Liu, Zhenmin Huang, Zicheng Zhu, Yulin Li, Shaojie Shen, and Jun Ma
Abstractâ€”This paper investigates a cooperative motion plan-
ning problem for large-scale connected autonomous vehicles
(CAVs) under limited communications, which addresses the
challenges of high communication and computing resource re-
quirements. Our proposed methodology incorporates a parallel
optimizationalgorithmwithimprovedconsensusADMMconsid-
ering a more realistic locally connected topology network, and Â·
timecomplexityofO(N)isachievedbyexploitingthesparsityin
the dual update process. To further enhance the computational
efficiency, we employ a lightweight evolution strategy for the
dynamicconnectivitygraphofCAVs,andeachsub-problemsplit ğ‘¥
fromtheconsensusADMMonlyrequiresmanagingasmallgroup
of CAVs. The proposed method implemented with the receding ğ‘¦
horizon scheme is validated thoroughly, and comparisons with
existing numerical solvers and approaches demonstrate the effi- Â· Communication Range
ciencyofourproposedalgorithm.Also,simulationsonlarge-scale Subgraph of CAVs
cooperative driving tasks involving 80 vehicles are performed
in the high-fidelity CARLA simulator, which highlights the
remarkablecomputationalefficiency,scalability,andeffectiveness Fig.1. Demonstrationoftheproposedcollaborativemotionplanningstrategy
ofourproposeddevelopment.Demonstrationvideosareavailable forlarge-scaleCAVsinurbandrivingscenarios.Theproblemisformulated,
where one optimal control problem is constructed within each subgraph
at https://henryhcliu.github.io/icadmm cmp carla.
(orange region) and solved by the improved consensus ADMM algorithm.
IndexTermsâ€”Connectedautonomousvehicles(CAVs),cooper- The subgraphs are generated by the proposed graph evolution algorithm, in
ativemotionplanning,alternatingdirectionmethodofmultipliers which the edges of the dynamic connectivity graph are created within each
(ADMM), iterative linear quadratic regulator (iLQR). blueregioncenteredbyeachCAVwithinaspecifiedsubgraph.
I. INTRODUCTION achieving cooperative driving is a multi-faced endeavor that
involves various essential aspects, including environmental
Recent developments in wireless communications and in-
perception[5],globalpathgeneration[6],motionplanning[7],
telligent transportation systems, particularly the integration of
trajectory tracking control [8], etc. Within the framework of
autonomous driving with vehicle-to-everything (V2X) tech-
cooperativemotionplanning,CAVscollaborativelymakejoint
nologies, have provided valuable insights in addressing ur-
decisions and subsequently generate cooperative trajectories
ban transportation challenges [1], [2]. Additionally, advanced
aimed at optimizing overall system performance and ensuring
planning and control methodologies for multi-agent systems
safe and efficient maneuvers. However, the incorporation of
have shown significant potential in the field of autonomous
various key factors, such as inter-vehicle collision avoidance,
vehicles [3], [4]. As a result, connected autonomous vehicles
vehiclemodel,andvariousphysicalconstraints,renderscoop-
(CAVs) have emerged as a promising technological solution
erative motion planning a challenging task. This is especially
for reducing traffic congestion, preventing accidents, and
evident when dealing with a larger number of CAVs or
enhancing both driving safety and efficiency. Significantly,
when operating in complex traffic environment. To address
thecooperativemotionplanningproblemforCAVs,aseriesof
HaichaoLiu,ZhenminHuang,YulinLi,andJunMaarewiththeRobotics
and Autonomous Systems Thrust and the Department of Electronic and representative works have been presented, drawing inspiration
Computer Engineering, The Hong Kong University of Science and Tech- from advancements in both learning-based and optimization-
nology, China (e-mail: hliu369@connect.ust.hk; zhuangdf@connect.ust.hk;
based methodologies [9].
yline@connect.ust.hk;jun.ma@ust.hk).
Zicheng Zhu is with the Department of Electrical and Com- The use of learning-based algorithms, represented by rein-
puter Engineering, National University of Singapore, Singapore (e-mail: forcementlearning(RL),hasbecomeprevalentintacklingmo-
zhuzicheng@u.nus.edu)
tionplanningproblems[10],[11].Inthecontextofmulti-agent
ShaojieSheniswiththeDepartmentofElectronicandComputerEngineer-
ing, The Hong Kong University of Science and Technology, China (e-mail: path finding, PRIMAL serves as a decentralized framework
eeshaojie@ust.hk). thatplansefficientsingle-agentpathsbyimitatingacentralized
This work has been submitted to the IEEE for possible publication.
expert through imitation learning, thereby facilitating implicit
Copyright may be transferred without notice, after which this version may
nolongerbeaccessible. coordination during online path planning [12]. Despite its
4202
naJ
71
]OR.sc[
1v23090.1042:viXra2
scalabilitytolargerteams,PRIMALsuffersfromperformance the performance comparable to that of algorithms under the
deteriorationinstructuredanddenselyoccupiedenvironments perfect communication [28]. On the other hand, decentralized
that require substantial efforts in coordination of agents. To methods have also been explored, utilizing ADMM applied
address this limitation, drawing inspiration from slime mold, to the dual of the resource allocation problem, where each
RL-APCP3 presents an effective solution to the deterioration agent exchanges information solely with its neighbors [25],
problem in dense maps using bionic SARSA algorithm [13]. [29]. The convergence of this method has been proven, and
Specifically for CAVs, a learning-based iterative optimization its effectiveness has been illustrated through numerical exam-
algorithm was used to explore the collision-free cooperative ples. Building upon the aforementioned algorithm, the ND-
motion planning problem for CAVs at unsignalized intersec- DDP algorithm was presented, where an efficient three-level
tions[14].Inaddition,anovelmulti-agentbehavioralplanning architecture was proposed employing ADMM for consensus
schemeforCAVswasinvestigatedbyexploitingRLandgraph and DDP for scalability [30]. With this approach, only local
neural networks at urban intersections, which improves the communication is required. However, these solutions, which
vehicle throughput significantly [15]. However, the learning- focus on commuting with neighbors, exhibit long compu-
based methods typically require substantial real-world data tational time when the number of agents increases. Also,
and may be limited by their interpretability, restricting their these approaches only consider a graph that does not evolve
generalization to a wider range of traffic scenarios. with time, where the assigned neighbors of each agent are
Alternatively, optimization-based approaches commonly assumed to be fixed. Yet in the real-world urban driving
adopt an optimal control problem (OCP) formulation for scenarios,thetopologynetworkbetweenvehiclesisspatiotem-
motion planning tasks. This approach offers several bene- porally dynamic, with each node experiencing constantly fast
fits such as providing a precise mathematical representation, changing neighborhoods throughout the driving process [31].
ensuring interpretability, and proving optimality [16]. When Nonetheless,maintainingadynamicconnectivitygraphwithin
dealing with cooperative motion planning problems involving the whole planning horizon is challenging considering the
CAVs with nonlinear vehicle models, these OCPs can be uncertainty in the future trajectories of all vehicles. For-
typicallysolvedusingwell-establishednonlinearprogramming tunately, receding horizon frameworks formulated with the
solvers such as interior point optimizer (IPOPT) and sequen- model predictive control (MPC), offer the potential for more
tial quadratic programming (SQP). Additionally, the iterative robust driving performance [32], [33]. Nonetheless, solving
linear quadratic regulator (iLQR) leverages the benefits of a centralized MPC problem involving all the agents is rather
differential dynamic programming (DDP) for addressing non- time-consuming [34]. Alternatively, the distributed MPC has
linear optimization problems, while retaining only the first- alsobeenwidelydeployed[35],[36],inwhicheachagentonly
order term of dynamics through Gauss-Newton approxima- considers its own objective thereby obviously reducing the
tion to enhance the computational efficiency [17]. While the scale of optimization. In [37], a partially parallel computation
traditional iLQR algorithm is effective and efficient in han- frameworkisproposedtosolvethemulti-agentMPCproblem
dling system dynamic constraints, this method cannot directly basedonADMM.However,evenifallagentscanbedeployed
address various inequality constraints entailed by collision in a distributed manner, the collision avoidance requirements
avoidance requirements and other physical limitations. To (which naturally lead to the coupling effects among agents)
overcome this limitation, many representative works have result in a dramatic increase in the number of constraints to
been presented to cope with inequality constraints within the the optimization problem. Therefore, all these aforementioned
DDP/iLQR framework, including control-limited DDP [18], methodssufferfromsignificantcomputationalburdens,render-
[19] and constrained iLQR [20]â€“[22]. To further reduce the ing them difficult to deploy in large-scale CAVs. Apparently,
computational burden, especially for large-scale systems, the to establish an efficient cooperative driving framework for an
alternating direction method of multipliers (ADMM) was excessive number of CAVs, necessary efforts are required to
developed by decomposing the original optimization problem decompose the overall OCP into a series of fully parallel and
intoseveralsub-problems[23].Withitsparallelanddistributed solvable sub-problems, such that the problem can be solved
characteristics, the ADMM can be well-suited to address efficiently.
the cooperative motion planning problem for CAVs [24]. Driven by the aforementioned challenges, this paper intro-
Leveraging the dual consensus ADMM [25], a fully paral- duces an improved consensus ADMM for cooperative motion
lel optimization framework was established for cooperative planningoflarge-scaleCAVswithlocallyconnectedtopology
trajectory planning of CAVs, which effectively distributes the network, together with a graph evolution strategy to limit the
computationalloadevenlyamongallparticipants,allowingfor scale of each OCP corresponding to each subset of the CAVs.
real-time performance [26]. Theoverviewoftheproposedmethodologyisdemonstratedin
However, the aforementioned works rely on a strong as- Fig. 1. Particularly, to achieve high computational efficiency,
sumptionoffullyconnectedtopologynetworkbetweenCAVs, we transform and decouple the inter-vehicle constraints and
which is not applicable in real-world driving conditions under leverageparallelsolvingcapabilitiesoftheADMM.Moreover,
V2Xcommunication,duetohighdelaysandlowtransmission we reduce the complexity of the dual update process by
reliability associated with long-range and large-scale V2X capturingthesparsityoftheproblemandderivingasimplified
communication [27]. To address the communication delays, equivalentform.Furthermore,weimproveitsreal-timeperfor-
the QuAsyADMM algorithm that incorporates a finite time mance by limiting the scale of the optimization problem by
quantized averaging approach was proposed, and it achieves integrating the dynamic graph evolution algorithm.3
The key contributions of this work are as follows: III. PROBLEMFORMULATION
â€¢ An improved consensus ADMM algorithm is introduced A. Representation of CAVs with Graph Theory
to solve the cooperative motion planning problem with The relationship of CAVs can be represented using graph
a locally connected topology network, such that the theory, where nodes represent individual vehicles and edges
problem is decomposed into a series of sub-problems representcommunicationlinksbetweenthem.Thisrepresenta-
that can be solved in a parallel manner. This algorithm tionallowsforacomprehensiveanalysisofthecommunication
achievesacomplexityofO(N)byexploitingthesparsity relationships among CAVs. Let G = (V,E) be an undirected
in the dual update process. graph,whereV representsthesetofvehiclesandE represents
â€¢ A graph evolution strategy for a dynamic connectivity the set of communication links between nodes. Each vehicle
graphofCAVsispresentedtocharacterizetheinteraction ni âˆˆ V is associated with a state vector zi and a control
patterns among CAVs, and each sub-problem attempts input vector ui. It is pertinent to note that according to the
to manage a small group of CAVs. In this sense, the relative locations of the CAVs, the subgraphs of G are noted
computational efficiency can be further enhanced. as H, evolved between the planning horizons of cooperative
â€¢ A closed-loop framework for cooperative motion plan- driving. Particularly, even in the same subgraph, the vehicle
ning is then proposed, which integrates the graph evo- ni only exchanges information with its surrounding vehicles
lution in a receding horizon fashion. This enhances the within a certain communication range. For clarification, we
ability of consensus ADMM to cope with large-scale denote the number of CAVs in the whole traffic system as
CAVs and provides a more robust driving performance. M. Accordingly, the distance matrix D = [a ] âˆˆ RMÃ—M
ij
â€¢ Real-time performance and superiority of our proposed with i,j âˆˆ {1,2,Â·Â·Â· ,M} of the whole connectivity graph G
method is demonstrated through numerical simulations. can be formulated. The number of CAVs in each subgraph
The large-scale cooperative motion planning simulations H = (N ,E ) is denoted as N . Note that we omit the
k k k,h k
involving 80 CAVs are executed in a high-fidelity urban subscript k (the index of a subgraph) of the above notations
map in CARLA, and the results showcase the effective- by default for simplicity. As shown in Fig. 1, for each pair of
ness and robustness of our proposed methodology. vehicles, an edge (ni,nj) = di,j âˆˆ E âŠ† E is established if
h
the distance between the pair of vehicles di,j is smaller than
The rest of this paper is organized as follows: Section II
the communication range ri âˆˆ R . In addition, we define
providesthedefinitionsofnotations.InSectionIII,wepresent tele +
thecardinalityofanodeni inHas|ni|=deg(ni),describing
the CAVsâ€™ connectivity pattern using graph theory and for-
the number of indices of the connected non-self nodes in
mulate the cooperative motion planning problem. Section IV
reformulates the problem and an improved consensus ADMM Ni ={j âˆˆN |(i,j)âˆˆE }. (1)
h
is proposed. In Section V, we present a closed-loop receding
The above representation offers clear and logical insights into
horizon-based cooperative motion planning strategy based on
the connectivity and communication patterns among CAVs,
our graph evolution algorithm. In Section VI, we demonstrate
thereby aiding the practical implementation of decentralized
theperformanceoftheproposedmethodologythroughaseries
cooperative motion planning algorithms.
of simulations. Section VII presents the conclusion.
B. Vehicle Model
For all CAVs, the non-linear bicycle kinematics model in
II. NOTATIONS [38] is used. The state vector of a vehicle is z =[x,y,Î¸,v]T,
where x and y are the positions of the rear axle of the vehicle
We use the lowercase letter and uppercase letter to rep-
from xâˆ’axis and yâˆ’axis in the global Cartesian map, Î¸ and
resent a vector x âˆˆ Rn and a matrix X âˆˆ RnÃ—m, re-
v are the heading angle (from the positive direction of the
spectively. Also, diag{a ,a ,Â·Â·Â· ,a } represents a diagonal
1 2 n x-axis) and velocity of the vehicle, respectively. The control
matrixwitha i,iâˆˆ{1,2,Â·Â·Â· ,n}asdiagonalentries.Similarly, inputvectorisu=[a,Î´]T,whereaandÎ´ aretheacceleration
blocdiag{A ,A ,...,A } is used to represent a block diag-
1 2 n and steering angle of the front wheel, respectively. Then, the
onal matrix with block diagonal entries A ,A ,...,A . The
1 2 n vehicle model can be expressed as:
setsofnon-negativeintegersandrealnumbersarerepresented ï£® ï£¹
as Z and R , respectively. A logical/Boolean matrix is x Ï„ +f i(v Ï„,Î´ Ï„)cosÎ¸ Ï„
+ +
denoted as B. [Â·]i represents the variable of the ith CAV, z =f(z ,u )=ï£¯ ï£¯ y Ï„ +f i(v Ï„, (cid:16)Î´ Ï„)sinÎ¸ Ï„ (cid:17) ï£º ï£º, (2)
while[Â·] Ï„ indicatesthevariableattimestepÏ„.Forsimplicity, Ï„+1 Ï„ Ï„ ï£¯ ï£° Î¸ Ï„ +arcsin g(vÏ„ bi,Î´Ï„) ï£º ï£»
a matrix concatenated in row [s1,s2,Â·Â·Â· ,sn] is denoted as v +Ï„ a
Ï„ s Ï„
[si],i = 1,2,Â·Â·Â· ,n. On the contrary, we denote the matrix
where g(v,Î´)=v âˆ†T sin(Î´ ), f (v,Î´) is defined as:
withentriessi concatenatedbycolumnas[s1;s2;...;sn].The Ï„ Ï„ i
(cid:113)
squared weighted L 2-norm xTMx is simplified as âˆ¥xâˆ¥2 M. f i(v,Î´)=b i+vâˆ†T cosÎ´âˆ’ b2
i
âˆ’g(v,Î´)2, (3)
We denote an indicator function w.r.t. a set X âˆˆ Rn as
I (x), which takes value 0 if x âˆˆ Rn belongs to X and where b i is the wheelbase of the ith CAV and âˆ†T =0.1 s. In
X
addition,weformulatetwomatricestodenotethestatevectors
+âˆ otherwise.Element-wise maximizationand minimization
and control inputs of the ith CAV by
operations for the vectors a and b are denoted as max{a,b}
and min{a,b}, respectively. Zi ={zi,zi,...,zi },Ui ={ui,ui,...,ui }.
0 1 T 0 1 Tâˆ’14
ğ‘¦ ğ‘¦$ ğ‘¦$ ğ‘¦$$
ğ’‘!,â€™
ğ’‘!,&
ğ‘Ÿ! ğ’‘)!#,& ğ’‘)!#,â€™
ğœƒ"! Constraint
ğ‘Ÿ! Rotation Transformation Scaling
CAV i CAV i CAV i CAV i
ğ‘#
ğ’‘# ğœƒ"# ğ‘¥$ ğ‘Ÿ! ğ‘# ğ’‘# ğ‘¥$ ğ‘¥$$
ğ‘# ğ‘# 1
CAV j CAV j CAV j
CAV j ğ‘¥
Fig.2. Geometricrelationshipandtransformationforinter-vehiclecollisionavoidance,inwhichthetwoCAVsinapairareenwrappedwithadoublecircle
andanellipse,respectively.TheradiusofCAViisri,whilethelengthofsemi-majorandsemi-minoraxesofCAVjareaj andbj,respectively.Therotation
anglebetweentheglobalcoordinatesystemandthea-paralleledcoordinatesystemisthesameastheheadingangleoftheÎ¸j.Aftertheabovetransformation,
thecollisiondiscriminantbecomesjudgingwhetherapointiswithinaunitcircle.
C. Cooperative Motion Planning with Communication Limits andthecriterionforcollisiondetectionisthedistancebetween
each pair of circles. For instance, to construct the safe region
This work considers a cooperative motion planning task in
Si, if there are |ni|=Ni CAVs around ith CAV, there would
one subgraph H where N CAVs drive on the urban road with Ï„
be 22Ni pairs of constraints that need to be considered.
their destinations and global path. Assuming all the vehicles
Alternatively, we can reduce the number of above con-
share the same control and velocity limits, we formulate this
straintsbymodelingcertainCAVs,suchasaCAVwithalower
problem as an OCP:
orderinapairofCAVs,asellipses[39],whilerepresentingthe
min (cid:80)N i=1Q i(Zi,Ui) other CAV in the pair as double circles. This would decrease
z Ï„i,ui Ï„ the constraints number by 2Ni for constructing the Si. For
s.t. zi =f(zi,ui), Ï„
Ï„+1 Ï„ Ï„ a CAV pair (ni and nj) using the above description, we
zi âˆˆSi,
âˆ’Ï„ u+ i1 âª¯uiÏ„ âª¯ui, (4) formulate the following constraints for inter-vehicle collision
Ï„ avoidance:
âˆ’zi âª¯zi âª¯zi,
Ï„
âˆ’zi âª¯z Ti âª¯zi, (xË†j Ï„ âˆ’xË†i Ï„,c)2 + (yË† Ï„j âˆ’yË† Ï„i,c)2 â‰¥1,
âˆ€Ï„ âˆˆT, âˆ€iâˆˆN, (aj +ri)2 (bj +ri)2 (6)
âˆ€câˆˆC,j âˆˆNi,iâˆˆN,Ï„ âˆˆT,
where N represents the set of index of CAVs in the traffic
systemofasubgraphH.T ={0,1,...,Tâˆ’1}isthetemporal where xË† and yË† means the rotated position w.r.t. the xâ€² âˆ’yâ€²
horizon within a cooperative motion planning episode. In coordinate parallel to the semi-major axis a of the ellipse (a-
addition, Si is the collision-free region of the ith CAV at parallelled coordinate) of (x,y), C ={0,1} denotes the front
Ï„
timestepÏ„,whichwillbedefinedinSectionIII-D.ui andui and rear circle of a CAV, Ni âˆˆ Zdeg(ni) denotes the index
+
mean the lower and upper bound of the control input for ith
set of the neighbor CAVs within the communication range
CAV, respectively. Similar meanings take effect on zi and zi. ri of the ith CAV. The discriminant (6) comes into effect
tele
Moreover, the objective of this OCP is to follow the
for the following reason. In Fig. 2, we can observe that after
referencetrajectoriesgeneratedbyanefficientsampling-based
applyingrotationandtranslationtransformationstoalignwith
algorithm. For an individual vehicle, it can be expressed as
the a-paralleled coordinate system, the origin is the center
T Tâˆ’1 of the CAV nj and the xâ€²-axis is parallel to the semi-major
(cid:88) (cid:88)
Q (Zi,Ui)= âˆ¥zi âˆ’zi âˆ¥2 + âˆ¥uiâˆ¥2 , (5) axis of the CAV nj. Then we proceed to enlarge the ellipse
i Ï„ ref,Ï„ Q Ï„ R
Ï„=0 Ï„=0 by the radius of the circles ri encapsulating the other CAV.
Consequently, we utilize the coordinates of the circle centers
where the weighted matrices are Q=diag{q ,q ,q ,q } and
x y Î¸ v
in (6) to assess whether these centers fall within the enlarged
R=diag{q ,q }. The expected outcome of the optimization
Î´ a
ellipse.Ifthisconditionismet,itsignifiesacollisionbetween
problem (4) is to cooperatively follow the reference states
the two CAVs. We will make the scaling transformation to
with different weights while complying with vehicle model
andstayinginthesaferegionSi toavoidcollisionswitheach make a more compact constraint form in Section IV-B.
Ï„
For the coordinate transformation of the CAVâ€™s position
other.
from the global coordinate to the a-parallelled coordinate, the
following equation is given:
D. Inter-Vehicle Collision Avoidance of CAVs
(cid:20) cosÎ¸j sinÎ¸j (cid:21)
Under connected conditions, assume each CAV can receive pË†k = Ï„ Ï„ Â·pk =Rj Â·pk, (7)
Ï„ âˆ’sinÎ¸j cosÎ¸j Ï„ Ï„ Ï„
real-time information from its neighbors in Ni in a certain Ï„ Ï„
range and collaborate to generate maneuvers that prevent where pË†k =[xË†k,yË†k]T is the position of the kth vehicle under
Ï„ Ï„ Ï„
collisions. Typically, vehicles are represented as two circles, thea-parallelledcoordinate,whilepk isthepositionunderthe
Ï„5
After the global reference waypoints are obtained, the local
reference waypoints can be determined utilizing a Nearest
Neighbor Search mechanism for updating the reference tra-
jectory of each CAV. Concretely, at each time step, each CAV
searches for the nearest waypoint using a KD-tree formulated
by the waypoints in its rough reference trajectory.
Remark 2. The utilization of the KD-tree data structure is
shown to be highly efficient, particularly when dealing with a
largenumberofwaypoints.Thisguidancewaypointsearching
process minimally impacts the efficiency of the cooperative
motion planning algorithm while offering a more robust and
comfortable riding experience.
Possible Collision Area B. Convexification and Reformulation
Inthissection,weassumethatalltheCAVsareallocatedto
Fig.3. Smoothedguidancetrajectoriesforcooperativemotionplanning.We
the same subgraph H. To achieve fully decentralized motion
generate these trajectories by sampling the road topology information from
theOpenDRIVEmap.Eachvehicleâ€™strajectoryisvisuallyrepresentedbydots planning for the CAVs efficiently, the objective function of
ofdifferentcolors.Theplottedguidancetrajectoriesunveilpotentialcollision the OCP should be convexified, and the constraints should be
conflictsthatmayarisewithintheintersectionarea.
linearized [26]. In this paper, we transform the optimization
variables from zi and ui to perturbed forms âˆ†zi and âˆ†u .
Ï„ Ï„ Ï„ Ï„
global xâˆ’y coordinate in Fig. 2. Another notation Rj is the Firstly, the vehicle model can be linearized by first-order
Ï„
transformation matrix to the a-paralleled coordinate. Besides, Taylor expansion:
if given the center position pi of the CAV ni, the center
Ï„ âˆ†zi =Aiâˆ†zi +Biâˆ†ui, (9)
positions of the front and rear circles are expressed as: Ï„+1 Ï„ Ï„ Ï„ Ï„
(cid:20) cosÎ¸i (cid:21) where Ai Ï„ = âˆ‚f(cid:0) z Ï„i,ui Ï„(cid:1) /âˆ‚z Ï„i, B Ï„i = âˆ‚f(cid:0) z Ï„i,ui Ï„(cid:1) /âˆ‚ui Ï„ are
pi,c =pi Â± Ï„ di,c. (8) the partial derivatives of the vehicle model.
Ï„ Ï„ sinÎ¸i
Ï„ Secondly, the inter-vehicle collision avoidance constraints
Clearly, There are two circles pi,0 and pi,1 that need to be between pairs of vehicles can be rewritten and convexified
Ï„ Ï„
transformed. The centers of these circles can be transformed as follows. We define the following function with perturbed
using (7), which involves replacing pk Ï„ with pi Ï„,c. With this, variable vector âˆ†pk Ï„ = [âˆ†xk Ï„,âˆ†yk Ï„]âŠ¤ as the discriminant for
the transformed positions of the circles, pË†i,0 and pË†i,1, can be inter-vehiclecollisionavoidanceinthea-paralleledcoordinate:
Ï„ Ï„
obtained. Additionally, the distance of the cth circle to the f (zj,zi,c)=kijâˆ†pij +âˆ¥pijâˆ¥ âˆ’d ,
center of the ith CAV is denoted by di,c. S Ï„ Ï„ Ï„ Ï„ Ï„ 2 safe (10)
âˆ€câˆˆC,iâˆˆNj,j âˆˆNi,Ï„ âˆˆT+,
IV. COOPERATIVEMOTIONPLANNINGWITHLIMITED where kij = pi Ï„j is a unit vector for projective transforma-
COMMUNICATIONVIAIMPROVEDCONSENSUSADMM tion of
tÏ„
he
peâˆ¥ rp tui Ï„j râˆ¥
bed displacement to the direction from the
A. Guidance Trajectory Generation and Dynamic Search ith CAV to the j th one, d safe â‰¥ 1 is the obstacle avoidance
margin,T+ ={0,1,...,T},pij istherelevantpositionofthe
In the rough trajectory generation process, waypoints are Ï„
pair of CAVs, and it can be calculated by:
sampled along the center line of lanes with equal intervals
in the OpenDRIVE format map. As illustrated in Fig. 3, pij =SijRj(pi,câˆ’pj), (11)
Ï„ Ï„ Ï„ Ï„
use the same approach in [33], for any starting point xs =
where Sij = diag{ 1 , 1 }. Given the state vectors zj
[ps,ps,Ï†s]âŠ¤,Aâˆ— searchcanbeperformedontheconnectivity aj+ri bj+ri Ï„
x y and zi as the working points, the perturbed relevant position
graph to obtain the shortest path leading to the target destina- Ï„
tion xt =[pt,pt,Ï†t]âŠ¤. Note that we use the Savitzky-Golay âˆ†pi Ï„j can be calculated by:
x y
filtertoimprovethecontinuityandsmoothnessofthesearched âˆ‚pij âˆ‚pij
âˆ†pij = Ï„ âˆ†zj + Ï„ âˆ†zi. (12)
path, which makes the distribution of waypoints more even, Ï„ âˆ‚zj Ï„ âˆ‚zi Ï„
Ï„ Ï„
especially around intersections, corners, and regions for lane
Plugging(7),(8),and(11)to(12),thepartialderivativeofthe
changing.
CAV nj at time step Ï„ is
Remark 1. For cooperative motion planning problems, the
âˆ‚pÂ¯ij âˆ‚Rjpic âˆ‚Rjpj
temporal trajectories of CAVs may not always be strictly fol- Ï„ =Sij Ï„ Ï„ +Sij Ï„ Ï„
lowed due to the influence of surrounding vehiclesâ€™ behavior. âˆ‚z Ï„j âˆ‚z Ï„j âˆ‚z Ï„j
To address this, it becomes necessary to enable CAVs to =Sij(cid:18)(cid:20) 0 0 âˆ’sinÎ¸ Ï„jxi Ï„,+cosÎ¸ Ï„jy Ï„i,c 0 (cid:21)
automatically follow an appropriate waypoint based on their 0 0 âˆ’cosÎ¸jxi,câˆ’sinÎ¸jyi,c 0
Ï„ Ï„ Ï„ Ï„
current state. One approach to achieving this is by searching (cid:20) cosÎ¸j sinÎ¸j âˆ’sinÎ¸jxj +cosÎ¸jyj 0 (cid:21)(cid:19)
âˆ’ Ï„ Ï„ Ï„ Ï„ Ï„ Ï„ ,
for the nearest waypoint that the vehicle should follow. âˆ’sinÎ¸j cosÎ¸j âˆ’cosÎ¸jxj âˆ’sinÎ¸jyj 0
t Ï„ Ï„ Ï„ Ï„ Ï„6
while the partial derivative of the CAV ni at time step Ï„ is With a similar expression, the vehicle model (9) can be
described by
âˆ‚pÂ¯ij âˆ‚pi,c
Ï„ =SijRj Ï„ (Li âˆ’Li)âˆ†Zi =0, (18)
âˆ‚zi Ï„ âˆ‚zi 3 4
Ï„ Ï„
=SijRj (cid:20) 1 0 âˆ“diÂ·csinÎ¸ Ï„i 0 (cid:21) , whereLi 3 =blocdiag{[Ai 0 B 0i],[Ai 1 B 1i],Â·Â·Â· ,[Ai Tâˆ’2 B Ti âˆ’2],
Ï„ 0 1 Â±diÂ·ccosÎ¸ Ï„i 0 [Ai
Tâˆ’1
B Ti
âˆ’1
04Ã—4]} âˆˆ R(4T)Ã—(6T+4) and Li
4
=
blocdiag{[04Ã—4 04Ã—2 I4],[04Ã—2 I4],Â·Â·Â· ,[04Ã—2 I4]} âˆˆ
where for the front and rear circles of the ith CAV, the
R(4T)Ã—(6T+4). Then, we define the solution set of the lin-
thirdcolumnelementsinthederivativematriceshaveopposite
signs. The vehicle is in the safe set Si if f (pË†j,pË†i,c) â‰¥ 0. earized vehicle model as
Ï„ S Ï„ Ï„
Therefore, with the new notation of
SD ={âˆ†Zi|(Li âˆ’Li)âˆ†Zi =0}, (19)
3 4
(cid:18) âˆ‚Rjpic âˆ‚Rjpj(cid:19)
J ij cÏ„ =k Ï„ijSij âˆ‚zÏ„ jÏ„ + âˆ‚zÏ„ j Ï„ , (13) which is nonempty, closed, and convex. In conclusion, when
Ï„ Ï„ combining the indicator function related to SD with the cost
âˆ‚pi,c associated with the host, the resulting expression can be
Ji,c =kijSijRj Ï„ , (14)
jÏ„ Ï„ Ï„ âˆ‚zi written as:
Ï„
the discriminant of the safety indicator is approximated as: Fi(âˆ†Zi)=FÂ¯i(âˆ†Zi)+I (âˆ†Zi). (20)
SD
âˆ¥SijRj(pi,câˆ’pj)âˆ¥ +Jj âˆ†zj+Ji,câˆ†ziâˆ’d â‰¥0, (15)
Ï„ Ï„ Ï„ 2 icÏ„ Ï„ jÏ„ Ï„ safe Afterward, we formulate the inter-vehicle collision avoid-
where j âˆˆNi, iâˆˆNj, câˆˆC, and Ï„ âˆˆT+. anceconstraintsandvehiclephysicalconstraints.Wecombine
the inequality constraints into another indicator function I
Third, the vehicle state and control input constraints w.r.t K
corresponding to the feasible set of (15) and (16). For inter-
the perturbed variables âˆ†z and âˆ†u can be written as:
vehicle collision avoidance constraints, the Jacobian matrices
ziâˆ’zi â‰¤âˆ†zi â‰¤ziâˆ’zi,
in(13)and(14)shouldbeconcatenatedinthefollowingorder.
Ï„ Ï„ Ï„ (16)
uiâˆ’ui â‰¤âˆ†ui â‰¤uiâˆ’ui. For ith CAV, its concatenated Jacobian at time step Ï„ is
Ï„ Ï„ Ï„
All the constraints of the original cooperative problem (4) are Ji =(cid:2) aâŠ¤(cid:3)âŠ¤ âˆˆRN(Nâˆ’1)Ã—4, (21)
Ï„ jk 1â‰¤j<kâ‰¤N
linearized and transformed by (9), (15), and (16).
Lastly, the quadratic objective function in (4) w.r.t. the where according to (13) and (14), a can be expressed as
jk
perturbed independent variables âˆ†zi can be derived by the
Ï„ ï£± [Ji ;Ji ] j =i
second-order Taylor Expansion, which can be described as: ï£² k0Ï„ kiÏ„
a = [Ji,0;Ji,1] k =i (22)
QÂ¯i Ï„(âˆ†z Ï„i,âˆ†ui Ï„)â‰ˆQi Ï„(z Ï„i,ui Ï„)+âˆ†ui Ï„âŠ¤Qi Ï„,u+âˆ†z Ï„iâŠ¤Qi Ï„,z jk ï£³ 02j Ã—Ï„ 4 jÏ„ otherwise.
1 1
+ 2âˆ†ui Ï„âŠ¤Qi Ï„,uuâˆ†ui Ï„ + 2âˆ†z Ï„iâŠ¤Qi Ï„,zzâˆ†z Ï„i, With the expression of the Jacobian Ji, we define JË†i =
Ï„
blocdiag{[Ji 0N(Nâˆ’1)Ã—2],Â·Â·Â· ,[Ji 0N(Nâˆ’1)Ã—2],Ji}.Fur-
where Ï„ âˆˆT, Qi(âˆ†zi,âˆ†ui)=Qi(zi +âˆ†zi,ui +âˆ†ui). 0 Tâˆ’1 T
Ï„ Ï„ Ï„ Ï„ Ï„ Ï„ Ï„ Ï„ ther,withaslightabuseofnotation,wedefinethenormvector
In addition, Qi and Qi are the partial derivatives of Qi
Ï„,u Ï„,z Ï„ k constructed by âˆ¥SijRj(pi,câˆ’pj)âˆ¥ at time step Ï„ with
w.r.t. ui and zi, while Qi and Qi are the second-order Ï„ Ï„ Ï„ Ï„ 2
Ï„ Ï„ Ï„,uu Ï„,zz a similar modality of (21), which is
partial derivatives of Qi w.r.t. ui and zi. Note that the state
Ï„ Ï„ Ï„
v see cc oto nr d-a on rd det rhe mc ixo en dtro dl eri in vp au tit vev sec Qto ir are =de Qco iuple =d, 0h .en Wce ithth ae k Ï„ =(cid:2)(cid:13) (cid:13)SijR Ï„j (cid:0) pi Ï„,câˆ’pj Ï„(cid:1)(cid:13) (cid:13) 2(cid:3) 1â‰¤j<iâ‰¤N âˆˆRNÃ—(Nâˆ’1), (23)
Ï„,uz Ï„,zu
similar definition of QÂ¯i, the terminal cost is where c âˆˆ C. Concatenating k at all time steps, we define
Ï„ Ï„
kË† = [k ] âˆˆ RN(Nâˆ’1)(T+1). Then, we rewrite the
1 Ï„ Ï„âˆˆT+
QÂ¯i T(âˆ†z Ti )â‰ˆQi T(z Ti )+âˆ†z TiâŠ¤Qi T,z+ 2âˆ†z TiâŠ¤Qi T,zzâˆ†z Ti . collision avoidance discriminant (15) of all the CAVs through
the planning horizon as:
The following part reformulates the OCP as a consensus
optimization problem with a standard consensus ADMM N
form [25]. To facilitate the description of the indepen- kË†+(cid:88) JË†iâˆ†Ziâˆ’dN(Nâˆ’1)(T+1) âª°0. (24)
safe
dent variables of the cooperative problem, define âˆ†Zi = i=1
[âˆ†ziâŠ¤,âˆ†uiâŠ¤,...,âˆ†ziâŠ¤]âŠ¤ âˆˆ R6T+4 as the concatenated
0 0 T For the box constraints in (16), we define a new ma-
vectorofallthestatevectorsandcontrolinputscorresponding trix OËœi step by step. We define a new variable âˆ†ei =
totheithCAV.Besides,defineLi 1 =[Qi 0,z,Qi 0,u,Â·Â·Â· ,Qi T,z]âˆˆ (cid:2) âˆ†eË†iâŠ¤,âˆ†vi (cid:3)âŠ¤ âˆˆ R3T+1 with the notation of âˆ†eË†i =
R6T+4 as the column vector containing all the first-order (cid:2) [âˆ†vi,âˆ†Î´iT ,âˆ†ai]âŠ¤(cid:3) , where âˆ†ei denotes the variables
Jacobians, and Li = blocdiag{Qi ,Qi ,Â·Â·Â· ,Qi } âˆˆ Ï„ Ï„ Ï„ iâˆˆT
2 0,zz 0,uu T,zz with box constraints in the dynamic system (2). Then âˆ†ei =
R(6T+4)Ã—(6T+4) as the block diagonal matrix of all second- Oiâˆ†Zi, where
order Hessians. Hence, the perturbed overall host cost is
Oi =blocdiag{[03Ã—3,I3],Â·Â·Â·,[01Ã—3,1]}âˆˆB(3T+1)Ã—(6T+4).
1
FÂ¯i(âˆ†Zi)=âˆ†ZiâŠ¤Li + âˆ†ZiâŠ¤Liâˆ†Zi. (17) (cid:124) (cid:123)(cid:122) (cid:125)
1 2 2 T7
To facilitate the form âˆ†e = (cid:80)N OË†iâˆ†Zi required in the Algorithm 1 Dual Consensus ADMM [40]
i=1
dual consensus ADMM algorithm [40], we further define 1: choose Ïƒ,Ï>0
2: initialize for all iâˆˆN: pi,0 =yi,0 =xi,0 =si,0 =0
OË†i =[0(3T+1)Ã—(6T+4),Â·Â·Â·,Oi,0(3T+1)Ã—(6T+4),Â·Â·Â·], (25) 3: repeat: for all iâˆˆN
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
iâˆ’1 Nâˆ’i 4: Broadcast yi,k to the vehicles in Ni
5: pi,k+1 =pi,k+Ï(cid:80) (yi,kâˆ’yj,k)
where OË†i âˆˆ B(3T+1)NÃ—(6T+4). Hence, the discriminant (16) jâˆˆNi
6: si,k+1 =si,k+Ïƒ(yi,kâˆ’xi,k)
for all the CAVs can be aggregated and rewritten as 7: ri,k+1 =Ïƒxi,k+Ï(cid:80) (cid:0) yi,k+yj,k(cid:1)
jâˆˆNi
N âˆ’(ki+pi,k+1+si,k+1)
Eâˆ’E Ï„ â‰¤(cid:88) OË†iâˆ†Zi â‰¤Eâˆ’E Ï„, (26) 8: zi,k+1 =argmin(cid:8) Fi(cid:0) zi(cid:1) +Î³(cid:13) (cid:13)Jizi+ri,k+1(cid:13) (cid:13)2(cid:111)
i=1 9: yi,k+1 =2Î³(cid:0) Jizi,k+1+ri,k+1(cid:1)
where E Ï„ = [ei] iâˆˆN, is the concatenated state and con- 10: xi,k+1 =Î  Kâ—¦(cid:0) Ïƒ1si,k+1+yi,k+1(cid:1)
trol input vectors of all the vehicles at time step Ï„. E 11: k =k+1
and E denote the lower and upper bounds, respectively. 12: until termination criterion is satisfied
With the notation k = [âˆ’kË† + dN(Nâˆ’1)(T+1),0(3T+1)N] âˆˆ
safe
RN(Nâˆ’1)(T+1)+(3T+1)N, we formulate the second element of
the unconstrained problem by the following two functions In this problem, Slaterâ€™s condition holds under affine con-
straints, which ensures the strong duality property. The La-
G (M )=I (M âˆ’k), G (M )=I (M ),
1 g1 R+ g1 2 g2 Sb g2 grangian of (28) is given by:
where the subscripts R + denotes a positive semidefinite cone N
with a N(N âˆ’1)(T +1) dimension and Sb ={s|Eâˆ’E Ï„ âª¯ L(âˆ†Z,h,y)=(cid:88) Fi(âˆ†Zi)+I K(h)
sâª¯Eâˆ’E } denotes a continuous convex set with a (3T +
Ï„ i=1 (29)
1)N dimension, respectively. The independent variables are (cid:32) N (cid:33)
+yâŠ¤ (cid:88)(cid:0) Jiâˆ†Ziâˆ’ki(cid:1) âˆ’h ,
N N
M =(cid:88)(cid:16) JË†iâˆ†Zi(cid:17) , M =(cid:88) OË†iâˆ†Zi. i=1
g1 g2
i=1 i=1 where y âˆˆ RN(Nâˆ’1)(T+1)+(3T+1)N represents the dual vari-
ablerelatingtotheinter-vehiclecollisionavoidanceconstraints
Concatenating JË†i with the upper and lower bound constraints
and box constraints from the vehicle physics. The Lagrange
in (25) as Ji =[JË†i;OË†i], we define the concatenated function
dual function can be expressed as:
(cid:32) N (cid:33)
(cid:88) h(y)= inf L(âˆ†Z,h,y)
G(M)=G(M ;M )=I Jiâˆ†Ziâˆ’k ,
[1] [1] K âˆ†Z,h
i=1 N (30)
where M = (cid:80)N Jiâˆ†Zi and K = {(a;b)|a âˆˆ R ,b âˆˆ
=âˆ’(cid:88)(cid:0) Fiâˆ—(cid:0) âˆ’JiâŠ¤y(cid:1)
+I
Kâ—¦(y)+yâŠ¤ki(cid:1)
.
i=1 +
Sb} is theCartesian product ofthe two sets R and Sb. Note i=1
+
that G(Â·), the sum of two convex functions G (Â·) and G (Â·), Note that Fiâˆ— represents the conjugates of Fi and Kâ—¦ =
1 2
is still convex. At this stage, by including G(Â·) in the overall (cid:8) y âˆˆRN(Nâˆ’1)(T+1)+(3T+1)N|sup yâŠ¤hâ‰¤0(cid:9) is the po-
hâˆˆK
cost incurred by F(Â·), with a new notation of ki =k/N, the lar cone of the convex cone K. The problem of the Lagrange
unconstrained convex optimization problem is given by: dual problem, i.e.,
N (cid:32) N (cid:33) N
min(cid:88) Fi(âˆ†Zi)+I
K
(cid:88)(cid:0) Jiâˆ†Ziâˆ’ki(cid:1) . (27) maxh(y)=max âˆ’(cid:88)(cid:0) Fiâˆ—(âˆ’JiâŠ¤y)+I Kâ—¦(y)+yâŠ¤ki(cid:1) ,
âˆ†Zi y y
i=1 i=1 i=1
can be treated as a consensus optimization problem that
C. ImprovedConsensusADMMforCooperativeMotionPlan- is decomposed. In this problem, all vehicles collaborate to
ning with Limited Communication Range collectivelyreachadecisiononasharedoptimizationvariable,
denoted as y. Consequently, the consensus ADMM Algo-
In this part, we leverage a parallel optimization framework
rithm 1 can be applied.
based on dual consensus ADMM and improve its computa-
Leveraging the methodological results in [26], we are
tional efficiency. For completeness, we restate the preliminar-
able to get the analytical expressions of the column vectors
ies of dual consensus ADMM [25], as also summarized in
Algorithm 1. We add the relax variable h and adapt the dual p,s,r,y,xâˆˆRN(Nâˆ’1)(T+1)+(3T+1)N showninAlgorithm1.
TheimprovedconsensusADMMforcooperativemotionplan-
formulation of the problem (27) as:
ning problem contains the following two steps:
(cid:88)N 1) Dual Update: The decentralized local problems corre-
min Fi(âˆ†Zi)+I (h)
K sponding to each CAV achieves consensus by dual update
âˆ†Z1,...,âˆ†ZN
i=1 (28) process. In Algorithm 1, we define Î³ = 1 . Steps
N 2(Ïƒ+2Ï|ni|)
s.t.
(cid:88)(cid:0) Jiâˆ†Ziâˆ’ki(cid:1)
=h.
5-7 and 9-10 are used to update the dual variables. Note that
inStep5andStep7,theithCAVonlyprocessestheJacobian
i=18
Matrices related to its own neighbors in Ni. All steps are With Assumption 1, if all the CAVs in H are fully connected,
straightforward, except for Step 10. Based on the Moreau the complexity of the Algorithm 1 is O(N3), due to Step 5
decomposition [41], the projection operator can be expressed and Step 7.
as Î  (a)=aâˆ’Î  (a). Therefore, Step 10 can be rewritten
Kâ—¦ K It is evident that the dual variables p,s,r,y,x âˆˆ
as
1 RN(Nâˆ’1)(T+1)+(3T+1)N are constructed corresponding to the
xi,k+1 = si,k+1+yi,k+1âˆ’Î»i,k+1, (31)
Ïƒ inter-vehicle collision avoidance constraints [Â·] [1] with a di-
mension of N(N âˆ’1)(T +1) and the box constraints [Â·]
where Î»i,k+1 is an intermediate variable calculated by: [2]
withadimensionof(3T+1)N.Therefore,separatetreatments
(cid:18) (cid:19)
1 are logical for these variable sets.
Î»i,k+1 =Î  si,k+1+yi,k+1
K Ïƒ With the limited communication condition, [Â·]i is cal-
[1]
=argmin(cid:13) (cid:13) (cid:13)yi,k+1+ 1 si,k+1âˆ’q(cid:13) (cid:13) (cid:13) (32) c cu ol mat med unw ici ath tiot nhe ranin gf eor lm ima it ti son thefr no um mN beri. oI fn tho eth ne or n-w zeo rr ods J, acth oe -
(cid:13) Ïƒ (cid:13)
qâˆˆK
(cid:26) (cid:26) (cid:27)(cid:27) bian matrices for the inter-vehicle collision avoidance from
1
=max Î›,min Î“,yi,k+1+ si,k+1 , N(N âˆ’ 1)(T + 1) to Ni(N âˆ’ 1)(T + 1), while the rest
Ïƒ
jacobian matrices are filled with 0. The number of terms to
where k means the number of the ADMM iteration. Based be summed in Step 5 and Step 7 are converted from N to
on the definition of the Cartesian product K, we denote Ni as well. Assuming Ni is a limited number, we derive
the element-wise lower bound and upper bound as Î› = the conclusion that the complexity of the calculation of [Â·]
[1]
(cid:2) 0N(Nâˆ’1)(T+1),E(cid:3) +Ïµ and Î“ = (cid:2) âˆN(Nâˆ’1)(T+1),E(cid:3) âˆ’Ïµ, is decreased from O(N3) to O(N) compared to the dual
respectively. Here, Ïµ = [Ïµ]N(Nâˆ’1)(T+1)+(3T+1)N is a vector consensus ADMM algorithm assuming the fully connected
filledwithasmallnon-negativenumberÏµtopushxi,k+1 away topology network between CAVs [26].
from the boundary into the feasible region, ensuring strict On the other hand, [Â·] has redundant variables associ-
[2]
satisfaction of constraints in the original problem. ated with other CAVs. We define [Â·] âˆˆ R3T+1 as the
[2,i]
((iâˆ’1)(3T +1)+1) to i(3T +1) rows of [Â·] pertaining
[2]
Remark 3. Due to the inherent decoupled nature of this
to the box constraints. Based on the sparsity of OË†i, we can
optimization problem with respect to each element of x,
reduce computational complexity by eliminating redundant
the solution can be easily obtained through element-wise
entities except Oi for [Â·]i . Assume i âˆˆ Nv, as outlined
maximization and minimization as described in (32). [2,i]
in Algorithm 1, the dual variables for the vth CAV w.r.t. the
2) Primal Update: Note that Step 8 of Algorithm 1 ex- ithCAVareiterativelyupdatedusingthefollowingequations:
ecutes the primal update to explore the optimal states and
control inputs for the ith CAV. The primal variable zi,k+1 = (cid:88) (cid:16) (cid:17)
pv,k+1 =pv,k +Ï yv,k âˆ’yj,k , (34a)
âˆ†Zi,k+1 denotes the augmented state of the ith CAV at the [2,i] [2,i] [2,i] [2,i]
(k +1)th ADMM iteration. It can be updated by solving a jâˆˆNv
(cid:16) (cid:17)
standard LQR problem: sv,k+1 =sv,k +Ïƒ yv,k âˆ’xv,k , (34b)
[2,i] [2,i] [2,i] [2,i]
minâˆ†ZiâŠ¤Li + 1 âˆ†ZiâŠ¤Liâˆ†Zi+2ri,k+1âŠ¤Jiâˆ†Zi rv,k+1 =Ïƒxv,k +Ï (cid:88) (cid:16) yv,k +yj,k (cid:17)
âˆ†Zi 1 2 2 [2,i] [2,i]
jâˆˆNv
[2,i] [2,i]
+ 1 âˆ†ZiâŠ¤JiâŠ¤Jiâˆ†Zi (33) âˆ’(cid:16) kv +pv,k+1+sv,k+1(cid:17) , (34c)
Ïƒ+2Ï|ni| [2,i] [2,i] [2,i]
s.t. (cid:0) Li 3âˆ’Li 4(cid:1) âˆ†Zi =0.
yv,k+1
=(cid:40) 2Î³(cid:16) Oiâˆ†Zi,k+1+r [i 2,k ,i+ ]1(cid:17) v =i
(34d)
It is worth noting that all terms of the objective function in [2,i] 2Î³rv,k+1 v Ì¸=i,
[2,i]
(33) are quadratic, and the constraint for the vehicle model is (cid:18) (cid:19)
1
linear. In this sense, the problem can be effectively solved xv [2, ,k i+ ] 1 =Î  Suâ—¦ Ïƒsv,k+1+yv,k+1 , (34e)
using dynamic programming. Besides, the problem solely
involves state variables and control inputs that are specific
to a single CAV. Consequently, the problem described by (33) Theorem 1. Given that the dual variables of the CAVs are
for different CAVs can be concurrently solved in a parallel initialized by same values, for the elements of dual variables
manner. with âˆ€j Ì¸= i,âˆ€v Ì¸= i, Î±j,k = Î±v,k = Î±k ,Î± âˆˆ
[2,i] [2,i] [2,i]
{p,s,r,y,x},âˆ€k âˆˆK holds.
Assumption 1. The maximum iterations for both the outer iter
and inner loops in Algorithm 1 are fixed and the planning Proof. Denote the statement of
horizon in each iteration is constant.
P(m): Î±j,m =Î±v,m,Î±âˆˆ{p,s,r,y,x},
Remark 4. Although the LQR problem can be efficiently [2,i] [2,i]
solved using the algebraic Riccati equation, it still requires and the proof is given by induction on m.
dealingwiththehigh-dimensionalJacobianmatrixJ toobtain Base case: With the same initialization of the dual variables,
its inverse matrix. This process can be time-consuming, espe- we have Î±j,0 =Î±v,0 =Î±0 ,Î±âˆˆ{p,s,r,y,x}, so P(0)
[2,i] [2,i] [2,i]
cially for large-scale cooperative motion planning problems. is clearly true.9
Induction step: Assume the induction hypothesis that âˆ€j Ì¸= Algorithm 2 Improved Consensus ADMM for Cooperative
i,[Â·]j,k = [Â·]k holds, meaning P(k) is true. According to Motion Planning Within One Subgraph H(N,E h)
2,i 2,i
(34), for the second term of the equations (34a) and (34c), 1: initialize {xi,ui}T ,{pi,0,yi,0,zi,0,si,0},âˆ€iâˆˆN
Ï„ Ï„ Ï„=0
because y [v 2, ,k
i]
=y [j 2,k
,i]
=y [k 2,i],j Ì¸=i,k Ì¸=i, we have: 2: choose Ïƒ,Ï>0
(cid:88) (cid:16) (cid:17) 3: repeat:
y [v 2, ,k i]âˆ’y [j 2,k
,i]
=y [k 2,i]âˆ’y [i 2,k ,i], (35) 4: Send {z Ï„i}T Ï„=1, receive {z Ï„j}T
Ï„=1
from j âˆˆNi
jâˆˆNv 5: Compute ki, Ji, {Ai}Tâˆ’1, {Bi}Tâˆ’1
Ï„ Ï„=0 Ï„ Ï„=0
(cid:88) (cid:16) (cid:17) 6: reset pi,0 =si,0 =0,yi,0 =ylast,xi,0 =xlast
y [v 2, ,k i]+y [j 2,k ,i] =(2|nv|âˆ’1)y [k 2,i]+Ïy [i 2,k ,i]. (36) 7: reset yi,0 =xi,0 =0
[2] [2]
jâˆˆNv 8: repeat: for all iâˆˆN
Plug (35) and (36) to (34) under the case of v Ì¸= i, the 9: Send yi,k, receive yj,k from j âˆˆNi
following equation holds: 10: Steps 4-7 of Algorithm 1 for [Â·]i,k
[1]
(cid:16) (cid:17) 11: Perform (38a-38c) for Î±i,k ,Î±âˆˆ{p,s,r}
pv,k+1 =pk +Ï yk âˆ’yi,k =pk+1, (37a) [2,i]
[2,i] [2,i] [2,i] [2,i] [2,i] 12: Perform (37a-37c) for Î±i,k ,Î±âˆˆ{p,s,r},j âˆˆNi
(cid:16) (cid:17) [2,j]
sv,k+1 =sk +Ïƒ yk âˆ’xk =sk+1, (37b) 13: Compute zi,k+1 by solving LQR problem (33)
[2,i] [2,1] [2,i] [2,i] [2,i] (cid:16) (cid:17)
rv,k+1 =Ïƒxk +Ï(2|nv|âˆ’1)yk +Ïyi,k 14: y [i 1,k ]+1 =2Î³ JË†iz [i 1,k ]+1+r [i 1,k ]+1
[2,i] [2,i] [2,i] [2,i] (cid:16) (cid:17)
âˆ’(k [k 2+ ,i1 ] +pk [2+ ,i1 ] +sk [2+ ,i1 ])=r [k 2+ ,i1 ], (37c) 15: xi [1,k ]+1 =Î  Râ—¦ + Ïƒ1si [1,k ]+1+y [i 1,k ]+1
yv,k+1 =2Î³rk+1 =yk+1, (37d) 16: Perform (38d-38e) for Î± [i 2,k ,i],Î±âˆˆ{y,x}
[2,i] [2, (cid:18)i] 1 (cid:16) [2,i] (cid:17)(cid:19) 17: Perform (37d-37e) for Î± [i 2,k ,j],Î±âˆˆ{y,x},j âˆˆNi
xv,k+1 =Î  sk+1+yk+1 =xk+1, (37e) 18: k =k+1
[2,i] Sbâ—¦ Ïƒ [2,i] [2,i] [2,i] 19: until number of iteration steps exceeds k max
which means the statement P(k+1) also holds, establishing 20: Update {z Ï„i,ui Ï„}T Ï„=0
the induction step from P(k) to P(k + 1). Since both the 21: until termination criterion is satisfied
base case and the induction step have been proved as true,
P(m) holds for every mâˆˆK . This completes the proof of
iter variables based on the received neighbor information and
Theorem 1.
performscomputationsforeachtimestepÏ„.Insidetheloop,it
Therefore, the dual update with v Ì¸=i can be completed by also performs additional computations and updates the primal
(37). Besides, according to (34) under the case of v =i, with variables until a termination criterion is satisfied. The inner
Theorem 1, the dual update of Î±i,k+1 can be simplified as: loop continues to iterate until a maximum number of steps
2,i
is reached. Finally, it updates the state vectors and control
(cid:16) (cid:17)
pi,k+1 =pi,k +Ï(N âˆ’1) yi,k âˆ’yk , (38a) inputs along the whole planning horizon until the termination
[2,i] [2,i] [2,i] [2,i]
(cid:16) (cid:17) criterion of the outer loop is satisfied.
si,k+1 =si,k +Ïƒ yi,k âˆ’xi,k , (38b)
[2,i] [2,i] [2,i] [2,i]
(cid:16) (cid:17) V. COOPERATIVEMOTIONPLANNINGFRAMEWORKFOR
ri,k+1 =Ïƒxi,k +Ï(N âˆ’1) yi,k +yk
[2,i] [2,i] [2,i] [2,i] LARGE-SCALECAVS
âˆ’(ki,k+1+pi,k+1+si,k+1), (38c) This section focuses on improving the practicality of the
[2,i] [2,i] [2,i]
(cid:16) (cid:17) proposed algorithm toward cooperative motion planning with
yi,k+1 =2Î³ Oiâˆ†Zi,k+1+ri,k+1 , (38d)
[2,i] [2,i] large-scaleCAVsunderalocallyconnectedtopologynetwork.
(cid:18) 1 (cid:16) (cid:17)(cid:19) We leverage graph evolution and receding horizon strategies
xi,k+1 =Î  si,k+1+yi,k+1 . (38e)
[2,i] Sbâ—¦ Ïƒ [2,i] [2,i] to achieve this objective.
A. Graph Evolution based on Manhattan Distance
Remark 5. Combining (37) and (38), the decoupled ADMM
To enable efficient decentralized cooperative motion plan-
iteration of variables corresponding to the box constraints
ning for CAVs, a graph evolution strategy is presented in-
of vehicle i is completed. Therefore, compared to (34), the
corporating node distribution algorithm and edge construction
computational complexity is reduced obviously from O(Ni)
rules. The node distribution mechanism is demonstrated in
toO(1),whichimprovesthecomputationalefficiencybutdoes
Algorithm 3. Leveraging the notations in Section III-A, each
not affect the optimization performance.
node ni is distributed into a subset of nodes N(H) from
In summary, combining the solving process of [Â·] and V(G), which belong to two graphs H(N,E ) and G(V,E),
[1] h
[Â·] , an improved decentralized cooperative motion planning respectively. Their relationship can be described as:
[2]
algorithm with a computation complexity of O(N) is pro-
H(N,E )âŠ†G(V,E). (39)
vided.AsdemonstratedinAlgorithm2,itstartsbyinitializing h
the dual variables and choosing values for hyper-parameters. The node distribution algorithm aims to establish the commu-
It then enters a loop where it sends and receives information nication and collaboration among CAVs with certain discrim-
among the CAVs in each Ni. It computes the augmented ination rules, referred to as the threshold distance di,j . To
safe10
Algorithm 3 Graph Evolution for CAVs â€¢ v ri efÃ—T s+v rj efÃ—T s â‰¥âˆ†xi Ï„j +âˆ†y Ï„ij =âˆ¥piâˆ’pjâˆ¥ 1
1: input: current positions pi , iâˆˆV Hence, Condition 2 is also a necessary and insufficient con-
Te
2: initialize: distance matrix D =[di,j],i,j âˆˆV dition for collision avoidance. In the sub-case of driving
3: reset: threshold distance di,j =âˆ toward each other, the situation of the CAVs can be treated
safe
4: if âˆ†Î¸ <45â—¦ then as an Encounter Problem, where the relative velocity âˆ†vij â‰¤
5: di sa,j
fe
=T sÂ·max{v ri ef,v rj ef} v ri
ef
+v rj ef. Therefore, the relative displacement of the CAVs
6: else can be expressed as âˆ†dij = âˆ†vij Ã—T â‰¤ (vi +vj )Ã—T .
7: di sa,j
fe
=T sÂ·(v ri ef+v rj ef) If âˆ†dij â‰¤ âˆ¥(xi Ï„,y Ï„i)âˆ’(xj Ï„,y Ï„j)âˆ¥ 1, thers e is noref possr ie bf ility os f
8: end if encountering with a time horizon T , which means
s
9: build: adjacency matrix A G with condition di,j <di sa,j fe âˆ¥(xi,yi)âˆ’(xj,yj)âˆ¥ >(vi +vj )Ã—T . (42)
10: initialize: subgraphs list, visited list Ï„ Ï„ Ï„ Ï„ 1 ref ref s
11: for i in range (len(D[0])) do At this stage, all the cases are discussed the safety guarantee
12: if visited[i] is 0 then of conditional Manhattan distance is proved completely.
13: Create subgraph with i
14: Mark i as visited Remark 6. In urban traffic systems, roads are typically verti-
15: Initialize queue with i cally staggered, and vehicles navigate based on the topology
16: while queue do oftheroadnetwork.Hence,wemotivatetheuseofManhattan
17: Get node and neighbors from queue distance to measure the safe range between CAVs. Each
18: for neighbor in neighbors do CAV has a target velocity, which is generally maintained
19: if visited[neighbor] is 0 then for extended periods. Therefore, the product of the target
20: Add neighbor to subgraph and queue velocity and the planning horizon can serve as a criterion for
21: Mark neighbor as visited establishing a safety distance between any pair of CAVs.
22: end if As shown in Algorithm 3, a distance matrix D is firstly
23: end for initialized to store the pairwise conditional Manhattan dis-
24: end while tances between ni âˆˆ V. The adjacency matrix A is then
G
25: Perform (43) to create the edge set E h constructed based on an element-wise comparison of the
26: Add subgraph H to subgraphs list distance between two CAVs that is smaller than the safe
27: end if distancei.e.,(ni,nj)=di,j <di,j .Hence,A representsthe
safe G
28: end for connectivitybetweenCAVs.Next,thealgorithminitializesthe
subgraphs and a visited array to keep track of visited CAVs.
It iterates through each CAV in V and checks if it has been
dividethegraphintoasmanysubgraphsaspossibleunderthe
visited. If not, a new subgraph H is created with the current
inter-subgraph safety guarantee for the node distribution strat-
CAVasthestartingnode.Thenodeismarkedasvisitedanda
egy, we propose a safe distance by the following conditional
queue is initialized with the current CAV. Within the â€œwhileâ€
Manhattan distance: loop, the algorithm retrieves a node nj from the queue along
ï£± (cid:110) (cid:111) withitsneighbors.Foreachneighborthathasnotbeenvisited,
di,j =ï£² T sÂ·m (cid:16)ax v ri ef,v (cid:17)rj ef ,âˆ†Î¸ < Ï€ 4 (40) it is added to the subgraph H and the queue. The neighbor is
safe ï£³ T sÂ· v ri
ef
+v rj
ef
, otherwise. also marked as visited. This process continues until the queue
is âˆ…. Finally, the algorithm create the edges of each subgraph
Vehicles with a Manhattan distance di,j = âˆ¥piâˆ’pjâˆ¥ larger and store it to the list of subgraphs H1,H2,Â·Â·Â· ,HK. This
1
than the safe distance have no potential to collide with each process repeats until all CAVs have been visited, resulting in
other, which is explained by the following statements. a collection of subgraphs. Within one set of nodes created by
If âˆ†Î¸ < Ï€, the two CAVs appear to be driving in the same Algorithm 3, the edges to construct the subgraph H(N,E )
4 h
direction.Inthiscase,thesituationoftheCAVscanbetreated between node pairs are created by:
asaPursuitProblem,wheretherelativevelocityâˆ†vij =viâˆ’
E =(cid:8) (ni,nj),j âˆˆN|di,j â‰¤ri (cid:9) . (43)
vj <max{vi,vj}. Therefore, the relative displacement of the h tele
CAVs can be expressed as Remark 7. Algorithm 3 provides a foundation for the con-
struction of decentralized cooperative motion planning prob-
âˆ†dij =T Â·âˆ†vij <T Â·max{vi,vj}. (41)
s s lems by maintaining the adjacency matrix A among CAVs.
G
If âˆ†Î¸ â‰¥ Ï€, the two CAVs are either driving vertically These sets of nodes Nk serve as the basis for CAV coordina-
4
or toward each other. In the sub-case of driving vertically, tion in the subsequent stages of the motion planning process.
a necessary and insufficient condition for the possibility of
collision is given by Condition 1: B. Large-Scale Cooperative Motion Planning with Receding
â€¢ v ri efÃ—T s â‰¥âˆ†xi Ï„j and v rj efÃ—T s â‰¥âˆ†y Ï„ij, or Horizon and Graph Evolution
â€¢ v rj efÃ—T s â‰¥âˆ†xi Ï„j and v ri efÃ—T s â‰¥âˆ†y Ï„ij The pipeline of the proposed cooperative motion planning
For Condition 1, an equivalent necessary and insufficient framework involves optimizing the trajectories of the CAVs
condition is listed as Condition 2: in a planning horizon of T and executing only the first T
s e11
Algorithm 4 Large-Scale Cooperative Motion Planning with 24Ã—4GBGraphicMemory.Weperformthealgorithmsusing
Receding Horizon and Graph Evolution Python3.8withNumbaacceleration.Thesimulationplatform
1: obtain starting and target positions of all CAVs in G isCARLA0.9.14[42]withTown05.Thepertinentparameters
2: determine optimal route using A* algorithm of the CAVs are depicted in Table I. It is notable that di,1 =
3: smooth the waypoints in each route using the Savitzky- âˆ’0.28 m means that the rear circle of the target vehicle is in
Golay filter frontofthevirtualcenter(centeroftherearaxle)ofthevehicle
4: while termination criterion is not satisfied do: model (2). In the remainder of this section, we conduct two
5: Execute Algorithm 3 to distribute the CAVs to Hk
6: for subgraph H in subgraphs list do TABLEI
7: formulate the OCP (28) for the CAVs in H PARAMETERSETTINGSOFTHECAVS
8: search nearest waypoints for each CAV at each
Param. Description Value Param. Description Value
time step Ï„ âˆˆ{0,1,...,T } using KD-Tree
s
9: Execute Algorithm 2 to obtain CAVsâ€™ trajectories b wheelbase 2.4m di,1 reardistance -0.28m
l vehiclelength 3.8m aj semi-major 3m
10: end for w vehiclewidth 1.7m bj semi-minor 1.1m
11: perform first T e steps of the CAVs in G di,0 frontdistance 2.68m ri radius 2.55m
12: feedback at time step T e
13: relay the states of all the CAVs in G sets of simulation experiments to evaluate the computational
14: end while efficiency of the proposed optimization algorithm and the
drivingperformanceoftheproposeddecentralizedcooperative
motion planning strategy, respectively.
steps. We set T > T , which can cater to uncertainties and
s e We use the same guidance trajectories of the CAVs in the
dynamicsfaultsduringthe(T âˆ’T )timehorizonconstructing
s e same map for all the benchmark methods in the comparative
a closed-loop structure. Besides, the horizon of the whole
experiment.Concretely,asshowninTableII,weadoptdiffer-
driving process from the starting point to the destination is
ent hyper-parameters for the reference trajectories generation
denoted as T. With a receding horizon manner, it is not of different scales of CAVs. The CAVsâ€™ spawn points zi
ref,0
necessary to detect vehicles that are far away, because the anddestinationszi arerandomlygenerated.Afterward,the
ref,T
maximum velocity of each CAV is limited, which defines a rough guidance trajectories containing waypoints zi ,Ï„ âˆˆ
boundary for the trip distance within the limited planning
ref,Ï„
[1,2,...,T] are searched as described by Section IV-A. The
horizon. This feature benefits the graph evolution algorithm
generatedspawnpointsarewithinarangeof[d ,d ]from
min max
to construct more subgraphs to effectively control the scale of
(âˆ’188m,âˆ’91.5m), the center position of an intersection in
the OCPs corresponding to each subgraph.
Town 05, while the destinations of CAVs are within a range
The cooperative motion planning strategy with a receding of [d ,d ] from their spawn points zi . Lastly, to
des,min des,max ref,0
horizon is presented in Algorithm 4. Initially, the starting
simulate real urban driving scenarios, the target velocity of
and target positions of all CAVs are determined by users. each CAV vi is randomly assigned between [v ,v ].
ref min max
A preliminary route with guidance waypoints is generated
and smoothed based on the road topology provided by the
TABLEII
OpenDRIVE map, using the A* algorithm and the Savitzky-
PARAMETERSFORDRIVINGSCENARIOCONSTRUCTION
Golay filter. In the â€œwhileâ€ loop, the graph evolution is
performedusingAlgorithm3,andOCPsareformulatedwithin #CAV d min dmax d des,min d des,max v min vmax
eachsubgraph.Tofacilitatecooperativemaneuvers,thenearest 8 7.5m 30.0m 100.0m 150.0m 10.0m/s 10.0m/s
neighbor search is performed using an efficient KD-Tree 16 7.5m 70.0m 100.0m 150.0m 5.0m/s 20.0m/s
32 10.0m 140.0m 120.0m 150.0m 5.0m/s 20.0m/s
structure within the subsequent T steps. After formulating
s 80 10.0m 340.0m 140.0m 170.0m 5.0m/s 20.0m/s
the decentralized cooperative motion planning optimization
problem and parallelly executing Algorithm 2 for each sub-
graph H, the trajectories of all CAVs are obtained. The
first T trajectories of the CAVs are executed, and the state B. Cooperative Motion Planning Under One Subgraph
e
and environment feedback at time step T is collected and 1) ComputationalEfficiencyComparison: Wecompareour
e
relayed between the CAVs. Simultaneously, G is updated by optimization algorithm for solving cooperative motion plan-
Algorithm 3. The aforementioned steps are repeated to obtain ning problems with existing commonly used solvers (the
the remaining trajectories during T to T. IPOPT solver and the SQP solver provided by CasADi [43])
e
andadvancedalgorithms(centralizediLQR(CiLQR)withlog
barrier function [20], and decentralized iLQR (DiLQR) with
VI. SIMULATIONRESULTS
soft collision avoidance [26]). The hyper-parameters of the
A. Environment Setup
optimization algorithms are listed in Table III.
We implement the proposed efficient decentralized coop- Computationtimeofdifferentoptimizationhorizons(T)and
erative motion planning framework in Ubuntu 20.04 LTS CAV numbers (N) are compared using a static CAV graph G
with Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz CPU withoutgraphevolution.AsdepictedinTableIV,wecompare
and NVIDIA TITAN RTX GPU with 256 GB RAM and the computation time of various optimization algorithms with12
TABLEIII
PARAMETERSETTINGSOFTHEOPTIMIZATIONALGORITHMS 6.0 CiLQR
IPOPT
5.5 SQP
Parameter Value Parameter Value Parameter Value DiLQR
5.0 Ours
Ïƒ 0.05 Ï„s 0.1s Ï† b 0.6rad
Ï 0.002 amax 3.0m/s2 Ts 15
4.5
Ïµ 0.1 a min -5.0m/s2 Te 10
4.0
3.5
aplanninghorizon(T )rangingfrom30to90andafixedCAV
s
number (N =8). IPOPT and SQP, typical solving methods in 3.0
CasADi, have high computation time and low efficiency for
2.5
CAVsâ€™ motion planning tasks. SQP struggles with planning 0 5 10 15 20 25 30
Time step
horizons greater than 40. CiLQR is more time-efficient due to
iterative linearization but faces significantly increased compu-
Fig. 4. The minimum distance between all the CAVs at each time step.
tationtimeastheplanninghorizongrows.Incontrast,DiLQR,
Differentcolorsrepresentdifferentmethods.Alltheabovemethodsperformed
which uses ADMM to decentralize the problem, maintains safecooperativemotionplanningwithaminimumdistancegreaterthan2.5m.
efficiency even with an increased planning horizon scale. Our
proposedmethodhasalsohighcomputationalefficiencywitha 11
largerplanninghorizon.Fromanotherperspective,asshownin
10
Table V, for most of the compared methods, a higher number
of CAVs has a greater impact on the computational efficiency 9
thanagreaterplanninghorizon.Inparticular,DiLQRismuch
8
less scalable than our improved consensus ADMM algorithm.
7
TABLEIV 6
COMPUTATIONTIMEWITHDIFFERENTOPTIMIZATIONHORIZONS
CiLQR IPOPT SQP DiLQR Ours
Method
OptimizationhorizonwithN =8
Method
30 40 50 60 70 80 90 Fig.5. Velocitydistributionalongallthetimestepswithdifferentmethods.
CiLQR[20] 0.276 0.361 0.577 1.314 2.031 1.413 2.099 Asthereferencevelocityis10m/s,aspeeddistributionclosertothisvalue
IPOPT[43] 4.311 8.701 18.602 31.630 95.909 â€” â€” indicatesbetterdrivingperformance.
SQP[43] 758.680 â€” â€” â€” â€” â€” â€”
DiLQR[26] 0.398 0.339 0.614 0.582 0.713 1.069 1.473
Ours 0.197 0.377 0.407 0.550 0.733 1.035 1.434
the alternatives. Compared with other algorithms, our pro-
posed method demonstrates minimal variance, coupled with
a relatively high average velocity. In summary, our proposed
TABLEV
cooperativeoptimizationalgorithmoutperformsothermethods
COMPUTATIONTIMEWITHDIFFERENTNUMBERSOFCAVS
in terms of scalability, safety, and traveling efficiency. It
NumberofCAVswithT=30 showcases robustness against an increase in the planning
Method 4 8 12 16 20 24 28 32 horizon and the number of CAVs.
CiLQR[20] 0.157 0.276 1.763 6.001 16.901 15.888 19.395 20.110
IPOPT[43] 0.935 4.311 130.961 173.720 314.550 â€” â€” â€” Note that when the number of CAVs involved in one
SQP[43] 124.320 758.680 â€” â€” â€” â€” â€” â€”
OCP is more than 20, the cooperative optimization problem
DiLQR[26] 0.073 0.398 0.301 0.490 1.096 3.343 5.146 5.419
Ours 0.152 0.197 0.565 0.792 0.364 1.159 1.887 2.522 consumesmorethan1.0s,whichisnotsufficientforreal-time
urban cooperative driving tasks. Hence, our proposed graph
2) Driving Performance Analysis: As the cooperative mo-
evolution algorithm is tailored for the context of large-scale
tion planning problem (4) is non-convex, it is challenging
cooperative motion planning, which we thoroughly examine
to guarantee finding the global optimal solution using any
in the subsequent part.
solver.Therefore,itbecomesnecessarytoestablishevaluation
criteria to assess the optimization performance. In this paper,
C. Large-Scale Cooperative Motion Planning
the motion planning performance is evaluated based on two
criteria: the minimum distance between any pair of CAVs and In this section, we implement closed-loop cooperative mo-
the velocity distribution throughout the entire driving process. tion planning framework for large-scale CAVs. The objectives
As depicted in Fig. 4, all the methods exhibit a similar of this experiment are to evaluate the robustness, scalability,
trend and successfully achieve safe driving performance in and effectiveness of the proposed cooperative motion plan-
terms of the minimum distance between CAVs. However, ning framework including the graph evolution and receding
when considering driving efficiency, notable differences arise horizonstrategies.Weanalyzenodedistributionsituationsand
among the methods. As demonstrated in Fig. 5, the SQP qualitative rationality of the CAVsâ€™ behavior. To achieve this,
method exhibits the largest deviation and variance from the we construct a randomly generated large-scale urban driving
reference velocity, with the lowest mean velocity among all scenario containing 80 CAVs with varied target velocities
)m(
ecnatsid
muminiM
)s/m(
yticoleV13
(a) Initialtrajectories (b) Cooperativelyplannedtrajectories
Fig.6. Roughguidancetrajectoriesandcooperativelyplannedtrajectoriesfor80CAVsintheTown 05.Differentcolorsrepresentthetrajectoriesfordifferent
CAVs.Notethattherearemanypotentialcollisionregionsintheroughguidancetrajectories.
2.00
1.75
1.50
1.25
1.00
0.75
0.50
0.25
0.00 (a) NodesetsdistributionatÏ„ =20 (b) NodesetsdistributionatÏ„ =60
1 2 3 4 5 6 7 8 9
Episode Fig.9. Nodesetsdistributionatdifferenttimesteps.Differentcolormeans
differentnodesetsofCAVs,andthedashedlinesbetweeneachpairofvehicles
meanthecommunicationabilitywitheachother.
Fig. 7. Computation time for each CAV in all the subgraphs. Most of the
problemscanbesolvedwithin0.25seconds,andthecomputationtimehasa
smallstandarddeviation.
We use a receding horizon strategy with a control horizon of
T =10 and planning horizon of T =15.
e s
1) Effectiveness Analysis of the Node Distribution: Fig. 7
15.0
depicts the computation time in each episode for the planning
12.5
horizon within each subgraph H generated from the dynamic
10.0 connectivity graph G of the 80 CAVs. In most cases, the
7.5 computation time is less than 0.25 s with a small standard
variance, which indicates that the computation time of the
5.0
algorithmdoesnotfluctuatemuchundervariousurbandriving
2.5
conditions and real-time planning can be achieved.
0.0 Note that such stable and efficient computing time is in-
âˆ’2.5 separable from our proposed graph evolution algorithm. With
1 2 3 4 5 6 7 8 9 this, the subsets of CAVs N are redistributed and updated
Episode
withanappropriatesizethroughthewholecooperativedriving
process. As demonstrated in Fig. 8 and Fig. 9, the sizes
Fig.8. ThenumberofCAVsineachsubgraphwithindifferentepisodesin
of the subgraphs, determined using the proposed conditional
theproposedcooperativemotionplanningframework.
Manhattan distance, are relatively small with less than 10
CAVs.NotethatinmomentswithhighCAVdensity,suchasat
as depicted in Table II. The guidance trajectories of the intersectionsorlongqueuesonastraightroad,thescaleofthe
CAVs in this scenario are shown in Fig. 6(a). This random subgraphs increases slightly, such as the sugraph distribution
scenario generation setting enables us to simulate complex of CAVs at Ï„ =60 in Fig. 9(b), which is the main reason for
urban driving tasks and validate the frameworkâ€™s robustness. the several high computation time recorded in Fig. 7.
)s(emitnoitatupmoC
hpargbushcaenisVACforebmuN14
appropriate CAV scale within each subgraph.
Ï„=1.0s Ï„ = 4.2 s
VII. CONCLUSION
In this work, a comprehensive cooperative motion planning
framework is devised to address the cooperative motion plan-
ning problem in large-scale traffic scenarios involving exces-
Ï„=2.0s Ï„ = 4.5 s sive numbers of CAVs. This framework integrates trajectory
generation, graph evolution, and parallel optimization for co-
operative urban driving. We enhance computational efficiency
of the dual consensus ADMM, by leveraging the sparsity
in the dual update of box constraints. The introduction of a
graph evolution strategy with the receding horizon effectively
Ï„=2.5s Ï„ = 4.9 s managesthescaleofeachOCPineachsubgraphH,regardless
of the number of CAVs in graph G. The simulation results of
cooperative motion planning within one subgraph showcase
the superiority of the proposed improved consensus ADMM
in terms of computational efficiency and driving efficiency,
especially with higher planning horizons and increasing num-
Ï„=3.4s Ï„ = 6.9 s bers of CAVs. We also conduct comprehensive simulations
for cooperative motion planning tasks involving 80 CAVs.
With the proposed methodology, the computation time for the
problemismaintainedtobeunder0.5sinmostinstances.The
CAVs exhibit exceptional cooperation behaviors in different
driving scenarios. These findings effectively showcase the
(a) CooperativeOvertaking (b) IntersectionCrossing capabilities of the proposed cooperative driving framework
in managing large-scale CAVs, offering valuable insights for
Fig. 10. Driving performance in two challenging scenarios simulated in
CARLA.In(a),theredCAVovertakestheleadingonewithminorsteeringand efficient coordination in modern transportation networks.
deviationfromitsroadlaneholdinganarrowsafetydistance,duetotheslight
avoidance of the leading vehicle. In (b), all the CAVs collaboratively drive
REFERENCES
witharelativelyhighsafetydistancewithoutcollisionindenseconditions.
[1] C. Chang, J. Zhang, K. Zhang, W. Zhong, X. Peng, S. Li, and L. Li,
â€œBEV-V2X:Cooperativebirds-eye-viewfusionandgridoccupancypre-
2) Cooperative Driving Performance Evaluation: In this dictionviaV2X-baseddatasharing,â€IEEETransactionsonIntelligent
Vehicles,vol.8,no.11,pp.4498â€“4514,2023.
part, we thoroughly evaluate the cooperative driving per-
[2] M. Wegener, F. Herrmann, L. Koch, R. Savelsberg, and J. Andert,
formance in the high-fidelity urban traffic scenario, taking â€œLongitudinal vehicle motion prediction in urban settings with traffic
into account safety and rationality indices. A comparison light interaction,â€ IEEE Transactions on Intelligent Vehicles, vol. 8,
no.1,pp.204â€“215,2023.
betweentheinitialtrajectoriesandthecooperativelyoptimized
[3] C.ToumiehandA.Lambert,â€œDecentralizedmulti-agentplanningusing
driving trajectories shown in Fig. 6 reveals that the optimized modelpredictivecontrolandtime-awaresafecorridors,â€IEEERobotics
trajectories exhibit more curves, even on straight road lanes. andAutomationLetters,vol.7,no.4,pp.11110â€“11117,2022.
[4] W. Xiao, H. Ren, Q. Zhou, H. Li, and R. Lu, â€œDistributed finite-
This can be attributed to the overtaking and active avoidance
time containment control for nonlinear multiagent systems with mis-
behaviorsoftheCAVs.Itisworthnotingthatthesetrajectories matcheddisturbances,â€IEEETransactionsonCybernetics,vol.52,no.7,
are sufficiently smooth, allowing the CAVs to adjust their pp.6939â€“6948,2022.
heading angles Î¸i with slight steering Ï†i, thereby enhancing [5] L.-H. Wen and K.-H. Jo, â€œDeep learning-based perception systems
Ï„ Ï„ for autonomous driving: A comprehensive survey,â€ Neurocomputing,
the comfort of passengers in CAVs within the traffic system. vol.489,pp.255â€“270,2022.
For typical and challenging situations, such as overtaking [6] L.Zhang,Z.Hou,J.Wang,Z.Liu,andW.Li,â€œRobotnavigationwith
reinforcement learned path generation and fine-tuned motion control,â€
or intersection areas, CAVs exhibit a proactive inclination to
IEEE Robotics and Automation Letters, vol. 8, no. 8, pp. 4489â€“4496,
evade one another, thereby enhancing both driving effective- 2023.
ness and safety performance. A notable illustration can be [7] X. Duan, C. Sun, D. Tian, J. Zhou, and D. Cao, â€œCooperative lane-
changemotionplanningforconnectedandautomatedvehicleplatoonsin
observed in Fig. 10(a), where the red CAV successfully exe-
multi-lane scenarios,â€ IEEE Transactions on Intelligent Transportation
cutes an overtaking maneuver without compromising driving Systems,vol.24,no.7,pp.7073â€“7091,2023.
efficiency,duetotheactiveavoidanceofthewhiteCAVonthe [8] C. Hu, Z. Wang, H. Taghavifar, J. Na, Y. Qin, J. Guo, and C. Wei,
â€œMME-EKF-Based path-tracking control of autonomous vehicles con-
left. Another noteworthy challenge in urban driving pertains
sideringinputsaturation,â€IEEETransactionsonVehicularTechnology,
to navigating intersections. As depicted in Fig. 10(b), all the vol.68,no.6,pp.5246â€“5259,2019.
CAVs efficiently drive without stopping and giving way to [9] L. Claussmann, M. Revilloud, D. Gruyer, and S. Glaser, â€œA review of
motionplanningforhighwayautonomousdriving,â€IEEETransactions
others in the unsignalized intersection, obviously increasing
on Intelligent Transportation Systems, vol. 21, no. 5, pp. 1826â€“1848,
the traveling efficiency. The reasons for the above safe and 2020.
efficientdrivingperformancearetheadoptionofacooperative [10] S.Teng,X.Hu,P.Deng,B.Li,Y.Li,Y.Ai,D.Yang,L.Li,Z.Xuanyuan,
F.Zhu,etal.,â€œMotionplanningforautonomousdriving:Thestateofthe
motionplanningoptimizationstrategy,alignedwiththedriving
artandfutureperspectives,â€IEEETransactionsonIntelligentVehicles,
strategy outlined in Algorithm 4 and the utilization of an 2023.15
[11] J.Duan,J.Li,Q.Ge,S.E.Li,M.Bujarbaruah,F.Ma,andD.Zhang, [32] T. BruÂ¨digam, M. Olbrich, D. Wollherr, and M. Leibold, â€œStochastic
â€œRelaxed actor-critic with convergence guarantees for continuous-time modelpredictivecontrolwithasafetyguaranteeforautomateddriving,â€
optimalcontrolofnonlinearsystems,â€IEEETransactionsonIntelligent IEEETransactionsonIntelligentVehicles,2021.
Vehicles,vol.8,no.5,pp.3299â€“3311,2023. [33] H. Liu, K. Chen, Y. Li, Z. Huang, J. Duan, and J. Ma, â€œIntegrated
[12] G. Sartoretti, J. Kerr, Y. Shi, G. Wagner, T. S. Kumar, S. Koenig, behavior planning and motion control for autonomous vehicles with
andH.Choset,â€œPRIMAL:Pathfindingviareinforcementandimitation traffic rules compliance,â€ in 2023 IEEE International Conference on
multi-agent learning,â€ IEEE Robotics and Automation Letters, vol. 4, RoboticsandBiomimetics(ROBIO),pp.1995â€“2002,IEEE,2023.
no.3,pp.2378â€“2385,2019. [34] Y.Qu,H.Chu,S.Gao,J.Guan,H.Yan,L.Xiao,S.E.Li,andJ.Duan,
[13] H.Liu,Z.Qu,andR.Zhu,â€œSolvingamulti-robotsearchproblemwith â€œRL-driven MPPI: Accelerating online control laws calculation with
bionic SARSA algorithm and artificial potential field,â€ in 2021 China offline policy,â€ IEEE Transactions on Intelligent Vehicles, pp. 1â€“12,
AutomationCongress(CAC),pp.1830â€“1835,IEEE,2021. 2023.
[14] M.Klimke,B.VoÂ¨lz,andM.Buchholz,â€œCooperativebehaviorplanning [35] C. E. Luis, M. Vukosavljev, and A. P. Schoellig, â€œOnline trajectory
for automated driving using graph neural networks,â€ in 2022 IEEE generation with distributed model predictive control for multi-robot
IntelligentVehiclesSymposium(IV),pp.167â€“174,IEEE,2022. motionplanning,â€IEEERoboticsandAutomationLetters,vol.5,no.2,
[15] B. Wang, X. Gong, Y. Wang, P. Lyu, and S. Liang, â€œCoordination for pp.604â€“611,2020.
connected and autonomous vehicles at unsignalized intersections: An [36] D. Qin, Z. Jin, A. Liu, W.-A. Zhang, and L. Yu, â€œAsynchronous
iterative learning based collision-free motion planning method,â€ IEEE event-triggered distributed predictive control for multi-agent systems
InternetofThingsJournal,2023. withparameterizedsynchronizationconstraints,â€IEEETransactionson
[16] B.Li,T.Acarman,Y.Zhang,Y.Ouyang,C.Yaman,Q.Kong,X.Zhong, AutomaticControl,2023.
and X. Peng, â€œOptimization-based trajectory planning for autonomous [37] Z. Cheng, J. Ma, X. Zhang, C. W. de Silva, and T. H. Lee, â€œADMM-
parkingwithirregularlyplacedobstacles:Alightweightiterativeframe- basedparalleloptimizationformulti-agentcollision-freemodelpredic-
work,â€IEEETransactionsonIntelligentTransportationSystems,vol.23, tivecontrol,â€arXivpreprintarXiv:2101.09894,2021.
no.8,pp.11970â€“11981,2022. [38] Y. Tassa, N. Mansard, and E. Todorov, â€œControl-limited differential
[17] Y.Lee,M.Cho,andK.-S.Kim,â€œGPU-parallelizediterativeLQRwith dynamic programming,â€ in 2014 IEEE International Conference on
input constraints for fast collision avoidance of autonomous vehicles,â€ RoboticsandAutomation(ICRA),pp.1168â€“1175,IEEE,2014.
in 2022 IEEE/RSJ International Conference on Intelligent Robots and [39] W.Schwarting,J.Alonso-Mora,L.Paull,S.Karaman,andD.Rus,â€œSafe
Systems(IROS),pp.4797â€“4804,IEEE,2022. nonlineartrajectorygenerationforparallelautonomywithadynamicve-
[18] C. Mastalli, W. Merkt, J. Marti-Saumell, H. Ferrolho, J. Sola`, hiclemodel,â€IEEETransactionsonIntelligentTransportationSystems,
N. Mansard, and S. Vijayakumar, â€œA feasibility-driven approach to vol.19,no.9,pp.2994â€“3008,2017.
control-limitedDDP,â€AutonomousRobots,vol.46,no.8,pp.985â€“1005, [40] P.D.Grontas,M.W.Fisher,andF.DoÂ¨rfler,â€œDistributedandconstrained
2022. H2 control design via system level synthesis and dual consensus
[19] Y.Aoyama,G.Boutselis,A.Patel,andE.A.Theodorou,â€œConstrained ADMM,â€ in 2022 IEEE 61st Conference on Decision and Control
differentialdynamicprogrammingrevisited,â€in2021IEEEInternational (CDC),pp.301â€“307,IEEE,2022.
ConferenceonRoboticsandAutomation(ICRA),pp.9738â€“9744,IEEE, [41] H.BauschkeandP.Combettes,â€œConvexanalysisandmonotoneoperator
2021. theoryinHilbertspaces,â€CMSbooksinmathematics,vol.10,pp.978â€“
[20] J.Chen,W.Zhan,andM.Tomizuka,â€œAutonomousdrivingmotionplan- 1,2011.
ningwithconstrainediterativeLQR,â€IEEETransactionsonIntelligent [42] A. Dosovitskiy, G. Ros, F. Codevilla, A. Lopez, and V. Koltun,
Vehicles,vol.4,no.2,pp.244â€“254,2019. â€œCARLA: An open urban driving simulator,â€ in Conference on Robot
[21] J. Ma, Z. Cheng, X. Zhang, M. Tomizuka, and T. H. Lee, â€œAlternat- Learning,pp.1â€“16,PMLR,2017.
ing direction method of multipliers for constrained iterative LQR in [43] J. A. Andersson, J. Gillis, G. Horn, J. B. Rawlings, and M. Diehl,
autonomous driving,â€ IEEE Transactions on Intelligent Transportation â€œCasADi:asoftwareframeworkfornonlinearoptimizationandoptimal
Systems,vol.23,no.12,pp.23031â€“23042,2022. control,â€MathematicalProgrammingComputation,vol.11,no.1,pp.1â€“
[22] J.Ma,Z.Cheng,X.Zhang,Z.Lin,F.L.Lewis,andT.H.Lee,â€œLocal 36,2019.
learningenablediterativelinearquadraticregulatorforconstrainedtra-
jectoryplanning,â€IEEETransactionsonNeuralNetworksandLearning
Systems,vol.34,no.9,pp.5354â€“5365,2023.
[23] S.Boyd,N.Parikh,E.Chu,B.Peleato,J.Eckstein,etal.,â€œDistributed
optimizationandstatisticallearningviathealternatingdirectionmethod
of multipliers,â€ Foundations and Trends in Machine Learning, vol. 3,
no.1,pp.1â€“122,2011.
[24] X.Zhang,Z.Cheng,J.Ma,S.Huang,F.L.Lewis,andT.H.Lee,â€œSemi-
definite relaxation-based ADMM for cooperative planning and control
of connected autonomous vehicles,â€ IEEE Transactions on Intelligent
TransportationSystems,vol.23,no.7,pp.9240â€“9251,2021.
[25] G.Banjac, F.Rey, P.Goulart,and J.Lygeros, â€œDecentralizedresource
allocation via dual consensus ADMM,â€ in 2019 American Control
Conference(ACC),pp.2789â€“2794,IEEE,2019.
[26] Z. Huang, S. Shen, and J. Ma, â€œDecentralized iLQR for cooperative
trajectoryplanningofconnectedautonomousvehiclesviadualconsensus
ADMM,â€ IEEE Transactions on Intelligent Transportation Systems,
2023.
[27] J. Ye, L. Xiang, and X. Ge, â€œSpatial-temporal modeling and analysis
ofreliabilityanddelayinurbanV2Xnetworks,â€IEEETransactionson
NetworkScienceandEngineering,2023.
[28] A. I. Rikos, W. Jiang, T. Charalambous, and K. H. Johansson, â€œAsyn-
chronous distributed optimization via ADMM with efficient communi-
cation,â€arXivpreprintarXiv:2309.04585,2023.
[29] O. Shorinwa, T. Halsted, and M. Schwager, â€œScalable distributed op-
timization with separable variables in multi-agent networks,â€ in 2020
AmericanControlConference(ACC),pp.3619â€“3626,IEEE,2020.
[30] A.D.Saravanos,Y.Aoyama,H.Zhu,andE.A.Theodorou,â€œDistributed
differential dynamic programming architectures for large-scale multia-
gentcontrol,â€IEEETransactionsonRobotics,2023.
[31] Z. Sheng, Y. Xu, S. Xue, and D. Li, â€œGraph-based spatial-temporal
convolutional network for vehicle trajectory prediction in autonomous
driving,â€ IEEE Transactions on Intelligent Transportation Systems,
vol.23,no.10,pp.17654â€“17665,2022.