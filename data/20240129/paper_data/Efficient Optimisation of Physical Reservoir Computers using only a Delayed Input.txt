Efficient Optimisation of Physical Reservoir
Computers using only a Delayed Input
ENRICO PICCO1,*, LINA JAURIGUE2, KATHY LÃœDGE2 AND SERGE
MASSAR1
1Laboratoiredâ€™InformationQuantiqueCP224,UniversitÃ©libredeBruxelles(ULB),Av. F.D.Roosevelt50,
1050Bruxelles,Belgium
2InstituteofPhysics,TechnischeUniversitÃ¤tIlmenau,WeimarerStraÃŸe25,98693Ilmenau,Germany
*enrico.picco@ulb.be
Abstract: Wepresentanexperimentalvalidationofarecentlyproposedoptimizationtechnique
forreservoircomputing,usinganoptoelectronicsetup. Reservoircomputingisarobustframework
forsignalprocessingapplications, andthedevelopmentofefficientoptimizationapproaches
remainsakeychallenge. Thetechniqueweaddressleveragessolelyadelayedversionoftheinput
signaltoidentifytheoptimaloperationalregionofthereservoir,simplifyingthetraditionally
time-consumingtaskofhyperparametertuning. Weverifytheeffectivenessofthisapproachon
differentbenchmarktasksandreservoiroperatingconditions.
1. Introduction
Inrecentyears,thequestforefficientandpowerfulmachinelearningparadigmshasledresearchers
to explore unconventional computational architectures inspired by the dynamics of physical
systems. ReservoirComputing(RC)[1]isapossiblepromisingapproach. RCdivergesfrom
conventional neural networks by introducing a distinct architecture characterized by a fixed,
randomlyinitializedrecurrentlayer,called"reservoir",coupledwithasimplelinearreadoutlayer:
itscharacteristicstructurereducesthetrainingcomputationalcomplexity,andconsequently,the
energyconsumption. RCpossessesaremarkablecapacitytoprocesstemporaldata,distinguishing
itselfacrossalargevarietyoftasks,suchasequalizationofdistortednonlinearcommunication
channels [1,2], audio processing [3,4], weather prediction [5], image [6,7] and video [8,9]
classification. RChasalsogatheredattentionforitsfeasibilitytobeingimplementedonawide
rangeofphysicalsubstrates[10,11]. Inparticular,photonicRCstandsoutasoneofthemost
promisinghardwareplatforms,thankstoitsadvantagesinparallelization[12,13],highspeed[14]
andminimalhardwarerequirements[15].
Hyperparameter optimisation is a crucial aspect of tuning reservoir computers, aiming to
enhancetheirperformanceacrossvarioustasks. Variousoptimizationtechniquesareemployed
tosearchforthemosteffectivehyperparametervalues. Gridsearch,randomsearch,andmore
sophisticatedmethodslikeBayesianoptimization[16,17]andgeneticalgorithms[18,19]have
beenproposed. Nonetheless,theoptimizationofhyperparametersremainsacriticalchallengeto
thewidespreadadoptionofRC[20]. Thechallengeliesinexploringthevasthyperparameter
space to find configurations that yield optimal results for a given task, and the sensitivity of
thereservoirtohyperparameters. Thehigh-dimensionalnatureofthehyperparameterspace
canmakethesearchprocesscomputationallyexpensiveandtime-consuming,evenmoresoin
thecaseofslowexperimentalreservoirsthatrequiremorehyperparametersandforwhichone
iterationofthegridsearchtakesuptoseveralhours[8].
In this work we study a novel approach, first introduced in [21] in numerical simulations,
basedontheuseofadelayedinput. In[21]andlaterin[22],Jaurigeatal. showthatadding
atime-delayedversionoftheinputcanconsiderablyimprovetheperformanceofareservoir
whose hyperparameters are not adjusted. This powerful approach requires to tune only two
parametersinsteadofthemanyhyperparametersusuallyassociatedtoareservoir,thusallowing
theoptimisationwithlittlecomputationalcost. Morerecently,theuseoftimedelayedinputswas
4202
naJ
52
]TE.sc[
1v17341.1042:viXrainvestigatednumericallyin[23]inthecontextofaRCbasedonsiliconmicrorings.
WetestthisapproachforthefirsttimeonanexperimentalRC.Weusethearchitecturebased
on time multiplexing first introduced in [24], but in an optoelectronic version as introduced
in[25]andsincestudiedextensively,seee.g.[26â€“28]. Weassesstheimpactofthistechniqueon
differenttasksinvolvingtime-seriesforecastingandaudioclassification,toverifyitseffectiveness
usingdataofvariousnaturewithdifferentintrinsictimescales. Weshowthesuperiority,interms
ofperformance,ofthisprocedureversusthestandardhyperparametersoptimisation.
WehopewiththisworktointroduceanewtechniqueinRCcommunityfortheoptimisation
ofphysicalreservoircomputers;asdiscussedintheconclusion,thisapproachcouldbepartic-
ularlyrelevantforhardwarereservoircomputingwhereitmaynotbepossibletooptimiseall
hyperparameters,orthehyperparametersmaydriftovertime.
2. Time-delayReservoirComputing
Areservoircomputerconsistsofthreemaincomponents: aninputlayer,areservoirandanoutput
layer. Theinputlayermapstheinputsignalintothereservoir. Thereservoirisarecurrentneural
networkwithfixedinterconnections. Thereservoirlayerexploitstherichdynamicsofitsinternal
state,actingasacomplexcomputationalsubstratethattemporallytransformsinputsignalsinto
high-dimensionalrepresentations. Duringthetrainingphase,thereservoirâ€™sstatesareusedto
evaluatetheparametersofthelinearoutputlayer.
Inthiswork,weusethewell-knowndelay-basedreservoircomputerbasedonasinglenonlinear
node. Thereadercanreferto[15,29]forreviewsontime-delayRC.Inthisimplementation,
thereservoirnodesarearrangedinatopologysimilartoaringstructurewhereeachnodeis
connectedtoitsneighboringnodes. Thedynamicsofatime-delayreservoirofsizeğ‘ indiscrete
timeisdescribedby:
ğ‘¥ 0(ğ‘›+1) = ğ‘“(ğ›¼ğ‘¥ ğ‘âˆ’1(ğ‘›âˆ’1)+ğ›½ğ‘€ 0ğ‘¢(ğ‘›))
(1)
ğ‘¥ ğ‘–(ğ‘›+1) = ğ‘“(ğ›¼ğ‘¥ ğ‘–âˆ’1(ğ‘›)+ğ›½ğ‘€ ğ‘–ğ‘¢(ğ‘›)) ğ‘– =1,..,ğ‘ âˆ’1,
andthereservoirâ€™soutputğ‘¦isevaluatedthroughasimplelinearoperationğ‘¦(ğ‘›) =ğ‘Š ğ‘œğ‘¢ğ‘¡ğ‘¥(ğ‘›)and
itisusedtoevaluatethereservoircomputerâ€™sperformance, selectingthetask-specificfigure
ormerit. ğ‘¥(ğ‘›) isthe ğ‘-sizevectorofthereservoirstatesattimestep ğ‘›; ğ‘¢(ğ‘›) isthetemporal
dependentinputsignalofsizeğ¾; ğ‘“ isanonlinearactivationfunction,inourexperimentsisa
sinusoidalfunction(cf. sec. 4);ğ›¼isthefeedbackattenuation,whichrepresentsthestrengthof
theinterconnectionsbetweenreservoirâ€™snodes;theinputmaskğ‘€ mapstheinputsignalinthe
reservoir,anditscoefficientareusuallydrawnatrandomfromauniformdistributionintherange
[âˆ’1,+1]; ğ›½isthescalingoftheinputsignal,usuallycalledinputstrength. Afterrunningthe
reservoir,allthestatevectorsğ‘¥(ğ‘›)arecollectedinağ‘xğ¾ statematrix ğ‘‹ whichisusedforthe
training,i.e. thetoobtaintheğ‘ weightsğ‘Š ğ‘œğ‘¢ğ‘¡ ofthelinearreadoutlayer. Inthisworkweusethe
regularizedlinearregression[43]:
ğ‘Š ğ‘œğ‘¢ğ‘¡ = (ğ‘‹ğ‘‡ğ‘‹+ğœ†ğ¼)âˆ’1ğ‘‹ğ‘‡ğ‘¦Ëœ, (2)
whereğ‘¦Ëœisthetargetsignalandğœ†istheregularizationparameter. Inthecaseofaclassification
taskwithğ¶ outputclasses,ğ‘Š ğ‘œğ‘¢ğ‘¡ becomesağ¶xğ‘ matrix.
3. ReservoirComputingwithDelayedInput
Theideaofthisworkistousedadelayedversionoftheinputtime-seriesğ‘¢(ğ‘›)astheinputsignal
tothereservoir. Weusetwoğ‘xğ¾ inputmasksğ‘€ andğ‘€ withvaluessampledfromuniform
1 2
distributionsintherange [0,1]. Thevalueofthenewinputğ½ attimestepğ‘›isthendefinedas:
ğ½(ğ‘›) = ğ›½ ğ‘¢(ğ‘›)ğ‘€ (ğ‘›)+ğ›½ ğ‘¢(ğ‘›âˆ’ğ‘‘)ğ‘€ (ğ‘›)+ğ½ , (3)
1 1 2 2 0whereğ‘‘ isthedelay, ğ›½ and ğ›½ arescalingparameters,andğ½ isaconstantbias. Thedynamics
1 2 0
ofthereservoirofequation(1)becomethen:
ğ‘¥ 0(ğ‘›+1) = ğ‘“(ğ›¼ğ‘¥ ğ‘âˆ’1(ğ‘›âˆ’1)+ğ½(ğ‘›+1))
(4)
ğ‘¥ ğ‘–(ğ‘›+1) = ğ‘“(ğ›¼ğ‘¥ ğ‘–âˆ’1(ğ‘›)+ğ½(ğ‘›+1)) ğ‘– =1,..,ğ‘ âˆ’1.
The new input ğ½ contains two different components: one related to the input at the present
timestep,andonerelatedtotheinputvalueğ‘‘ timestepsinthepast. Themaskingprocessisnow
madewiththetwodifferentmasksğ‘€ andğ‘€ . Theideaistooptimisethereservoirtuningonly
1 2
thevaluesof ğ›½ andğ‘‘,whilekeepingfixedtheparametersspecifictothereservoir(suchasğ›¼
2
and ğ›½ ). Adetailedexplanationofthisprocedurecanbefoundinsection6.
1
4. ExperimentalSetup
Our optoelectronic setup, shown in Figure 1, implements the time-delay RC introduced in
section 2 and it is similar to experimental systems introduced in previous works [26,27]. A
Fig.1. Optoelectronicreservoircomputer. Inorangetheopticpartandinbluethe
electronicpart. SLD:superluminescentdiode. MZ:Mach-Zenderintensitymodulator.
OA:OpticalAttenuator. PD:Photo-Detector. FPGA:FieldProgrammableGateArray.
Amp: amplifier.
superluminescentdiode(ThorlabsSLD1550P-A40)generatesbroadbandlightat1550nm. A
Field Programmable Gate Array (FPGA) board generates the reservoirâ€™s input signal. This
electricalsignalcomingfromtheFPGAdrivesanelectro-opticMach-Zender(MZ)intensity
modulator(EOSPACEAX2X2-0MSS-12): theinputsignalisthusrepresentedintheoptical
domain. Moreover,thesinusoidaltransferfunctionoftheMZmodulatorworksinintensityonly,
sothattheMZactsas ğ¼ ğ‘ ğ‘–ğ‘›2(ğ‘‰ + ğœ‹) = ğ¼ (1 + 1ğ‘ ğ‘–ğ‘›(2ğ‘‰)). Becausethephotodetectorandthe
0 4 0 2 2
amplifierhavealowpassfilter,theconstanttermhasnoroleinthedynamics,leadingtothe
equations (1), with ğ‘“ as a sinusoidal nonlinearity. The MZ modulator takes roughly 5 ns to
reachasteadystateresponse,whilethemaskstepdurationisintheorderofhundredsofns: itis
thereforepossibletodescribethesystemusingtimediscreteequations.
ThelightpassestroughanOpticalAttenuator(JDSHA9)whichattenuatesthelightintensity
intheloopbyafixedconfigurablefactor. Then,thelighttravelsinafiberspool,whoselengthof
1.7kmcorrespondstoadelayof7.94ğœ‡s. Thisisthedelayusedtoimplementthedelay-based
RC:atthispoint,afterthespool,thelightrepresentsthetime-multiplexedvaluesofreservoirâ€™s
nodes. PartofthislightiscollectedbyaPhoto-Detector(PD),electricallysummedtotheinput
comingfromtheFPGA,andamplified(withaMiniCircuitsZHL-32A+coaxialamplifier)todrivetheMZmodulatoroveritsfullğ‘‰ ğœ‹ range. Theotherpartofthelightiscollectedbyanother
PD,storedbytheFPGAandsavedonaPCforofflinecomputationsoftheoutputweights.
5. Tasks
Wetestouroptoelectronicreservoircomputeronfourdifferenttasks: NARMA10,Mackey-Glass
system,SpokenDigitRecognitionandSpeakerRecognition. Theseareallwidelyusedbenchmark
tasksinRCcommunity. Thefirsttwoaretime-seriespredictionstasks,whosegoalistoforecast
futurevaluesinasequencebasedonhistoricalinformation;thelasttwoareclassificationtasks,
aimingtoaccuratelyidentifyandcategorizeaudio-basedtemporalsignals.
5.1. NARMA10
TheNARMA10taskisawidelyusedbenchmarkinRC,andinvolvespredictingthenextvaluein
asequencegeneratedbyaNARMA(NonlinearAuto-RegressiveMovingAverage)processof
order10. ThistaskevaluatesthecapabilityofaRCtocapturecomplextemporaldependencies
andmakeaccuratepredictionsinnonlineardynamicsystems. Theinputsignalğ‘¢(ğ‘›)israndomly
drawnfromauniformdistributionbetween [0,0.5]. Theoutputğ‘(ğ‘›)oftheNARMA10system
isdefinedas:
9
âˆ‘ï¸
ğ‘(ğ‘›+1) =0.3ğ‘(ğ‘›)+0.05ğ‘(ğ‘›)( ğ‘(ğ‘›âˆ’1))+1.5ğ‘¢(ğ‘›âˆ’9)ğ‘¢(ğ‘›)+0.1. (5)
ğ‘–=0
The aim is, given ğ‘¢(ğ‘›), to predict ğ‘(ğ‘›). We evaluate the accuracy of the system using the
normalisedmeansquareerror(NMSE),definedas
âŸ¨(ğ‘¦(ğ‘›)âˆ’ğ‘¦Ëœ(ğ‘›))2âŸ©
ğ‘ğ‘€ğ‘†ğ¸ = , (6)
âŸ¨ğ‘¦Ëœ(ğ‘›)âˆ’âŸ¨ğ‘¦Ëœ(ğ‘›)âŸ©)2âŸ©
whereğ‘¦(ğ‘›)isthereservoirâ€™soutputandğ‘¦Ëœ(ğ‘›)isthetargetsignal(ğ‘¦Ëœ(ğ‘›) =ğ‘(ğ‘›)forNARMA10).
5.2. Mackey-Glasssystem
The Mackey-Glass system describes a time-delay differential equation that exhibits chaotic
behavior[30]:
ğ‘‘ğ‘¥ ğ‘¥(ğ‘¡âˆ’ğœ)
= ğ›½ âˆ’ğ›¾ğ‘¥. (7)
ğ‘‘ğ‘¡ 1+ğ‘¥(ğ‘¡âˆ’ğœ)ğ‘›
With ğ›½ =0.2,ğœ =17,ğ‘› =10,ğ›¾ =0.1andtimestepğ‘‘ğ‘¡ =1. Inthisworkwetrytoforecastthe
valuesoftheseriestentimestepsintothefuture. SimilarlytoNARMA10,alsoforthistaskwe
usetheNMSE(eq. 6)asafigureofmerit.
5.3. SpokenDigitRecognition
TheSpokenDigitRecognitiondatasetconsistsof500totalutterancesofthe10(from0to9)
digits. Eachdigitisrepeatedtentimesbyfivedifferentindividuals. Weuseadatasetwitha3dB
Signal-To-Noise(SNR)ratiobabblenoise,toincreasethedifficultyofthetaskandtoevaluate
thesystemâ€™sperformanceinnoisyenvironments. Thedatasetissplit450/50fortrain/test. The
audiosignalsarepre-processedusingtheLyonPassiveEarmodel[31]. Thismodelemulates
theauditorycanalâ€™sbiologicalresponseandtransformstheoriginaltime-domainutterancesina
86-channelsfrequencyrepresentation,whichisusedasinputsignal. Thelengthoftheutterances
rangesfrom22to95timesteps,withanaveragelengthofapproximately68timestepseach.
Inordertoaddressthesmallsizeofourdatasetcontaining500digits,weimplementk-fold
cross-validationwithk=10. Thistechniqueinvolvesdividingthedatasetinto10equalpartsof50
digitseach. Thetrainingprocessisthenrepeated10times,whereeachtimeadifferentsubsetof50digitsisusedfortestingwhiletheremaining450areusedfortraining. Sincethisisisa
classificationtaskwith10outputclasses,weuse10distinctlinearclassifiers: eachclassifieris
designedtooutput"+1"iftheinputmatchesthecorrespondingdigitand"-1"otherwise. The
systemselectsoneoftheoutputclassesasthewinningoneforeverytimestepofanutterance,
and the most voted classduring the duration of anutterance is selected as the prediction for
thatparticularutterance: thisapproachisusuallyreferredtoaswinner-takes-all. Sincethisisa
classificationtaskandnotatime-seriespredictiontask,wedonâ€™tuseuseanymoretheNMSEas
afigureofmeritbuttheErrorRate. TheErrorRateissimplydefinedastheratiobetweenthe
utterancespredictedcorrectlyandthetotalamountofutterances.
5.4. SpeakerRecognition
TheJapaneseVowelsdataset[32]consistsof640utterancesoftheJapanesevowelâ€˜aeâ€™,pronounced
by 9 individuals. The goal is to correctly identify the speaker for each utterance. To keep
consistency with previous works, the database is split in 270 train sequences and 370 test
sequences. Theaudiosamplesarepre-processedusingtheMel-frequencycepstralcoefficients
(MFCCs)toobtaintheirfrequencyrepresentation,usedasinputsignaltothereservoir. Each
sampleconsiststhusof12MFCCcoefficientsforeverytimestep. Thelengthoftheutterances
rangesfrom7to29timesteps,withanaveragelengthofapproximately15timestepseach. For
statisticalpurpose,thetrainingprocedureisrepeated10times: eachtimeweselectatrandom
270audiosamplesforthetrainingandusetherestfortesting. Alsohere,aswiththeSpoken
DigitRecognitiontask,theErrorRateandthewinner-takes-allapproachareusedtoevaluatethe
accuracyofthesystem.
6. Results
Inthissectionweshowtheexperimentalresultsobtainedwithouroptoelectronicreservoiron
thetaskslistedinsection5. Weuseğ‘ =50reservoirnodesforNARMA10andMackey-Glass,
andğ‘ =100nodesfortheaudiotasks. FortheNARMA10andMackey-Glasstasks,weusea
time-serieslengthofğ¾ =21000. Wedividethesedatapointsinfoursets: thefirst500points
areremovedforwashout,thenext10000pointsareusedfortraining,then500pointsareagain
removedforwashout,andthelast10000pointsareusedfortesting. Forwashoutwemeanthe
removingofinitialortransientstatesinasystem,toensurethatthemodelfocusesonthesystemâ€™s
steady-statebehaviorratherthantransienteffectsthatmightnotrepresentthesystemâ€™slong-term
dynamics. FortheDigitsandtheSpeakerstasks,theinputlengthisgivenbythedatasetitself(cf.
section5). Thefrequency-encodedaudiosamplesaresenttothereservoirsequentially: thestate
ofthereservoirarenotresetbetweeneverydigit,meaningthatthedelayedinputcancombine
datapointscomingfromthepresentandthepreviousdigit.
Totesttheeffectivenessoftheoptimisationusingthedelayedinput,weusethesameapproach
forallthetasks. Theinputscaling ğ›½ andthebias ğ½ (cf. equation(3))areselectedforeach
1 0
tasksothattherangeoftheinputğ½(ğ‘›)fallsintherange[0.2,1.4]when ğ›½ issettozero. These
2
values,thoughnotoptimized,areconsideredreasonableinputsforthereservoir. Thefeedback
attenuationissetwiththeOAofFigure1to2dB(whichroughlycorrespondstoağ›¼ = 0.15
in equation (1)), a reasonable operating value for our optoelectronic reservoir, and the ridge
regressionparameterissettoğœ† =10âˆ’5forallthetasks. Weemphasizethatwedonotoptimise
thevalueofğ›¼, ğ›½ andğœ†ashyperparametersforeverytask,asitisusuallydoneinRC.Another
1
importantparameterthatisnotoptimisedisthefeedbackdelaytime. Infact,inthisworkwewant
tohighlightthereliabilityofusingthedelayedinputforoptimisationwithouthavingtorelyonthe
traditionaltuningofhyperparameters. Moreover,wetesttheNARMA10andMackey-Glasstasks
alsowithavalueoffeedbackparameterof15dB(whichroughlycorrespondstoğ›¼ =10âˆ’4),very
farfromreasonablevalues,toassesstheeffectivenessofthisapproachwhenthehyperparameters
areofffromacceptablevalues. Table1containsinamorecompactformallthevaluesabovementioned,forallthetasks.
ğ›½ ğ½ Opt. att. ğœ† ğ‘
1 0
NARMA10 1.8 0.4 2dB&15dB 10âˆ’5 50
Mackey-Glass 1 0 2dB&15dB 10âˆ’5 50
SpokenDigit 10 0 2dB 10âˆ’5 100
Speaker 0.3 0.8 2dB 10âˆ’5 100
Table1. Parametersoftheinputandthereservoir,foralltheconsideredtasks. The
optical attenuation (opt. att.) is set by the OA in Figure 1, and is related to the
hyperparameterğ›¼ofequation(1).
Theonlytwoparametersthatweneedtotuneforeachtaskarethenthescalingofthedelayed
partoftheinput ğ›½ andthedelayğ‘‘ (cf. equation(3)). Weincludeinthesearchalsothecase
2
where ğ›½ isscannedwhileğ‘‘ =0,whichgivesaroughideaofhowthereservoirbehaveswhen
2
scanningtheinputstrengthwithnodelayedinput(cf. section6.2foramoredetailedcomparison
oftheoptimisationwithandwithoutdelayedinput).
6.1. Effectivenessofoptimisationwithdelayedinput
Figure2showresultsontheNARMA10task. Wescantheparameters ğ›½ andğ‘‘ lookingforthe
2
bestconfiguration. OurbestresultsisaNMSEof0.4: itcorrespondstoadelayof9timesteps,
most likely due to the intrinsic timescales of the NARMA10 task (cf. equation (5)). As a
comparison,in[27]authorsreachabestNMSEof0.32withasimilaroptoelectronicsystem,in
alllikelihoodbecauseofthehighernumberofvirtualnodesused(ğ‘ =80whileweuseğ‘ =50).
Moreover,theresultsin[27]areobtainedthroughamoreadvancedtrainingmethodbasedon
physicalbackpropagation,whileweuseasimplescanningoftwoparameters. In[26]authorsuse
anFPGA-basedoptoelectronicreservoirsimilartooursandreachaNMSEof0.2,butusinga
morecomplextrainingschemebasedonananalogoutputlayerandanonlinelearningalgorithm.
In[21]authorsreachaNMSEof0.3usingthedelayedinputapproachinnumericalsimulations.
Additionally,wewantedtotesthowtheoptimisationwithdelayedinputworksinthecase
wherethereservoirhyperparametersareratherpoor. Figure2(a)andFigure2(b)showresults
correspondingtoreservoirswhereadifferentfeedbackattenuationğ›¼isapplied: theattenuation
is2dBinFigure2(a)and15dBinFigure2(b). Asexplainedpreviously,with2dBoursetup
canworkreasonablyonvarioustasks;instead,15dBisahighattenuationvaluethatbringsthe
systeminaoperatingregionofpoorperformance. Nonetheless,itisclearfromFigure2(b)that
usingadelayedinput,forthistask,allowstoreachthebestperformanceevenwhileoperating
inthissub-optimalhyperparameterregion. Wealsofindquitepoorperformancewithoutdelay
(ğ›½ =0)inbothcases,mostlikelybecausethehyperparametersofthereservoir(suchasğ›¼, ğ›½ ,
2 1
ğœ†)arenotoptimised.
Similar results, shown in Figure 3(a), are obtained on the prediction of the Mackey-Glass
system. Withoutdelay(ğ›½ =0)theperformancearealreadyacceptable(NMSE=0.20),butthey
2
getfurtherimprovedwiththedelay,reachinganNMSE=0.063withğ‘‘ =11. Similarresultswere
obtainedonthesametaskinnumericalsimulationsin[21],usingthedelayedinputapproach. Our
resultsarealsocomparabletopreviousworks[33,34]whichusesimilartime-delayreservoirs
withthousandsofnodes. Inthecaseofanattenuationof15dB(Figure3(b)),withoutdelaythe
systemperformsverypoorly,withtheNMSEexceeding2;instead,bytuningthedelayedinput
wereachanNMSE=0.141. Thisprovesthat,evenwhenveryinadequatehyperparametersare
selected,theuseofadelayedinputcanstillbringthereservoirinavaluableoperatingregion.Fig.2. ExperimentalresultsontheNARMA10taskasafunctionofğ›½ andthedelayğ‘‘
2
ofequation(3),usingdifferentopticalfeedbackattenuation: 2dB(a)and15dB(b).
Note that the optimal delay ğ‘‘ is different from the delay ğœ in equation (7) (while one would
naivelysupposetheyshouldbesimilar).
Fig.3. ExperimentalresultsonthepredictionofMackey-Glasssystem10stepsin
thefuture,asafunctionofğ›½ andthedelayğ‘‘ofequation(3),usingdifferentoptical
2
feedbackattenuation: 2dB(a)and15dB(b).
Theresultson"noisy"SpokenDigitRecognitionarereportedinFigure4. Forthistaskthe
errorrateisconsiderablyimprovedusingthedelayedinput,decreasingfrom0.250withnodelay
(ğ›½ =0)to0.156withadelayğ‘‘ =23. In[35],onthesametaskandwiththesameoptoelectronic
2
setup, we reported similar performance but using a deep architecture with 2 interconnected
reservoirofsizeğ‘ =100each,orusingasinglereservoirofsizeğ‘ =600,whileinthisworkwe
useonlyonereservoirofsizeğ‘ =100.
Figure5showsresultsontheSpeakerRecognition. Alsointhiscasetheuseofadelayedinput
increasetheperformance. Theerrorratedecreasesfrom0.0384withnodelay(ğ›½ =0)to0.0170
2
errorwithadelayğ‘‘ =5. Asacomparison,in[36]authorsreachabesterrorofroughly0.020
withanopticalreservoirofğ‘ =200nodes,whereasin[37]authorsreportanerrorofroughlyFig.4. ExperimentalresultsonSpokenDigitRecognitionwithnoise,asafunctionof
ğ›½ andthedelayğ‘‘ofequation(3).
2
0.035withareservoirsizecomparabletoours.
Forthesetwolattertasksinvolvingaudioprocessing,theexplanationfortheoptimumvalues
ofthedelayisnotstraightforward. Forbothtasks,theoptimumdelayvalueisshorterthanthe
averagedurationofanutterance: theDigitstaskhasanaveragesamplelengthof68timestepsand
anoptimumdelayğ‘‘ =23,whiletheSpeakerstaskhasanaveragesamplelengthof15timesteps
andanoptimumdelayğ‘‘ = 5. Adelayshorterthantheutterancedurationmeansthatmostof
the times the delayed input term and the non-delayed input term refer to the same utterance.
Thus,theseresultssuggestthattheperformanceofthereservoircanbeincreasedwhendifferent
temporalcomponentsofthesameutterancearecombined. While ğ‘‘ andthesampleduration
seemsomewhatcorrelated,theirrelationshipdoesnotlookimmediatelyquantifiableanditisnot
possiblesofartoestimatetheoptimumdelayapriori. Thismaybeduetothedifferentaudio
preprocessingalgorithmsusedforthetwodatasets.
6.2. Optimisationwithdelayedinputvsstandardhyperparametersoptimisation
Theprevioussectionreportshow,forallthetasks,theuseofadelayedinputoutperformsthe
case where no delay is used, i.e. ğ›½ = 0. However, all the results presented so far refer to a
2
reservoirwhosehyperparametersarenotoptimised,butrathersettoareasonablevalue. What
happensinsteadifthehyperparametersareoptimizedforeachtask? Wouldthesuperiorityof
theoptimisationwithdelayedinputstillholdtrue? WetrytoanswerthisquestionwithFigure
6. Thepurplecurvesrepresentthe"standard"approachinRCwithnodelay, i.e. tuningthe
hyperparameters (in this case ğ›¼, ğ›½ and ğœ†) for every task. The orange curves represent the
1
optimisationusingthedelayedinput,bysettingtheparameterstothereasonablevaluesofTable
1andtuningonlythedelayparameters ğ›½ andğ‘‘. Inbothcases,weexplorethebehaviourofthe
2
systemwhensweepingtheopticalattenuation(expressedindB),whichisrelatedtothefeedback
attenuationğ›¼.
Forallthetasks,itisclearthattheoptimisationwithadelayedinputprevails: itsaccuracy
ishigherforeveryvalueofattenuationconsidered. Especiallyforanopticalattenuationlarger
than10dB,whereperformancewithoutdelayareverybad,theuseofadelayensuresaccuracy
remainshigh.Fig.5. ExperimentalresultsonSpeakerRecognition,asafunctionofğ›½ andthedelay
2
ğ‘‘ofequation(3).
Fig.6. Experimentalresultsonallthetasks,tocomparethestandardapproach(without
delay)andtheapproachproposedinthiswork(withdelay). Thepurplecurvesare
obtainedusingnodelay,optimisingthehyperparametersğ›½ andğœ†andthensweeping
1
theopticalfeedbackattenuation. Theorangecurvesareobtainedusingthedelayed
input,optimisingtheparametersğ›½ andğ‘‘ofequation(3),andthensweepingtheoptical
2
feedbackattenuation.7. Conclusions
Inthisworkweinvestigateanovelapproachfortheoptimisationofphysicalreservoircomputers
using a delayed input, introduced numerically in [21]. We verify its effectiveness using an
optoelectronicsetupondifferentbenchmarktasks,involvingtime-seriespredictionandaudio
signalclassification.
Weemphasizetheadvantagesofthisapproach. Itisaverysimpletechniquethatdoesnot
requirecomplexsearchalgorithms. Infact,thereservoirâ€™sperformancecanbeoptimisedonlyby
tuningtwoparameters: thestrengthofthedelayedcomponent(ğ›½ )oftheinput,andthedelay
2
itself(ğ‘‘). Therefore,itisnotnecessarytocarefullyselectthereservoirâ€™shyperparametersfor
everytask: itissufficienttosetthemtosomereasonablevalueandfinetunethedelayedinput.
Inaddition,theperformanceisnotverysensitiveonthevalueof ğ›½ : valuesintherange1-3
2
aregood,andneedabitofrefinementtogetthebestvalues. Sinceoneonlyneedstoactonthe
inputsignal,thisapproachcanbeusefulforphysicalreservoirswhosehyperparameterscannot
betunedduetoreal-worldconstraints. Furthermore,eveninthecasewherethehyperparameters
areconsiderablyofffromacceptablevalues,theuseofadelayedinputcanstillbringthereservoir
tosatisfactoryperformance. Moreover,thisoptimisationprocedureoutperformsthetraditional
hyperparameterstuningintermsofperformance.
Someopenquestionswhichweleaveopenforfutureresearchconcerntherelationshipbetween
thetimescaleofatemporaltaskandtheoptimumamountofdelaytoemploy;theuseofmultiple
delays(inwhichcaseimprovedoptimisationschemes,suchasBayesianoptimisation,ratherthan
thesimplegridscanusedhere,wouldbeuseful);andontheexperimentalsidetheimplementation
ofthedelayedinputwithaphysicaldelayline.
Funding. E.PandS.M.acknowledgefinancialsupportfromtheH2020MarieSkÅ‚odowska-CurieActions
(ProjectPOSTDIGITALGrantnumber860360),andfromtheFondsdelaRechercheScientifique-FNRS,
BelgiumunderfundingEOSnÂ°40007536andCDRnÂ°40021243. L.J.andK.L.acknowledgefunding
fromtheDeutsche369Forschungsgemeinschaft(DFG),GrantNo. LU1729/3-1370(Projektnummer
445183921).
References
1. H. Jaeger and H. Haas, â€œHarnessing nonlinearity: Predicting chaotic systems and saving energy in wireless
communication,â€Science304,78â€“80(2004).
2. I.EstÃ©banez,S.Li,J.Schwind,etal.,â€œ56gbaudpam-4100kmtransmissionsystemwithphotonicprocessing
schemes,â€J.Light.Technol.40,55â€“62(2022).
3. D.Verstraeten,B.Schrauwen,D.Stroobandt,andJ.VanCampenhout,â€œIsolatedwordrecognitionwiththeliquid
statemachine:acasestudy,â€Inf.Process.Lett.95,521â€“528(2005).
4. F.Triefenbach, A.Jalalvand, B.Schrauwen, andJ.-P.Martens, â€œPhonemerecognitionwithlargehierarchical
reservoirs,â€Adv.NeuralInf.Process.Syst.23(2010).
5. Y.D.Mammedov,E.U.Olugu,andG.A.Farah,â€œWeatherforecastingbasedondata-drivenandphysics-informed
reservoircomputingmodels,â€Environ.Sci.Pollut.Res.pp.1â€“14(2022).
6. N.Schaetti,M.Salomon,andR.Couturier,â€œEchostatenetworks-basedreservoircomputingformnisthandwritten
digitsrecognition,â€in2016IEEEIntlConferenceonComputationalScienceandEngineering(CSE)andIEEEIntl
ConferenceonEmbeddedandUbiquitousComputing(EUC)and15thIntlSymposiumonDistributedComputingand
ApplicationsforBusinessEngineering(DCABES),(2016),pp.484â€“491.
7. P. Antonik, N. Marsal, and D. Rontani, â€œLarge-scale spatiotemporal photonic reservoir computer for image
classification,â€IEEEJ.Sel.Top.QuantumElectron.26,1â€“12(2019).
8. P.Antonik,N.Marsal,D.Brunner,andD.Rontani,â€œHumanactionrecognitionwithalarge-scalebrain-inspired
photoniccomputer,â€Nat.Mach.Intell.1,530â€“537(2019).
9. E.Picco,P.Antonik,andS.Massar,â€œHighspeedhumanactionrecognitionusingaphotonicreservoircomputer,â€
NeuralNetworks165,662â€“675(2023).
10.G.Tanaka,T.Yamane,J.B.HÃ©roux,etal.,â€œRecentadvancesinphysicalreservoircomputing:Areview,â€Neural
Networks115,100â€“123(2019).
11.K.NakajimaandI.Fischer,ReservoirComputing(Springer,2021).
12.A.Liutkus,D.Martina,S.Popoff,etal.,â€œImagingwithnature:Compressiveimagingusingamultiplyscattering
medium,â€Sci.Reports4,1â€“7(2014).13.M.Rafayelyan,J.Dong,Y.Tan,etal.,â€œLarge-scaleopticalreservoircomputingforspatiotemporalchaoticsystems
prediction,â€Phys.Rev.X10,041037(2020).
14.L.Larger,A.BaylÃ³n-Fuentes,R.Martinenghi,etal.,â€œHigh-speedphotonicreservoircomputingusingatime-delay-
basedarchitecture:Millionwordspersecondclassification,â€Phys.Rev.X7,011015(2017).
15.G.VanderSande,D.Brunner,andM.C.Soriano,â€œAdvancesinphotonicreservoircomputing,â€Nanophotonics6,
561â€“576(2017).
16.J.YpermanandT.Becker,â€œBayesianoptimizationofhyper-parametersinreservoircomputing,â€arXivpreprint
arXiv:1611.05193(2016).
17.P.Antonik, N.Marsal, D.Brunner, andD.Rontani, â€œBayesianoptimisationoflarge-scalephotonicreservoir
computers,â€Cogn.Comput.pp.1â€“9(2021).
18.A.A.Ferreira,T.B.Ludermir,andR.R.deAquino,â€œAnapproachtoreservoircomputingdesignandtraining,â€
ExpertSyst.withAppl.40,4172â€“4182(2013).
19.S.BasterrechandT.K.Sharma,â€œRe-visitingreservoircomputingarchitecturesoptimizedbyevolutionaryalgorithms,â€
inInternationalConferenceonSoftComputingandPatternRecognition,(Springer,2022),pp.832â€“843.
20.H.Joy, M.Mattheakis, andP.Protopapas, â€œRctorch: apytorchreservoircomputingpackagewithautomated
hyper-parameteroptimization,â€arXivpreprintarXiv:2207.05870(2022).
21.L.Jaurigue,E.Robertson,J.Wolters,andK.LÃ¼dge,â€œReservoircomputingwithdelayedinputforfastandeasy
optimisation,â€Entropy23,1560(2021).
22.L.JaurigueandK.LÃ¼dge,â€œReducingreservoircomputerhyperparameterdependencebyexternaltimescaletailoring,â€
NeuromorphicComput.Eng.(2024).
23.B.J.G.Castro,C.Peucheret,andF.DaRos,â€œWavelength-multiplexeddelayedinputsformemoryenhancementof
microring-basedreservoircomputing,â€arXivpreprintarXiv:2312.04204(2023).
24.L.Appeltant,M.C.Soriano,G.VanderSande,etal.,â€œInformationprocessingusingasingledynamicalnodeas
complexsystem,â€Nat.Commun.2,468(2011).
25.Y.Paquot,F.Duport,A.Smerieri,etal.,â€œOptoelectronicreservoircomputing,â€Sci.Reports2,287(2012).
26.P.Antonik,F.Duport,M.Hermans,etal.,â€œOnlinetrainingofanopto-electronicreservoircomputerappliedto
real-timechannelequalization,â€IEEETrans.onNeuralNetworksLearn.Syst.28,2686â€“2698(2016).
27.M.Hermans,P.Antonik,M.Haelterman,andS.Massar,â€œEmbodimentoflearninginelectro-opticalsignalprocessors,â€
Phys.Rev.Lett.117,128301(2016).
28.M.Nakajima,K.Inoue,K.Tanaka,etal.,â€œPhysicaldeeplearningwithbiologicallyinspiredtrainingmethod:
gradient-freeapproachforphysicalhardware,â€Nat.Commun.13,7847(2022).
29.T.HÃ¼lser,F.KÃ¶ster,L.Jaurigue,andK.LÃ¼dge,â€œRoleofdelay-timesindelay-basedphotonicreservoircomputing,â€
Opt.Mater.Express12,1214â€“1231(2022).
30.M.C.MackeyandL.Glass,â€œOscillationandchaosinphysiologicalcontrolsystems,â€Science197,287â€“289(1977).
31.R.Lyon,â€œAcomputationalmodeloffiltering,detection,andcompressioninthecochlea,â€inICASSPâ€™82.IEEE
InternationalConferenceonAcoustics,Speech,andSignalProcessing,vol.7(IEEE,1982),pp.1282â€“1285.
32.M.Kudo,J.Toyama,andM.Shimbo,â€œMultidimensionalcurveclassificationusingpassing-throughregions,â€Pattern
Recognit.Lett.20,1103â€“1111(1999).
33.S.OrtÃ­n,M.C.Soriano,L.Pesquera,etal.,â€œAunifiedframeworkforreservoircomputingandextremelearning
machinesbasedonasingletime-delayedneuron,â€Sci.reports5,14945(2015).
34.P.Antonik,M.Gulina,J.Pauwels,andS.Massar,â€œUsingareservoircomputertolearnchaoticattractors,with
applicationstochaossynchronizationandcryptography,â€Phys.Rev.E98,012215(2018).
35.E.Picco,A.Lupo,andS.Massar,â€œDeepphotonicreservoircomputerforspeechrecognition,â€(2023).
36.U.Paudel,M.Luengo-Kovac,J.Pilawa,etal.,â€œClassificationoftime-domainwaveformsusingaspeckle-based
opticalreservoircomputer,â€Opt.Express28,1225â€“1237(2020).
37.M.Dale,R.F.Evans,A.Sebald,andS.Stepney,â€œReservoircomputingwithnanowireexchange-coupledspintorque
oscillatorarrays,â€inInternationalConferenceonUnconventionalComputationandNaturalComputation,(Springer,
2023),pp.64â€“78.