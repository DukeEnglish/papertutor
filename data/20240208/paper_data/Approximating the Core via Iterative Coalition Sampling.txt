Approximating the Core via Iterative Coalition Sampling
IanGemp MarcLanctot LukeMarris
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom Montreal,Canada London,UnitedKingdom
imgemp@google.com lanctot@google.com marris@google.com
YiranMao EdgarDuÃ©Ã±ez-GuzmÃ¡n SarahPerrin
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom London,UnitedKingdom Paris,France
yiranm@google.com duenez@google.com sarahperrin@google.com
AndrasGyorgy RomualdElie GeorgiosPiliouras
GoogleDeepMind GoogleDeepMind GoogleDeepMind
London,UnitedKingdom Paris,France London,UnitedKingdom
agyorgy@google.com relie@google.com gpil@google.com
MichaelKaisers DanielHennes KaleshaBullard
GoogleDeepMind GoogleDeepMind GoogleDeepMind
Paris,France ZÃ¼rich,Switzerland London,UnitedKingdom
mkaisers@google.com hennes@google.com ksbullard@google.com
KateLarson YoramBachrach
GoogleDeepMind GoogleDeepMind
Montreal,Canada London,UnitedKingdom
katelarson@google.com yorambac@google.com
ABSTRACT ACMReferenceFormat:
Thecoreisacentralsolutionconceptincooperativegametheory, IanGemp,MarcLanctot,LukeMarris,YiranMao,EdgarDuÃ©Ã±ez-GuzmÃ¡n,
SarahPerrin,AndrasGyorgy,RomualdElie,GeorgiosPiliouras,Michael
definedasthesetoffeasibleallocationsorpaymentssuchthatno
Kaisers,DanielHennes,KaleshaBullard,KateLarson,andYoramBachrach.
subsetofagentshasincentivetobreakawayandformtheirownsub-
2024.ApproximatingtheCoreviaIterativeCoalitionSampling.InProc.
grouporcoalition.However,ithaslongbeenknownthatthecore
ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagent
(andapproximations,suchastheleast-core)arehardtocompute.
Systems(AAMAS2024),Auckland,NewZealand,May6â€“10,2024,IFAAMAS,
Thislimitsourabilitytoanalyzecooperativegamesingeneral,and 15pages.
tofullyembracecooperativegametheorycontributionsindomains
suchasexplainableAI(XAI),wherethecorecancomplementthe
Shapleyvaluestoidentifyinfluentialfeaturesorinstancessupport-
ingpredictionsbyblack-boxmodels.Weproposenoveliterative 1 INTRODUCTION
algorithmsforcomputingvariantsofthecore,whichavoidthe Coalitionalgametheorystudiesgamesplayedbyself-interested
computationalbottleneckofmanyotherapproaches;namelysolv- playerswhereincentivesarealignedandfully-bindingcontracts
inglargelinearprograms.Assuch,theyscalebettertoverylarge aresupported[21].Theutilityachieveddependsonwhichgroup,
problemsaswedemonstrateacrossdifferentclassesofcoopera- i.e.,whichcoalition,ofplayersisformedtosolvethegame.The
tivegames,includingweightedvotinggames,inducedsubgraph keyproblemthatresearchershavefocusedonishowthistotal
games,andmarginalcontributionnetworks.Wealsoexploreour utility should be divided among the individual members of the
algorithmsinthecontextofXAI,providingfurtherevidenceofthe team.Severalsolutionconceptshavebeenproposedtoaddressthis
powerofthecoreforsuchapplications. question,withthecore[40]andtheShapleyvalue[70]beingamong
thebestknown.TheShapleyvaluequantifiesthecontributionof
KEYWORDS eachindividualplayerviathedifferencesinvalueobtainedover
allpossiblesubgroupswhichincludeandexcludethatplayer.In
CooperativeGameTheory;Core;ExplainableAI
contrast, the core is a rough cooperative analogue of the Nash
equilibrium:autilitydivisionthatisstable,i.e.,nosubsetofplayers
hasincentivetodeviatefromthechosencoalition.
Proc.ofthe23rdInternationalConferenceonAutonomousAgentsandMultiagentSystems Cooperativegametheoryhasfoundmanyapplications,ranging
(AAMAS2024),N.Alechina,V.Dignum,M.Dastani,J.S.Sichman(eds.),May6â€“10,2024, fromanalyzingpowerindecisionmakingbodiesandpoliticalset-
Auckland,NewZealand.Â©2024InternationalFoundationforAutonomousAgentsand
MultiagentSystems(www.ifaamas.org). tings[71],throughpredictinghowplayersmayshareteampayoffs
4202
beF
6
]TG.sc[
1v82930.2042:viXraorcosts[32,53]toriskattribution[73].Oneprominentapplica- 2 BACKGROUND
tionofcooperativegametheoryisinanalyzingwhatdrivesthe Thecentralconceptincooperativegametheoryisthatofacoalition.
predictionsofmachinelearningmodels.Asmoreofourdecisions Givenasetofğ‘›agents,ğ¼ ={1,2,...,ğ‘›},acoalitionisasubsetof
arenowinformedbylearnedmodels,itiscrucialtounderstand agents,ğ¶ âŠ†ğ¼,wherethegrandcoalitionisthecoalitioncontaining
whyourmodelsoutputwhattheydo,whichisthemaingoalof allagentsinğ¼.Acoalitionalgame,ğº,isfurthercoupledwitha
explainableAI(XAI)[13].TheShapleyvaluehasbeenadoptedin characteristicfunction,ğ‘£ :2ğ¼ â†’Rthatassignsarealvaluetoeach
themachinelearningcommunitytoexplainmodelpredictions[54]: coalitionofagents,representingthetotalutilitythatthecoalitionof
thefeaturesaretreatedasplayers,andthepayofftoacoalitionis agentsachievetogether.Westudytransferableutilitygames,where
theoutputofthemodelwhentrainingexclusivelyonthesubsetof ğ‘£(ğ¶) isinterpretedasvaluethatistobesharedandtransferred
inputfeaturesinthecoalition.TheShapleyvaluethencomputes betweenmembersofthecoalitionğ¶.Asisstandard,ğ‘£(âˆ…)=0.
themarginalcontributionofeachfeaturetotheoutput,offering Thecharacteristicfunctiononlydefinesthegainsacoalitioncan
additiveexplanationsfortheeffectofeachfeatureonprediction. achieve;itdoesnotdefinehowthesegainsaredistributedamong
However,therearesomelimitationsregardingShapleyvalues:it thecoalitionmembers.Animputation(alsocalledpayoffvector)
mayproducecounter-intuitiveexplanations[72],behavioralstudies ğ‘ = (ğ‘1,...,ğ‘ ğ‘›)isadivisionofthegainsofthegrandcoalitionğ¼
h dia vv ie siosh no sw ,an ndth ae cc co ur re atc ea en stb ie mm ato iore np rere qd ui ic rt ei sve mo af nh yu sm aman plp ea sy [m 6,e 5n 5t
,
ğ‘am to hn eg pt ah ye oa ffge on ft as g, ew nh te ğ‘–r ,e anğ‘ ğ‘– dâ‰¥ de0 n, os tu ec th ht eh pat ay(cid:205) oğ‘› ğ‘– ff=1 oğ‘ fğ‘– a= coğ‘£ a(ğ¼ li) t. ioW ne ğ¶ca al sl
ğ‘–
56]1.Assuch,thecorehasbeenrecentlymotivatedasapossible
ğ‘(ğ¶)=(cid:205) ğ‘–âˆˆğ¶ğ‘ ğ‘–.
alternativetoShapleyvaluesforXAI[78].UnlikeShapleyvalues, Abasicrequirementforagoodimputationisindividualrational-
thecorefocusesonstability[21]:apaymentdivisionisstableif ity,whichstatesthatforallagentsğ‘– âˆˆğ¶,wehaveğ‘
ğ‘–
â‰¥ğ‘£({ğ‘–});oth-
noplayerhasincentivetodeviatefromthecoalitionandforma erwise,someagenthasincentivestoworkaloneinstead.Similarly,
differentoneontheirown.Consequently,corepaymentsmaybetter wesayacoalitionğµblocksimputation(ğ‘1,...,ğ‘ ğ‘›)ifğ‘(ğµ) <ğ‘£(ğµ),
reflecteachplayerâ€™sâ€œmarketvalueâ€[25,68]. sincethemembersofğµcansplitfromtheoriginalcoalition,derive
Akeybarriertoapplyingcooperativegametheoryinpracticeis thegainsofğ‘£(ğµ)byworkingtogetherandthenreallocatethisex-
thehighcomputationalcostassociatedwithcalculatingthevarious cess,ğ‘£(ğµ)âˆ’ğ‘(ğµ) >0,toagentsinğµ.Thisincentivetobreakaway
solutionconcepts,whichmaybehardtocomputeevenforvery andformnewcoalitionsleadstoinstabilityandhaslongbeena
restricted forms of cooperative games [21]. For some solutions, focusofcooperativegametheory.Themostprominentsolution
such as the Shapley value and other power indices, there exist conceptisthatofthecore[40].
efficientapproximationalgorithms[16,20],e.g.,anapproximate
formoftheShapleyvaluecanbecomputedusingMonteCarlo Definition1. Thecoreofacoalitionalgameğº isthesetofall
sampling[6,39,56],whichmightexplainitswideadoption. imputationsthatarenotblockedbyanycoalition.Thatisitcontains
Incontrast,solutionsbasedonthecorehaveprovedtobemore imputationğ‘ =(ğ‘1,...,ğ‘ ğ‘›)ifandonlyifforallğ¶ âŠ†ğ¼,ğ‘(ğ¶) â‰¥ğ‘£(ğ¶).
elusive;thereexistmultipleapproachesthatcanapproximateor
Unfortunately,thecorecanbeempty,meaningthatforevery
exactlysolveforthecore,butcanonlybeappliedtoveryrestricted
imputation,thereexistsablockingcoalition.Thus,relaxationsof
classesofcoalitionsgames[5,35,48,49].Computingthecoreex-
thecoreareoftenstudiedby,forexample,assumingthatthegains
actlyrequiressolvingalinearprogram(LP)withanexponential
madebyformingablockingcoalitionaresmall.Theğœ–-coreallows
numberofconstraints(onepereachpossiblesubsetoftheagents).
forsuchslightrelaxationsoftheinequalitiesinthecoredefinition.
Alternatively,assumingaccesstoincrementallysampledcoalition
values,boundscanbegivenforlikelystablepaymentsthatrelateto Definition2. Givenğœ–,theğœ–-coreofcoalitionalgameğº isthe
thecore[11].Arecentbreakthroughinapproximatingthecoreisa setofallimputationssuchthatforanyğ¶ âŠ†ğ¼,ğ‘(ğ¶) â‰¥ğ‘£(ğ¶)âˆ’ğœ–,i.e.,
MonteCarloalgorithmthatsamplescoalitionsinthisway,yielding ğœ–-cored=ef{(ğ‘1,...,ğ‘ ğ‘›) | ğ‘(ğ¶) â‰¥ğ‘£(ğ¶)âˆ’ğœ– âˆ€ğ¶ âŠ†ğ¼}.
probabilisticboundsonapproximationquality[78].Thisapproach
significantlyexpandsthesetofgamesforwhichonecantractably Clearly,forlargeenoughvaluesofğœ–,theğœ–-coreisnon-empty.
approximatethecore,albeititstillrequiressolvingLPs,wherethe Furthermore,ifğœ– =0,thedefinitionoftheğœ–-coreisequivalentto
sizeoftheLPgrowslinearlyinthenumberofsamples. thecore.Anaturalquestioniswhatisthesmallestğœ–suchthatthe
Ourcontribution:Inthispaper,weintroducenoveliterative ğœ–-coreisnon-empty.Givenagameğº weconsidertheset{ğœ–|the
algorithmsforthecore.Noneofouralgorithmsrequiresolving ğœ–-coreofGisnotempty}.Itiseasytoseethatthissetiscompact,
alinearprogram:assuch,theyenjoygreaterscalingpotentialto andthushasaminimalelementğœ– ğ‘šğ‘–ğ‘›.
verylargeproblems.Wedemonstratethisefficiencyinpractice
Definition3. Givencoalitionalgameğº,defineğœ–
min
=min{ğœ–|
acrossseveralclassesofcoalitiongamesincludingweightedvoting
ğœ–-coreofğº isnon-empty}.Theleastcoreofğº istheğœ– ğ‘šğ‘–ğ‘›-coreofğº,
games[35],inducedsubgraphgames[28],marginalcontribution
andthisvalueğœ– ğ‘šğ‘–ğ‘›iscalledtheLeast-CoreValue(LCV)ofğº.
networks [45], and apply them to feature-importance and data-
valuationproblemsarisinginXAI[13].
3 APPROXIMATINGTHECORETHROUGH
ITERATIVEPAYOFFADJUSTMENTSVIA
COALITIONSAMPLING
Earlierworkhasshownthatgivenagameğº,checkingifthecoreis
1SeeAppendixBforamorecomprehensivediscussionofthedifferencesbetweenthe
Shapleyvalueandthecore. non-emptyisğ‘ğ‘ƒ-hard[28]and,furthermore,thatcomputingtheleast-coreexactlyisimpossible[12].Thisopensupthequestionwe Algorithm1ğœ–-CoreviavonNeumann-Halperin
addressinthissection;howtobestapproximatetheleastcore. Input: Numberofiterationsğ‘‡
Theleast-corecanbeformulatedasalinearprogramming(LP) ğ‘0= ğ‘›1 1ğ‘›
problem.Letğ‘beabinarycoalition-membershipvectorforcoalition forğ‘¡ =1â‰¤ğ‘‡ do
ğ¶ suchthatğ‘ ğ‘– =1ifğ‘– âˆˆğ¶ and0otherwise.Whenclearfromthe Selectcoalitionğ¶(cyclically)asbinaryvectorğ‘
contextwesometimesuseğ‘torepresentcoalitionğ¶.Furthermore, ğ‘‘
ğ‘
=max(0,ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘)
w fai ct th oo rut 1loss ifo nf eg ce en se sr aa rl yi .ty T, ha es nsu tm hee lt eh aa st tğ‘£ -c( oğ¼) re= p1 ro,r be le-s mca il sin tg oğ‘£ sow lvit eha ğ‘ ğ‘¡ â†ğ‘ ğ‘¡âˆ’1+ |ğ‘‘ ğ¶ğ‘ |ğ‘
ğ‘£(ğ¼) ğ‘ ğ‘¡ â†ProjÎ”(ğ‘ ğ‘¡)
endfor
min ğœ– (1) Output: ğ‘ ğ‘‡
ğ‘,ğœ–
ğ‘ .ğ‘¡. ğ‘£(ğ‘)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘ â‰¤0 âˆ€ğ‘ (2)
ğ‘› formsolutionthatcanbecomputedefficiently:
âˆ‘ï¸
ğ‘ ğ‘– =1 (3) (cid:40) ğ‘ ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘ â‰¤0
ğ‘ğ‘– ğ‘–=1
â‰¥0 âˆ€ğ‘– âˆˆğ¼. (4)
Projğ‘,ğœ–(ğ‘)=
ğ‘âˆ’(ğ‘âŠ¤ğ‘+ğœ–âˆ’ğ‘£(ğ¶))/||ğ‘||2ğ‘ otherwise
ğ‘‘
=ğ‘+ ğ‘ ğ‘ where|ğ‘|=thesizeofthecoalition (5)
ThechallengeisthattheConstraint2relatesto2ğ‘›coalitions,mak- |ğ‘|
ingitinfeasibletosolveforgameswithmanyplayers.Arecent andwhereğ‘‘
ğ‘
=max(0,ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘)isthedeficit.Ifğ‘£(ğ¶)âˆ’ğœ–âˆ’
methodtoapproximatingtheleast-corerandomlysamplessome ğ‘âŠ¤ğ‘ <0,playersincoalitionğ¶arebeingpaidmorethantheyare
numberoftheconstraintsimposedonthecoalitionsandsolves actuallycontributing(wherethepaymentisğœ–+ğ‘âŠ¤ğ‘).Intuitively,
theresultingLP[78].However,evenwhenonlyusingsub-sampled playersareincentivizedtoremaininacoalitionifğ‘‘
ğ‘
=0,otherwise,
constraints,solvingLPsisstilltimeconsuming.2Wepresentalter-
thecoalitionisunstable.Algorithm1formalizesthismethod.
nativeiterativealgorithmsthatavoidtherequirementofsolving
theLP,circumventingasignificantcomputationalbottleneck.
Theorem1. Letğ‘£ :2ğ¼ â†’Rbeacharacteristicfunction.Givenan
Ouralgorithmsarepresentedinincreasingcomplexity.Ourfirst
ğœ–andassumingtheğœ–-coreexists,Algorithm1convergestoanğœ–-core
twoalgorithms,IterativeProjections(Section3.1)andStochastic
imputationasymptotically,i.e.:lim ğ‘‡â†’âˆğ‘
ğ‘‡
â†’ğœ–-core(ğ‘£).
SubgradientDescent(Section3.2)takeagivenvalueofğœ–andseek Proof. Wecanappealdirectlytoclassicalconvergenceresultsof
animputationintheğœ–-core(assumingtheğœ–-coreisnon-empty).In thevonNeumann-Halperincyclicprojectionsalgorithm[10]. â–¡
ordertocomputetheleast-core,onemayapplyanouterloopthat
callsthesemethodssoastoperformabinarysearchfortheminimal
valueğœ– yieldinganon-emptyğœ– -core.OurCoreLagrangian 3.2 Theğœ–-CoreviaStochastic(Sub)Gradient
ğ‘šğ‘–ğ‘› ğ‘šğ‘–ğ‘›
method(Section3.3)directlyreturnstheleast-core,includingboth Descent
theğœ– ğ‘šğ‘–ğ‘›(least-corevalue),andanimputationintheğœ– ğ‘šğ‘–ğ‘›-core.Our Whileprojectinganimputationğ‘ontoahyperplanecanbecom-
empiricalresultsinSection4arereportedforthisalgorithmalone. putedefficiently,cyclingthroughallconstraintsisnot,anditisalso
computationallyexpensivetoupdateğ‘ onabatchofconstraints
3.1 Theğœ–-CoreviaIterativeProjections asthatinvolvesprojectingğ‘intotheintersectionofasetofhalf-
spaces. Instead, we propose a new approach that re-formulates
WeobservethateachConstraint2onğ‘ representsahalf-space,
theprojectionproblemasanoptimizationproblemandadmitsan
namelyaconvexset.Assumingthatthereexistssomeğ‘suchthat
efficientbatchalgorithm.
allconstraintscanbesatisfiedforagivenğœ–,thecorresponding
Wedefinealossfunction,â„“ ğ‘(ğ‘,ğœ–) foreachcoalitionğ¶ (repre-
constraintsatisfactionproblemistofindğ‘suchthatConstraint2is
sentedbyvectorğ‘):
satisfied.Thisisequivalenttosolvingaconvexfeasibilityproblem
byfindingağ‘onthe(ğ‘›âˆ’1)-dimensionalsimplexÎ”thatlieswithin â„“ ğ‘(ğ‘,ğœ–)= 1 (cid:0)max(0,ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘)(cid:1)2 = ğ‘‘ ğ‘2 . (6)
theintersectionofalltheseconvexsets,aproblemthatcanbesolved 2|ğ‘| 2|ğ‘|
viavonNeumann-Halperinmethodofcyclicalternatingprojec- Observethatifğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘ â‰¤ 0,â„“ ğ‘ =0,otherwise,weaccrue
tions[10,14,30].Westartwithaninitialguessforğ‘andthencycle somepositivelossfornotsatisfyingtheconstraintforcoalitionğ‘.
throughtheconstraints(foreachcoalition,ğ¶),iterativelymodifying Furthermore,avalidnegative(sub)gradientofâ„“ withrespecttoğ‘
ğ‘
theguessbyprojectingitontothefeasiblesetrepresentedbyeach isexactlytheupdatedirectioncomputedbytheprojectionProjğ‘,ğœ–
individualconstraint.Weobservethattheprojection,Projğ‘,ğœ–(ğ‘), fromequation(5):
ofanimputationğ‘ontoahalf-spaceğ‘âŠ¤ğ‘ â‰¥ğ‘£(ğ¶)âˆ’ğœ–hasaclosed
ğ‘‘
âˆ’âˆ‡ğ‘â„“ ğ‘ = ğ‘ ğ‘. (7)
|ğ‘|
Therefore, if we run stochastic gradient descent (SGD) with
2MethodsthatguaranteepolynomialruntimeforsolvingLPs[47]havearuntime
learning rate equal to 1 on (cid:205) ğ‘â„“ ğ‘(ğ‘), sampling one coalition at
a time, we recover Algorithm 1. However, it is also possible to
thatiscubicinthenumberofparameters.AnefficientimplementationoftheSimplex
method[22]ismuchfasterinpractice,butisstilltimeconsumingforlargeLPs. increasetheminibatchsize,samplingmultiplecoalitionsatonetime,asshowninAlgorithm2.Theorem2showsthatifAlgorithm2 objectiveandconstraintissufficientforoptimalityofthesolution
returnsanimputationthatisapproximatelyintheğœ–-core,thenit tothecorrespondingLagrangianformulation(seeSec5.5of[18]):
p for uo nv dab il ny Ali pe ps ei nn dt ih xe Ağœ– .â€² 1- .core,albeitwithğœ–â€² >ğœ–.Theproofcanbe
min max
L(ğ‘,ğœ–,ğœ‡)=ğœ–+ğœ‡(cid:16)âˆ‘ï¸
â„“
ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2(cid:17)
. (10)
ğ‘âˆˆÎ”,ğœ–âˆˆ[ğœ–,ğœ–]ğœ‡âˆˆ[0,ğœ‡]
ğ¶âŠ†ğ¼
Wecanboundbothğœ–andğœ‡whichensuresthefunctionvaluesand
Algorithm2ğœ–-CoreviaSGD
Input: Numberofiterationsğ‘‡ g cora ad lii te in ot ns aa lr ce ob no su tn rad ie nd ta is sw tre ivll i. aL le lytğ‘£ sm aa tx isfi= em da ifx ğ¶ ğœ–âŠ† â‰¥ğ¼ğ‘£ ğ‘£( mğ¶ a) x. ,T whe hn ile ev te hry e
Input: Batchsizeğµ constraintassociatedwiththegrandcoalitioncannotbesatisfiedif
In ğ‘pu =t: ğ‘›1S 1t ğ‘›epsizescheduleğœ‚ ğ‘¡ ğœ– on< e0 c. oT nh ste rr ae if no tre i, sw ve ioc laa tn edbo ,u thn ed nğœ– wâˆˆ e[ wğœ–, ağœ– n] t= ğœ‡[ t0 o,ğ‘£ bm ea lx a] r. gF eo er nğœ‡ o, uif go hn tl oy
forğ‘¡ =1â‰¤ğ‘‡ do forceanincreaseinğœ–.Therefore,foranysingleviolatedcoalitional
Samplebatchğ¶ containingğµcoalitions
Computeaveragğµ egradientoverbatch:âˆ‡ğ‘ = ğµ1 (cid:205) ğ¶âˆˆğ¶ğµâˆ‡ğ‘â„“ ğ‘ 1co âˆ’ns ğœ‡tr (ğ›¾ai /n |ğ¶t |a )ss to oc bia ete sd triw cti lt yh lğ¶ e, ssw te haw nan zet râˆ‡ o.ğœ–L Thi= s i1 mâˆ’ plğœ‡ ie( sğ‘‘ ğ‘ t/ h| ağ¶ t|) if< ğœ‡
ğ‘ â†ğ‘âˆ’ğœ‚ ğ‘¡âˆ‡ğ‘ isatleast|ğ¶|/ğ›¾,thenğœ– willincreaseinresponsetoanyviolated
ğ‘ â†ProjÎ”(ğ‘)
constraint.Hence,wesetğœ‡=ğ‘›/ğ›¾ asanupperbound.
endfor WeobservethattheLagrangianformulationisconvexinthepri-
Sampleğ‘¡âˆ— âˆˆ{0,...,ğ‘‡}accordingtoğ‘ƒ(ğ‘¡âˆ—=ğ‘¡)=
(cid:205)
ğ‘¡ğœ‚ â€²ğ‘¡
ğœ‚
ğ‘¡â€².
malvariables(ğ‘,ğœ–)andconcaveinthedualvariableğœ‡,henceequa-
Output: ğ‘ ğ‘¡âˆ— tion(10)istypicallyreferredtoasaconvex-concavesaddle-point
problemwhichcanbeequivalentlyformulatedasamonotonevari-
âˆš ationalinequalityproblem[38],forwhichstochasticalgorithms
Theorem2. Ifâ„“ ğ‘(ğœ–,ğ‘) â‰¤ğ›¾2 forallğ‘,thenğ‘isinthe(ğœ–+ 2ğ‘›ğ›¾)- existincludingextragradient[51]andStochasticMirrorProx[46].
core. Algorithm4providespseudocodefortheprocess.Thekeystepis
Theorem3. Letğ‘£ :2ğ¼ â†’Rbeacharacteristicfunction.Givenan theUpdatefunction(Algorithm3)whichrequiresaProxğ‘¥ oper-
ğœ–andassumingtheğœ–-coreexists,Algorithm2convergestoanğœ–-core atorandamonotonemapoperatorğ¹.5 Invariationalinequality
imputationinexpectationatarateofO(ğ‘‡âˆ’1/4). formulationsğ‘‰ğ¼(ğ¹,X),theproblemistofindğ‘¥âˆ— âˆˆ X suchthat
âŸ¨ğ¹(ğ‘¥âˆ—),ğ‘¥ âˆ’ğ‘¥âˆ—âŸ© â‰¥ 0forallğ‘¥ âˆˆ X,andthemapğ¹ : X â†’ Rğ‘›+2
Proof. Wecanappealdirectlytoconvergenceratesofstochas- istypicallywrittenasasinglevectorvaluedmapcontainingthe
ticprojectedsubgradientalgorithmsforconvexoptimization[24]. â€œdescentâ€directionsofallvariables.Foroursetting,wecandefine
TheseratesproveAlgorithm2convergestoastationarypointwith ğ¹ asfollows:
âˆš
d t 3O he .( e 3t1 e v/ rm ioğ‘‡ Ti ln a) t he ie ot ex h np a Lote efc tht t ae he sd es tqs c -uq o Cau rr e oa er c rde o ed g nr asg a tr sd ra aid e ainnie St tn si a,st ğ‘‘ dpn ğ‘r do ,or d lpm eeo c. r PatR i y ooe snc iaa na sl ll tt Ooe Pq (ğ‘‘ ğ‘‡u rğ‘2a oâˆ’.t T 1 bi /o h l4n e e)r . m( e7 f) ort â–¡eo , ğ¹(ğ‘¥)= ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£°âˆ’âˆ‡ âˆ‡ âˆ‡ğ‘ ğœ– ğœ‡LL Lï£¹ ï£º ï£º ï£º ï£º ï£» = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯âˆ’(cid:16)1 (cid:205)âˆ’ âˆ’ğœ‡ ğ¶(cid:16) ğœ‡ âŠ†(cid:205) (cid:16) ğ¼(cid:205) â„“ğ¶ ğ‘âŠ† ğ¶ (ğ‘ğ¼ âŠ† ,ğ¼| ğœ–ğ‘‘ ğ¶ğ‘ )|ğ‘‘| ğ¶ âˆ’ğ‘ ğ‘ |(cid:17) (cid:17) ğ›¾2(cid:17)ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º (11)
ï£° ï£»
Algorithms1and2assumeanğœ–isprovidedsuchthatallconstraints whereğ‘¥ = [ğ‘,ğœ–,ğœ‡] âˆˆX =Î”Ã—[ğœ–,ğœ–]Ã—[0,ğœ‡].Observethatwecan
representedbyConstraint2aresatisfied.3However,wearereally usesamplingofminibatchesofcoalitionstoMonteCarloestimate
interestedinfindingthesmallestsuchğœ–forwhichtheconstraints thesumsinğ¹(ğ‘¥),e.g.,(cid:205) ğ¶âŠ†ğ¼â„“ ğ‘(ğ‘,ğœ–)= 2 ğµğ‘›E ğ¶ğµâˆ¼ğ¼[(cid:205) ğ¶âˆˆğ¶ğµâ„“ ğ‘(ğ‘,ğœ–)].
stillhold,i.e.theleast-corevalue(LCV).Tothisend,wereformulate
Lemma1. Themapğ¹ inequation(11)ismonotone,i.e.,âŸ¨ğ¹(ğ‘¥)âˆ’
theoriginalLP,makinguseofasinglenon-linearconstraint:
ğ¹(ğ‘¥â€²),ğ‘¥âˆ’ğ‘¥â€²âŸ© â‰¥0overallğ‘¥,ğ‘¥â€² âˆˆX.
min ğœ– (8)
ğ‘âˆˆÎ”,ğœ– TheproofofLemma1canbefoundintheAppendix.
ğ‘ .ğ‘¡. âˆ‘ï¸ â„“ ğ‘(ğ‘,ğœ–) â‰¤ğ›¾2 (9) Theorem4. Letğ‘£ : 2ğ¼ â†’ Rbeacharacteristicfunction.Algo-
forsomeconstantğ›¾
>0.Notğ¶ eâŠ† tğ¼
hatifğ›¾ =0,wewouldrecoverthe
r ai tth am ra4 tere od fu Oce (s 1t /h âˆše ğ‘‡du )a .litygapmax ğœ‡â€²L(ğ‘,ğœ–,ğœ‡â€²)âˆ’min ğ‘â€²,ğœ–â€²L(ğ‘â€²,ğœ–â€²,ğœ‡)
solutiontotheleast-coreLPin(1)-(4).Forğ›¾ >0,wecanrecoveran
approximatesolutionviaTheorem2.Whilethisformisnolonger Proof. Wecanappealdirectlytoconvergenceratesofmirror
anLP,itretainsacrucialproperty:convexity.Eachâ„“ ğ‘(ğ‘,ğœ–)isconvex proxalgorithmsformonotonevariationalinequalities[46]given
inğ‘andğœ–,andhencethenonlinearconstraint(cid:205) ğ¶âŠ†ğ¼â„“ ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2 wehavealreadyarguedabovethatthenormofthemapğ¹ andits
remainsconvexinğ‘andğœ–.SimilarlyObjective8isconvexasitis variancearebothfiniteandthemapğ¹ ismonotone(Lemma1). â–¡
linearinğœ–andğ‘.Thisallowsustoviewtheoptimizationproblem
asasaddle-pointproblemusingLagrangemultipliers.4 Wefirst
Inexperiments,weuseatailoredProxoperator,specifically,
observethatviaKarush-Kuhn-Tuckerconditions,convexityinthe ï£®softmax(log(ğ‘)âˆ’ğœ‚ğ¹ ğ‘(ğ‘¦)),
ï£¹
43 NRe oc ta el tl ht ah ta wts eu ic nh tra on duğœ– ci es tg hu ea cr oa nn ste tae nd tt ğ›¾oe >xi 0st s.
oastoensureSlaterâ€™sconditionholdsso
Proxğ‘¥(ğœ‚ğ¹(ğ‘¦))= ï£¯ ï£¯ ï£¯
ï£¯
c cl li ip p( (ğœ– ğœ‡âˆ’ âˆ’ğœ‚ ğœ‚ğ¹ ğ¹ğœ– ğœ‡( (ğ‘¦ ğ‘¦) ), ,ğœ– 0, ,ğœ– ğœ‡) ), ï£º ï£º ï£º
ï£º
(12)
ï£° ï£»
astomeetthenecessaryandsufficientconditionsforoptimalityofthesubsequent
saddlepointsolution[18]. 5See[58]forproximalpointapproachestosaddlepointproblems.Algorithm3Update availableforthatagent,andthethresholdisthetotalamountof
Input: Initialiterateğ‘¥,mapevaluationiterateğ‘¦,batchsizeğµ,step pooledresourcesrequiredtoaccomplishsometaskofinterest.
sizeğœ‚,Proxoperator Inourexperiments,eachagentğ‘–hasaweightğ‘¤ ğ‘– âˆˆ{1,2,Â·Â·Â·,100}
Samplebatchğ¶ containingğµcoalitions drawnuniformlyatrandomandwesetthequotağ‘ = ğœ‰ğ‘›E[ğ‘¤ ğ‘–],
ğµ
Computeğ¹(ğ‘¦)usingbatchofcoalitions whereğœ‰istheproportionalthreshold(fractionoftheexpectedtotal
ğ‘¥â€² â†Proxğ‘¥(ğœ‚ğ¹(ğ‘¦)) weight).Weuseproportionalthresholdsğœ‰sampleduniformlyatran-
Output: ğ‘¥â€²
domintherange[0.1,0.9].Thereare2100coalitionsandthus2100
constraintsintheLPformulationoftheleastcore(Constraint2),
soexactlysolvingfortheleast-coreiscomputationallyinfeasible.
Algorithm4Least-CoreviaMirrorProx(CoreLagrangian) WecomparedourmethodtoYanandProcacciaâ€™srecentalgo-
rithmforapproximatingtheleastcore[78].Theiralgorithmsamples
Input: Numberofiterationsğ‘‡,batchsizeğµ,stepsizescheduleğœ‚ ğ‘¡
ğ‘0= ğ‘›1 1ğ‘› a strs au ib ns te st bo uf ilc to oa nl li ytio frn os man thd er se at mur pn ls edth se ubL sP ets .o Wlu itt hio hn igb has pe rd obo an bic lo itn y-
,
ğœ–0=ğœ–
thismethodisguaranteedtoreducetheapproximationerrorasthe
ğœ‡0=ğœ‡
numberofcoalitionssampledincreases[78,Theorem1].
ğ‘¥0= [ğ‘0,ğœ–0,ğœ‡0]
ItisdifficulttocompareiterationsofCLtothenumberofsampled
forğ‘¡ =1â‰¤ğ‘‡ do
ğ‘¥â€² â†Update(ğ‘¥ ğ‘¡âˆ’1,ğ‘¥ ğ‘¡âˆ’1,ğµ,ğœ‚) coalitionsusedinLP;instead,wechoseanumberofsampledcoali-
ğ‘¥
ğ‘¡
â†Update(ğ‘¥ ğ‘¡âˆ’1,ğ‘¥â€²,ğµ,ğœ‚) tionsğ‘˜andrecordedthewallclocktimetakenbytheLPmethod
for each value ofğ‘˜, sayğ‘¡ seconds. Then, we let CL run forğ‘¡
endfor ğ‘˜ ğ‘˜
Computeweightedaverageofimputations:ğ‘âˆ—= ğœ‚ğ‘¡ğ‘ğ‘¡ . secondsandretrievedthesolutionafterthatamountofelapsed
(cid:205) ğ‘¡â€²ğœ‚ ğ‘¡â€² time.TheLPmethodusedCVXPY[31]whileourCLcodeusedJAX
Output: ğ‘âˆ—
andoptax[4].Foreachğ‘¡ ,bothmethodsreturnedanimputation,
ğ‘˜
ğ‘ andğ‘ ,respectively.Foreachimputationwecomputedits
ğ¿ğ‘ƒ ğ¶ğ¿
respective(average)ğœ–value.Duetothesizeofthegametheerrorof
whereğ¹ ğ‘§(ğ‘¦)retrievesthepartofthevectoroutputğ¹(ğ‘¦)correspond-
thesolutioncannotbecomputedexactly,soweapproximatedthe
ingtothevariableğ‘¦andsoftmax(ğ‘ )= [ (cid:205)ğ‘’ğ‘  ğ‘’1 ğ‘ ğ‘—,..., (cid:205)ğ‘’ğ‘  ğ‘’ğ‘› ğ‘ ğ‘—]. valueofğœ–bysamplingasetof50,000coalitions,ğ¶Ëœ,andcomputing
ğ‘— ğ‘—
InstructionsforacceleratingourproposedalgorithmsonGPUs/T- ğœ–Ë†(ğ‘,ğ¶Ë† )=max ğ‘âˆˆğ¶Ë†(ğ‘£(ğ‘)âˆ’ğ‘âŠ¤ğ‘).Figure2summarizesourfindings.
PUsareinAppendixA.2.Hyperparametersincluding,e.g.,learning Inparticular,weobservedasignificantimprovementinthecore
rateschedules,usedinexperimentsarefoundinAppendixA.3. approximationwhenusingourmethod(CL)asopposedtotheLP-
basedmethod.Wedidobserve,however,thatthethresholdaffects
4 EMPIRICALANALYSIS thedegreetowhichCLoutperformstheLP-basedmethod.Inpar-
Wetestedouralgorithm,CoreLagrangian(CL)(Alg.4),onarange ticular,whenthethresholdwascloseto50%ofthetotalexpected
ofcooperativegamesandreportourfindingshere.Inourfirstsetof weight,theLP-basedmethodwouldsometimesoutperformCL.
experimentswecomparedtheperformanceofCLtothatofarecent
state-of-the-artalgorithmforapproximatingtheleast-corewhich 4.2 AnalyzingStabilityinCompactGame
reliesonsolvingtheLPusingsampledcoalitions[78](Section4.1). Representations
Wethenuseouralgorithmasatooltostudythestabilityproperties
Aftervalidatingthatouralgorithmcaneffectivelysolvelargeco-
ofanumberofprominentcooperative-gameclasses,illustrating
operativegames,showingimprovementsoverastrongbaseline,
thebenefitsofhavingalgorithmsforapproximatingthecorefor
wefurtherillustrateitsvaluebymakingarigorousstudyacross
largegames(Section4.2).Finally,weexamineapplicationsofour
prominentclassesofcooperativegamestobetterunderstandhow
algorithmsforexplainableAI(XAI)purposes(Section5).
differentgame-featuresaffectstability.
4.1 TimingSampledLPsvs.CoreLagrangian 4.2.1 WeightedVotingGames. Inourfirstsetofexperimentswe
studiedhowstabilitywasimpactedbydifferentparameterizations
TotesthowefficientCLisinpractice,weevaluateitsperformance
ofweightedvotinggames,definedinSection4.1.Sincewewere
acrossverylarge(ğ‘›=100)instancesofweightedvotinggames.
runningmultipleexperiments,wesetthenumberofagentstobeğ‘›=
Definition4. ([21,Definition4.1])Aweightedvotinggameğº 15,butdrewagentsâ€™weightsfromdifferentdistributionsandvaried
isatuple (ğ¼,w,ğ‘) whereğ¼ = {1,2,Â·Â·Â·,ğ‘›} isasetofagents,w = theproportionalquota,ğœ‰.Figure1presentsourresults.Wesample
(ğ‘¤1,ğ‘¤2,Â·Â·Â·,ğ‘¤ ğ‘›) âˆˆâ„œğ‘› isavectorofweights(oneperplayer),and 10,000gamesforeachparameterconfiguration,andexaminethe
ğ‘ âˆˆâ„œisaquota.Thecharacteristicfunctionis averageleast-corevalueinthesegames.Wefirstnotethatregions
thathavealowleast-corevalue(blue)arestableorverycloseto
ğ‘£(ğ¶)=(cid:26) 1 if(cid:205) ğ‘âˆˆğ¶ğ‘¤
ğ‘
â‰¥ğ‘;
beingstable,whereashighğœ–-coreindicateregionsofinstability.
0 otherwise.
Second,weobservethatthethresholdgreatlyaffectedthestability
Weightedvotinggamesarewellstudiedintheliterature(e.g.,[3, ofaninstance.Ifthethresholdwaslow,manycoalitionsformand
34,66,69,74,80])andcanmodelreal-worldscenariossuchasthe achievethemaximumcoalitionalvalueof1.Ifthethresholdwas
EuropeanUnionvotingsystem[17,64],ormultiagentresourceal- veryhigh,inexpectationtheonlysuccessfulcoalitionwasthegrand
locationproblemswhereanagentâ€™sweightcorrespondtoresources coalition,reducingthelikelihoodofblockingcoalitions.4.2.2 GraphGames. Inmanycooperativegames,relationshipsbe-
Core Approximation Quality ( )
tweenagentsaremodelledviaagraphğº = âŸ¨ğ‘‰,ğ¸âŸ©(e.g.,[7,8,19,
0.50 LP 27,28,61,65,67]).Ininducedsubgraphgames[28],theagentsare
CL representedbyverticesofthegraphandtheedgeweight,ğ‘¤(ğ‘’)for
0.48
ğ‘’ =(ğ‘–,ğ‘—),indicatesthevaluethatagentsğ‘–andğ‘—accruefrombeingin
0.46 thesamecoalition.Anabsenceofanedgeimpliesthereisnointerac-
tionbetweenapairofagentsandthus,nolossorbenefitfrombeing
0.44
inthesamecoalition.Givengraphğº,thecharacteristicfunctionfor
0.42 theinducedcooperativegameisğ‘£(ğ¶)=(cid:205) ğ‘’âˆˆ{(ğ‘–,ğ‘—)âˆˆğ¸|ğ‘–,ğ‘—âˆˆğ¶}ğ‘¤(ğ‘’).
Weconductanempiricalstudytobetterunderstandhowthe
0.40
underlyinggraphstructureinfluencesthestabilityofthegame.
0 25 50 75 100 125
Wall Clock Time (seconds) Tothisend,weselectacollectionofwell-knownparameterized
randomgraphmodels,eachwithdifferentproperties,andgenerate
Figure 2: Approximate ğœ– of the linear program (LP) ver- 80cooperativegraphgamesforeachparameterization,measuring
theirstabilitybycomputingtheirleast-corevaluesviaouralgorithm
susthecoreLagrangian(CL)methodasafunctionofcom-
putation time (seconds). The ğ‘¥-axis corresponds to wall- CL.Wesetğ‘› = 32,andgenerateedgeweightswithaGaussian
clocktimetakenbybothalgorithmsrunside-by-sidegiven
distributionwithvarianceğœ =1.0(unlessspecifiedotherwise)and
ğ‘˜ âˆˆ {500,1000,2000,4000,8000,16000} sampledcoalitionsfor positivemeanğœ‡chosensuchthat60%ofedgeweightsarepositivein
theLPmethod,ğ‘¡ ğ‘˜.Abettercoreapproximationqualityis
expectation.6AllgraphsweregeneratedusingtheNetworkXlibrary
reflectedinhavingalowerğœ– forthesameruntime.Theğ‘¦- [41].Wepresentresultsontwograph-classes,ErdÅ‘s-RÃ©nyi[37]and
axisrepresentstheapproximateğœ–oftheleast-coresolution NewmanWattsStrogatz[62],anddiscussfouradditionalmodels
found,ğœ–Ë†(ğ‘ ğ¿ğ‘ƒ,ğ¶Ë† )andğœ–Ë†(ğ‘ ğ¶ğ¿,ğ¶Ë† ),computedoverthesamesetof inAppendixC.
50,000coalitions,ğ¶Ë† .Eachdatapoint(ğ‘¡ ğ‘˜,ğœ–Ë†(ğ‘ ğ‘¥,ğ¶Ë† ))represents IntheErdÅ‘s-RÃ©nyigraphmodelthereisasingleparameterğ‘,
anaverageoverthesamesetof2,500randomweightedvoting whichindicatestheprobabilitythatforanypairofvertices,ğ‘¥,ğ‘¦,
thereisanedgeconnectingğ‘¥andğ‘¦.Inourexperimentswevariedğ‘
gameswithshadingindicatingstandarderrorofthemean.
from0.0to1.0,andvariedthevarianceğœoftheweightdistribution
from1.0to3.0.OurresultsareshowninFigure1d.Weobservethat
thestabilityofthegamesgenerateddependsonbothğ‘andğœ.In
particular,gameswithhighweightvarianceforedgeweights,and
In Figure 1(a) we present results where the agentsâ€™ weights highuncertaintyastowhetheranedgewouldformbetweenany
weregeneratedbyaGaussiandistributionwithğœ‡ = 1.0andğœ âˆˆ pairofvertices(i.e.,forğ‘ âˆˆ [0.4,0.7])arelessstable.
[0.01,0.3].Weobservethatforafixedquota,highweight-variance TheNewmanWattsStrogatzmodelgeneratesgraphswiththe
leadstolessstablegames.Figure1(b)presentsresultswhenagentsâ€™ small-worldpropertyandconsistsoftwoparameters.Aninstance
weightsweredrawnfromanexponentialdistributionwithğœ† âˆˆ ofagraphisinitializedasaringandconnectedwithitsğ‘ âŒŠğ‘˜ âŒ‹nearest
[0.25,2.50].Weobservethatasğœ†increaseswefindlessstablegames. neighbours.Additionaledgesinthegraphareaddedwith2
probabil-
Wehypothesizethatsinceagentweightsaremoreconcentrated
ityğ‘.Figure1epresentsourresultsaswevariedğ‘˜from4to24,and
aroundlowvalues,possiblesuccessfulcoalitionsoftenshareagents,
ğ‘ âˆˆ [0.0,1.0].Thevarianceoftheedge-weightdistributionwas
openingupthepossibilityoftheformationofblockingcoalitions.
fixedatğœ =1.0.Inparticularweobservethatbothparametersğ‘
Finally,inFigure1(c)wepresentresultswhereweusedaBetadis-
andğ‘˜positivelycorrelatewithstabilityinthesegraphs.
tributionwithparameters(ğ›¼,ğ›½).Wenoticeadifferenceinstability
ofgameswhentheparametersareeitherlessthan1.0orgreater
than1.0.Ifbothğ›¼ andğ›½arehigh,gamesarelessstable.However,
6Ifgraphgameshaveonlypositiveedgeweights,thenthecoreisnon-empty,i.e.the
thereisaregionofstabilitywhenğ›¼ >1.0andğ›½ <1.0 least-corevalueis0.0[28].
00 .. 55 02 0000 .... 4455 6802 00 .. 57 00 0000 .... 2468 12 .. 00 50 000 ... 345 00001 ..... 24680 123 000 ... 000 1122 2604
8
45 .. 00
0.48 0.44 0.30 0.0 0.10 0.2 0.0 0.0 4 3.0
0.01 0.15 0.30 0.25 1.38 2.50 0.10 1.05 2.00 1.0 2.0 3.0 0.0 0.5 1.0
ğœ ğœ† ğ›¼ ğœ ğ‘
(a)Gaussian(ğœ‡=1.0) (b)Exponential (c)Beta(ğœ‰=0.25) (d)ErdÅ‘s-RÃ©nyi (e)NewmanWattsStrogatz
(ğœ=1)
Figure1:(a)-(c)Heatmapsillustratingtheimpactofparameteraxesontheleast-corevalue(incolor)inthreeweightedvoting
games.(d)-(e)Meanleast-corevalueforErdÅ‘s-RÃ©nyiandNewmanWattsStrogatzwhensweepingovertwohyperparameters.
Constanthyperparametersareshowninparenthesis.
ğœ‰
etamixorppA
ğœ‰ ğ›½ ğ‘ ğ‘˜Moregenerally,theseresults(alongwithfurtherresultsinAp- takingsomeoriginalinstancefromthedataset,fixingthevalues
pendixC)showtheinterplaybetweentheparametersofrandom- ofallfeaturesinğ¶,andreplacingthevaluesoffeaturesnotinğ¶
graphgeneratorsandthestabilityoftheinducedcooperativegame. byrandomlysamplingotherinstances.7Givenadatasetcontain-
Webelievethatfurtherresearchinthisareaiswarranted,butalso ingğ‘‘ instances,suchananalysisresultsinğ‘“ featureimportance
emphasizethatsuch empiricalanalysiscanonly be carriedout measurespereachinstance,resultinginğ‘‘Â·ğ‘“ feature-importance
whenusingalgorithmsfortractablysolvingcooperativegamesat measures,illustratingtheimportanceofhavingscalablesolutions
scale,suchasthealgorithmswehaveproposed. forcomputingboththeShapleyvalueandleast-core.
Figure3presentsresultsshowingthecorrelationbetweenShap-
5 EXPLAINABLEAI leyfeature-importanceandleast-coremeasures,overallthein-
stancesineachdataset.Wepresentthedatausingcontourplots
Cooperative game theory has played an important role in the
duetothesheernumberofdata-points.Similartoourfindingsfor
developmentofexplainableAI(XAI)throughtheapplicationof
theglobalexplainabilityproblem,weobservepositivecorrelation
theShapleyvaluetofeature-attributionanddata-valuationprob-
betweenleast-coreandShapleyvalue.Notethattheleastcorere-
lems[1,2,23,54].Howeverresearchershavealsoidentifieddis-
turnsnon-negativepayoffs,whichexplainsthebendinthetrend
advantagesofShapley-basedanalysis,suchasgeneratingcounter-
attheorigin.
intuitiveexplanationsinvariouscases[72].Arecentpaperargued
thatthecoremayprovideanalternativetotheShapleyvaluefor
XAI applications. In this section we explore this idea, applying 5.3 DataValuation
ouralgorithm,CL,forcomputingtheleast-coreonthreedifferent Inthedatavaluationproblem,theimportanceofeachdatapoint
real-worlddatasets:BostonHousingdataset[42](priceregression), inthetrainingsetismeasured.Thisproblemcanbeformulatedas
Diabetesdataset[33](classification)andtheWisconsinBreastCan- acooperativegamebydefiningacoalition,ğ¶,tobeasetofdata
cerdataset[77](classification).Ourgoalistobetterunderstand points,withcharacteristicfunction,ğ‘£(ğ¶),beingthequalityofthe
howtheShapleyvalueandthecorearesimilarordifferentintheir modeltrainedonlyondatapointsinğ¶.Thecore(orleastcore)isa
relativeassessmentoftheimpactofdifferentfeaturesordatapoints particularlycompellingsolutionforthedatavaluationproblemas
haveonthequalityoftrainedmodels,specifically,scikit-learnâ€™s imputationsinthecorecanbeinterpretedaspricesthatmustbe
defaultlinearorlogisticregressionmodels[63]. paidtodataproviderssoastoensurethedataisavailable(e.g.,inthe
samewaythatcore-pricingisusedinpackage-auctions[25,26]).
5.1 GlobalExplainability Weconductedaseriesofdata-valuationstudiesacrossdifferent
datasets.WeusedasimilarmethodolgyasYanandProcaccia[78]:
Intheglobalexplainabilityproblem,afulldatasetisusedtode-
weimposedabudgetof50,000callstothecharacteristicfunction,
termine which features have high impact on the quality of the
limitingthenumberofpermutationssampledfortheShapleyvalue
trainedmodel.Weformulatethisasacooperativegamebydefining
approximationanditerationsforourleast-corealgorithm,CL.We
acoalition,ğ¶,tobeasubsetoffeaturesandğ‘£(ğ¶)tobethequality
thensortedthedatabyimportanceaccordingtotheShapleyvalue
ofthemodeltrainedonlyonfeaturesinğ¶.Qualitymaybemea-
andleast-core,andretrainedthemodelsbyremovingthemost
suredastheaccuracyinclassificationtasks,orasthecoefficient
ofdeterminationğ‘…2forregressiontasks.ComputingtheShapley importantdatainblocksof5%atatime.
ResultsareshowninFigure4.Inparticular,theseshowdata
valueortheleast-coreforthisgamereturnsindividualvalues,one
pointsdeemedmostimportantbytheleast-corearemorecritical
per each feature, which are can be interpreted as a measure of
tomodelperformancethanthoseselectedaccordingtoShapley
feature-importance.
value.Thesefindingsareconsistentwithpreviousliterature[78].
Figure3presentsascatterplotshowingthecorrelationbetween
However,wealsoappliedthisprocesstootherdatasetsincludingan
thefeature-importancemeasuresreturnedbyapplyingtheShapley
evaluationproblemforlargelanguagemodels(LLMs),presentedin
valueandthoseproducedbytheleastcore(usingouralgorithm).
AppendixD.2.There,theresultsaremorenuancedinthatthereexist
Everypointrepresentsasinglefeature,withtheğ‘¥-axisreflectingits
scenarioswhereaShapleyvalueapproachisbetteratidentifying
importanceaccordingtotheShapleyvalueandtheğ‘¦-axisreflecting
key data points. These results open up new research questions
itsimportanceaccordingtotheleastcore.Thetwoimportance
aroundcharacterizationsastowhenShapley-basedorcore-based
measures are correlated, but reflect a different order of feature
datavaluationismoreappropriate.
importance.Interestingly,thecorrelationishighwhentherearea
fewdominantfeatures(Figures3a,3b),butnotasstronginthecase 5.3.1 EloRatingsonChatbotArenadataset. Wenowdescribean-
wherethepredictionsaredrivenbymanyfeatureswherenoneof otherdatavaluationexperimentthatdiffersfromtheothersinthat
thefeaturesisdominant(Figure3c). itisnotatraditionalregressionnorclassificationtask.TheChatbot
Arenadatasetiscomposedofhumansratingthequalityofanswers
5.2 LocalExplainability toquestionsto20differentlargelanguagemodels(LLMs)[79].Each
Inthelocalexplainabilityproblem,thefocusisonthepredictiona datapointconsistsofaquestionandtwoanswers:eachanswer
trainedmodelmakesonanindividualinstance.Itseekstodeter- generatedbytwodifferentLLMs.Thehumanthenpickswhich
minehowthevaluesofindividualfeaturesincreaseordecrease answeristhebestoneandthisisrecordedasawinfortheLLMthat
themodelâ€™spredictionforsomeinstance.Wedefineacooperative
gamewhereacoalition,ğ¶,isasetoffeaturesandthecharacteristic
7Inourexperimentswiththeleastcore,weusetheversionwherenon-coalition
featuresaretakenfromarandominstanceselectedfromthe10%oftheinstanceswith
functionisthemodelâ€™spredictiononanewinstance,createdby thelowestprediction.(a)BostonHousing(global/local) (b)Diabetes(global/local) (c)BreastCancer(global/local)
Figure3:CorrelationofShapleyandCoreimportancemeasuresoffeaturesatbothglobaldatasetandindividualinstancelevels.
(a)BostonHousing (b)BreastCancer (c)ChatBotArena
Removal of Most Important Data Points Removal of Most Important Data Points Removal of Most Important Data Points
Boston Housing (Budget = 50000) Breast Cancer (Budget = 50000) Chatbot Arena (Budget = 50000)
0.7 Shapley 0.97 1.10
Least Core 0.6 1.05
0.96
0.5 0.95 1.00
Shapley Shapley
0.4 0.94 Least Core 0.95 Least Core
0 10 20 30 40 50 0 10 20 30 40 50 0 10 20 30 40 50
Data removal percentage Data removal percentage Data removal percentage
Figure4:DataValuationontheBostonHousing,Diabetes,andChatBotArena.Errorbarscorrespondto95%confidence
intervals(1000repeats).
generatedthebetterresponseandalossfortheonethatgenerated 6 CONCLUSION
theworseresponse.Intotal,thedatasetconsistsof33000data Weexaminedthecore,adistributionofpayoffovermembersin
points. acoalitionthatisacentralsolutionconceptincooperativegame
ThesupervisedlearningproblemistolearnanElorating[36] theory.Weproposedascalablesolverfortheleastcorethatcan
foreachLLMthatcanberankedtocomparetheâ€œskilllevelâ€(in handletheexponentialnumberofpossiblecoalitionsthatdefinethe
thiscontext:propensitytogeneratethebetteranswer)ofeachLLM. coreconstraints.Weprovidedconvergenceratesandguarantees
Eloisclassicratingsystemthatwasproposedforrankingchess forthissolverandshowedempiricallythatitisfasterthanprevious
engines;eachLLMisassignedarating,sayğ‘Ÿ ğ‘– andğ‘Ÿ ğ‘—,thatmodels coresolvers[78].
theprobabilityofLLMğ‘–beatingLLMğ‘—asalogisticfunctionofthere Ourempiricalanalysisshowsseveralapplicationsofourcore
ratings,Pr(ibeatsj) = ğœ(cid:0)(ğ‘Ÿ ğ‘– âˆ’ğ‘Ÿ ğ‘—)/400(cid:1) = 1+ğ‘’(ğ‘Ÿğ‘—1 âˆ’ğ‘Ÿğ‘–)/400,whereğœ solver,includingstudyingstabilityofprominentformsofcoalitional
isthesigmoidfunctionğœ(ğ‘¥) = (1+ğ‘’âˆ’ğ‘¥)âˆ’1.Theratingscanbe gamesandexplainableAI(XAI)problems.ForXAI,wehighlighted
learnedusingonlineupdates,ormorepreciselygivenabatchof thatanalysisbasedonthecorediffersfromthecurrentde-facto
datausinglogisticregressionorminorization-maximization(MM) standardbasedontheShapleyvalue.Further,forthepurposeof
algorithms[44]. dataevaluation,ourresultsindeedshowthatincertaincasesthe
Weapplydatavaluationinasimilarwayasbefore.Foreach coreoutperformstheShapleyvalueasawayofselectingthedata
experiment,wefirstsampleatrainingsetandtestsetpair(Dğ‘…,Dğ‘‡), instancesfortrainingmachinelearningmodels.
with|Dğ‘…|=1000and|Dğ‘‡|=10000.Acoalitionisthenasubsetof Severalproblemsremainopenforfutureresearch.First,could
datapointsfromthistrainingset,ğ‘ âŠ†Dğ‘…,leadingtoa1000-player onederiveevenfasteralgorithmsforapproximatingthecore(in
coalitionalgame.Asintheothersettings,thecharacteristicfunction termsoftheworst-caseperformance,orintermsofempiricalper-
isameasureofhowwellthemodellearnedonğ‘performsonthetest formanceonproblemsofinterest)?Second,couldbetterapproxima-
setDğ‘‡.Foreachcoalition,ğ‘,weruntheMMmethod[44]for20000 tionalgorithmsforthecorebetailoredtospecificclassesofgames?
iterationstolearnEloratingsofthebatchofdatağ‘ âŠ†Dğ‘….Giventhe Third,couldoneextendouranalysistootherknownformsofcoop-
learnedratingsğ‘Ÿ(cid:174)ğ‘,wecomputetheaveragecrossentropylossover erativegamestodeterminethekeyfeaturesthataffectcoalitional
thetestset,ğ¿ ğ¶ğ¸(ğ‘Ÿ(cid:174)ğ‘,Dğ‘‡).Finally,wedefinethethecharacteristic stabilityinthem?Fourth,ouranalysishasidentifiedwaysofse-
functionforasğ‘£(ğ‘)=2âˆ’ğ¿ ğ¶ğ¸(ğ‘Ÿ(cid:174)ğ‘,Dğ‘‡).Asbeforewesetabudget lectingdatafortrainingmodels.Couldoneleveragesuchresultsto
of50000callstothecharacteristicfunctionforbothShapleyand speedupthetrainingorruntimeperformanceofmachinelearning
theleastcorecomputations.Figure4cshowsthatincontrasttothe models?Finally,whenisitbettertousethecoreandwhenisitbet-
otherdatasetsandexperimentsin[78],theShapleyvaluesattribute tertousetheShapleyvalueforfeatureimportancemeasurements
importancesthataremorecriticaltomodelperformancethanthe ordataselection?
leastcore.
erocs
ledoM
erocs
ledoM
erocs
ledoMREFERENCES 2016IEEESymposiumonSecurityandPrivacy(SP).IEEE,598â€“617.
[1] LiatAntwarg,RonnieMindlinMiller,BrachaShapira,andLiorRokach.2019. [24] DamekDavisandDmitriyDrusvyatskiy.2018.Stochasticsubgradientmethod
ExplaininganomaliesdetectedbyautoencodersusingSHAP. arXivpreprint convergesattherateO(ğ‘˜âˆ’1/4)onweaklyconvexfunctions. arXivpreprint
arXiv:1903.02407(2019). arXiv:1802.02988(2018).
[2] AlejandroBarredoArrieta,NataliaDÃ­az-RodrÃ­guez,JavierDelSer,AdrienBen- [25] RobertDayandPaulMilgrom.2008.Core-selectingpackageauctions.interna-
netot,SihamTabik,AlbertoBarbado,SalvadorGarcÃ­a,SergioGil-LÃ³pez,Daniel tionalJournalofGameTheory36(2008),393â€“407.
Molina,RichardBenjamins,etal.2020.ExplainableArtificialIntelligence(XAI): [26] RobertW.DayandPeterCramton.2012. QuadraticCore-SelectingPayment
Concepts,taxonomies,opportunitiesandchallengestowardresponsibleAI.In- RulesforCombinatorialAuctions.OperationsResearch60,3(2012),588â€“603.
formationFusion58(2020),82â€“115. [27] GabrielleDemange.2004. OnGroupStabilityinHierarchiesandNetworks.
[3] HarisAziz,YoramBachrach,EdithElkind,andMikePaterson.2011.False-name JournalofPoliticalEconomy112,4(2004),754â€“778.
manipulationsinweightedvotinggames.JournalofArtificialIntelligenceResearch [28] XiaotieDengandChristosH.Papadimitriou.1994.Onthecomplexityofcooper-
40(2011),57â€“93. ativesolutionconcepts.Math.Oper.Res.19,2(1994),257â€“266.
[4] IgorBabuschkin,KateBaumli,AlisonBell,SuryaBhupatiraju,JakeBruce,Peter [29] G.dâ€™EonandK.Larson.2020.TestingAxiomsAgainstHumanRewardDivisions
Buchlovsky,DavidBudden,TrevorCai,AidanClark,IvoDanihelka,Antoine inCooperativeGames.InProceedingsoftheNineteenthInternationalConference
Dedieu,ClaudioFantacci,JonathanGodwin,ChrisJones,RossHemsley,Tom onAutonomousAgentsandMulti-AgentSystems(AAMAS).
Hennigan,MatteoHessel,ShaoboHou,StevenKapturowski,ThomasKeck,Iurii [30] FrankDeutsch.1995.Dykstraâ€™scyclicprojectionsalgorithm:therateofconver-
Kemaev,MichaelKing,MarkusKunesch,LenaMartens,HamzaMerzic,Vladimir gence.ApproximationTheory,WaveletsandApplications(1995),87â€“94.
Mikulik,TamaraNorman,GeorgePapamakarios,JohnQuan,RomanRing,Fran- [31] StevenDiamondandStephenBoyd.2016.CVXPY:APython-embeddedmodeling
ciscoRuiz,AlvaroSanchez,LaurentSartran,RosaliaSchneider,ErenSezener, languageforconvexoptimization.JournalofMachineLearningResearch17,83
StephenSpencer,SrivatsanSrinivasan,MiloÅ¡StanojeviÄ‡,WojciechStokowiec, (2016),1â€“5.
LuyuWang,GuangyaoZhou,andFabioViola.2020.TheDeepMindJAXEcosystem. [32] PradeepDubey.1982.TheShapleyvalueasaircraftlandingfeesâ€“revisited.Man-
http://github.com/deepmind agementScience28,8(1982),869â€“874.
[5] YoramBachrach.2011.Theleast-coreofthresholdnetworkflowgames.InInter- [33] BradleyEfron,TrevorHastie,IainJohnstone,andRobertTibshirani.2004.Least
nationalSymposiumonMathematicalFoundationsofComputerScience.Springer, angleregression.(2004).
36â€“47. [34] EdithElkind,LeslieAnnGoldberg,PaulWGoldberg,andMichaelWooldridge.
[6] YoramBachrach,EvangelosMarkakis,EzraResnick,ArielDProcaccia,JeffreyS 2009. Onthecomputationalcomplexityofweightedvotinggames. Annalsof
Rosenschein,andAminSaberi.2010.Approximatingpowerindices:Theoretical MathematicsandArtificialIntelligence56(2009),109â€“131.
andempiricalanalysis.AutonomousAgentsandMulti-AgentSystems20(2010), [35] E.ElkindandD.Pasechnik.2009.Computingthenucleolusofweightedvoting
105â€“122. games.InProceedingsoftheNineteenthAnnualACM-SIAMSymposiumonDiscrete
[7] YoramBachrachandElyPorat.2010.Pathdisruptiongames.InProceedingsof Algorithms.SocietyforIndustrialandAppliedMathematicsPhiladelphia,PA,
USA,327â€“335.
the9thInternationalConferenceonAutonomousAgentsandMultiagentSystems:
volume1-Volume1.1123â€“1130. [36] ArpadE.Elo.1978.TheRatingsofChessPlayers,PastandPresent(2nded.).Arco
[8] YoramBachrachandJeffreySRosenschein.2007.ComputingtheBanzhafpower Publishing,Inc.
indexinnetworkflowgames.InProceedingsofthe6thInternationalJointConfer- [37] LÃ¡szlÃ³ErdÅ‘s,AnttiKnowles,Horng-TzerYau,andJunYin.2013.Spectralstatistics
enceonAutonomousAgentsandMultiagentSystems.1â€“7. ofErdÅ‘sâ€“RÃ©nyigraphsI:Localsemicirclelaw.(2013).
[9] Y.;BachrachandJ.S.Rosenschein.2008.CoalitionalSkillsGames.InProceedings [38] FranciscoFacchineiandJong-ShiPang.2003. Finite-DimensionalVariational
ofthe7thInternationalConferenceonAutonomousAgentsandMulti-AgentSystems
InequalitiesandComplementarityProblems.Springer.
(AAMAS).1023â€“1030. [39] ShaheenSFatima,MichaelWooldridge,andNicholasRJennings.2008.Alinear
[10] CatalinBadeaandDavidSeifert.2016. Rittoperatorsandconvergenceinthe approximationmethodfortheShapleyvalue.ArtificialIntelligence172,14(2008),
methodofalternatingprojections.JournalofApproximationTheory205(2016), 1673â€“1699.
133â€“148. [40] DonaldBruceGillies.1953.Sometheoremsonn-persongames.Ph.D.Dissertation.
[11] Maria-FlorinaBalcan,ArielProcaccia,andYairZick.2015.LearningCooperative PrincetonUniversity.
Games.InProceedingsoftheTwenty-FourthInternationalJointConferenceon [41] AricA.Hagberg,DanielA.Schult,andPieterJ.Swart.2008.ExploringNetwork
ArtificialIntelligence(IJCAI2015).475â€“481. Structure,Dynamics,andFunctionusingNetworkX.InProceedingsofthe7th
[12] U.;Balkanski,E.;SyedandS.Vassilvitskii.2017. StatisticalCostSharing.In PythoninScienceConference,GaÃ«lVaroquaux,TravisVaught,andJarrodMillman
(Eds.).Pasadena,CAUSA,11â€“15.
Proceedingsofthe31stAnnualConferenceonNeuralInformationProcessingSystems
(NeurIPS).6221â€“6230. [42] DavidHarrisonJrandDanielLRubinfeld.1978.Hedonichousingpricesandthe
[13] AlejandroBarredoArrieta,NataliaDÃ­az-RodrÃ­guez,JavierDelSer,AdrienBen- demandforcleanair.JournalofEnvironmentalEconomicsandManagement5,1
netot,SihamTabik,AlbertoBarbado,SalvadorGarcia,SergioGil-Lopez,Daniel (1978),81â€“102.
Molina,RichardBenjamins,RajaChatila,andFranciscoHerrera.2020. Ex- [43] PetterHolmeandBeomJunKim.2002.Growingscale-freenetworkswithtunable
plainable Artificial Intelligence (XAI): Concepts, taxonomies, opportunities clustering.Phys.Rev.E65(Jan2002),026107.Issue2. https://doi.org/10.1103/
andchallengestowardresponsibleAI. InformationFusion58(2020),82â€“115. PhysRevE.65.026107
https://doi.org/10.1016/j.inffus.2019.12.012 [44] DavidR.Hunter.2004.MMAlgorithmsforGeneralizedBradley-TerryModels.
[14] HeinzHBauschkeandJonathanMBorwein.1996.Onprojectionalgorithmsfor TheAnnalsofStatistics32,1(2004),384â€“406.
solvingconvexfeasibilityproblems.SIAMRev.38,3(1996),367â€“426. [45] SamuelIeongandYoavShoham.2005.Marginalcontributionnets:acompact
[15] UmangBhatt,AliceXiang,ShubhamSharma,AnkurTalyAdrianWeller,Yunhan representationschemeforcoalitionalgames.InProceedingsofthe6thACM
Jia,JoydeepGhosh,RuchirPuri,JosÃ©M.F.Moura,andPeterEckersley.2020.Ex- ConferenceonElectronicCommerce.193â€“202.
plainableMachineLearninginDeployment.InProceedingsoftheACMConference [46] AnatoliJuditsky,ArkadiNemirovski,andClaireTauvel.2011.Solvingvariational
onFairness,Accountability,andTransparency. inequalitieswithstochasticmirror-proxalgorithm.StochasticSystems1,1(2011),
[16] JMBilbao,JRFernandez,AJimÃ©nezLosada,andJJLopez.2000. Generating 17â€“58.
functionsforcomputingpowerindicesefficiently.Top8,2(2000),191â€“213. [47] NarendraKarmarkar.1984. Anewpolynomial-timealgorithmforlinearpro-
[17] JMBilbao,NJiminÃ©z,andJJLÃ³pez.2002.VotingpowerintheEuropeanUnion gramming.InProceedingsoftheSixteenthAnnualACMSymposiumonTheoryof
enlargement.EuropeanJournalofOperationsResearch143(2002),181â€“196. Computing.302â€“311.
[18] StephenPBoydandLievenVandenberghe.2004.Convexoptimization.Cambridge [48] WalterKernandDaniÃ«lPaulusma.2003.Matchinggames:theleastcoreandthe
universitypress. nucleolus.MathematicsofOperationsResearch28,2(2003),294â€“308.
[19] SiminaBranzeiandKateLarson.2011.SocialDistanceGames.InProceedingsof [49] AlfKimmsandIgorKozeletskyi.2016.Core-basedcostallocationinthecoopera-
theTwenty-SecondInternationalJointConferenceonArtificialIntelligence(IJCAI
tivetravelingsalesmanproblem.EuropeanJournalofOperationalResearch248,3
2011). (2016),910â€“916.
[20] JavierCastro,DanielGÃ³mez,andJuanTejada.2009.Polynomialcalculationof [50] DiederikPKingmaandJimmyBa.2014.Adam:Amethodforstochasticopti-
theShapleyvaluebasedonsampling. Computers&OperationsResearch36,5 mization.arXivpreprintarXiv:1412.6980(2014).
(2009),1726â€“1730. [51] GalinaMKorpelevich.1976.Theextragradientmethodforfindingsaddlepoints
[21] GeorgiosChalkiadakis,EdithElkind,andMichaelWooldridge.2012.Computa- andotherproblems.Matecon12(1976),747â€“756.
tionalAspectsofCooperativeGameTheory.Morgan&ClaypoolPublishers. [52] I.E.Kumar,Venkatasubramanian,S.,Scheidegger,andC.Friedler.2020.Prob-
[22] GeorgeDantzig.1963.Linearprogrammingandextensions.PrincetonUniversity lemswithShapley-value-basedexplanationsasfeatureimportancemeasures.In
Press. Proceedingsofthe37thInternationalConferenceonMachineLearning(ICML).
[23] AnupamDatta,ShayakSen,andYairZick.2016.Algorithmictransparencyvia [53] StephenCLittlechildandGFThompson.1977. Aircraftlandingfees:agame
quantitativeinputinfluence:Theoryandexperimentswithlearningsystems.In theoryapproach.TheBellJournalofEconomics(1977),186â€“204.[54] ScottMLundbergandSu-InLee.2017.Aunifiedapproachtointerpretingmodel [80] MichaelZuckerman,PiotrFaliszewski,YoramBachrach,andEdithElkind.2012.
predictions.AdvancesinNeuralInformationProcessingSystems30(2017). Manipulatingthequotainweightedvotinggames. ArtificialIntelligence180
[55] SasanMaleki,LongTran-Thanh,GregHines,TalalRahwan,andAlexRogers.2013. (2012),1â€“19.
Boundingtheestimationerrorofsampling-basedShapleyvalueapproximation.
arXivpreprintarXiv:1306.4265(2013).
[56] RoryMitchell,JoshuaCooper,EibeFrank,andGeoffreyHolmes.2022.Sampling
permutationsforshapleyvalueestimation. TheJournalofMachineLearning
Research23,1(2022),2082â€“2127.
[57] RoryMitchell,JoshuaCooper,EibeFrank,andGeoffreyHolmes.2022.Sampling
PermutationsforShapleyValueEstimation.JournalofMachineLearningResearch
23(2022),2082â€“2127.
[58] AryanMokhtari,AsumanOzdaglar,andSarathPattathil.2020.Aunifiedanalysis
ofextra-gradientandoptimisticgradientmethodsforsaddlepointproblems:
Proximalpointapproach.InInternationalConferenceonArtificialIntelligenceand
Statistics.PMLR,1497â€“1507.
[59] DmitryMoor,SvenSeuken,TobiasGrubenmann,andAbrahamBernstein.2016.
Core-SelectingPaymentRulesforCombinatorialAuctionswithUncertainAvail-
abilityofGoods.InProceedingsoftheTwenty-FifthInternationalJointConference
onArtificialIntelligence(IJCAI-16).
[60] Niema Moshiri. 2018. The dual-BarabÃ¡si-Albert model.
arXiv:1810.10538[physics.soc-ph]
[61] RogerB.Myerson.1977. GraphsandCooperationinGames. Mathematicsof
OperationsResearch2,3(1977),225â€“229.
[62] M.E.J.NewmanandD.J.Watts.1999. Renormalizationgroupanalysisofthe
small-worldnetworkmodel. PhysicsLettersA263,4(1999),341â€“346. https:
//doi.org/10.1016/S0375-9601(99)00757-4
[63] F.Pedregosa,G.Varoquaux,A.Gramfort,V.Michel,B.Thirion,O.Grisel,M.
Blondel,P.Prettenhofer,R.Weiss,V.Dubourg,J.Vanderplas,A.Passos,D.Cour-
napeau,M.Brucher,M.Perrot,andE.Duchesnay.2011.Scikit-learn:Machine
LearninginPython.JournalofMachineLearningResearch12(2011),2825â€“2830.
[64] TapioRaunioandMattiWiberg.1998.WinnersandLosersintheCouncil:Voting
PowerConsequencesofEUEnlargements.JournalofCommonMarketStudies
(JCMS)38(1998),549â€“562.Issue4.
[65] EzraResnick,YoramBachrach,ReshefMeir,andJeffreySRosenschein.2009.The
costofstabilityinnetworkflowgames.InMathematicalFoundationsofComputer
Science2009:34thInternationalSymposium,MFCS2009,NovySmokovec,High
Tatras,Slovakia,August24-28,2009.Proceedings34.Springer,636â€“650.
[66] AnjaReyandJÃ¶rgRothe.2010. Complexityofmergingandsplittingforthe
probabilisticBanzhafpowerindexinweightedvotinggames.InECAI2010.IOS
Press,1021â€“1022.
[67] AnjaReyandJÃ¶rgRothe.2011.Briberyinpath-disruptiongames.InInternational
ConferenceonAlgorithmicDecisionTheory.Springer,247â€“261.
[68] DovSametandEitanZemel.1984.Onthecoreanddualsetoflinearprogramming
games.MathematicsofOperationsResearch9,2(1984),309â€“316.
[69] AbigailSee,YoramBachrach,andPushmeetKohli.2014.Thecostofprinciples:
analyzingpowerincompatibilityweightedvotinggames.InProceedingsofthe
2014InternationalConferenceonAutonomousAgentsandMulti-AgentSystems.
Citeseer,37â€“44.
[70] LloydS.Shapley.1951.Notesonthen-PersonGameâ€“II:TheValueofann-Person
Game. RANDCorporation.
[71] LloydSShapleyandMartinShubik.1954.Amethodforevaluatingthedistribution
ofpowerinacommitteesystem.AmericanPoliticalScienceReview48,3(1954),
787â€“792.
[72] MukundSundararajanandAmirNajmi.2020.ThemanyShapleyvaluesformodel
explanation.InInternationalConferenceonMachineLearning.PMLR,9269â€“9278.
[73] NikolaTarashev,KostasTsatsaronis,andClaudioBorio.2016.Riskattribution
usingtheShapleyvalue:Methodologyandpolicyapplications.ReviewofFinance
20,3(2016),1189â€“1213.
[74] AlanTaylorandWilliamZwicker.1992.Acharacterizationofweightedvoting.
ProceedingsoftheAmericanmathematicalsociety115,4(1992),1089â€“1094.
[75] HildeJ.P.Weerts,WernervanIpenburg,andMykolaPechenizkiy.2019.AHuman-
GroundedEvaluationofSHAPforAlertProcessing.InProceedingsoftheKDD
WorkshoponExplainableAI2019(KDD-XAI).
[76] M.A.Williams.1988.Anempiricaltestofcooperativegamesolutionconcepts.
BehavioralScience33,3(1988),224â€“237.
[77] WilliamWolberg,OlviMangasarian,NickStreet,andW.Street.1995. Breast
CancerWisconsin(Diagnostic). UCIMachineLearningRepository. DOI:
https://doi.org/10.24432/C5DW2B.
[78] TomYanandArielD.Procaccia.2021.IfYouLikeShapleyThenYouâ€™llLovethe
Core. ProceedingsoftheAAAIConferenceonArtificialIntelligence35,6(May
2021),5751â€“5759. https://doi.org/10.1609/aaai.v35i6.16721
[79] LianminZheng,Wei-LinChiang,YingSheng,SiyuanZhuang,ZhanghaoWu,
YonghaoZhuang,ZiLin,ZhuohanLi,DachengLi,Eric.PXing,HaoZhang,
JosephE.Gonzalez,andIonStoica.2023. JudgingLLM-as-a-judgewithMT-
BenchandChatbotArena. arXiv:2306.05685[cs.CL]Seealsohttps://lmsys.org/
blog/2023-05-03-arena/andhttps://huggingface.co/spaces/lmsys/chatbot-arena-
leaderboard.AccessedAugust13th,2023.A ALGORITHMS Wefurtherboundthefollowingquantitiesastheymaybeof
interesttoothersforfurtherfollow-upalgorithmicdevelopment.
A.1 ProofsofTheoreticalResults
WecanboundtheresultinLemma1.First,recognize
WerestateTheorem2andLemma1andincludetheirproofs.
âˆš
Theorem. Ifâ„“ ğ‘(ğœ–,ğ‘) â‰¤ğ›¾2 forallğ‘,thenğ‘isinthe(ğœ–+ 2ğ‘›ğ›¾)-core.
Proof.
â„“ ğ‘(ğœ–,ğ‘)=
21
|ğ‘ =| â‡’(cid:0)ma âˆšï¸x( 210 |ğ‘,ğ‘£ |(( ğ‘£ğ¶ () ğ¶âˆ’ )ğœ– âˆ’âˆ’ ğœ–âˆ’ğ‘âŠ¤ ğ‘ğ‘ âŠ¤) ğ‘(cid:1)2
)
â‰¤ â‰¤ğ›¾ ğ›¾2 âˆ€âˆ€ ğ‘ğ‘ âˆˆâˆˆ ğ¶ğ¶ ( (1 13 4)
)
(ğ‘‘
ğ‘
âˆ’ğ‘‘ ğ‘â€²)2
=ï£±ï£´ï£´ï£´ï£´ï£´ï£² ï£´ï£´ï£´ï£´ï£´0(cid:0)(cid:0)
(cid:0)
ğ‘£ğ‘£(ğœ–
((
ğ¶ğ¶+ ))ğ‘ âˆ’âˆ’âŠ¤ğ‘
ğœ–ğœ–
â€²)
âˆ’
âˆ’âˆ’
ğ‘
ğ‘âŠ¤( âŠ¤ğœ– ğ‘â€² ğ‘(cid:1)+
â€²2
(cid:1)ğ‘ 2âŠ¤ğ‘â€²)(cid:1)2 eiii fff lsğ‘‘ğ‘‘ğ‘‘ e<â‰¥â‰¥ 000 aaa nnn dd
d
ğ‘‘ğ‘‘ğ‘‘ â€²â€²â€² â‰¥<â‰¥ 000
ï£³
âˆš (31)
=â‡’ ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘ â‰¤ 2ğ‘›ğ›¾ âˆ€ğ‘ âˆˆğ¶ (15)
âˆš â‰¤ (cid:0)(ğœ–+ğ‘âŠ¤ğ‘)âˆ’(ğœ–â€²+ğ‘âŠ¤ğ‘â€²)(cid:1)2 (32)
=â‡’ ğ‘£(ğ¶)âˆ’(ğœ–+ 2ğ‘›ğ›¾)âˆ’ğ‘âŠ¤ğ‘ â‰¤0âˆ€ğ‘ âˆˆğ¶. (16)
â–¡
+max(cid:110) (cid:0)ğ‘£(ğ¶)âˆ’ğœ–âˆ’ğ‘âŠ¤ğ‘(cid:1)2,(cid:0)ğ‘£(ğ¶)âˆ’ğœ–â€²âˆ’ğ‘âŠ¤ğ‘â€²(cid:1)2(cid:111)
(33)
Lemma. Themapğ¹ inequation(11)ismonotone,i.e., âŸ¨ğ¹(ğ‘¥) âˆ’ â‰¤ (cid:0)(ğœ–+ğœ–â€²)+(ğ‘âŠ¤ğ‘âˆ’ğ‘âŠ¤ğ‘â€²)(cid:1)2 +4ğ‘‰(ğ¼)2 (34)
ğ¹(ğ‘¥â€²),ğ‘¥âˆ’ğ‘¥â€²âŸ© â‰¥0overallğ‘¥,ğ‘¥â€² âˆˆX. =||ğ‘¥âˆ’ğ‘¥â€²||2 +4ğ‘‰(ğ¼)2 (35)
ğ‘€
Proof. First,foranyğ‘¥ âˆˆXandğ‘¥â€² âˆˆX,wefindthatğ¹(ğ‘¥)âŠ¤ğ‘¥â€²
=ğœ–â€²+ğœ‡(cid:16)âˆ‘ï¸ ğ‘‘ ğ‘ (âˆ’ğ‘âŠ¤ğ‘â€²âˆ’ğœ–â€²)(cid:17) âˆ’ğœ‡â€²(cid:16)âˆ‘ï¸ â„“ ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2(cid:17) (17)
|ğ¶|
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶ ï£®1 ğ‘âŠ¤ 0
ï£¹
=ğœ–â€²+ğœ‡(cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ‘‘ ğ¶ğ‘ |(ğ‘‘ ğ‘â€²âˆ’ğ‘£(ğ¶))(cid:17) âˆ’ğœ‡â€²(cid:16) ğ‘âˆ‘ï¸ âˆˆğ¶â„“ ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2(cid:17) . (18) whereğ‘€ = ï£¯ ï£¯
ï£¯
ï£¯
ï£°ğ‘
0
ğ‘ğ‘ 0âŠ¤ 00ï£º ï£º
ï£º
ï£º ï£»
âª¯2ğ‘›ğ¼.Therefore,
Therefore,(ğ¹(ğ‘¥)âˆ’ğ¹(ğ‘¥â€²))âŠ¤(ğ‘¥âˆ’ğ‘¥â€²)
=ğœ–+ğœ‡(cid:16)âˆ‘ï¸ ğ‘‘ ğ‘ (ğ‘‘
ğ‘
âˆ’ğ‘£(ğ¶))(cid:17) âˆ’ğœ‡(cid:16)âˆ‘ï¸ â„“ ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2(cid:17) (19)
|ğ¶|
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶ 0â‰¤ (ğ¹(ğ‘¥)âˆ’ğ¹(ğ‘¥â€²))âŠ¤(ğ‘¥âˆ’ğ‘¥â€²) (36)
âˆ’ğœ–âˆ’ğœ‡â€²(cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ‘‘ ğ¶ğ‘â€² |(ğ‘‘ ğ‘ âˆ’ğ‘£(ğ¶))(cid:17) +ğœ‡(cid:16) ğ‘âˆ‘ï¸ âˆˆğ¶â„“ ğ‘(ğ‘â€²,ğœ–â€²)âˆ’ğ›¾2(cid:17) (20) = 1 2(cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ¶1 |(ğœ‡+ğœ‡â€²)(ğ‘‘â€²âˆ’ğ‘‘)2 )(cid:17) (37)
âˆ’ğœ–â€²âˆ’ğœ‡(cid:16)âˆ‘ï¸ |ğ‘‘ ğ¶ğ‘ |(ğ‘‘ ğ‘â€²âˆ’ğ‘£(ğ¶))(cid:17) +ğœ‡â€²(cid:16)âˆ‘ï¸ â„“ ğ‘(ğ‘,ğœ–)âˆ’ğ›¾2(cid:17) (21) â‰¤ (cid:16)âˆ‘ï¸ |ğ¶1 |ğœ‡(||ğ‘¥âˆ’ğ‘¥â€²|| ğ‘€2 +4ğ‘£(ğ¼)2 )(cid:17) . (38)
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶ ğ‘âˆˆğ¶
+ğœ–â€²+ğœ‡â€²(cid:16)âˆ‘ï¸ |ğ‘‘ ğ¶ğ‘â€²
|(ğ‘‘
ğ‘â€²âˆ’ğ‘£(ğ¶))(cid:17) âˆ’ğœ‡â€²(cid:16)âˆ‘ï¸
â„“
ğ‘(ğ‘â€²,ğœ–â€²)âˆ’ğ›¾2(cid:17)
(22)
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶
= (cid:16)âˆ‘ï¸ |ğ¶1 |(cid:2)ğœ‡ğ‘‘ ğ‘(ğ‘‘ ğ‘ âˆ’ğ‘£(ğ¶))âˆ’ğœ‡â€²ğ‘‘ ğ‘â€²(ğ‘‘ ğ‘ âˆ’ğ‘£(ğ¶)) (23) Wecanalsobound||ğ¹(ğ‘¥)âˆ’ğ¹(ğ‘¥â€²)||2.First,wecanrewriteitas
ğ‘âˆˆğ¶
âˆ’ğœ‡ğ‘‘ ğ‘(ğ‘‘ ğ‘â€²âˆ’ğ‘£(ğ¶))+ğœ‡â€²ğ‘‘ ğ‘â€²(ğ‘‘
ğ‘â€²âˆ’ğ‘£(ğ¶))(cid:3)(cid:17)
(24)
âˆ’(cid:16) ğ‘âˆ‘ï¸ âˆˆğ¶(ğœ‡â€²âˆ’ğœ‡)(â„“ ğ‘(ğ‘â€²,ğœ–â€²)âˆ’â„“ ğ‘(ğ‘,ğœ–))(cid:17) (25) =||ğœ‡â€²(âˆ‘ï¸ğ‘‘ ğ¶â€² ğ‘)âˆ’ğœ‡(âˆ‘ï¸ğ‘‘ ğ¶â€²
ğ‘)||2 (39)
= (cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ¶1 |(ğ‘‘ ğ‘â€²âˆ’ğ‘‘ ğ‘)(ğœ‡â€²ğ‘‘ ğ‘â€²âˆ’ğœ‡ğ‘‘ ğ‘)(cid:17) (26) +(cid:16) ğœ‡â€²(âˆ‘ï¸ğ‘âˆˆğ¶ ğ‘‘â€² )âˆ’ğœ‡(âˆ‘ï¸ğ‘âˆˆğ¶ ğ‘‘â€² )(cid:17)2
(40)
ğ¶ ğ¶
âˆ’(cid:16)âˆ‘ï¸ (ğœ‡â€²âˆ’ğœ‡)(â„“ ğ‘(ğ‘â€²,ğœ–â€²)âˆ’â„“ ğ‘(ğ‘,ğœ–))(cid:17) (27) ğ‘âˆˆğ¶ ğ‘âˆˆğ¶
ğ‘âˆˆğ¶
+(cid:16) (âˆ‘ï¸
â„“
ğ‘(ğ‘â€²,ğœ–â€²))âˆ’(âˆ‘ï¸
â„“
ğ‘(ğ‘,ğœ–))(cid:17)2
(41)
= (cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ¶1 |(ğ‘‘ ğ‘â€²âˆ’ğ‘‘ ğ‘)(ğœ‡â€²ğ‘‘ ğ‘â€²âˆ’ğœ‡ğ‘‘ ğ‘)(cid:17) (28) =||ğ‘ âˆ‘ï¸âˆˆğ¶
ğ‘
(ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)ğ‘ ||âˆˆ 2ğ¶
(42)
ğ¶
âˆ’(cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ¶1 |1 2(ğœ‡â€²âˆ’ğœ‡)(ğ‘‘ ğ‘â€²2 âˆ’ğ‘‘ ğ‘2 ))(cid:17) (29) +(cid:16)âˆ‘ï¸ğ‘âˆˆğ¶
1 (ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)(cid:17)2
(43)
ğ¶
= 1 2(cid:16) ğ‘âˆ‘ï¸
âˆˆğ¶
|ğ¶1 |(ğœ‡+ğœ‡â€²)(ğ‘‘ ğ‘ âˆ’ğ‘‘ ğ‘â€²)2 )(cid:17) â‰¥0 (30) +(cid:16)ğ‘ âˆ‘ï¸âˆˆğ¶ 1
(ğ‘‘â€²2 âˆ’ğ‘‘2
)(cid:17)2
(44)
2ğ¶
confirmingthatğ¹ isindeedmonotone. â–¡ ğ‘âˆˆğ¶andthenupperbounditas LearningRateScheduleğœ‚ ğ‘¡ 0.1â†’0.01over1000steps
CoalitionBatchSizeğµ 100
(45) LagrangeMutiplierInitialValueğœ‡0 1000
ConstraintViolationThresholdğ›¾ 0.001
â‰¤ âˆ‘ï¸ ||ğ‘ (ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)||2 +âˆ‘ï¸(cid:16)1 (ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)(cid:17)2 (46) NumberofIterationsğ‘‡ 10,000
ğ¶ ğ¶
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶ Table 1: Algorithm 4 Hyperparameters: Runtime Experi-
+âˆ‘ï¸(cid:16) 1 (ğ‘‘â€²2 âˆ’ğ‘‘2 )(cid:17)2 (47) ment.Alternatively,thelinearschedulecanbewrittenas
ğ‘âˆˆğ¶ 2ğ¶ ğœ‚ ğ‘¡ =max(cid:0)0.01,0.1Â·(1âˆ’ 10ğ‘¡ 00)+0.01( 10ğ‘¡ 00)(cid:1) .
â‰¤ âˆ‘ï¸ 1 (ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)2 +âˆ‘ï¸(cid:16)1 (ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)(cid:17)2 (48)
ğ¶ ğ¶
ğ‘âˆˆğ¶ ğ‘âˆˆğ¶
+âˆ‘ï¸(cid:16) 21 ğ¶(ğ‘‘â€²2 âˆ’ğ‘‘2 )(cid:17)2 (49) repF lao cr et dhe ğ‘r wem ita hin soin ftg mex axpe (ğ‘ r )im we hn et rs e,w ğ‘ ,e ou us red nea wch da en cg ise ioo nfv va ar ri ia ab bl le es ,a isnd a
ğ‘âˆˆğ¶ vectorofğ‘›real-valuedlogits.Thisthenallowedustousethemore
â‰¤ âˆ‘ï¸ 1(cid:16) 2(ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)2 + 1 (ğ‘‘â€²2 âˆ’ğ‘‘2 )2(cid:17) (50) sophisticatedupdateoperatorAdam[50].NotethattheJAX[4]
ğ‘âˆˆğ¶ğ¶ 4 autodifflibrarymakesittrivialtocomputeğ¹ ğ‘  = âˆ‡ğ‘ L(ğ‘(ğ‘ ),ğœ–,ğœ‡)
â‰¤ âˆ‘ï¸ 1(cid:16) 2(ğœ‡â€²ğ‘‘â€²âˆ’ğœ‡ğ‘‘)2 + 1 (ğ‘‘â€²+ğ‘‘)2 (ğ‘‘â€²âˆ’ğ‘‘)2(cid:17) . (51) a infte Tr at bh leec 2h .angeofvariables.Weusedthehyperparametersreported
ğ¶ 4
ğ‘âˆˆğ¶
LearningRateScheduleğœ‚ 0.1
ğ‘¡
A.2 DeploymentwithAccelerators CoalitionBatchSizeğµ 1000
ItispossibletoaccelerateAlgorithm4onGPU/TPUs.Theother LagrangeMutiplierInitialValueğœ‡0 1000
algorithmsweproposedcanreusethesetechniquesaswell.Thisis ConstraintViolationThresholdğ›¾ 0.01
akeyadvantageofiterative,stochastic(MonteCarlo,minibatch) NumberofIterationsğ‘‡ 10,000
algorithms.Thekeysteptoparallelizeisğ‘‘ ğ‘ =max(0,ğ‘£(ğ‘)âˆ’ğœ–âˆ’ğ‘ğ‘‡ğ‘) Table2:Algorithm4Hyperparameters:OtherExperiments
forabatchofconstraints.
Letğ¶beağµÃ—ğ‘›matrixrepresentingabatchofğµcoalitionswitha
singlecoalitionğ‘representedoneachrow(weareabusingnotation
fromearlierwhereğ¶representsasinglecoalition).Eachentryof B SHAPLEYVALUEVERSUSTHECORE
ğ¶indicateswhetherplayerğ‘–isincludedincoalitionğ‘.Therefore,
TheShapleyvalueisanintuitivesolutionconceptforquantify-
thismatrixissparse(andbinary).Letğ‘‘beavectorcontainingğ‘‘
ğ‘ ingtheexpectedmarginalcontributionofaplayer.Themarginal
foreachcoalitionğ‘.Letğ‘£beavectorcontainingthevalueofeach
contribution of agent ğ‘– to a coalitionğ¶ such that ğ‘– âˆ‰ ğ¶ is the
coalition.TheninJAX[4],ğ‘‘ =jax.nn.relu(ğ‘£âˆ’ğœ–âˆ’jnp.dot(ğ¶,ğ‘)).
increase in utility the coalitionğ¶ achieves when ğ‘– joins it, de-
Thisisquitesimilartotheoperationofprocessingtheoutput
fined asğ‘šğ¶ = ğ‘£(ğ¶ âˆª{ğ‘–}) âˆ’ğ‘£(ğ¶). We can define a similar con-
ofasingleneuralnetworklayerfollowedbyaReLUnonlinearity. ğ‘–
ceptforpermutationsofagents.Wedenotethepredecessorsofğ‘–
ğ¶ playstheroleofthetypicalweightmatrixğ‘Š.ğ‘ playstherole
inthethepermutationğœ‹ asğ‘(ğ‘–,ğœ‹),i.e.theagentsappearingbe-
ofthetypicalinputğ‘¥ toaneuralnetworklayer.Theoffsetofthe
foreğ‘–inthepermutationğœ‹.Wedenotethesetofallpermutations
neuralnetworklayerisğ‘£âˆ’ğœ–.Andjax.nn.reluisthenonlinearity.
over the agents as Î . The marginal contribution of playerğ‘– in
Wenowdescribehowtousetheresultingoutputğ‘‘tocompute
thepermutationğœ‹ istheincreaseinutilityğ‘–provideswhenjoin-
theupdatesofAlgorithm4.Theupdateinğ¹(ğ‘¥)(seeequation(11))
ingtheteamofagentsappearingbeforetheminthepermutation,
canthenbeeasilycomputedfromğ‘‘.Noteâ„“(ğ‘,ğœ–) =ğ‘‘2 âŠ˜(2ğ¶1ğ‘›)
ğ‘šğœ‹ =ğ‘£(ğ‘(ğ‘–,ğœ‹)âˆª{ğ‘–})âˆ’ğ‘£(ğ‘(ğ‘–,ğœ‹)).TheShapleyvalueofagentğ‘–is
where1ğ‘›isthelength-ğ‘›onesvector.ğ¹(ğ‘¥)isthenusedtoconstruct değ‘–
finedastheirmarginalcontribution,averagedacrossallpermu-
theUpdateintheforloopofAlgorithm4.
tations:
Whenthebatchsizeğµisverylarge,theoperationjnp.dot(ğ¶,ğ‘)
cantakeadvantageofGPUs/TPUstoprocessthismatrix-vector 1 âˆ‘ï¸
operationquickly.ğ¶issparse,whichcanalsospeedupcalculations
Î¦ ğ‘–(ğ‘£)=
ğ‘!
ğ‘£(ğ‘(ğ‘–,ğœ‹))âˆª{ğ‘–})âˆ’ğ‘£(ğ‘(ğ‘–,ğœ‹)) (52)
usingsparsematrixmultiplicationlibraries. ğœ‹âˆˆÎ 
The Shapley value uniquely exhibits four axiomatic proper-
Furthermore,ifthebatchsizeğµ istoolargetofitğ¶ onasin-
gle device, the batches can be split up across devices, sayğ‘‘ğ‘— =
ties[21]:efficiency:(cid:205)ğ‘› ğ‘–=1Î¦ ğ‘–(ğ‘£) =ğ‘£(ğ¼),nullplayer:ifğ‘–contributes
jax.nn.relu(ğ‘£ğ‘—âˆ’ğœ–âˆ’jnp.dot(ğ¶ğ‘—,ğ‘)).Theupdateinğ¹(ğ‘¥)canbe nothing,thenÎ¦ ğ‘–(ğ‘£) = 0,symmetry:âˆ€ğ¶ âŠ† ğ¼ âˆ’{ğ‘–,ğ‘—},ğ‘£(ğ¶âˆª{ğ‘–}) =
computedsimilarlytobeforeoneachdevice(givingusğ¹ğ‘—(ğ‘¥))and
ğ‘£(ğ¶âˆª{ğ‘—}) â‡’Î¦ ğ‘–(ğ‘£) =Î¦ ğ‘—(ğ‘£),andadditivity:fortwogamesğ‘£1,ğ‘£2,
thenaggregatedacrossdevicestoproducethefinalresult.
theShapleyvalueofthecombinedgameÎ¦ ğ‘–(ğ‘£1+ğ‘£2) = Î¦ ğ‘–(ğ‘£1)+
Î¦ ğ‘–(ğ‘£2).OneadvantageoftheShapleyvalueisthatitcanalsobe
computedusingMonteCarlosampling[6,57].TheShapleyvalue
A.3 AlgorithmHyperparameters hasbecomewidely-usedasameansofquantifyingtheeffectsof
WereportthehyperparametersweusedforAlgorithm4below. individualfeaturesinXAI[54].
FortheruntimeexperimentinFigure2,weusedthosereportedin Asdiscussedinthemainpaper,therearesomecomputational
Table1. andconceptuallimitationsoftheShapleyvalue.Computationally,therearesomegameswherenopolynomial-timealgorithmcan
Imputation Approximation Quality
obtainsufficientlysmallconfidenceintervals[9]andothersfor
whichitcannotbecomputedusingauniformdistribution[12]. 8 Shapley LP
CL 25
For XAI applications, the Shapley value has been criticized for
7 CL (1.5x LR)
several reasons. Firstly, the Shapley value does not necessarily 20
CL (0.2x LR)
reflectwhathumanendusersreallywanttoexplainaboutmodels 6
15
in deployment [15]. As such, it has been labeled â€œnot a natural
5 solutiontothehuman-centricissuesofexplainabilityâ€[52].Second, 10
whenfeaturesarecorrelated,itisnotclearhowShapleyvalues 4
5
shouldattributerelativeimportance[52].Third,theusefulnessof 0 20 40 60 80 100
theadditivityaxiomisquestionable[78]andcanbeuninformative Wall Clock Time (seconds)
fornon-additivemodels[52].Finally,whenhumansaidedwitha
modelwereevaluatedonalertprocessing,therewasnosignificant Figure5:Approximationqualityofthelinearprogram(LP),
differenceintaskutilitymetricswhentheShapleyvalueswere coreLagrangian(CL),andShapleymethodasafunctionof
providedversusnotprovided[75]. computationtime(seconds).Theğ‘¥-axiscorrespondstowall-
Incontrast,thecorefocusesonthestabilityoftheimputations. clocktimetakenbyallalgorithmsrunside-by-sidegiven
Inparticular,utilitysubdivisionsdiscoveredbythecorecanbe ğ‘˜ âˆˆ {500,1000,2000,4000,8000,16000} sampledcoalitionsfor
interpretedasâ€œeconomicallyplausiblepaymentsinacompetitive theLPmethod,ğ‘¡ ğ‘˜.Abettercoreapproximationqualityis
marketinthesensethateverycoalitionshouldbecompensatedfor reflectedinhavingalowerğœ–forthesameruntime.Theleft
itsmarketvalueâ€[78].Imputationsoutsidethecorewouldleadto ğ‘¦-axisrepresentstheapproximateğœ– oftheleast-coresolu-
someagentshavingincentivetoformdifferentcoalitionsforhigher tionfound,ğœ–Ë†(ğ‘ ğ¿ğ‘ƒ,ğ¶Ë† )andğœ–Ë†(ğ‘ ğ¶ğ¿,ğ¶Ë† ),computedoverthesame
valueandredistributetheextrapayoffamongthemselves.Insome setof225 coalitions,ğ¶Ë† .AstheShapleysolutionisnotmoti-
contexts,approximationsoftheleastcorecanattributeimportance vatedbystability,wemeasuretheapproximatesolutionâ€™s
morereliablythanShapleyvalueinXAI[78].OutsideofXAI,the qualitybyeuclideandistancetotheShapleyvalueestimated
coreisusedtoselectpaymentrulesincombinatorialauctionsdue with10millionMonte-Carlosamples.EachShapleyapproxi-
toproblemswiththecommonly-usedmechanisms[26,59]. mationisestimatedusing125Ã—ğ‘˜samples.Eachdatapoint
Lastly,thereisevidencethattheShapleyvaluehasweakerempir- (ğ‘¡ ğ‘˜,ğœ–Ë†(ğ‘ ğ‘¥,ğ¶Ë† ))representsanaverageoverthesamesetof2,500
icalsupportthanthecoreforpredictinghumanpaymentdivisions randomweightedvotinggameswithshadingindicatingstan-
inbehavioralstudies[76].Inamorerecentstudy,behaviorofplay- darderrorofthemean.
ersdeviatedfromtheShapleyvaluepredictionsandviolatedtwoof
itsaxioms[29]:nullplayerandadditivity.Forallthesereasons,we
believethattheleastcoreisaworthyalternativesolutionconcept aregeneratedbyconnectingeachnewvertexwitheitherğ‘š1edges
ingeneralandalsoforXAI. withprobabilityğ‘ orğ‘š2 edgeswithprobability1âˆ’ğ‘ [60](with
edgetargetsselectedatrandomfromthecurrentvertices).Pow-
B.1 AdditionalTimingExperiment
erlawClustersaregraphswithapowerlawdegreedistribution
andapproximateaverageclustering[43],whereğ‘šisthenumber
InFigure5,wereplicatetheweightedvotinggamestimingexper-
ofedgestorandomlyaddtoeachnodeandğ‘ istheprobability
imentfromFigure2butnowforaweightedgraphgame,specif-
ofaddingatriangleafteraddingeachedge.RandomUniform
icallytheNewmanWattsStrogatzgameinFigure1ewithgame
IntersectionArandomsubsetofğ‘šelementsisassignedtoevery
parametersğ‘ andğ‘˜ sampledfrom [4,24] and [0,1] asindicated
vertexinagraph,eachelementbeingassignedindependentlywith
inthefigure.WealsodisplaytwoadditionalrunsoftheCoreLa-
probabilityğ‘.Anedgebetweentwoverticesexistsiftheirelement
grangianapproachwithtwodifferentlearningrates(LR)aroundthe
subsetsintersect.
baselearningrate:learningrateschedule=linear_schedule(2Ã—
WeobserveinFigure6thatsimilarlytoErdÅ‘s-RÃ©nyi,partition
ğ¿ğ‘…,0.1Ã—ğ¿ğ‘…,103) withbaseğ¿ğ‘… = 0.5.Lastly,wereportapproxi-
graphshavetheoppositephenomenonofasmallcornerofthe
mationqualityfortheMonte-CarloShapleyvalueasmeasuredby
spacewithstablegames(lowğ‘ andğ‘ ),withthegameswith
euclideandistancetoitsapproximategroundtruthvalue.Inthis ğ‘–ğ‘› ğ‘œğ‘¢ğ‘¡
moderatevaluesofthetwoparametersbeinglessstable.Incon-
case,theLPmethodoutperformstheCLmethodsuggestingitis
trast,DualBarabasiAlbertgraphshavestablegameswhenboth
importantkeepbothapproachesinmindwhenattemptingtosolve
parametershavemediumvalues,withlessstabilityaseitherof
newproblemdomains.
theparametersdeviatingfromthesevalues.Finally,similarlyto
NewmanWattsStrogatz,Intersectiongraphsindicateaspectrum
C GRAPHGAMES
betweenstableandunstablegames(withtheğ‘parameterhaving
C.1 Othergraphgames stronginfluenceinIntersectiongraphs,andğ‘˜ parameterhaving
Wepresent4moregraphgamestocomplementSection4.2.2: thestrongerinfluenceonstabilityinNWSgraphs).
PartitionGrapharegraphswheretheverticesaresplitinto
ğ‘›partitions.SimilartotheErdÅ‘s-RÃ©nyigraph,anedgeoccursbe- C.2 ExampleGraphs
tween vertices within a partition with probabilityğ‘ ğ‘–ğ‘› and with Figure7presentsanexampleofaninducedsubgraphgame,de-
probabilityğ‘
ğ‘œğ‘¢ğ‘¡
acrosspartitions.DualBarabasiAlbertgraphs scribinghowthecharactersiticfunctioniscalculatedinthisgame.
etamixorppA
rorrE
yelpahS
2L
)shtdnasuoht
ni(1.0 24 0.5 6 23 10
0.8 4 20 5.0 8
0.6 16 4.8 4
0.3 12 6 0.4 2 12 4.6 2 4
0.2 8
4.4 2
0.0 0 4 0.1 3
0.00.20.40.60.81.0 2 14 26 38 50 62 0.1 0.3 0.5 2 11 22
ğ‘ ğ‘œğ‘¢ğ‘¡ ğ‘š2 ğ‘ numberofrules
(a)Partition (b)DualBarabasiAlbert (a)Varysamplingprobability (b)Varyrulesandplayers
(ğ‘›=4,ğœ=1) (ğ‘=0.25,ğœ=1)
24 24 Figure8:Meanleast-corevalueover200randomlygenerated
5.0
20 20 4 MCNs(10players,ğ‘˜ =10rules).
4.8
16 16
12 4.6 12 2 Dataset #ofFeatures #ofSamples Task
BreastCancer 569 30 Classification
8 4.4 8
Diabetes 442 10 Regression
4 4 0 Wine 178 13 Classification
0.00.20.40.60.81.0 0.00.20.40.60.81.0
BostonHousing 506 13 Regression
ğ‘ ğ‘
Table3:StatisticsofMLTasksinXAIExperiments
(c)PowerlawCluster (d)Intersection
(ğœ=1) (ğœ=1)
TogeneraterandomMCNs,wegenerateğ‘˜rules,eachusingthe
Figure 6: Mean LCV for different classes of graphs when
followingsamplingprocess:foreachplayer,theyareincludedin
sweepingovertwohyperparameters.Constanthyperparam-
ğ‘ƒ withprobabilityğ‘,andinğ‘ withprobabilityğ‘.Ifanagentis
etersareshowninparenthesis.
selectedforbothğ‘ƒ andğ‘ theruleisdiscardedandre-sampled.
Figure8showstheimpactoftheparametersontheexpected
a b least-corevalue.InFigure8awevaryğ‘andğ‘whileinFigure8b
1 2 3
wechangeboththenumberofrulesandthenumberofplayers.In
e g h particular,weobservethattheexpectedleast-corevalue(andhence,
c
4 5 6 theexpectedstabilityofthegame)dependsonallfourparameters.
Forexample,gameswithlowğ‘buthighğ‘(i.e.coalitionsaremore
f i
j d likelytonothaveanyrulesapplytothem)areverystable,butso
7 8 9
aregameswithfewrulesandmanyagents.Theseinsightsopenup
newresearchquestionssuchasthepossibilityfordesigningspecial-
purposealgorithmsforMCNsunderspecificparameter-regimes.
Figure7:Examplegraphgamewith9players.Thecoalition
withplayers{1,2,4,5,7,8}haspayoffğ‘+ğ‘’+ğ‘”+ğ‘“+ğ‘—,thecoalition
withplayers{3,6}haspayoffâ„,andthecoalitionwithplayers D XAI:DATASETSANDADDITIONAL
{9}haspayoff0(asdoallsingletoncoalitions).Intuitively, EXPERIMENTS
theedgescorrespondtosynergiesbetweenplayersthatare D.1 Datasets
onlyrealisediftheyareinthesamecoalition.
WeliststatisticsofourXAIdatasetsinTable3.Weused80%ofthe
datafortrainingandkept20%asidefortestingandmeasuringthe
performanceoftheAImodel.
Figures9showexamplesofrandomlygeneratedgraphs,ofthe
variousclassesconsideredinthepaper,alongwiththeirrepresen-
D.2 AdditionalDataValuationExperiments
tationasweightedadjacencymatrices.
WerepeatedthedatavaluationexperimentdescribedinSection5
C.2.1 MarginalContributionNetworks. Thefinalclassofgameswe onallthedatasetspresentedintheglobalandlocalexperiments.
studyarethemarginalcontributionnetworks(MCNs)[45].Inan Recallthatdatavaluationassignsimportancestoeachdatapoint
MCN,thecooperativegameisdefinedbyasetofrules{ğ‘Ÿ1,...,ğ‘Ÿ ğ‘˜} ratherthanfeatures.Figure10showsasimilartrendthatremoving
suchthateachruletakestheformğ‘Ÿ =(ğ‘ƒ,ğ‘)whereğ‘ƒ,ğ‘ âŠ†ğ¼ refer thetopdatapointstheleastcoreseemstobemorecriticalformodel
tothepositiveandnegativepartsrespectively.Givenacoalition performancethanShapleyvalues.Thetrendsometimesswitches
ğ¶ âŠ† ğ¼, a ruleğ‘Ÿ = (ğ‘ƒ,ğ‘) applies toğ¶ if and only ifğ‘ƒ âŠ† ğ¶ and after40-50%ofdataremoved.
ğ¶âˆ©ğ‘ =âˆ….Clearlymultiplerulescanapplytoacoalitionandsowe
letğ‘… bethesetofrulesthatapplytoğ¶.Theresultingcharacteristic
ğ¶
functionisthusğ‘£(ğ¶)=(cid:205) ğ‘Ÿâˆˆğ‘…ğ¶ğ‘¤(ğ‘Ÿ).
ğ‘
ğ‘š
ğ‘›ğ‘– 1ğ‘š
ğ‘š
ğ‘
sreyalpforebmun(a)ErdÅ‘s-RÃ©nyi (b)Partition (c)DualBarabasi (d)PowerlawCluster (e)Intersection (f)NewmanWatts
ğ‘=0.4 ğ‘ğ‘–ğ‘›=0.9,ğ‘ğ‘œğ‘¢ğ‘¡ =0.1 Albert ğ‘š=8,ğ‘=0.8 ğ‘š=8,ğ‘=0.4 Strogatz
ğ‘š1=8,ğ‘š2=8, ğ‘˜=8,ğ‘=0.4
ğ‘=0.2
(g)ErdÅ‘s-RÃ©nyi (h)Partition (i)DualBarabasi (j)PowerlawCluster (k)Intersection (l)NewmanWatts
Albert Strogatz
Figure9:Exampleadjacencymatricesandvertexandedgeplotsofdifferentgraphclasses.
(a)Wine (b)Diabetes
Removal of Most Important Data Points Removal of Most Important Data Points
Wine (Budget = 50000) Diabetes (Budget = 50000)
0.5
0.975
Shapley Shapley
Least Core 0.4 Least Core 0.950
0.3
0.925
0.2
0.900
0.1
0.875
0 10 20 30 40 50
0 10 20 30 40 50
Data removal percentage
Data removal percentage
Figure10:DataValuationExperimentsfromSection5.3ontheWineandDiabetesdatasets.
erocs
ledoM
erocs
ledoM