1
UnderconsiderationforpublicationinJ.FluidMech.
Bannerappropriatetoarticletypewillappearhereintypesetarticle
Learning rheological parameters of non-Newtonian
fluids from velocimetry data
AlexandrosKontogiannis1â€ ,RichardHodgkinson2 andEmilyL.Manchester3
1EngineeringDepartment,UniversityofCambridge,TrumpingtonStreet,Cambridge,CB21PZ,UK
2MaterialsScienceandEngineeringDepartment,UniversityofSheffield,Sheffield,S13JD,UK
3Mechanical&AerospaceEngineeringDepartment,UniversityofManchester,Manchester,M139PL,UK
(Receivedxx;revisedxx;acceptedxx)
We solve a Bayesian inverse Navierâ€“Stokes (Nâ€“S) problem that assimilates velocimetry
data in order to jointly reconstruct the flow field and learn the unknown Nâ€“S parameters.
By incorporating a Carreau shear-thinning viscosity model into the Nâ€“S problem, we
devise an algorithm that learns the most likely Carreau parameters of a shear-thinning
fluid, and estimates their uncertainties, from velocimetry data alone. We then conduct a
flow-MRI experiment to obtain velocimetry data of an axisymmetric laminar jet through
an idealised medical device (FDA nozzle) for a blood analogue fluid. We show that the
algorithm can successfully reconstruct the flow field by learning the most likely Carreau
parameters, and that the learned parameters are in very good agreement with rheometry
measurements.Thealgorithmacceptsanyalgebraiceffectiveviscositymodel,aslongasthe
model is differentiable, and it can be extended to more complicated non-Newtonianfluids
(e.g.Oldroyd-Bfluid)ifaviscoelasticmodelisincorporatedintotheNâ€“Sproblem.
Keywords:rheology,Bayesianinference,magneticresonancevelocimetry
1. Introduction
Magneticresonancevelocimetry(flow-MRI)isanexperimentaltechniqueusedtomeasure
fluid velocities in time and three-dimensional space. Flow-MRI is most commonly known
for its use in vivo in clinical settings, however, it is gaining popularity within the wider
scientificcommunityforinvitroapplications(Elkins&Alley2007).Whilstflow-MRIcan
providereliablevelocitymeasurements, itdoesnotprovideinformationonfluidproperties
such as rheology or pressure, which require additional experiments. Various experimental
approachesarecapableofmeasuringafluidâ€™sshearstress-straincurve.Acquiringthisnon-
invasivelyischallengingasitrequiresknowledgeaboutboththestressandstrain,andsome
degree of control of either. Common experimental techniques to measure fluid viscosity
include rotational and capillary rheometry, which involve passing a fluid sample through
a precision geometry and measuring shear-rate, torque, or pressure drop. Other techniques
â€  Emailaddressforcorrespondence:ak2239@cam.ac.uk
Abstract must not spill onto p.2
4202
guA
5
]nyd-ulf.scisyhp[
1v40620.8042:viXra2
are available such as industrial â€˜in-lineâ€™ and â€˜on-lineâ€™ rheometry, or ultrasound velocity
profiling.However,thesemethodsareeitherhighlyinvasive(MagalhaËœesetal.2017)orrequire
pressure drop measurements (K. et al. 2022). Due to the additional costs and complexities
associatedwithrheometryexperiments,itisnotalwaysfeasibletoacquirerheologicaldata.
For computational fluid dynamic (CFD) simulations of non-Newtonian fluids, rheological
behaviours are captured in mathematical models via adjustable parameters. If unknown,
model parameters are typically selected using values taken from the literature. One such
applicationisthefieldofbiomedicalengineering,whereflow-MRIdataiscommonlyusedto
informpatient-specificcardiovascularmodels.Withoutpatientspecificbloodrheology,CFD
modelslackaccuracy.Ranftletal.(2023)performedanuncertaintyquantificationstudyto
investigate the impact of non-Newtonian and Newtonian CFD models on haemodynamic
outputs.Theyfoundthatspecifyingpatientrheologicalpropertiesisnecessaryforaccurate
wallshearstresspredictions.Thisisespeciallyimportantindiseaseswherebloodproperties
differfromhealthypopulationsandinsmallarterieswherenon-Newtonianeffectsdominate.
Bayesianinferenceisadata-driventechniquethatcanbeusedtoestimateunknownphysical
ormodelparametersandtheiruncertaintiesfromexperimentalreferencedata.Worthenetal.
(2014) used such an approach to infer two unknown parameters of a constitutive equation
for viscosity in mantle flow. The forward problem was governed by a Nonlinear Stokes
problem and experimental reference data took the form of surface velocity measurements.
Their method was able to recover constant and spatially-varying parameters reasonably
well.AlthoughWorthenâ€™sproblemdiffersfromours,theunderlyingapproachissimilarand
effectivelydemonstratesthefeasibilityofinferringrheologicalparametersfromexperimental
measurements.
Inthisstudyweaimtoinfertherheologicalparametersofashear-thinningbloodanalogue
from flow-MRI-measured velocity fields alone. The Carreau model is selected to represent
thenon-Newtonianfluidbehaviour(Sequeira&Janela2007)becauseitisdifferentiableand
bounded. Fluid experiments are performed using an idealised medical device, namely the
Food and Drug Administrationâ€™s (FDA) benchmark nozzle model, and data is assimilated
usingaBayesianinverseNavierâ€“Stokesproblemthatjointlyreconstructstheflowfieldand
learns the Carreau parameters. To the best of the authorsâ€™ knowledge, this is the first time
flow-MRIhasbeenusedforanon-invasivemeasurementofrheologicalparameterswithout
apressuredropmeasurement.
2. BayesianinversionoftheNavierâ€“Stokesproblem
Welearntherheologyofanon-NewtonianfluidfromvelocimetrydatabysolvingaBayesian
inverseNâ€“Sproblem.WefirstassumethatthereisaNâ€“SproblemwithaCarreaufluidmodel,
whichcanexplainthevelocimetrydata,ğ’–â˜….Thatis,thereexistNâ€“Sparametersğ’™â—¦suchthat
ğ’–â˜… âˆ’Zğ’™â—¦ =ğœº âˆ¼N(0,C ğ’–â˜…) , (2.1)
whereZisthenonlinearoperatorthatmapsNâ€“SparameterstoNâ€“Ssolutionsprojectedinto
thedataspace,andğœºisGaussiannoisewithzeromeanandcovarianceoperatorC ğ’–â˜….Wedo
not know ğ’™â—¦, but we assume that its prior probability distribution is N(ğ’™Â¯,C ğ’™Â¯), where ğ’™Â¯ is
thepriormean,and C ğ’™Â¯ isthepriorcovarianceoperator.UsingBayesâ€™theoremwethenfind
thattheposteriorprobabilitydensityfunction(p.d.f.)ofğ’™,giventhedatağ’–â˜…,isgivenby
ğœ‹(cid:0) ğ’™(cid:12) (cid:12)ğ’–â˜…(cid:1) âˆ ğœ‹(cid:0) ğ’–â˜…(cid:12) (cid:12)ğ’™(cid:1) ğœ‹(ğ’™) =exp(cid:16) âˆ’ 1 âˆ¥ğ’–â˜… âˆ’Zğ’™âˆ¥2 âˆ’ 1 âˆ¥ğ’™âˆ’ğ’™Â¯âˆ¥2 (cid:17) , (2.2)
2 C ğ’–â˜… 2 C ğ’™Â¯
where ğœ‹(cid:0) ğ’–â˜…(cid:12) (cid:12)ğ’™(cid:1) is the data likelihood, ğœ‹(cid:0) ğ’™(cid:1) is the prior p.d.f. of ğ’™, and âˆ¥Â·,Â·âˆ¥2 (cid:66) (cid:10) Â·,Câˆ’1Â·(cid:11)
C
isthecovariance-weighted ğ¿2-norm.Themostlikelyparameters, ğ’™â—¦,inthesensethatthey3
maximise the posterior p.d.f. (maximum a posteriori probability, or MAP estimator), are
givenimplicitlyasthesolutionofthenonlinearoptimisationproblem
ğ’™â—¦ â‰¡argminğ’¥ , where ğ’¥ (cid:66) âˆ’logğœ‹(cid:0) ğ’™(cid:12) (cid:12)ğ’–â˜…(cid:1) . (2.3)
ğ’™
UsingafirstorderTaylorexpansionofZ aroundğ’™ğ‘˜,givenby
Zğ’™ â‰ƒZğ’™ğ‘˜ +Gğ‘˜ (cid:0) ğ’™âˆ’ğ’™ğ‘˜) , (2.4)
theoptimalityconditionsofproblem(2.3)leadtothefollowingiteration(Tarantola2005)
ğ’™ğ‘˜+1 â†(cid:0) ğ’™ğ‘˜ +ğœ ğ‘˜ C ğ’™ğ‘˜ (cid:0)ğ· ğ’™ğ’¥(cid:1) ğ‘˜ , (2.5)
where (cid:0)ğ· ğ’™ğ’¥(cid:1) ğ‘˜ (cid:66) G ğ‘˜âˆ— C ğ’–âˆ’ â˜…1(cid:0) ğ’–â˜…âˆ’Zğ’™ğ‘˜(cid:1) +C ğ’™âˆ’ Â¯1(cid:0) ğ’™ğ‘˜âˆ’ğ’™Â¯(cid:1),ğœ ğ‘˜ isthestepsizeatiterationğ‘˜,which
is determined by a line-search algorithm, G ğ‘˜âˆ— is the adjoint of Gğ‘˜, and C
ğ’™ğ‘˜
is the posterior
covarianceoperatoratiteration ğ‘˜,whichisgivenby
C
ğ’™ğ‘˜
(cid:66) (cid:0) G ğ‘˜âˆ— C ğ’–âˆ’ â˜…1 Gğ‘˜ +C ğ’™âˆ’ Â¯1(cid:1)âˆ’1 . (2.6)
The posterior covariance operator around the MAP estimate, C , can then be used to
ğ’™â—¦
approximatetheposteriorp.d.f.suchthat
ğœ‹(cid:0) ğ’™(cid:12) (cid:12)ğ’–â˜…(cid:1) â‰ƒexp(cid:16) âˆ’ 1 âˆ¥ğ’™âˆ’ğ’™â—¦âˆ¥2 âˆ’const.(cid:17) , (2.7)
2 C ğ’™â—¦
which is known as the Laplace approximation. For linear models, the approximation is
exact when both ğœ‹(cid:0) ğ’–â˜…(cid:12) (cid:12)ğ’™(cid:1) and ğœ‹(ğ’™) are normal. For nonlinear models, the accuracy of the
approximationdependsonthebehaviouroftheoperatorZ aroundthecriticalpointğ’™â—¦.
2.1. Nâ€“SproblemandtheoperatorsZ,G
Inordertosolvetheinverseproblem(2.3)usingformulas(2.5),(2.6),weneedtodefineZ
andG.Tothatend,westartfromtheNâ€“SboundaryvalueprobleminÎ© âŠ‚ R3
ğ’–Â·âˆ‡ğ’–âˆ’âˆ‡Â· (cid:0)2ğœˆ ğ‘’âˆ‡ğ‘  ğ’–(cid:1) +âˆ‡ğ‘ =0 and âˆ‡Â·ğ’– =0 in Î© ,
ğ’– =0 on Î“ , ğ’– = ğ’ˆğ‘– on Î“ğ‘– , âˆ’2ğœˆ ğ‘’âˆ‡ğ‘  ğ’–Â·ğ‚+ ğ‘ğ‚ = ğ’ˆğ‘œ on Î“ğ‘œ , (2.8)
whereğ’–isthevelocity, ğ‘ â†(cid:0) ğ‘/ğœŒisthereducedpressure, ğœŒisthedensity,ğœˆ
ğ‘’
istheeffective
(kinematic)viscosity, (âˆ‡ğ‘  ğ’–)ğ‘–ğ‘— (cid:66) 21(ğœ• ğ‘—ğ‘¢ ğ‘– +ğœ• ğ‘–ğ‘¢ ğ‘—) isthestrain-ratetensor, ğ’ˆğ‘– istheDirichlet
boundarycondition(b.c.)attheinletÎ“ğ‘–,ğ’ˆğ‘œisthenaturalb.c.attheoutletÎ“ğ‘œ,andğ‚istheunit
normalvectorontheboundaryğœ•Î©= Î“âˆªÎ“ğ‘–âˆªÎ“ğ‘œ,whereÎ“istheno-slipboundary(wall).The
constructionoftheoperatorsZ,GofthegeneralisedinverseNâ€“Sproblem,whoseunknown
parametersaretheshapeofthedomainÎ©,theboundaryconditions ğ’ˆğ‘–,ğ’ˆğ‘œ,andtheviscosity
field ğœˆ ğ‘’, is treated in Kontogiannis et al. (2022, 2024). Here, we fix the geometry, Î©, and
the outlet b.c., ğ’ˆğ‘œ, and infer only the inlet b.c., ğ’ˆğ‘–, and the effective viscosity field, ğœˆ ğ‘’. We
furtherintroducetheCarreaumodelfortheeffectiveviscosityfield,whichisgivenby
ğœ‡ ğ‘’(ğ›¾(cid:164); ğ’‘ğœ‡) (cid:66) ğœ‡ âˆ+ğ›¿ğœ‡(cid:0)1+(ğœ†ğ›¾(cid:164))2(cid:1)(ğ‘›âˆ’1)/2 , (2.9)
âˆš
where ğœ‡ ğ‘’ (cid:66) ğœˆ ğ‘’ğœŒ, ğ›¾(cid:164)(ğ’–) (cid:66) 2âˆ‡ğ‘ ğ’– : âˆ‡ğ‘ ğ’– is the magnitude of the strain-rate tensor, and
ğ’‘ğœ‡ (cid:66) (cid:0)ğœ‡ âˆ,ğ›¿ğœ‡,ğœ†,ğ‘›(cid:1) are the Carreau fluid parameters. In order to infer the most likely
viscosityfield, ğœ‡â—¦,wethereforeneedtoinferthemostlikelyCarreaufluidparameters, ğ’‘â—¦.
ğ‘’ ğœ‡
After linearising problem (2.8) around ğ’–ğ‘˜, we obtain ğ’–(ğ’™) â‰ƒ ğ’–ğ‘˜ +Ağ‘˜(cid:0) ğ’™ âˆ’ ğ’™ğ‘˜), where
Ağ‘˜ â‰¡ (cid:0) (ğ· ğ’–â„³)âˆ’1ğ·â„³
ğ’™
(cid:1) ğ‘˜, with Ağ‘˜ being a linear, invertible operator, which encapsulates
the inverse Jacobian of the Nâ€“S problem, (ğ·â„³)âˆ’1, and the generalised gradient of the
ğ’–
velocityfieldwithrespecttotheparametersğ’™,ğ·â„³.ObservingthatZ,GmapfromtheNâ€“S
ğ’™4
parameter space to the (velocimetry) data space, we define Z (cid:66) SQ, and Gğ‘˜ (cid:66) SAğ‘˜,
whereS : ğ‘´ â†’ ğ‘« isaprojectionfromthemodelspace, ğ‘´,tothedataspace, ğ‘«,andQ is
theoperatorthatmapsğ’™toğ’–,i.e.solvestheNâ€“Sproblem.(OperatorsS,Q,Aarederivedin
Kontogiannisetal.(2024)fromtheweakformoftheNâ€“Sproblem(2.8),â„³.)Basedonthe
abovedefinitions,anddueto(2.5),weobservethatthemodelcontributiontotheobjectiveâ€™s
steepestdescentdirection,fortheCarreauparameters, ğ’‘ğœ‡,is
ğ›¿ğ’‘ğœ‡ (cid:66) G ğ‘˜âˆ— C ğ’–âˆ’ â˜…1(cid:0) ğ’–â˜… âˆ’Zğ’™ğ‘˜(cid:1) = (cid:0)ğ· (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)â„³ ğ’‘ (cid:32)(cid:32)(cid:32)ğœ‡(cid:32)(cid:32)(cid:32)(cid:32)(cid:1) (cid:32)(cid:32)âˆ— ğ‘˜ (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:0) (ğ· (cid:32)(cid:32)(cid:32)ğ’–â„³ (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)) (cid:32)(cid:32)(cid:32)âˆ— (cid:32)(cid:32)(cid:32)(cid:1) (cid:32)(cid:32)(cid:32)âˆ’ ğ‘˜ (cid:32)1 S (cid:32)(cid:32)âˆ— (cid:32)(cid:32)(cid:32)(cid:32)C (cid:32)(cid:32)(cid:32)(cid:32)ğ’–(cid:32)âˆ’ (cid:32)(cid:32)â˜… (cid:32)(cid:32)1 (cid:32)(cid:32)(cid:32)(cid:0) (cid:32)ğ’–â˜… (cid:32)(cid:32)(cid:32)âˆ’ (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)S (cid:32)(cid:32)(cid:32)(cid:32)(cid:32)(cid:32)ğ’– (cid:32)(cid:32)(cid:32)(cid:32)ğ‘˜ (cid:32)(cid:1) . (2.10)
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
ğ·ğ’‘ğœ‡ model-datadiscrepancyğ›¿ğ’–âˆˆğ‘´
ğ’–
Eventhough ğ·â„³ isinvertible,forlarge-scaleproblems,suchasthoseinfluiddynamics,its
ğ’–
inverse, (ğ·â„³)âˆ’1,cannotbestoredincomputermemorybecauseitsdiscreteformproduces
ğ’–
adensematrix.Thediscreteformofğ·â„³,however,producesasparsematrix.Consequently,
ğ’–
insteadofusingtheexplicitformula(2.10),thesteepestdescentdirectionsaregivenby
âˆ«
ğ›¿ğ’‘ğœ‡ (cid:66) (cid:0)ğ·â„³ ğ’‘ğœ‡(cid:1)âˆ—
ğ‘˜
ğ’—ğ‘˜ =2ğœŒ (cid:0)ğ· ğ’‘ğœ‡ğœ‡ ğ‘’(cid:1) ğ‘˜(cid:0) âˆ‡ğ‘  ğ’–ğ‘˜ : âˆ‡ğ‘  ğ’—ğ‘˜(cid:1) , (2.11)
Î©
where (cid:0)ğ· ğ’‘ğœ‡ğœ‡ ğ‘’(cid:1)
ğ‘˜
â‰¡ ğ· ğ’‘ğœ‡ğœ‡ ğ‘’(cid:0)ğ›¾(cid:164)(ğ’–ğ‘˜);(ğ’‘ğœ‡)ğ‘˜(cid:1) consistsofthederivativesoftheCarreaumodel
with respect to its parameters, and ğ’—ğ‘˜ is the adjoint velocity field, which is obtained by
solvingthefollowinglinearoperatorequation
ğ´ğ’—ğ‘˜ = ğ‘ , where ğ´ â‰¡ (cid:0)ğ· ğ’–â„³(cid:1)âˆ—
ğ‘˜
, and ğ‘ â‰¡Sâˆ—C ğ’–âˆ’ â˜…1(cid:0) ğ’–â˜… âˆ’Sğ’–ğ‘˜(cid:1) . (2.12)
Instead of explicitly computing C at every iteration using formula (2.6), we approximate
ğ’™ğ‘˜
C using the damped BFGS quasi-Newton method (Goldfarb et al. 2020), which ensures
ğ’™ğ‘˜
thatC remainspositivedefinite,anditsapproximationremainsnumericallystable.
ğ’™ğ‘˜
Algorithm1:Learningrheologicalparametersfromvelocimetrydata
Input:velocimetrydata,ğ’–â˜…,datacov.,C ğ’–â˜…,priormean,ğ’™Â¯,andpriorcov.C
ğ’™Â¯
Initialisation:set ğ‘˜ â†(cid:0)0,ğ’™0 â†(cid:0) ğ’™Â¯,andcomputeinitialvelocityfieldğ’–0 â†(cid:0) Q ğ’™0
whiletermination criterion is not metdo
(ğ’—,ğ‘)ğ‘˜ â†(cid:0)solveadjointNâ€“Sproblemaroundğ’–ğ‘˜ (eq.(2.12))
(cid:0)ğ· ğ’¥(cid:1) â†(cid:0)computesteepestdescentdirection (eq.(2.5),(2.11))
ğ’™ ğ‘˜
C ğ’™ğ‘˜,ğœ ğ‘˜ â†(cid:0)updatepost.cov.approx.andfindstepsize(dampedBFGS)
ğ’™ğ‘˜+1 â†(cid:0)ğ’™ğ‘˜ +ğœ ğ‘˜ C ğ’™ğ‘˜ğ· ğ’™ğ’¥,i.e.updateNâ€“Sparameters
ğ’–ğ‘˜+1 â†(cid:0)Q ğ’™ğ‘˜+1,i.e.updateNâ€“Ssolution,andset ğ‘˜ â†(cid:0) ğ‘˜ +1
Output:MAPestimates:ğ’–â—¦ â†(cid:0) ğ’–ğ‘˜, ğ‘â—¦ â†(cid:0) ğ‘ ğ‘˜,ğ’™â—¦ â†(cid:0) ğ’™ğ‘˜ andpost.covarianceC ğ’™â—¦
3. Flow-MRIexperimentofanon-Newtonianlaminarjet
ThetestsectionispartoftheFDAnozzle(Hariharanetal.2011;Stewartetal.2012),which
is an axisymmetric pipe that converges to a narrow throat section, followed by a sudden
expansion,whereanon-Newtonianlaminarjetforms(seefigure1).Thegeometrywas3D-
resin-printedtoanominaltoleranceofÂ±0.2mm.Acrylictubeswereattachedupstreamand
downstreamofthetestsection,andtheformerwasequippedwithaflowstraightenerarray.
Thetestsectionwasplacedinsideawater-filledacrylicoutertubeinordertoavoidair-induced
magneticsusceptibilitygradients.Apipeloopprovidedflowfrompumpinghardwareoutside
theMRIscannerroom,withthereturnpipeloopingbackthroughanannulargapbetweenthe
Focus on Fluids articles must not exceed this page length5
Figure1:OverallflowsystemandsetuparoundtheMRIscannerwithdetailoftheFDA
flownozzlegeometryimplemented.ID:Innerdiameter,OD:outerdiameter.
resonatorbodyandthegradientcoilinnerdiameter.Flowwascollectedinareceiverreservoir,
pumped via a variable speed diaphragm pump, fed to a pulsation dampening accumulator,
andthenbacktothetestsection.Controlledpumpbypassenabledverylowflowrateswhilst
keeping the pump oscillation frequency high. Loop circulation timescales are on the order
ofthescanningtimescale.Theflowloopwaspurgedofbubblesafterfilling,andK-Typeand
alcoholthermometersmeasurementsindicatedafluid(ambient)temperatureof21.8â—¦C.The
testsolutionusedhereisa46wt%haematocritlevelbloodanalogue(Brookshier&Tarbell
1993)(0.5wt%NaClwasomittedbecauseitwouldinterferewithMRI).A40wt%glycerine
solution in deionised water was first prepared and then used as the solvent for a 0.04wt%
xanthamgumsolution.Thesolutionappearsweaklyviscoelastic,withviscousstressesabove
elasticstressesintheir2Hzoscillatorysheartests,justifyingthegeneralisedNewtonianfluid
assumption. Flow-MRI was performed using a Bruker Biospec 70/30USR 7T preclinical
scanner(660mT/mgradients,35mmIDresonatorcoil).Imageswereacquiredwithuniform
radial pixel spacing of 0.1mm and axial slice thickness of 0.08mm. Four scan repetitions
wereperformedinordertoreducenoise(âˆ¼15minutestotalscanningtime).
3.1. Flow-MRIdatapre-processing
We use phase-contrast MRI and Hadamard encoding to measure all three components of
a three-dimensional velocity field using a single set of four, fully-sampled ğ’Œ-space scans,
{ğ‘ }4 ğ‘—=1.Foreachscanwecomputeitsrespectivecompleximage,ğ‘¤ ğ‘—,whichisgivenby
ğ‘¤ ğ‘— (cid:66) ğœŒ ğ‘—ğ‘’ğ‘–ğœ‘ ğ‘— = Fâˆ’1ğ‘  ğ‘— , (3.1)
where ğœŒ ğ‘— is the nuclear spin density image, ğœ‘ ğ‘— is the phase image, and F is the Fourier
transform.Thevelocitycomponentsğ‘¢ ğ‘–,forğ‘– =1,...3,arethengivenby
âˆ’1 1 1 âˆ’1
ğ‘¢ ğ‘– = ğ‘ ğ‘– â„ ğ‘–ğ‘— ğœ‘ ğ‘— , â„ ğ‘–ğ‘— =(cid:169) (cid:173)âˆ’1 1 âˆ’1 1(cid:170) (cid:174) , ğ‘— =1...4 , (3.2)
âˆ’1 âˆ’1 1 1
(cid:171) (cid:172)
where repeated indices imply summation, and ğ‘ is a known constant that depends on the
ğ‘–
gyromagnetic ratio of hydrogen and the gradient pulse properties. In order to remove any
phase shift contributions that are not caused by the flow, we conduct an additional no-flow
experiment. That is, we acquire a set of four ğ’Œ-space scans, {ğ‘ Â¯}4 , for the same geometry
ğ‘—=1
and field-of-view, but with zero flow (stagnant fluid). We then obtain the no-flow complex
images, ğ‘¤Â¯ , using equation (3.1), and compute the corresponding no-flow velocity images
ğ‘—6
using equation (3.2), such that ğ‘¢Â¯ ğ‘– = ğ‘Â¯ ğ‘–â„ ğ‘–ğ‘—ğœ‘Â¯ ğ‘—, where ğ‘Â¯ ğ‘– is the no-flow constant, which
is known. The corrected velocity is then given by ğ‘¢ ğ‘– = ğ‘ ğ‘–ğœƒ(â„ ğ‘–ğ‘—ğœ‘ ğ‘—) âˆ’ ğ‘Â¯ ğ‘–ğœƒ(â„ ğ‘–ğ‘—ğœ‘Â¯ ğ‘—), where
ğœƒ(ğ‘¥) = ğ‘¥âˆ’2ğœ‹(cid:0)(cid:4) (âŒŠğ‘¥/ğœ‹âŒ‹ âˆ’1)/2(cid:5) +1(cid:1) isthephasedifferenceunwrappingfunction,and âŒŠÂ·/Â·âŒ‹
denotes integer division. To increase the signal-to-noise ratio (SNR) of steady flow images
we acquire ğ‘› sets (in this study ğ‘› = 4) of ğ’Œ-space scans, generate their respective velocity
images {ğ‘¢ ğ‘–}ğ‘› ğ‘˜=1, and compute the average velocity image (cid:205)ğ‘› ğ‘˜=1(ğ‘¢ ğ‘–)ğ‘˜/ğ‘›. The noise variance
in the averaged velocity images then reduces to ğœ2/ğ‘›, where ğœ2 is the noise variance of
each individual velocity image. We straighten and centre the averaged flow-MRI images,
and,sincetheflowisaxisymmetric,wemirror-averagetheimagestofurtherincreaseSNR
andenforcemirror-symmetry.Wegenerateamaskfortheregionofinterestbysegmenting
themirror-averagednuclearspindensityimage,andapplythismasktothevelocityimages.
Because we solve an inverse Nâ€“S problem in a 3D discrete space comprised of trilinear
finite elements (voxels), the final pre-processing step is to ğ¿2-project the 2D axisymmetric
flow-MRI images, (ğ‘¢ ğ‘Ÿ,ğ‘¢ ğ‘§), to their corresponding 3D flow field, ğ’–â˜… = (ğ‘¢â˜… ğ‘¥,ğ‘¢â˜… ğ‘¦,ğ‘¢â˜… ğ‘§). Note
thatthe3Ddatathatwegeneratehavethesame(2D)spatialresolutionasthe2Dimages.
4. JointflowfieldreconstructionandCarreauparameterlearning
Weapplyalgorithm1tothenon-Newtonianaxisymmetricjetinordertojointlyreconstruct
the velocity field and learn the rheological parameters of the Carreau fluid. We use the
velocimetry data, ğ’–â˜…, and compute the data noise covariance, C ğ’–â˜… = ğœ2I, where I is the
identityoperator,andğœ = 0.234cm/s(Gudbjartsson&Patz1995)(Forreference,thepeak
jetvelocityisâˆ¼24cm/s.)Wefixthegeometry,Î©,whichisknown(sectionofFDAnozzle),
and the outlet b.c. to ğ’ˆğ‘œ â‰¡ 0, and we infer the unknown Carreau parameters and the inlet
b.c., ğ’ˆğ‘–. To test the robustness of algorithm 1, we assume high uncertainty in the priors by
setting the prior mean and covariance of the Carreau parameters to ğ’‘Â¯ ğœ‡ = (cid:0)ğœ‡ âˆ,ğ›¿ğœ‡,ğœ†,ğ‘›(cid:1) =
(cid:0)4 Â· 10âˆ’3, 1 Â· 10âˆ’1, 5, 1(cid:1), C ğ’‘Â¯
ğœ‡
= diag(cid:0)0.5 Â· 10âˆ’3, 0.5 Â· 10âˆ’1, 1, 0.5(cid:1)2, in SI units, and
ğœŒ =1099.3kg/m3.NotethatthepriormeancorrespondstoaNewtonianfluidwithviscosity
ğœ‡ ğ‘’(ğ’‘Â¯ ğœ‡) â‰¡ ğœ‡Â¯ âˆ+ğ›¿Â¯ğœ‡ â‰ƒ0.1Pa.s.Wesetthepriormeanoftheinletb.c.to ğ’ˆÂ¯ ğ‘– = (Sâˆ—ğ’–â˜…)| Î“ğ‘–,i.e.
therestrictionoftheSâˆ—-projecteddataonÎ“ğ‘–,andthepriorcovariancetoC ğ’ˆÂ¯ ğ‘– = ğœ ğ’ˆ2 Â¯ ğ‘–I,where
ğœ
ğ’ˆÂ¯
ğ‘–
=1cm/s. We infer the inlet b.c., instead of fixing its value to (Sâˆ—ğ’–â˜…)| Î“ğ‘–, in order to
compensateforlocalimagingartefactsand/ormeasurementbiaseson(ornear)Î“ğ‘–.
4.1. Flowfieldreconstruction
The reconstructed flow field, ğ’–â—¦, which is generated using algorithm 1, is shown in
figure 2 vs. the velocimetry data, ğ’–â˜…. We define the average model-data distance by
E(ğ‘¢ â–¡) (cid:66) |Î©|âˆ’1âˆ¥ğ‘¢â˜… â–¡âˆ’Sğ‘¢ â–¡âˆ¥ ğ¿2(Î©), where |Î©| is the volume of Î©, and â–¡ is a symbol place-
holder. For the reconstructed velocity field, ğ’–â—¦, we then find E(ğ‘¢â—¦) = E(ğ‘¢â—¦) = 0.71ğœ,
ğ‘¥ ğ‘¦
E(ğ‘¢â—¦) = 1.40ğœ, and compare this to the distance between the initial guess, ğ’–(0), and the
ğ‘§
dataE(ğ‘¢(0)) = E(ğ‘¢(0)) =1.39ğœ,E(ğ‘¢(0)) =5.87ğœ.Theinferred(MAP)vs.priorstrain-rate
ğ‘¥ ğ‘¦ ğ‘§
magnitude, ğ›¾(cid:164), and effective viscosity field, ğœ‡ ğ‘’(ğ›¾(cid:164)), are shown in figure 3. Note that, we
initialisealgorithm1usingthepriormeans,andthus ğœ‡ ğ‘’(0) = ğœ‡ ğ‘’(cid:0)ğ›¾(cid:164)(ğ’–0); ğ’‘Â¯ ğœ‡(cid:1) â‰ƒ0.1Pa.s.
4.2. Carreauparameterlearning
According to the optimisation log (figure 4a), the algorithm learns the unknown Nâ€“S
parameters in âˆ¼20 iterations (i.e. the Carreau parameters and the inlet b.c.), but most
of the work is done in âˆ¼10 iterations. Using the Carreau parameters learned at every
step, ğ‘˜, of the optimisation process, we plot the evolution of the posterior p.d.f. of ğœ‡
ğ‘’7
(a)axialvelocity,ğ‘¢ (b)radialvelocity,ğ‘¢
ğ‘§ ğ‘Ÿ
(c)streamlinesandmagnitude (d)slicesindices
(e)axialvelocity,ğ‘¢ (f)radialvelocity,ğ‘¢
ğ‘§ ğ‘Ÿ
Figure2:Imagesandslicesofreconstructed(MAP)flow,ğ’–â—¦,vs.velocimetrydata,ğ’–â˜….In
figures2eand2f,velocityisnormalisedbyğ‘ˆ =20cm/s,andlengthisnormalisedby
ğ¿=5mm.Weseparatethetransverseslicesintheplotbyapplyingaverticaloffsetof
0.1ğ‘›totheğ‘›-thslice(thehorizontaloffsetvalueisimmaterial).
(mean, ğœ‡(ğ‘˜), and covariance, C(ğ‘˜)) (figure 4b). The posterior covariance of ğœ‡(ğ‘˜) is given
ğ‘’ ğœ‡ ğ‘’
ğ‘’
by C ğœ‡( ğ‘’ğ‘˜) (cid:66) G ğœ‡(ğ‘˜ ğ‘’) C(cid:101)ğ’‘(ğ‘˜ ğœ‡) (cid:0) G ğœ‡(ğ‘˜ ğ‘’)(cid:1)âˆ—,where G ğœ‡(ğ‘˜ ğ‘’) istheJacobianoftheCarreaufluidmodel(2.9)
with respect to its parameters, ğ’‘ğœ‡, and C(cid:101)ğ’‘(ğ‘˜ ğœ‡) is the BFGS approximation of the posterior
covariance of the Carreau parameters, C(ğ‘˜). The prior uncertainty, shown in figure 4b as a
ğ’‘ğœ‡
Â±3ğœredshadedregion,issufficientlyhighandextendsbeyondtheğœ‡ ğ‘’âˆ’ğ›¾(cid:164)plottingrange.We
observethattheposterioruncertaintyof ğœ‡ significantlyreducesafterassimilatingthedata
ğ‘’
in the model, and that the highest uncertainty reduction is for 10 < ğ›¾(cid:164) < 200, which is the
ğ›¾(cid:164)-rangeofthelaminarjet(seefigure3a).Itisworthmentioningthat,eventhoughweobserve8
(a)strain-ratemagnitude[s-1] (b)effectiveviscosity[Pa.s]
Figure3:Inferred(MAP)vs.priorstrain-ratemagnitude,ğ›¾(cid:164),andeffectiveviscosity,ğœ‡ ğ‘’.
aflowforwhichğ›¾(cid:164) âˆˆ [0,200],themostinformativeregionistheonearoundthejet,becausei)
inertialeffectsbalanceviscouseffects,andii)thelocalvelocity-to-noiseratioishigh,hence
the uncertainty collapse in the jet-operating ğ›¾(cid:164)-range. The posterior p.d.f evolution of the
Carreauparametersisshowninfigure4c.Inthiscase,theprioruncertaintyiso-contourscan
bevisualisedusinghyperellipsoidsinR4whosecentresare ğ’‘Â¯ ğœ‡,andaxeslengthproportional
to(thecolumnsof)C
ğ’‘Â¯
ğœ‡.Tohighlighttheparameteruncertaintyreductionafterassimilating
the data, we set the origin to ğ’‘Â¯ ğœ‡, and scale each dimension of R4 using (the columns of)
C ğ’‘Â¯ ğœ‡.Inthistransformedspacetheprioruncertaintyiso-contoursarehyperspheres,andthe
posterioruncertaintyiso-contoursarehyperellipsoids,whoseslicesareshowninfigure4c.
Itisinterestingtonotethat,afterassimilatingthevelocimetrydata,theposterioruncertainty
collapses along the axes ğ‘›, ğ›¿ğœ‡, whilst it remains almost unaltered along the axes ğœ‡ , ğœ†.
âˆ
This is because, particularly for the asymptotic value ğœ‡
âˆ
(= ğœ‡ ğ‘’(ğ›¾(cid:164)) for ğ›¾(cid:164) â†’ âˆ), there is
not sufficient information in the data to further collapse the prior uncertainty. To further
collapse the uncertainty in the directions ğœ‡ ,ğœ†, a new experiment would need to include
âˆ
higherstrain-ratemagnitudes(ğ›¾(cid:164) â‰« 200s-1).
4.3. Validationviaanindependentrheometryexperiment
Steady-shearrheometryofthetestsolutionwasconductedusingaNetzschKinexusrheometer
witha 27.5mmcupanda 25mmbobgeometry,atthesametemperatureastheflow-MRI
experiment.TheexperimentwasconductedtovalidatetheCarreauparameterslearnedfrom
(cid:31) (cid:31)
the flow-MRI data (section 4.2) against rheometry data. To find the most likely Carreau
parameters that fit the rheometry data, we use Bayesian inversion (see section 2). In this
case,operatorZ correspondstotheCarreaumodel,givenbytheexplicitrelation(2.9),and
operatorG correspondstotheJacobianoftheCarreaumodelwithrespecttoitsparameters.
We use the same prior as in section 4. Because the prior uncertainty is sufficiently high
relativetothenoisevariance,thebiasitintroducestothemodelfitisnegligible.TheCarreau
parameters learned from flow-MRI vs. rheometry are shown in figure 5. We observe that
theparameterslearnedfromflow-MRIagreewithrheometrydata,consideringuncertainties
(table5b),andthatthelearnedeffectiveviscosityfieldfitstherheometrydata(figure5a).As
inthecaseoflearningfromflow-MRI,itisnotpossibletoinferğœ‡ andğœ†withhighcertainty
âˆ
whendata, ğœ‡ ğ‘’(ğ›¾(cid:164)),forğ›¾(cid:164) â‰« 200s-1 aremissing(rheometerflowinstabilityonset).
5. Summaryandconclusions
WehaveformulatedaBayesianinverseNâ€“Sproblemthatassimilatesvelocimetrydataof3D
steadyincompressibleflowinordertojointlyreconstructtheflowfieldandlearntheunknown9
(a)optimisationlog (b)p.d.f.evolutionofğœ‡
ğ‘’
(c)p.d.f.evolutionof ğ’‘ğœ‡
Figure4:Optimisationlog(figure4a),andposteriorp.d.f.evolutionoftheeffective
viscosity(figure4b)andtheCarreauparameters(figure4c).Infigure4ctheaxesaresuch
thatğ‘‘ ğœğ‘¥ (cid:66) (ğ‘¥âˆ’ğ‘¥Â¯)/ğœ ğ‘¥Â¯,whereğ‘¥Â¯isthepriormean,andğœ ğ‘¥Â¯ isthepriorstandarddeviation.
learnedfromflow-MRI
ğœ‡ (mPa.s) ğ›¿ğœ‡(mPa.s) ğœ† ğ‘›
âˆ
3.80Â±1.46 134Â±16.8 5.11Â±1.38 0.601Â±0.0437
learnedfromrheometry
ğœ‡ (mPa.s) ğ›¿ğœ‡(mPa.s) ğœ† ğ‘›
âˆ
4.64Â±1.18 132Â±11.0 3.36Â±0.904 0.539Â±0.0288
priors
4.00Â±1.50 100Â±150 5.00Â±3.00 1.00Â±1.50
(a)learnedeffectiveviscosity (b)learnedmodelparameters
Figure5:LearnedCarreaufittorheometrydata,learnedmodelparameters(MAP
estimates),andassumedpriors.Uncertaintiesinthefigurescorrespondto3ğœintervals.
Nâ€“S parameters. By incorporating a Carreau shear-thinning viscosity model into the Nâ€“S
problem, we devise an algorithm that learns the Carreau parameters of a shear-thinning
fluid, and estimates their uncertainties, from velocimetry data alone. Then we conduct a
flow-MRI experiment to obtain velocimetry data of an axisymmetric laminar jet through
an idealised medical device (FDA nozzle), for a blood analogue fluid. We show that the10
algorithm successfully reconstructs the noisy flow field, and, at the same time, learns the
Carreau parameters and their uncertainties. To ensure that the learned Carreau parameters
explaintherheologyofthefluid,insteadofsimplyfittingthevelocimetrydata,weconduct
an additional rheometry experiment. We find that the Carreau parameters learned from the
flow-MRI data alone are in very good agreement with the parameters learned from the
rheometryexperiment(takingintoaccounttheiruncertainties),andthatthelearnedeffective
viscosity field fits the rheometry data. In this paper we have applied the algorithm to a
Carreaufluid.Thepresentalgorithm,however,acceptsanygeneralisedNewtonianfluid,as
long as the model is (weakly) differentiable. More complicated non-Newtonian behaviour,
such as viscoelasticity, can be learned from velocimetry data if a viscoelastic model (e.g.,
Oldroyd-Bfluid)isincorporatedintotheNâ€“Sproblem.
REFERENCES
Brookshier,K.A.&Tarbell,J.M.1993Evaluationofatransparentbloodanalogfluid:AqueousXanthan
gum/glycerin.Biorheology30,107â€“116,2.
Elkins,C.J.&Alley,M.T.2007Magneticresonancevelocimetry:applicationsofmagneticresonance
imaginginthemeasurementoffluidmotion.ExperimentsinFluids43(6),823â€“858.
Goldfarb,D.,Ren,Y.&Bahamou,A.2020PracticalQuasi-NewtonMethodsforTrainingDeepNeural
Networks.InAdvancesinNeuralInformationProcessingSystems(ed.H.Larochelle,M.Ranzato,
R.Hadsell,M.F.Balcan&H.Lin),,vol.33,pp.2386â€“2396.CurranAssociates,Inc.
Gudbjartsson,H.&Patz,S.1995TheRicianDistributionofNoisyMRIData.MagneticResonancein
Medicine34(6),910â€“914.
Hariharan, P., Giarra, M., Reddy, V., Day, S. W., Manning, K. B., Deutsch, S., Stewart, S. F. C.,
Myers, M. R., Berman, M. R., Burgreen, G. W., Paterson, E. G. & Malinauskas, R. A.
2011MultilaboratoryParticleImageVelocimetryAnalysisoftheFDABenchmarkNozzleModel
to Support Validation of Computational Fluid Dynamics Simulations. Journal of Biomechanical
Engineering133(4),041002.
K., Shwetank, T., Gerhard, K., Sunil, E., Asad & R., Krishna 2022 Ultrasound velocity profiling
techniqueforin-linerheologicalmeasurements:Aprospectivereview.Measurement205,112152.
Kontogiannis, A., Elgersma, S. V., Sederman, A. J. & Juniper, M. P. 2022 Joint reconstruction and
segmentation of noisy velocity images as an inverse Navierâ€“Stokes problem. Journal of Fluid
Mechanics944,A40.
Kontogiannis, A., Elgersma, S. V., Sederman, A. J. & Juniper, M. P. 2024 Bayesian inverse
Navierâ€“Stokesproblems:jointflowfieldreconstructionandparameterlearning.SubmittedtoInverse
Problems.
MagalhaËœes,S.daC.,Folsta,M.,Noronha,E.V.N.,Scheid,C.M.&CalcÂ¸ada,L.A.2017Studyof
continuousrheologicalmeasurementsindrillingfluids.BrazilianJournalofChemicalEngineering
34(3),775â€“788.
Ranftl,S.,MuÂ¨ller,T.S.,Windberger,U.,Brenn,G.&vonderLinden,W.2023ABayesianapproach
to blood rheological uncertainties in aortic hemodynamics. International Journal for Numerical
MethodsinBiomedicalEngineering39.
Sequeira,A.&Janela,J.2007Anoverviewofsomemathematicalmodelsofbloodrheology.Springer
Netherlands.
Stewart, Sandy F. C., Paterson, Eric G., Burgreen, Greg W., Hariharan, Prasanna, Giarra,
Matthew, Reddy, Varun, Day, Steven W., Manning, Keefe B., Deutsch, Steven, Berman,
Michael R., Myers, Matthew R. & Malinauskas, Richard A. 2012 Assessment of CFD
PerformanceinSimulationsofanIdealizedMedicalDevice:ResultsofFDAâ€™sFirstComputational
InterlaboratoryStudy.CardiovascularEngineeringandTechnology3(2),139â€“160.
Tarantola,A.2005InverseProblemTheoryandMethodsforModelParameterEstimation.SIAM.
Worthen,J.,Stadler,G.,Petra,N.,Gurnis,M.&Ghattas,O.2014Towardsadjoint-basedinversion
for rheological parameters in nonlinear viscous mantle flow. Physics of the Earth and Planetary
Interiors234,23â€“34.
Rapids articles must not exceed this page length